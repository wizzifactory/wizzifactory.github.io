<!doctype html>
<html VERSION-5="5" VERSION-4="4" version="5">
<head>
    <title>The Wizzi Factory</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" />
    <link href="sanitize.css" rel="stylesheet" />
    <link href="../styles/main.css" rel="stylesheet" />
    <link href="styles.css" rel="stylesheet" />
</head>
<body class="Code-wizzi-repo">
    <nav class="navBar">
        <nav class="navMain">
            <a href="index.html.ittf"><div class="logo">
                <img width="100" height="45px" src="../images/logo.svg" />
            </div>
            </a>
            <input type="checkbox" id="menu-toggle" />
            <label for="menu-toggle" class="label-toggle"></label>
            <label for="menu-toggle" class="label-toggle-close">&times;</label>
            <ul>
                <li><a href="../concepts.html">Concepts</a>
                </li>
                <li><a href="../docs/intro.html">Documentation</a>
                </li>
                <li><a href="../api.html">Api</a>
                </li>
                <li class="nav1selected"><a href="../code/intro.html">Code</a>
                <nav class="navSub1_mobile">
                    <ul>
                        <li><a href="../code/intro.html">intro</a>
                        </li>
                        <li><a href="../code/wizzi.html">wizzi</a>
                        </li>
                        <li><a href="../code/wizzi-mtree.html">wizzi-mtree</a>
                        </li>
                        <li><a href="../code/wizzi-repo.html">wizzi-repo</a>
                        </li>
                        <li><a href="../code/wizzi-utils.html">wizzi-utils</a>
                        </li>
                        <li><a href="../code/wizzi-core.html">wizzi-core</a>
                        </li>
                        <li><a href="../code/wizzi-js.html">wizzi-js</a>
                        </li>
                        <li><a href="../code/wizzi-web.html">wizzi-web</a>
                        </li>
                        <li><a href="../code/wizzi-demo.html">wizzi-demo</a>
                        </li>
                    </ul>
                </nav>
                </li>
                <li><a href="../starters.html">Starters</a>
                </li>
                <li><a href="../project.html">Project</a>
                </li>
            </ul>
        </nav>
        <nav class="navSub1">
            <ul>
                <li><a href="../code/intro.html">intro</a>
                </li>
                <li><a href="../code/wizzi.html">wizzi</a>
                </li>
                <li><a href="../code/wizzi-mtree.html">wizzi-mtree</a>
                </li>
                <li class="subPageSelected"><a href="../code/wizzi-repo.html">wizzi-repo</a>
                </li>
                <li><a href="../code/wizzi-utils.html">wizzi-utils</a>
                </li>
                <li><a href="../code/wizzi-core.html">wizzi-core</a>
                </li>
                <li><a href="../code/wizzi-js.html">wizzi-js</a>
                </li>
                <li><a href="../code/wizzi-web.html">wizzi-web</a>
                </li>
                <li><a href="../code/wizzi-demo.html">wizzi-demo</a>
                </li>
            </ul>
        </nav>
    </nav>
    <main class="mainContent">
        <div class="site">
            <main id="wrapper-sub">
                <nav class="main-sidebar-left main-sidebar-left-sub">
                    <img src="../workinprogress.jpg" />
                    <section id="main-toc" class="toc">
                        <h3>wizzi-repo ittf source code:</h3>
                        <div class="treeview">
                            <ul>
                                <li><input type="checkbox" checked id="f2" />
                                <span></span>
                                <label for="f2">src</label>
                                <ul>
                                    <li><input type="checkbox" checked id="f3" />
                                    <span></span>
                                    <label for="f3">ittf</label>
                                    <ul>
                                        <li><input type="checkbox" id="f4" />
                                        <span></span>
                                        <label for="f4">_old</label>
                                        <ul>
                                            <li><input type="checkbox" id="f5" />
                                            <span></span>
                                            <label for="f5">lib</label>
                                            <ul>
                                                <li><input type="checkbox" id="f6" />
                                                <span></span>
                                                <label for="f6">fs</label>
                                                <ul>
                                                    <li><a href="#d1">file.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d2">index.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d3">repo.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d4">uriparser.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><input type="checkbox" id="f7" />
                                                <span></span>
                                                <label for="f7">git</label>
                                                <ul>
                                                    <li><a href="#d5">index.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><input type="checkbox" id="f8" />
                                                <span></span>
                                                <label for="f8">mongodb</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f9" />
                                                    <span></span>
                                                    <label for="f9">fs</label>
                                                    <ul>
                                                        <li><a href="#d6">file.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><input type="checkbox" id="f10" />
                                                    <span></span>
                                                    <label for="f10">glob</label>
                                                    <ul>
                                                        <li><a href="#d7">balanced-match.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d8">brace-expansion.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d9">common.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d10">concat-map.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d11">fs.realpath.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d12">glob.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d13">inflight.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d14">minimatch.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d15">old.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d16">once.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d17">path-is-absolute.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d18">wrappy.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><input type="checkbox" id="f11" />
                                                    <span></span>
                                                    <label for="f11">t</label>
                                                    <ul>
                                                        <li><input type="checkbox" id="f12" />
                                                        <span></span>
                                                        <label for="f12">filesystem</label>
                                                        <ul>
                                                            <li><a href="#d19">copyFile.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d20">fsstat.ittf</a>
                                                            </li>
                                                            <li><a href="#d21">glob.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d22">isFile.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d23">isFolder.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d24">mkdir.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d25">readdir.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d26">readFile.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d27">stat.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d28">writeFile.js.ittf</a>
                                                            </li>
                                                        </ul>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><a href="#d29">filesystem.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><input type="checkbox" id="f13" />
                                                <span></span>
                                                <label for="f13">repo</label>
                                                <ul>
                                                    <li><a href="#d30">fsapi.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d31">sanitize.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                            </ul>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f14" />
                                        <span></span>
                                        <label for="f14">examples</label>
                                        <ul>
                                            <li><input type="checkbox" id="f15" />
                                            <span></span>
                                            <label for="f15">ittf__copy</label>
                                            <ul>
                                                <li><input type="checkbox" id="f16" />
                                                <span></span>
                                                <label for="f16">mongoDocument</label>
                                                <ul>
                                                    <li><a href="#d32">bye_1.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d33">bye_2.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d34">bye_3.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f17" />
                                            <span></span>
                                            <label for="f17">t</label>
                                            <ul>
                                                <li><a href="#d35">base_example.js.ittf</a>
                                                </li>
                                                <li><a href="#d36">document_operations.js.ittf</a>
                                                </li>
                                                <li><a href="#d37">folder_data.js.ittf</a>
                                                </li>
                                                <li><a href="#d38">mongo_connect.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d39">jsonComponents.js.ittf</a>
                                            </li>
                                            <li><a href="#d40">jsonDocument.js.ittf</a>
                                            </li>
                                            <li><a href="#d41">jsonFsImpl.js.ittf</a>
                                            </li>
                                            <li><a href="#d42">jsonFsJson.js.ittf</a>
                                            </li>
                                            <li><a href="#d43">mongoDocument.js.ittf</a>
                                            </li>
                                            <li><a href="#d44">mongoFile.js.ittf</a>
                                            </li>
                                            <li><a href="#d45">mongoFsDb.js.ittf</a>
                                            </li>
                                            <li><a href="#d46">mongoFsImpl.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f18" />
                                        <span></span>
                                        <label for="f18">lib</label>
                                        <ul>
                                            <li><input type="checkbox" id="f19" />
                                            <span></span>
                                            <label for="f19">json</label>
                                            <ul>
                                                <li><input type="checkbox" id="f20" />
                                                <span></span>
                                                <label for="f20">fs</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f21" />
                                                    <span></span>
                                                    <label for="f21">t</label>
                                                    <ul>
                                                        <li><input type="checkbox" id="f22" />
                                                        <span></span>
                                                        <label for="f22">fsjson</label>
                                                        <ul>
                                                            <li><a href="#d47">deleteItem.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d48">getItem.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d49">insertItem.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d50">read.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d51">updateItem.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d52">write.js.ittf</a>
                                                            </li>
                                                        </ul>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><a href="#d53">document.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d54">fsjson.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><input type="checkbox" id="f23" />
                                                <span></span>
                                                <label for="f23">t</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f24" />
                                                    <span></span>
                                                    <label for="f24">jsonFsimpl</label>
                                                    <ul>
                                                        <li><a href="#d55">m.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d56">directoryTree.js.ittf</a>
                                                </li>
                                                <li><a href="#d57">index.js.ittf</a>
                                                </li>
                                                <li><a href="#d58">jsonFsimpl.js.ittf</a>
                                                </li>
                                                <li><a href="#d59">jsonUriParser.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f25" />
                                            <span></span>
                                            <label for="f25">mongodb</label>
                                            <ul>
                                                <li><input type="checkbox" id="f26" />
                                                <span></span>
                                                <label for="f26">fs</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f27" />
                                                    <span></span>
                                                    <label for="f27">t</label>
                                                    <ul>
                                                        <li><input type="checkbox" id="f28" />
                                                        <span></span>
                                                        <label for="f28">fsdb</label>
                                                        <ul>
                                                            <li><a href="#d60">deleteItem.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d61">getItem.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d62">insertItem.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d63">read.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d64">updateItem.js.ittf</a>
                                                            </li>
                                                            <li><a href="#d65">write.js.ittf</a>
                                                            </li>
                                                        </ul>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><a href="#d66">document.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d67">fsdb.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><input type="checkbox" id="f29" />
                                                <span></span>
                                                <label for="f29">t</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f30" />
                                                    <span></span>
                                                    <label for="f30">mongoFsimpl</label>
                                                    <ul>
                                                        <li><a href="#d68">m.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d69">errors.js.ittf</a>
                                                </li>
                                                <li><a href="#d70">mongoFsimpl.js.ittf</a>
                                                </li>
                                                <li><a href="#d71">mongoUriParser.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f31" />
                                            <span></span>
                                            <label for="f31">repo</label>
                                            <ul>
                                                <li><input type="checkbox" id="f32" />
                                                <span></span>
                                                <label for="f32">t</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f33" />
                                                    <span></span>
                                                    <label for="f33">ittfDocumentFinder</label>
                                                    <ul>
                                                        <li><a href="#d72">recurserTFolder.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d73">errors.js.ittf</a>
                                                </li>
                                                <li><a href="#d74">fileSystemStore.js.ittf</a>
                                                </li>
                                                <li><a href="#d75">fragmentsFinder.js.ittf</a>
                                                </li>
                                                <li><a href="#d76">ittfDocumentFinder.js.ittf</a>
                                                </li>
                                                <li><a href="#d77">ittfDocumentStore.js.ittf</a>
                                                </li>
                                                <li><a href="#d78">jsonDbStore.js.ittf</a>
                                                </li>
                                                <li><a href="#d79">mongoDbStore.js.ittf</a>
                                                </li>
                                                <li><a href="#d80">uriParser.js.ittf</a>
                                                </li>
                                                <li><a href="#d81">utils.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f34" />
                                            <span></span>
                                            <label for="f34">t</label>
                                            <ul>
                                                <li><input type="checkbox" id="f35" />
                                                <span></span>
                                                <label for="f35">fscommon</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f36" />
                                                    <span></span>
                                                    <label for="f36">document</label>
                                                    <ul>
                                                        <li><a href="#d82">copyFile.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d83">copyFolder.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d84">createFolder.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d85">createWriteStream.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d86">deleteFile.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d87">deleteFolder.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d88">download.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d89">exists.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d90">getContent.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d91">getDir.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d92">getFiles.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d93">getFolder.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d94">isFile.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d95">isFolder.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d96">readFile.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d97">renameFile.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d98">renameFolder.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d99">stat.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d100">upload.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d101">writeFile.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d102">check_wz_callback.js.ittf</a>
                                                </li>
                                                <li><a href="#d103">check_wz_not_empty.js.ittf</a>
                                                </li>
                                                <li><a href="#d104">co_run_test.js.ittf</a>
                                                </li>
                                                <li><a href="#d105">co_run.js.ittf</a>
                                                </li>
                                                <li><a href="#d106">error.js.ittf</a>
                                                </li>
                                                <li><a href="#d107">repeater.js.ittf</a>
                                                </li>
                                                <li><a href="#d108">throw_error.js.ittf</a>
                                                </li>
                                                <li><a href="#d109">var_cb_error.js.ittf</a>
                                                </li>
                                                <li><a href="#d110">var_error.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f37" />
                                            <span></span>
                                            <label for="f37">utils</label>
                                            <ul>
                                                <li><a href="#d111">_ild_objectId.js.ittf</a>
                                                </li>
                                                <li><a href="#d112">collection.js.ittf</a>
                                                </li>
                                                <li><a href="#d113">errors.js.ittf</a>
                                                </li>
                                                <li><a href="#d114">fsstream.js.ittf</a>
                                                </li>
                                                <li><a href="#d115">objectId.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d116">errors.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f38" />
                                        <span></span>
                                        <label for="f38">meta</label>
                                        <ul>
                                            <li><a href="#d117">index.json.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f39" />
                                        <span></span>
                                        <label for="f39">root</label>
                                        <ul>
                                            <li><input type="checkbox" id="f40" />
                                            <span></span>
                                            <label for="f40">t</label>
                                            <ul>
                                                <li><a href="#d118">json.js.ittf</a>
                                                </li>
                                                <li><a href="#d119">mongoDb.js.ittf</a>
                                                </li>
                                                <li><a href="#d120">readme_content.md.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d121">.gitignore.text.ittf</a>
                                            </li>
                                            <li><a href="#d122">index.js.ittf</a>
                                            </li>
                                            <li><a href="#d123">license.text.ittf</a>
                                            </li>
                                            <li><a href="#d124">package.json.ittf</a>
                                            </li>
                                            <li><a href="#d125">readme.md.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f41" />
                                        <span></span>
                                        <label for="f41">t</label>
                                        <ul>
                                            <li><a href="#d126">checked_call_return_set.js.ittf</a>
                                            </li>
                                            <li><a href="#d127">checked_call_return.js.ittf</a>
                                            </li>
                                            <li><a href="#d128">checked_call.js.ittf</a>
                                            </li>
                                            <li><a href="#d129">error.js.ittf</a>
                                            </li>
                                            <li><a href="#d130">f_cb_done.js.ittf</a>
                                            </li>
                                            <li><a href="#d131">f_cb_no_err.js.ittf</a>
                                            </li>
                                            <li><a href="#d132">f_cb_test.js.ittf</a>
                                            </li>
                                            <li><a href="#d133">f_cb_throw.js.ittf</a>
                                            </li>
                                            <li><a href="#d134">f_cb.js.ittf</a>
                                            </li>
                                            <li><a href="#d135">r_cb_error.js.ittf</a>
                                            </li>
                                            <li><a href="#d136">r_cb_wz_err.js.ittf</a>
                                            </li>
                                            <li><a href="#d137">r_cb.js.ittf</a>
                                            </li>
                                            <li><a href="#d138">r_wz_err.js.ittf</a>
                                            </li>
                                            <li><a href="#d139">var_cb_error.js.ittf</a>
                                            </li>
                                            <li><a href="#d140">var_error.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f42" />
                                        <span></span>
                                        <label for="f42">tests_stop</label>
                                        <ul>
                                            <li><input type="checkbox" id="f43" />
                                            <span></span>
                                            <label for="f43">json</label>
                                            <ul>
                                                <li><input type="checkbox" id="f44" />
                                                <span></span>
                                                <label for="f44">t</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f45" />
                                                    <span></span>
                                                    <label for="f45">fsjson</label>
                                                    <ul>
                                                        <li><a href="#d141">createItem.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d142">deleteItem.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d143">updateItem.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d144">writeFile.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d145">document.js.ittf</a>
                                                </li>
                                                <li><a href="#d146">fsjson.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f46" />
                                            <span></span>
                                            <label for="f46">mongodb</label>
                                            <ul>
                                                <li><a href="#d147">document.js.ittf</a>
                                                </li>
                                                <li><a href="#d148">folder.js.ittf</a>
                                                </li>
                                                <li><a href="#d149">fsdb.js.ittf</a>
                                                </li>
                                                <li><a href="#d150">fsimpl.js.ittf</a>
                                                </li>
                                                <li><a href="#d151">index.js.ittf</a>
                                                </li>
                                                <li><a href="#d152">uriParser.js.ittf</a>
                                                </li>
                                                <li><a href="#d153">vfile_db.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f47" />
                                            <span></span>
                                            <label for="f47">repo</label>
                                            <ul>
                                                <li><input type="checkbox" id="f48" />
                                                <span></span>
                                                <label for="f48">data</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f49" />
                                                    <span></span>
                                                    <label for="f49">t</label>
                                                    <ul>
                                                        <li><a href="#d154">frag1.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d155">frag2.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d156">ittf_object_args_item.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d157">mixin_1.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d158">mixin_2_appender.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d159">mixin_2_evaluator.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d160">mixin_3_evaluator.tests.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><a href="#d161">appender_1.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d162">doc1.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d163">doc2.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d164">evaluator_1.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d165">evaluator_2.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d166">evaluator_3.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d167">evaluator_4.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d168">evaluator_5.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d169">ittf_object_args.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d170">lexer_1.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d171">mixer_1.tests.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d172">ittfDocumentFinder.js.ittf</a>
                                                </li>
                                                <li><a href="#d173">ittfDocumentStore.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f50" />
                                            <span></span>
                                            <label for="f50">utils</label>
                                            <ul>
                                                <li><a href="#d174">collection.js.ittf</a>
                                                </li>
                                                <li><a href="#d175">objectid.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f51" />
                                        <span></span>
                                        <label for="f51">tests</label>
                                        <ul>
                                            <li><input type="checkbox" id="f52" />
                                            <span></span>
                                            <label for="f52">json</label>
                                            <ul>
                                                <li><input type="checkbox" id="f53" />
                                                <span></span>
                                                <label for="f53">t</label>
                                                <ul>
                                                    <li><a href="#d176">json_after_async.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d177">json_before_async.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d178">fsimpl.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f54" />
                                            <span></span>
                                            <label for="f54">mocks</label>
                                            <ul>
                                                <li><a href="#d179">misc.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f55" />
                                            <span></span>
                                            <label for="f55">mongodb</label>
                                            <ul>
                                                <li><input type="checkbox" id="f56" />
                                                <span></span>
                                                <label for="f56">t</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f57" />
                                                    <span></span>
                                                    <label for="f57">folder</label>
                                                    <ul>
                                                        <li><a href="#d180">copyFolder.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d181">deleteFolder.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d182">download.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d183">getFiles.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d184">renameFolder.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d185">upload.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><input type="checkbox" id="f58" />
                                                    <span></span>
                                                    <label for="f58">fsdb</label>
                                                    <ul>
                                                        <li><a href="#d186">createItem.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d187">deleteItem.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d188">readDocument.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d189">updateItem.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d190">writeDocument.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><input type="checkbox" id="f59" />
                                                    <span></span>
                                                    <label for="f59">vfile_db</label>
                                                    <ul>
                                                        <li><a href="#d191">glob.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><a href="#d192">async.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d193">co_run_test.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d194">co_run.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d195">expect_throw_error.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d196">itasync.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d197">mongo_after_async.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d198">mongo_before_async.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f60" />
                                            <span></span>
                                            <label for="f60">t</label>
                                            <ul>
                                                <li><input type="checkbox" id="f61" />
                                                <span></span>
                                                <label for="f61">fscommon</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f62" />
                                                    <span></span>
                                                    <label for="f62">document</label>
                                                    <ul>
                                                        <li><a href="#d199">copyFile.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d200">createFolder.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d201">deleteFile.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d202">getFolder.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d203">isFile.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d204">isFolder.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d205">readFile.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d206">renameFile.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d207">write_read_File.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><input type="checkbox" id="f63" />
                                                    <span></span>
                                                    <label for="f63">fsimpl</label>
                                                    <ul>
                                                        <li><a href="#d208">writeFile.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d209">base_test.js.ittf</a>
                                                </li>
                                                <li><a href="#d210">expect_throw_error.js.ittf</a>
                                                </li>
                                                <li><a href="#d211">f_cb_done.js.ittf</a>
                                                </li>
                                                <li><a href="#d212">f_cb_no_err.js.ittf</a>
                                                </li>
                                                <li><a href="#d213">f_cb_test.js.ittf</a>
                                                </li>
                                                <li><a href="#d214">f_cb_throw.js.ittf</a>
                                                </li>
                                                <li><a href="#d215">tobe_array.js.ittf</a>
                                                </li>
                                                <li><a href="#d216">tobe_eql.js.ittf</a>
                                                </li>
                                                <li><a href="#d217">tobe_equal.js.ittf</a>
                                                </li>
                                                <li><a href="#d218">tobe_false.js.ittf</a>
                                                </li>
                                                <li><a href="#d219">tobe_null.js.ittf</a>
                                                </li>
                                                <li><a href="#d220">tobe_number.js.ittf</a>
                                                </li>
                                                <li><a href="#d221">tobe_object.js.ittf</a>
                                                </li>
                                                <li><a href="#d222">tobe_string_value.js.ittf</a>
                                                </li>
                                                <li><a href="#d223">tobe_string.js.ittf</a>
                                                </li>
                                                <li><a href="#d224">tobe_true.js.ittf</a>
                                                </li>
                                                <li><a href="#d225">tobe_typeof.js.ittf</a>
                                                </li>
                                                <li><a href="#d226">tobe_undefined.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                        </ul>
                                        </li>
                                    </ul>
                                    </li>
                                    <li><a href="#d227">generate.wfjob.ittf</a>
                                    </li>
                                </ul>
                                </li>
                            </ul>
                        </div>
                    </section>
                </nav>
                <div class="main-content">
                    <div class="code-panel" id="d1">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/fs/file.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> path = require('path')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fs = require('fs')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> iconv = require('iconv-lite')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> glob = require('glob')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = module.exports = {}</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> pathSeparatorRe = /[\/\\]/g</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.defaultEncoding = 'utf8'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.preserveBOM = false</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.exists</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fs.lstat</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> String(path_string)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> stat </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> err.code === 'ENOENT'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> false</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> stat.isFile() || stat.isDirectory()</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.isDirectory</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fs.lstat</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> String(path_string)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> stat </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> err.code === 'ENOENT'</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> false</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> stat.isDirectory()</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.isFile</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fs.lstat</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> String(path_string)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> stat </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> err.code === 'ENOENT'</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> false</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> stat.isFile()</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.read</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fs.readFile</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> String(path_string)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> options.encoding !== null</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> content = iconv.decode(content, (options.encoding || md.defaultEncoding))</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> !md.preserveBOM && content.charCodeAt(0) === 0xFEFF</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> content = content.substring(1)</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.getGlobbedFiles</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> globPattern</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> removeRoot = options.removeRoot</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> glob</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> String(globPattern)</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> files </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> removeRoot</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> files</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> files.map</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> file</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span><span class="pp-pln"> file.replace(removeRoot, '')</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.fs.file.getGlobbedFiles', files</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> files</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.write</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> md.mkpath</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> !Buffer.isBuffer(content)</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> content = iconv.encode(content, (options.encoding || md.defaultEncoding))</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> fs.writeFile</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> String(path_string)</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> true</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.mkpath</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> dir = path.dirname(path_string)</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> md.mkdir(dir, callback)</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.mkdir</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> dirpath</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mode</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (mode) === 'function'</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = mode, mode = null</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> mode == null</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> mode = parseInt('0777', 8) & ~ (process.umask())</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> part, parts = dirpath.split(pathSeparatorRe)</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> len = parts.length</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> pathArray = []</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> repeater</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> index == len</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> we are done, return</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null)</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> part = parts[index]</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> pathArray.push(part)</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> subpath = path.resolve(pathArray.join('/'))</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> md.exists</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> subpath</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> result == false</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> fs.mkdir</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> subpath</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mode</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                                        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(index + 1)</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(index + 1)</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(0)</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.copy</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> source_path_string</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> dest_path_string</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> md.mkpath</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> String(dest_path_string)</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> md.read</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> String(source_path_string)</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> md.write</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> String(dest_path_string)</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> true</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d2">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/fs/index.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> uriparser = require('./uriparser')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('./file')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> repo = require('./repo')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = module.exports = {}</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> win32 = process.platform === 'win32'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.unixifyPath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> path_string</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> win32</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> path_string.replace(/\\/g, '/')</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> path_string</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.exists</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> path_string</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriparser</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> parsed </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parsed.storeKind === 'repo'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> repo.exists(parsed, callback)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> file.exists(path_string, callback)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.isFile</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> path_string</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriparser</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> parsed </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parsed.storeKind === 'repo'</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> repo.isFile(parsed, callback)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> file.isFile(path_string, callback)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.isDirectory</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> path_string</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriparser</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> parsed </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parsed.storeKind === 'repo'</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> repo.isDirectory(parsed, callback)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> file.isDirectory(path_string, callback)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.read</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> path_string</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(options) === 'function'</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = options, options = {}</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !options</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">check_wz_callback(</span><span class="pp-arg"> read </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriparser</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> parsed </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parsed.storeKind === 'repo'</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> repo.read(parsed, options, callback)</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> file.read(path_string, options, callback)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.readJSON</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> path_string</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (options) === 'function'</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = options, options = {}</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !options</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">check_wz_callback(</span><span class="pp-arg"> readJSON </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> md.read</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                    </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> result = JSON.parse(content)</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                    </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> JSONParseError</span><span class="pp-pln">,</span><span class="pp-arg">  readJSON</span><span class="pp-pln">,</span><span class="pp-arg">  ex  </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Unable to parse ' +  path_string + '. Message: ' + ex.message</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.readXml</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> path_string</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (options) === 'function'</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = options, options = {}</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !options</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">check_wz_callback(</span><span class="pp-arg"> readXml </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> NotImplementedYet</span><span class="pp-pln">,</span><span class="pp-arg">  readXml </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Not implemented yet. Trying to read: ' + path_string</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.getGlobbedFiles</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> globPattern</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (options) === 'function'</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = options, options = {}</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !options</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">check_wz_callback(</span><span class="pp-arg"> getGlobbedFiles </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriparser</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> globPattern</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> parsed </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parsed.storeKind === 'repo'</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> repo.getGlobbedFiles(parsed, options, callback)</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> file.getGlobbedFiles(globPattern, options, callback)</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.write</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> path_string</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> content</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (options) === 'function'</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = options, options = {}</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !options</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">check_wz_callback(</span><span class="pp-arg"> write </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriparser</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> parsed </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parsed.storeKind === 'repo'</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> repo.write(parsed, content, options, callback)</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> file.write(path_string, content, options, callback)</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.mkdir</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> path_string</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mode</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (mode) === 'function'</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = mode, mode = null</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(callback) !== 'function'</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error('wizzi-repo.fs.index.mkdir error. Missing callback parameter. Trying to read: ' + path_string)</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">check_wz_callback(</span><span class="pp-arg"> mkdir </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriparser</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> parsed </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parsed.storeKind === 'repo'</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> no mode param for repo.mkdir</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> repo.mkdir(parsed, callback)</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> file.mkdir(path_string, mode, callback)</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.copy</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> source_path_string</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> dest_path_string</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriparser</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> source_path_string</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> parsed </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parsed.storeKind === 'repo'</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> repo.copy(parsed, dest_path_string, callback)</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> file.copy(source_path_string, dest_path_string, callback)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d3">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/fs/repo.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> uriparser = require('./uriparser')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> repoFS = null</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> verifyFS</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> repoFS == null</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> repoFS = require('wizzi-mongodb').Filesystem</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> repoFS && repoFS.isMounted</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Module lib/ittf/fs/repo. MongoDB wizzi repo database not mounted. Review your wizzi instance starter.'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = module.exports = {}</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.exists</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> parsed_path_string</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> verifyFS</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> repoFS.exists</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.userId</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.projectId</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.path</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.isFile</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> parsed_path_string</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> verifyFS</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> repoFS.isFile</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.userId</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.projectId</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.path</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.isDirectory</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> parsed_path_string</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> verifyFS</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> repoFS.isFolder</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.userId</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.projectId</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.path</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.mkdir</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> parsed_path_string</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> verifyFS</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> repoFS.mkdir</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.userId</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.projectId</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.path</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.read</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> parsed_path_string</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> verifyFS</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> repoFS.readFile</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.userId</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.projectId</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.path</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.getGlobbedFiles</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> parsed_path_string</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> verifyFS</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> repoFS.glob</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.userId</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.projectId</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.path</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.write</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> parsed_path_string</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> verifyFS</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> repoFS.writeFile</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.userId</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.projectId</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_path_string.path</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.copy</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> parsed_source_path_string</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> dest_path_string</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriparser</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> String(dest_path_string)</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> parsed_dest_path_string </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parsed_dest_path_string.storeKind !== 'repo'</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Destination uri must have schema = "repo", instead it is : ' + dest_path_string</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> "copy"</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> parsed_dest_path_string.userId !== parsed_source_path_string.userId</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Copy of documents between different users is not implemented : ' + parsed_source_path_string.userId + '/' + parsed_dest_path_string.userId</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> "copy"</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> repoFS.copyFile</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_source_path_string.userId</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_source_path_string.projectId</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_source_path_string.path</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_dest_path_string.projectId</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsed_dest_path_string.path</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> true</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d4">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/fs/uriparser.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.fs.uriParser</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> url</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> parse</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> uri</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> uri = uri.toLowerCase()</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = {}</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> parsedUri = url.parse(uri)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(parsedUri.protocol) !== 'string'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  parse </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Uri must have a protocol (must be an absolute url). Received: ' + uri</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> protocol</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> parsedUri.protocol.substr(-1, 1) === ':'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> parsedUri.protocol.substr(0, (parsedUri.protocol.length - 1))</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> parsedUri.protocol</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'parseuri.parsedUri', parsedUri</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> name, parts = parsedUri.pathname ? parsedUri.pathname.split('/') : []</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> parsedUri.pathname && parsedUri.pathname.length &gt; 0 && parsedUri.pathname[0] == '/'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> parts.shift()</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> name = parts[parts.length-1]</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ret.basename = name</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nameparts = name.split('.')</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> nameparts.length &gt; 2 && nameparts[nameparts.length -1] === 'ittf'</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.isIttfDocument = true</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.schema = nameparts[nameparts.length -2]</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.isIttfDocument = false</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.extension = nameparts[nameparts.length -1]</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> protocol.length === 1</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.storeKind = 'filesystem'</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ret.isIttfDocument</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parts.length &lt; 3</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  parse </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Invalid uri for an IttfDocument. Too short. Received: ' + uri</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> ret.userId = parts[0]</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> ret.projectId = parts[1]</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> ret.uri = uri</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> parts.shift()</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> parts.shift()</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> ret.path = parts.join('/')</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> ret.path = parts.join('/')</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> protocol === 'repo'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> parts.length &lt; 2</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  parse </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'uri'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Invalid uri for an IttfDocument. Too short. Received: ' + uri</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.fs.uriparser.parsedUri.parts', parts</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.fs.uriparser.parsedUri', parsedUri</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.storeKind = 'repo'</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.userId = parsedUri.host</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.projectId = parts[0]</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.uri = uri</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> parts.shift();</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.path = parts.join('/')</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  parse </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Invalid uri protocol for an IttfDocument. Must be a drive letter or "repo". Received: ' + uri</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'parseuri.ret', ret</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ret</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d5">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/git/index.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d6">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/fs/file.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> fs</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> iconv = require('iconv-lite')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> pathSeparatorRe = /[\/\\]/g</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.defaultEncoding = 'utf8'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.preserveBOM = false</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> getFilesDefaults</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> deep true</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> extension null</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> documentContent false</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.getFiles</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> options = Object.assign({}, getFilesDefaults, (options || {}))</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> md.isDirectory(path_string)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> files</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> md._appendFiles(path_string, files, options)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> result = files</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> md.isFile(path_string)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> result = [normalize(path_string)]</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> result = []</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> options.documentContent</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">var</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">decl</span><span class="pp-pln"> newResult</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">decl</span><span class="pp-pln"> content</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in result</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> content = md.read(item)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> newResult.push</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> file item</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> content content</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> newResult</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> result</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md._appendFiles</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> files</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> dir = fs.readdirSync(String(path_string))</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> folders = []</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in dir</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> filePath = path.join(path_string, item)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.file._appendFiles found item', filePath</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> md.isDirectory(filePath)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> options.deep</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> folders.push(item)</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> !options.extension || item.substr(-options.extension.length) === options.extension</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filemd._appendFiles added file', filePath</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> files.push</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in folders</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> folderPath = path.join(path_string, item)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> md._appendFiles(folderPath, files, options)</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> getFoldersDefaults</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> deep true</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> tFoldersOnly false</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> documentNames false</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> documentContents false</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.getFolders</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> options = Object.assign({}, getFoldersDefaults, options)</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> result</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> md.isDirectory(path_string)</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> folders</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> md._appendFolders(path_string, folders, options)</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> result = folders</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> md.isDirectory(path_string)</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> result = [normalize(path_string)]</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> result = []</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> options.documentNames</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-tag">var</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                    </span><span class="pp-tag">decl</span><span class="pp-pln"> newResult</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                    </span><span class="pp-tag">decl</span><span class="pp-pln"> files</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in result</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> filePath = path.join(path_string, item)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> options.tFoldersOnly</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> files = md.getFiles(filePath, {deep: true, filesOnly: true})</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> files = md.getFiles(filePath, {deep: false, filesOnly: true})</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> newResult.push</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> folder item</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> documents files</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> newResult</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> result</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md._appendFolders</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> folders</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> dir = fs.readdirSync(String(path_string))</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in dir</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> filePath = path.join(path_string, item)</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> md.isDirectory(filePath)</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> options.tFoldersOnly</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> item.toLowerCase() === 't'</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> folders.push</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> folders.push</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> options.deep</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> md._appendFolders(filePath, folders, options)</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.read</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !(options)</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> contents = fs.readFileSync(String(path_string))</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> options.encoding !== null</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> contents = iconv.decode(contents, (options.encoding || md.defaultEncoding))</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !md.preserveBOM && contents.charCodeAt(0) === 0xFEFF</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> contents = contents.substring(1)</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> contents</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.writeBuffer</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> overwrite</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> attr</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> fs.existsSync(path)</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !(overwrite)</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> stat = fs.statSync(path)</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> stat.isDirectory()</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> md.mkpath(path)</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fd</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> fd = fs.openSync(path, 'w', 438)</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> e</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> fs.chmodSync(path, 438)</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> fd = fs.openSync(path, 'w', 438)</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> fd</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> fs.writeSync</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> fd</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> content.length</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> fs.closeSync(fd)</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fs.chmodSync(path, (attr || 438))</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.write</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> contents</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !options</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> md.mkpath(path_string)</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !Buffer.isBuffer(contents)</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> contents = iconv.encode(contents, (options.encoding || md.defaultEncoding))</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> fs.writeFileSync(path_string, contents)</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ex.message = 'Writing file ' + path_string + '.\n' + ex.message</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> ex</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.mkpath</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> dir = path.dirname(path_string)</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> md.mkdir(dir)</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.mkdir</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> dirpath</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mode</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> mode == null</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> mode = parseInt('0777', 8) & ~ (process.umask())</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> dirpath.split(pathSeparatorRe)</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> reduce</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> parts</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> part</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> parts += part + '/'</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> subpath = path.resolve(parts)</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> !md.exists(subpath)</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">                            </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> fs.mkdirSync(subpath, mode)</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">                            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">                                </span><span class="pp-tag">throw</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">                                    </span><span class="pp-tag">new</span><span class="pp-pln"> errors.FileError</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Unable to create directory "' + subpath + '" (Error code: ' + e.code + ').'</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> ex</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> parts</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ''</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.exists</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> stat = fs.lstatSync(String(path_string))</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> stat.isFile() || stat.isDirectory()</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L8"><span class="pp-ln"> 228 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.isDirectory =</span></div><div class="L9"><span class="pp-ln"> 229 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln"> 230 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L1"><span class="pp-ln"> 231 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln"> 232 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln"> 233 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> fs.lstatSync(String(path_string))</span></div><div class="L4"><span class="pp-ln"> 234 </span><span class="pp-pln">                        </span><span class="pp-tag">._</span><span class="pp-pln"> isDirectory()</span></div><div class="L5"><span class="pp-ln"> 235 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L6"><span class="pp-ln"> 236 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L7"><span class="pp-ln"> 237 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.isFile</span></div><div class="L8"><span class="pp-ln"> 238 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln"> 239 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L0"><span class="pp-ln"> 240 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L1"><span class="pp-ln"> 241 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 242 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> fs.lstatSync(String(path_string))</span></div><div class="L3"><span class="pp-ln"> 243 </span><span class="pp-pln">                        </span><span class="pp-tag">._</span><span class="pp-pln"> isFile()</span></div><div class="L4"><span class="pp-ln"> 244 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L5"><span class="pp-ln"> 245 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L6"><span class="pp-ln"> 246 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> normalize</span></div><div class="L7"><span class="pp-ln"> 247 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L8"><span class="pp-ln"> 248 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> path.trim().replace(/\\/g,'/').toLowerCase()</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d7">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/glob/balanced-match.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = balanced</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> balanced</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> a</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> b</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> a instanceof RegExp</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> a = maybeMatch(a, str)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> b instanceof RegExp</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> b = maybeMatch(b, str)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> r = range(a, b, str)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> r && {start: r[0], end: r[1], pre: str.slice(0, r[0]), body: str.slice((r[0] + a.length), r[1]), post: str.slice((r[1] + b.length))}</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> maybeMatch</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> reg</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> m = str.match(reg)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">iif</span><span class="pp-pln"> m</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">then</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> m[0]</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">else</span><span class="pp-pln"> null</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> balanced.range = range</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> range</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> a</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> b</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> begs</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> beg</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> left</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> right</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> result</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> ai = str.indexOf(a)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> bi = str.indexOf(b, (ai + 1))</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> i = ai</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ((ai &gt;= 0) && (bi &gt; 0))</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> begs = []</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> left = str.length</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">while</span><span class="pp-pln"> ((i &gt;= 0) && ! (result))</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> i == ai</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> begs.push(i)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> ai = str.indexOf(a, (i + 1))</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> begs.length == 1</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> result = [begs.pop(), bi]</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> beg = begs.pop()</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> beg &lt; left</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> left = beg</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> right = bi</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> bi = str.indexOf(b, (i + 1))</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> i = ((ai &lt; bi) && (ai &gt;= 0)) ? ai : bi</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> begs.length</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> result = [left, right]</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> result</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d8">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/glob/brace-expansion.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> concatMap = require('./concat-map')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> balanced = require('./balanced-match')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = expandTop</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> escSlash = ((('\0SLASH' + Math.random())) + '\0')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> escOpen = ((('\0OPEN' + Math.random())) + '\0')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> escClose = ((('\0CLOSE' + Math.random())) + '\0')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> escComma = ((('\0COMMA' + Math.random())) + '\0')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> escPeriod = ((('\0PERIOD' + Math.random())) + '\0')</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> numeric</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">iif</span><span class="pp-pln"> parseInt(str, 10) == str</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">then</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> parseInt(str, 10)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> str.charCodeAt(0)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> escapeBraces</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> str.split('\\\\')</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> join(escSlash)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> split('\\{')</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-tag">._</span><span class="pp-pln"> join(escOpen)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                            </span><span class="pp-tag">._</span><span class="pp-pln"> split('\\}')</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                </span><span class="pp-tag">._</span><span class="pp-pln"> join(escClose)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                    </span><span class="pp-tag">._</span><span class="pp-pln"> split('\\,')</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                        </span><span class="pp-tag">._</span><span class="pp-pln"> join(escComma)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                            </span><span class="pp-tag">._</span><span class="pp-pln"> split('\\.')</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                                </span><span class="pp-tag">._</span><span class="pp-pln"> join(escPeriod)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> unescapeBraces</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> str.split(escSlash)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> join('\\')</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> split(escOpen)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">._</span><span class="pp-pln"> join('{')</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                            </span><span class="pp-tag">._</span><span class="pp-pln"> split(escClose)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                                </span><span class="pp-tag">._</span><span class="pp-pln"> join('}')</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                    </span><span class="pp-tag">._</span><span class="pp-pln"> split(escComma)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                        </span><span class="pp-tag">._</span><span class="pp-pln"> join(',')</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                                            </span><span class="pp-tag">._</span><span class="pp-pln"> split(escPeriod)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                                </span><span class="pp-tag">._</span><span class="pp-pln"> join('.')</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> parseCommaParts</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (str)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ''</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> parts</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> m = balanced('{', '}', str)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (m)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> str.split(',')</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> pre = m.pre</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> body = m.body</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> post = m.post</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> p = pre.split(',')</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> p[(p.length - 1)] += ((('{' + body)) + '}')</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> postParts = parseCommaParts(post)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> post.length</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> p[(p.length - 1)] += postParts.shift()</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> p.push.apply(p, postParts)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> parts.push.apply(parts, p)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> parts</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> expandTop</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (str)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> str.substr(0, 2) === '{}'</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> str = ('\\{\\}' + str.substr(2))</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> expand</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> escapeBraces(str)</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> true</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> map(unescapeBraces)</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> identity</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> e</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> e</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> embrace</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> ((('{' + str)) + '}')</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> isPadded</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> el</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> /^-?0\d/.test(el)</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> lte</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> i</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> y</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> i &lt;= y</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> gte</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> i</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> y</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> i &gt;= y</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> expand</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> isTop</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> expansions</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> m = balanced('{', '}', str)</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> (! (m) || /\$$/.test(m.pre))</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> str</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> isNumericSequence</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> /^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> m.body</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> isAlphaSequence</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> /^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> m.body</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> isSequence = (isNumericSequence || isAlphaSequence)</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> isOptions = m.body.indexOf(',') &gt;= 0</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (isSequence) && ! (isOptions)</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> m.post.match(/,.*\}/)</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> str = (((((((m.pre + '{')) + m.body)) + escClose)) + m.post)</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> expand(str)</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> str</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> n</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> isSequence</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> n = m.body.split(/\.\./)</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> n = parseCommaParts(m.body)</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> n.length === 1</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> n = expand(n[0], false).map(embrace)</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> n.length === 1</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> post</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                        </span><span class="pp-tag">iif</span><span class="pp-pln"> m.post.length</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                            </span><span class="pp-tag">then</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> expand</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> m.post</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> false</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                                </span><span class="pp-tag">[</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> ''</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> post.map</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                            </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                                </span><span class="pp-tag">param</span><span class="pp-pln"> p</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span><span class="pp-pln"> (((m.pre + n[0])) + p)</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> pre = m.pre</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> post</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">            </span><span class="pp-tag">iif</span><span class="pp-pln"> m.post.length</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                </span><span class="pp-tag">then</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> expand</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> m.post</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> false</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ''</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> N</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> isSequence</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> x</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> numeric</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> n[0]</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> y</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> numeric</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> n[1]</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> width</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> Math.max</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> n[0].length</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> n[1].length</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> incr</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> n.length == 3</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> Math.abs</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> numeric</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> n[2]</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span><span class="pp-pln"> 1</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> test = lte</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> reverse = y &lt; x</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> reverse</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> incr *= - (1)</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> test = gte</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> pad = n.some(isPadded)</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> N = []</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var i = x; test(i, y); i += incr</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> c</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> isAlphaSequence</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> c = String.fromCharCode(i)</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> c === '\\'</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> c = ''</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> c = String(i)</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> pad</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> need = (width - c.length)</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> need &gt; 0</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> z</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                                </span><span class="pp-tag">new</span><span class="pp-pln"> Array((need + 1))</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">                                    </span><span class="pp-tag">._</span><span class="pp-pln"> join('0')</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> i &lt; 0</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> c = ((('-' + z)) + c.slice(1))</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> c = (z + c)</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> N.push(c)</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> N =</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> concatMap</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> n</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> el</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> expand(el, false)</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var j = 0; j &lt; N.length; j++</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var k = 0; k &lt; post.length; k++</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> expansion = (((pre + N[j])) + post[k])</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> (((! (isTop) || isSequence)) || expansion)</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> expansions.push(expansion)</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> expansions</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d9">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/glob/common.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> exports.alphasort = alphasort</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> exports.alphasorti = alphasorti</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> exports.setopts = setopts</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> exports.ownProp = ownProp</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> exports.makeAbs = makeAbs</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> exports.finish = finish</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> exports.mark = mark</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> exports.isIgnored = isIgnored</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> exports.childrenIgnored = childrenIgnored</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> ownProp</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> field</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> Object.prototype.hasOwnProperty.call(obj, field)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> path = require("path")</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> minimatch = require("./minimatch")</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> isAbsolute = require("./path-is-absolute")</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> Minimatch = minimatch.Minimatch</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> alphasorti</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> a</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> b</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> a.toLowerCase()</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> localeCompare</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> b.toLowerCase()</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> alphasort</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> a</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> b</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> a.localeCompare(b)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> setupIgnores</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> self</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.ignore = (options.ignore || [])</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (Array.isArray(self.ignore))</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> self.ignore = [self.ignore]</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> self.ignore.length</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> self.ignore = self.ignore.map(ignoreMap)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> ignoreMap</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> gmatcher = null</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> pattern.slice(- (3)) === '/**'</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> gpattern = pattern.replace(/(\/\*\*)+$/, '')</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> gmatcher = new Minimatch(gpattern, {dot: true})</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> matcher</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> Minimatch</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> pattern</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> dot true</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> gmatcher gmatcher</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> setopts</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> self</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (options)</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> (options.matchBase && (- (1) === pattern.indexOf("/")))</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> options.noglobstar</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> Error("base matching requires globstar")</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> pattern = ("**/" + pattern)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.silent = ! (! (options.silent))</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.pattern = pattern</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.strict = options.strict !== false</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.realpath = ! (! (options.realpath))</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.realpathCache = (options.realpathCache || Object.create(null))</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.follow = ! (! (options.follow))</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.dot = ! (! (options.dot))</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.mark = ! (! (options.mark))</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.nodir = ! (! (options.nodir))</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> self.nodir</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> self.mark = true</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.sync = ! (! (options.sync))</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.nounique = ! (! (options.nounique))</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.nonull = ! (! (options.nonull))</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.nosort = ! (! (options.nosort))</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.nocase = ! (! (options.nocase))</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.stat = ! (! (options.stat))</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.noprocess = ! (! (options.noprocess))</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.absolute = ! (! (options.absolute))</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.maxLength = (options.maxLength || Infinity)</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.cache = (options.cache || Object.create(null))</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.statCache = (options.statCache || Object.create(null))</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.symlinks = (options.symlinks || Object.create(null))</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> setupIgnores(self, options)</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.changedCwd = false</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> cwd = process.cwd()</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (ownProp(options, "cwd"))</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> self.cwd = cwd</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> self.cwd = path.resolve(options.cwd)</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> self.changedCwd = self.cwd !== cwd</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.root = (options.root || path.resolve(self.cwd, "/"))</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.root = path.resolve(self.root)</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> process.platform === "win32"</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> self.root = self.root.replace(/\\/g, "/")</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.cwdAbs = isAbsolute(self.cwd) ? self.cwd : makeAbs(self, self.cwd)</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> process.platform === "win32"</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> self.cwdAbs = self.cwdAbs.replace(/\\/g, "/")</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.nomount = ! (! (options.nomount))</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> options.nonegate = true</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> options.nocomment = true</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.minimatch = new Minimatch(pattern, options)</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.options = self.minimatch.options</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> finish</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> self</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> nou = self.nounique</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> all</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">            </span><span class="pp-tag">iif</span><span class="pp-pln"> nou</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                </span><span class="pp-tag">then</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> Object.create(null)</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0, l = self.matches.length; i &lt; l; i++</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> matches = self.matches[i]</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !matches || Object.keys(matches).length === 0</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> self.nonull</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> literal = self.minimatch.globSet[i]</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> nou</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> all.push(literal)</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> all[literal] = true</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> m = Object.keys(matches)</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> nou</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> all.push.apply(all, m)</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> m.forEach</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> m</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> all[m] = true</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> !nou</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> all = Object.keys(all)</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> !self.nosort</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> all = all.sort(self.nocase ? alphasorti : alphasort)</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> self.mark</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; all.length; i++</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> all[i] = self._mark(all[i])</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> self.nodir</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> all =</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> all.filter</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> e</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> notDir = ! (/\/$/.test(e))</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> c = (self.cache[e] || self.cache[makeAbs(self, e)])</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> notDir && c</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> notDir = ((c !== 'DIR') && ! (Array.isArray(c)))</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span><span class="pp-pln"> notDir</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> self.ignore.length</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> all =</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> all.filter</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> m</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> ! (isIgnored(self, m))</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> self.found = all</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> mark</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> self</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> p</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> abs = makeAbs(self, p)</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> c = self.cache[abs]</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> m = p</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> c</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> isDir = ((c === 'DIR') || Array.isArray(c))</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> slash = p.slice(- (1)) === '/'</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isDir && ! (slash)</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> m += '/'</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> ! (isDir) && slash</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> m = m.slice(0, - (1))</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> m !== p</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mabs = makeAbs(self, m)</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> self.statCache[mabs] = self.statCache[abs]</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> self.cache[mabs] = self.cache[abs]</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> m</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> makeAbs</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> self</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> f</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> abs = f</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> f.charAt(0) === '/'</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> abs = path.join(self.root, f)</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> (isAbsolute(f) || (f === ''))</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> abs = f</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> self.changedCwd</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> abs = path.resolve(self.cwd, f)</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> abs = path.resolve(f)</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> process.platform === 'win32'</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> abs = abs.replace(/\\/g, '/')</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> abs</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> isIgnored</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> self</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (self.ignore.length)</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> self.ignore.some</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> ( item.matcher.match(path) || !!(item.gmatcher && item.gmatcher.match(path)) )</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> childrenIgnored</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> self</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> !self.ignore.length</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> self.ignore.some</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> !!(item.gmatcher && item.gmatcher.match(path))</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d10">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/glob/concat-map.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> xs</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> fn</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> res</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; xs.length; i++</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> x</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> fn</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> xs[i]</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> i</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> isArray(x)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> res.push.apply(res, x)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> res.push(x)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> res</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> isArray</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">||</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> Array.isArray</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> xs</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> Object.prototype.toString.call(xs) === '[object Array]'</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d11">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/glob/fs.realpath.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = realpath</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> realpath.realpath = realpath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> realpath.sync = realpathSync</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> realpath.realpathSync = realpathSync</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> realpath.monkeypatch = monkeypatch</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> realpath.unmonkeypatch = unmonkeypatch</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fs = require('fs')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> origRealpath = fs.realpath</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> origRealpathSync = fs.realpathSync</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> version = process.version</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> ok = /^v[0-5]\./.test(version)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> old = require('./old.js')</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> newError</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> er</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> (((er && (er.syscall === 'realpath'))) && (((((er.code === 'ELOOP') || (er.code === 'ENOMEM'))) || (er.code === 'ENAMETOOLONG'))))</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> realpath</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> p</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> cache</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ok</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> origRealpath(p, cache, cb)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (cache) === 'function'</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> cb = cache</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> cache = null</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> origRealpath</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> p</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> cache</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> er</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> newError(er)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> old.realpath(p, cache, cb)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> cb(er, result)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> realpathSync</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> p</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> cache</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ok</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> origRealpathSync(p, cache)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">try</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> origRealpathSync(p, cache)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">catch</span><span class="pp-pln"> er</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> newError(er)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> old.realpathSync(p, cache)</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> er</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> monkeypatch</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> fs.realpath = realpath</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> fs.realpathSync = realpathSync</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> unmonkeypatch</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> fs.realpath = origRealpath</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> fs.realpathSync = origRealpathSync</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d12">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/glob/glob.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> class Glob</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> function glob</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = glob</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fs = require('fs')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> minimatch = require('./minimatch')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> Minimatch = minimatch.Minimatch</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> inherits = require('inherits')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> EE</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> require('events')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">.</span><span class="pp-pln"> EventEmitter</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> path = require('path')</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> assert = require('assert')</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> isAbsolute = require('./path-is-absolute')</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> common = require('./common.js')</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> alphasort = common.alphasort</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> alphasorti = common.alphasorti</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> setopts = common.setopts</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> ownProp = common.ownProp</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> inflight = require('./inflight')</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> childrenIgnored = common.childrenIgnored</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> isIgnored = common.isIgnored</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> once = require('./once')</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> glob</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> mongoFS</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (options) === 'function'</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> cb = options, options = {}</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> !options</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Glob(pattern, mongoFS, options, cb)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> Glob</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mongoFS</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (options) === 'function'</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> cb = options</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options = null</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !(this instanceof Glob)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> Glob(pattern, mongoFS, options, cb)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.mongoFS = mongoFS</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setopts(this, pattern, options)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'this.minimatch', this.minimatch</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'this.minimatch.set', this.minimatch.set</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> n = this.minimatch.set.length</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.matches = new Array(n)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(cb) === 'function'</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> cb = once(cb)</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.on('error', cb)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.on</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'end'</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> matches</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> 'on.end.cb.matches', matches.length</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> cb(null, matches)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> self = this</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this._processing = 0</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.noprocess</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> n === 0</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> done()</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> sync = true</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; n; i++</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this._process</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> this.minimatch.set[i]</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> i</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> false</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> done</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> sync = false</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> done</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> --self._processing</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> '---------- done self._processing, sync', self._processing, sync</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> self._processing &lt;= 0</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> sync</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                            </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> self._finish()</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> self._finish()</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _finish</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> assert(this instanceof Glob)</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> common.finish(this)</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.emit</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'end'</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> this.found</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _mark</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> p</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> common.mark(this, p)</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _makeAbs</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> f</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> common.makeAbs(this, f)</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _process</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> inGlobStar</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cbDone</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> assert(this instanceof Glob)</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> assert(typeof (cbDone) === 'function')</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this._processing++</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '_process.pattern.index.inGlobStar', pattern, index, inGlobStar</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> n = 0</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">            </span><span class="pp-tag">while</span><span class="pp-pln"> typeof (pattern[n]) === 'string'</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> n++</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '_process.n', n</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> prefix</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">            </span><span class="pp-tag">switch</span><span class="pp-pln"> n</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> pattern.length</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> '_process.prefix.case._processSimple'</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this._processSimple</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> pattern.join('/')</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> index</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> cbDone</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> 0</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> prefix = null</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> '_process.prefix.n=0', prefix</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                    </span><span class="pp-tag">break</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                </span><span class="pp-tag">default</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> prefix = pattern.slice(0, n).join('/')</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> '_process.prefix.default', prefix</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                    </span><span class="pp-tag">break</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> remain = pattern.slice(n)</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> read</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> prefix === null</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> read = '.'</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> isAbsolute(prefix) || isAbsolute(pattern.join('/'))</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !prefix || !isAbsolute(prefix)</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> prefix = ('/' + prefix)</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> read = prefix</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> read = prefix</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> abs = this._makeAbs(read)</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> childrenIgnored(this, read)</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> cbDone()</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> isGlobStar = remain[0] === minimatch.GLOBSTAR</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'read, abs, remain, isGlobStar', read, abs, remain, isGlobStar</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isGlobStar</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this._processGlobStar(prefix, read, abs, remain, index, inGlobStar, cbDone)</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this._processReaddir(prefix, read, abs, remain, index, inGlobStar, cbDone)</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _processReaddir</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> prefix</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> read</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> abs</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> remain</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> inGlobStar</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cbDone</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> self = this</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this._readdir</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> abs</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> inGlobStar</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> er</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> entries</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> self._processReaddir2(prefix, read, abs, remain, index, inGlobStar, entries, cbDone)</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _processReaddir2</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> prefix</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> read</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> abs</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> remain</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> inGlobStar</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> entries</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cbDone</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !entries</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> cbDone()</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> pn = remain[0]</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> negate = !!this.minimatch.negate</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> rawGlob = pn._glob</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> dotOk = this.dot || rawGlob.charAt(0) === '.'</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '***** _processReaddir2 pn, negate, rawGlob, dotOk', pn, negate, rawGlob, dotOk</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> matchedEntries</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; entries.length; i++</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> e = entries[i]</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> ePath = e.basename</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ePath.charAt(0) !== '.' || dotOk</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> m</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> negate && !prefix</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> m = !ePath.match(pn)</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> m = ePath.match(pn)</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> m</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> matchedEntries.push(e)</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> len = matchedEntries.length</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> len === 0</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> cbDone()</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> remain.length === 1 && !this.mark && !this.stat</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !this.matches[index]</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> this.matches[index] = Object.create(null)</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; len; i++</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> e = matchedEntries[i]</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> ePath = e.basename</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> prefix</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> prefix !== '/'</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> ePath = prefix + '/' + ePath</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> ePath = prefix + ePath</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> ePath.charAt(0) === '/' && !this.nomount</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> ePath = path.join(this.root, ePath)</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this._emitMatch(index, ePath, e)</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> cbDone()</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> remain.shift()</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; len; i++</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> ePath = matchedEntries[i].basename</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> newPattern</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> prefix</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> prefix !== '/'</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> ePath = prefix + '/' + ePath</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> ePath = prefix + ePath</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this._process</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ePath</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">                        </span><span class="pp-tag">._</span><span class="pp-pln"> concat(remain)</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> index</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> inGlobStar</span></div><div class="L8"><span class="pp-ln"> 228 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> cbDone</span></div><div class="L9"><span class="pp-ln"> 229 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> cbDone()</span></div><div class="L0"><span class="pp-ln"> 230 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _emitMatch</span></div><div class="L1"><span class="pp-ln"> 231 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L2"><span class="pp-ln"> 232 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ePath</span></div><div class="L3"><span class="pp-ln"> 233 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> e</span></div><div class="L4"><span class="pp-ln"> 234 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '***** _emitMatch.index,ePath,e', index, ePath, e</span></div><div class="L5"><span class="pp-ln"> 235 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isIgnored(this, ePath)</span></div><div class="L6"><span class="pp-ln"> 236 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln"> 237 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> abs</span></div><div class="L8"><span class="pp-ln"> 238 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> isAbsolute(ePath)</span></div><div class="L9"><span class="pp-ln"> 239 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span><span class="pp-pln"> ePath</span></div><div class="L0"><span class="pp-ln"> 240 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 241 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> this._makeAbs(ePath)</span></div><div class="L2"><span class="pp-ln"> 242 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.mark</span></div><div class="L3"><span class="pp-ln"> 243 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ePath = this._mark(ePath)</span></div><div class="L4"><span class="pp-ln"> 244 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.absolute</span></div><div class="L5"><span class="pp-ln"> 245 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ePath = abs</span></div><div class="L6"><span class="pp-ln"> 246 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.matches[index][ePath]</span></div><div class="L7"><span class="pp-ln"> 247 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 248 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.nodir</span></div><div class="L9"><span class="pp-ln"> 249 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> c = this.cache[abs]</span></div><div class="L0"><span class="pp-ln"> 250 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> (c === 'DIR') || Array.isArray(c)</span></div><div class="L1"><span class="pp-ln"> 251 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 252 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.matches[index][ePath] = true</span></div><div class="L3"><span class="pp-ln"> 253 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> st = this.statCache[abs]</span></div><div class="L4"><span class="pp-ln"> 254 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> st</span></div><div class="L5"><span class="pp-ln"> 255 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.emit('stat', ePath, e, st)</span></div><div class="L6"><span class="pp-ln"> 256 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.emit('match', ePath, e)</span></div><div class="L7"><span class="pp-ln"> 257 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _readdirInGlobStar</span></div><div class="L8"><span class="pp-ln"> 258 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> abs</span></div><div class="L9"><span class="pp-ln"> 259 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L0"><span class="pp-ln"> 260 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.follow</span></div><div class="L1"><span class="pp-ln"> 261 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this._readdir(abs, false, cb)</span></div><div class="L2"><span class="pp-ln"> 262 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> lstatkey = ('lstat\0' + abs)</span></div><div class="L3"><span class="pp-ln"> 263 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> self = this</span></div><div class="L4"><span class="pp-ln"> 264 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> lstatcb = inflight(lstatkey, lstatcb_)</span></div><div class="L5"><span class="pp-ln"> 265 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> lstatcb</span></div><div class="L6"><span class="pp-ln"> 266 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.mongoFS._stat(abs, lstatcb)</span></div><div class="L7"><span class="pp-ln"> 267 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> lstatcb_</span></div><div class="L8"><span class="pp-ln"> 268 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> er</span></div><div class="L9"><span class="pp-ln"> 269 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> lstat</span></div><div class="L0"><span class="pp-ln"> 270 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> er && er.code === 'ENOENT'</span></div><div class="L1"><span class="pp-ln"> 271 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> cb()</span></div><div class="L2"><span class="pp-ln"> 272 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> lstat && !lstat.isDirectory()</span></div><div class="L3"><span class="pp-ln"> 273 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> self.cache[abs] = 'FILE'</span></div><div class="L4"><span class="pp-ln"> 274 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> cb()</span></div><div class="L5"><span class="pp-ln"> 275 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 276 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> self._readdir(abs, false, cb)</span></div><div class="L7"><span class="pp-ln"> 277 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _readdir</span></div><div class="L8"><span class="pp-ln"> 278 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> abs</span></div><div class="L9"><span class="pp-ln"> 279 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> inGlobStar</span></div><div class="L0"><span class="pp-ln"> 280 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L1"><span class="pp-ln"> 281 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> cb = inflight('readdir\0' + abs + '\0' + inGlobStar, cb)</span></div><div class="L2"><span class="pp-ln"> 282 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !(cb)</span></div><div class="L3"><span class="pp-ln"> 283 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 284 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> inGlobStar</span></div><div class="L5"><span class="pp-ln"> 285 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this._readdirInGlobStar(abs, cb)</span></div><div class="L6"><span class="pp-ln"> 286 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ownProp(this.cache, abs)</span></div><div class="L7"><span class="pp-ln"> 287 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> c = this.cache[abs]</span></div><div class="L8"><span class="pp-ln"> 288 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !c || c === 'FILE'</span></div><div class="L9"><span class="pp-ln"> 289 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> cb()</span></div><div class="L0"><span class="pp-ln"> 290 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> Array.isArray(c)</span></div><div class="L1"><span class="pp-ln"> 291 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> cb(null, c)</span></div><div class="L2"><span class="pp-ln"> 292 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> self = this</span></div><div class="L3"><span class="pp-ln"> 293 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'readdirCb(this, abs, cb)', abs</span></div><div class="L4"><span class="pp-ln"> 294 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.mongoFS._readDir</span></div><div class="L5"><span class="pp-ln"> 295 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> abs</span></div><div class="L6"><span class="pp-ln"> 296 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> readdirCb(this, abs, cb)</span></div><div class="L7"><span class="pp-ln"> 297 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> readdirCb</span></div><div class="L8"><span class="pp-ln"> 298 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> self</span></div><div class="L9"><span class="pp-ln"> 299 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> abs</span></div><div class="L0"><span class="pp-ln"> 300 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L1"><span class="pp-ln"> 301 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 302 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln"> 303 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> er</span></div><div class="L4"><span class="pp-ln"> 304 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> entries</span></div><div class="L5"><span class="pp-ln"> 305 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> er</span></div><div class="L6"><span class="pp-ln"> 306 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> self._readdirError(abs, er, cb)</span></div><div class="L7"><span class="pp-ln"> 307 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 308 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> self._readdirEntries(abs, entries, cb)</span></div><div class="L9"><span class="pp-ln"> 309 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _readdirEntries</span></div><div class="L0"><span class="pp-ln"> 310 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> abs</span></div><div class="L1"><span class="pp-ln"> 311 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> entries</span></div><div class="L2"><span class="pp-ln"> 312 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L3"><span class="pp-ln"> 313 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !(this.mark) && !(this.stat)</span></div><div class="L4"><span class="pp-ln"> 314 </span><span class="pp-pln">                </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; entries.length; i++</span></div><div class="L5"><span class="pp-ln"> 315 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> e = entries[i]</span></div><div class="L6"><span class="pp-ln"> 316 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> ePath = e.basename</span></div><div class="L7"><span class="pp-ln"> 317 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> abs === '/'</span></div><div class="L8"><span class="pp-ln"> 318 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> ePath = abs + ePath</span></div><div class="L9"><span class="pp-ln"> 319 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 320 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> ePath = abs + '/' + ePath</span></div><div class="L1"><span class="pp-ln"> 321 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> this.cache[ePath] = true</span></div><div class="L2"><span class="pp-ln"> 322 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.cache[abs] = entries</span></div><div class="L3"><span class="pp-ln"> 323 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> cb(null, entries)</span></div><div class="L4"><span class="pp-ln"> 324 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _readdirError</span></div><div class="L5"><span class="pp-ln"> 325 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> f</span></div><div class="L6"><span class="pp-ln"> 326 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> er</span></div><div class="L7"><span class="pp-ln"> 327 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L8"><span class="pp-ln"> 328 </span><span class="pp-pln">            </span><span class="pp-tag">switch</span><span class="pp-pln"> er.code</span></div><div class="L9"><span class="pp-ln"> 329 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> 'ENOTSUP'</span></div><div class="L0"><span class="pp-ln"> 330 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> 'ENOTDIR'</span></div><div class="L1"><span class="pp-ln"> 331 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> abs = this._makeAbs(f)</span></div><div class="L2"><span class="pp-ln"> 332 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> this.cache[abs] = 'FILE'</span></div><div class="L3"><span class="pp-ln"> 333 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> abs === this.cwdAbs</span></div><div class="L4"><span class="pp-ln"> 334 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> error</span></div><div class="L5"><span class="pp-ln"> 335 </span><span class="pp-pln">                            </span><span class="pp-tag">new</span><span class="pp-pln"> Error(((er.code + ' invalid cwd ')) + this.cwd)</span></div><div class="L6"><span class="pp-ln"> 336 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> error.path = this.cwd</span></div><div class="L7"><span class="pp-ln"> 337 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> error.code = er.code</span></div><div class="L8"><span class="pp-ln"> 338 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> this.emit('error', error)</span></div><div class="L9"><span class="pp-ln"> 339 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> this.abort()</span></div><div class="L0"><span class="pp-ln"> 340 </span><span class="pp-pln">                    </span><span class="pp-tag">break</span></div><div class="L1"><span class="pp-ln"> 341 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> 'ENOENT'</span></div><div class="L2"><span class="pp-ln"> 342 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> 'ELOOP'</span></div><div class="L3"><span class="pp-ln"> 343 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> 'ENAMETOOLONG'</span></div><div class="L4"><span class="pp-ln"> 344 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> 'UNKNOWN'</span></div><div class="L5"><span class="pp-ln"> 345 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> this.cache[this._makeAbs(f)] = false</span></div><div class="L6"><span class="pp-ln"> 346 </span><span class="pp-pln">                    </span><span class="pp-tag">break</span></div><div class="L7"><span class="pp-ln"> 347 </span><span class="pp-pln">                </span><span class="pp-tag">default</span></div><div class="L8"><span class="pp-ln"> 348 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> this.cache[this._makeAbs(f)] = false</span></div><div class="L9"><span class="pp-ln"> 349 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> this.strict</span></div><div class="L0"><span class="pp-ln"> 350 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> this.emit('error', er)</span></div><div class="L1"><span class="pp-ln"> 351 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> this.abort()</span></div><div class="L2"><span class="pp-ln"> 352 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> ! (this.silent)</span></div><div class="L3"><span class="pp-ln"> 353 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> console.error('glob error', er)</span></div><div class="L4"><span class="pp-ln"> 354 </span><span class="pp-pln">                    </span><span class="pp-tag">break</span></div><div class="L5"><span class="pp-ln"> 355 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> cb()</span></div><div class="L6"><span class="pp-ln"> 356 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _processGlobStar</span></div><div class="L7"><span class="pp-ln"> 357 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> prefix</span></div><div class="L8"><span class="pp-ln"> 358 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> read</span></div><div class="L9"><span class="pp-ln"> 359 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> abs</span></div><div class="L0"><span class="pp-ln"> 360 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> remain</span></div><div class="L1"><span class="pp-ln"> 361 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L2"><span class="pp-ln"> 362 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> inGlobStar</span></div><div class="L3"><span class="pp-ln"> 363 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cbDone</span></div><div class="L4"><span class="pp-ln"> 364 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> self = this</span></div><div class="L5"><span class="pp-ln"> 365 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '_processGlobStar'</span></div><div class="L6"><span class="pp-ln"> 366 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this._readdir</span></div><div class="L7"><span class="pp-ln"> 367 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> abs</span></div><div class="L8"><span class="pp-ln"> 368 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> inGlobStar</span></div><div class="L9"><span class="pp-ln"> 369 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln"> 370 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> er</span></div><div class="L1"><span class="pp-ln"> 371 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> entries</span></div><div class="L2"><span class="pp-ln"> 372 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> self._processGlobStar2(prefix, read, abs, remain, index, inGlobStar, entries, cbDone)</span></div><div class="L3"><span class="pp-ln"> 373 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _processGlobStar2</span></div><div class="L4"><span class="pp-ln"> 374 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> prefix</span></div><div class="L5"><span class="pp-ln"> 375 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> read</span></div><div class="L6"><span class="pp-ln"> 376 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> abs</span></div><div class="L7"><span class="pp-ln"> 377 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> remain</span></div><div class="L8"><span class="pp-ln"> 378 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L9"><span class="pp-ln"> 379 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> inGlobStar</span></div><div class="L0"><span class="pp-ln"> 380 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> entries</span></div><div class="L1"><span class="pp-ln"> 381 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cbDone</span></div><div class="L2"><span class="pp-ln"> 382 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '_processGlobStar2.entries', entries</span></div><div class="L3"><span class="pp-ln"> 383 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !(entries)</span></div><div class="L4"><span class="pp-ln"> 384 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> cbDone()</span></div><div class="L5"><span class="pp-ln"> 385 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> remainWithoutGlobStar = remain.slice(1)</span></div><div class="L6"><span class="pp-ln"> 386 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> gspref</span></div><div class="L7"><span class="pp-ln"> 387 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> prefix</span></div><div class="L8"><span class="pp-ln"> 388 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span></div><div class="L9"><span class="pp-ln"> 389 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span></div><div class="L0"><span class="pp-ln"> 390 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> prefix</span></div><div class="L1"><span class="pp-ln"> 391 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 392 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span></div><div class="L3"><span class="pp-ln"> 393 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> noGlobStar = gspref.concat(remainWithoutGlobStar)</span></div><div class="L4"><span class="pp-ln"> 394 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this._process(noGlobStar, index, false, cbDone)</span></div><div class="L5"><span class="pp-ln"> 395 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> len = entries.length</span></div><div class="L6"><span class="pp-ln"> 396 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; len; i++</span></div><div class="L7"><span class="pp-ln"> 397 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> ePath = entries[i].basename</span></div><div class="L8"><span class="pp-ln"> 398 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ePath.charAt(0) === '.' && !this.dot</span></div><div class="L9"><span class="pp-ln"> 399 </span><span class="pp-pln">                    </span><span class="pp-tag">continue</span></div><div class="L0"><span class="pp-ln"> 400 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> instead</span></div><div class="L1"><span class="pp-ln"> 401 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> gspref.concat</span></div><div class="L2"><span class="pp-ln"> 402 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ePath</span></div><div class="L3"><span class="pp-ln"> 403 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> remainWithoutGlobStar</span></div><div class="L4"><span class="pp-ln"> 404 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this._process(instead, index, true, cbDone)</span></div><div class="L5"><span class="pp-ln"> 405 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> below</span></div><div class="L6"><span class="pp-ln"> 406 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> gspref.concat</span></div><div class="L7"><span class="pp-ln"> 407 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ePath</span></div><div class="L8"><span class="pp-ln"> 408 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> remain</span></div><div class="L9"><span class="pp-ln"> 409 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this._process(below, index, true, cbDone)</span></div><div class="L0"><span class="pp-ln"> 410 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> '_processGlobStar2 e.instead.below', ePath, instead, below</span></div><div class="L1"><span class="pp-ln"> 411 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> cbDone()</span></div><div class="L2"><span class="pp-ln"> 412 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _processSimple</span></div><div class="L3"><span class="pp-ln"> 413 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> prefix</span></div><div class="L4"><span class="pp-ln"> 414 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L5"><span class="pp-ln"> 415 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cbDone</span></div><div class="L6"><span class="pp-ln"> 416 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '***** _processSimple', prefix, index</span></div><div class="L7"><span class="pp-ln"> 417 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> self = this</span></div><div class="L8"><span class="pp-ln"> 418 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this._stat</span></div><div class="L9"><span class="pp-ln"> 419 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> prefix</span></div><div class="L0"><span class="pp-ln"> 420 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln"> 421 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> er</span></div><div class="L2"><span class="pp-ln"> 422 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> exists</span></div><div class="L3"><span class="pp-ln"> 423 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> self._processSimple2(prefix, index, er, exists, cbDone)</span></div><div class="L4"><span class="pp-ln"> 424 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _processSimple2</span></div><div class="L5"><span class="pp-ln"> 425 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> prefix</span></div><div class="L6"><span class="pp-ln"> 426 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L7"><span class="pp-ln"> 427 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> er</span></div><div class="L8"><span class="pp-ln"> 428 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> exists</span></div><div class="L9"><span class="pp-ln"> 429 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cbDone</span></div><div class="L0"><span class="pp-ln"> 430 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !this.matches[index]</span></div><div class="L1"><span class="pp-ln"> 431 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.matches[index] = Object.create(null)</span></div><div class="L2"><span class="pp-ln"> 432 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !exists</span></div><div class="L3"><span class="pp-ln"> 433 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> cbDone()</span></div><div class="L4"><span class="pp-ln"> 434 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> prefix && isAbsolute(prefix) && !this.nomount</span></div><div class="L5"><span class="pp-ln"> 435 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> trail = /[\/\\]$/.test(prefix)</span></div><div class="L6"><span class="pp-ln"> 436 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> prefix.charAt(0) === '/'</span></div><div class="L7"><span class="pp-ln"> 437 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> prefix = path.join(this.root, prefix)</span></div><div class="L8"><span class="pp-ln"> 438 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 439 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> prefix = path.resolve(this.root, prefix)</span></div><div class="L0"><span class="pp-ln"> 440 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> trail</span></div><div class="L1"><span class="pp-ln"> 441 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> prefix += '/'</span></div><div class="L2"><span class="pp-ln"> 442 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> process.platform === 'win32'</span></div><div class="L3"><span class="pp-ln"> 443 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> prefix = prefix.replace(/\\/g, '/')</span></div><div class="L4"><span class="pp-ln"> 444 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this._emitMatch(index, prefix, null)</span></div><div class="L5"><span class="pp-ln"> 445 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> cbDone()</span></div><div class="L6"><span class="pp-ln"> 446 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> from _processSimple</span></div><div class="L7"><span class="pp-ln"> 447 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _stat</span></div><div class="L8"><span class="pp-ln"> 448 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> f</span></div><div class="L9"><span class="pp-ln"> 449 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L0"><span class="pp-ln"> 450 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> abs = this._makeAbs(f)</span></div><div class="L1"><span class="pp-ln"> 451 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> needDir = f.slice(-1) === '/'</span></div><div class="L2"><span class="pp-ln"> 452 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> f.length &gt; this.maxLength</span></div><div class="L3"><span class="pp-ln"> 453 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> cb()</span></div><div class="L4"><span class="pp-ln"> 454 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !this.stat && ownProp(this.cache, abs)</span></div><div class="L5"><span class="pp-ln"> 455 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> c = this.cache[abs]</span></div><div class="L6"><span class="pp-ln"> 456 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> Array.isArray(c)</span></div><div class="L7"><span class="pp-ln"> 457 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> c = 'DIR'</span></div><div class="L8"><span class="pp-ln"> 458 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !needDir || c === 'DIR'</span></div><div class="L9"><span class="pp-ln"> 459 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> cb(null, c)</span></div><div class="L0"><span class="pp-ln"> 460 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> needDir && c === 'FILE'</span></div><div class="L1"><span class="pp-ln"> 461 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> cb()</span></div><div class="L2"><span class="pp-ln"> 462 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> exists</span></div><div class="L3"><span class="pp-ln"> 463 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> stat = this.statCache[abs]</span></div><div class="L4"><span class="pp-ln"> 464 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> stat !== undefined</span></div><div class="L5"><span class="pp-ln"> 465 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> stat === false</span></div><div class="L6"><span class="pp-ln"> 466 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> cb(null, stat)</span></div><div class="L7"><span class="pp-ln"> 467 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 468 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> type = stat.isDirectory() ? 'DIR' : 'FILE'</span></div><div class="L9"><span class="pp-ln"> 469 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> (needDir && (type === 'FILE'))</span></div><div class="L0"><span class="pp-ln"> 470 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> cb()</span></div><div class="L1"><span class="pp-ln"> 471 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 472 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> cb(null, type, stat)</span></div><div class="L3"><span class="pp-ln"> 473 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> self = this</span></div><div class="L4"><span class="pp-ln"> 474 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> statcb = inflight('stat\0' + abs, lstatcb_)</span></div><div class="L5"><span class="pp-ln"> 475 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> statcb</span></div><div class="L6"><span class="pp-ln"> 476 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.mongoFS._stat(abs, statcb)</span></div><div class="L7"><span class="pp-ln"> 477 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> lstatcb_</span></div><div class="L8"><span class="pp-ln"> 478 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> er</span></div><div class="L9"><span class="pp-ln"> 479 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> lstat</span></div><div class="L0"><span class="pp-ln"> 480 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> self._stat2(f, abs, er, lstat, cb)</span></div><div class="L1"><span class="pp-ln"> 481 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _stat2</span></div><div class="L2"><span class="pp-ln"> 482 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> f</span></div><div class="L3"><span class="pp-ln"> 483 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> abs</span></div><div class="L4"><span class="pp-ln"> 484 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> er</span></div><div class="L5"><span class="pp-ln"> 485 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> stat</span></div><div class="L6"><span class="pp-ln"> 486 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L7"><span class="pp-ln"> 487 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> er && (er.code === 'ENOENT' || er.code === 'ENOTDIR')</span></div><div class="L8"><span class="pp-ln"> 488 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.statCache[abs] = false</span></div><div class="L9"><span class="pp-ln"> 489 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> cb()</span></div><div class="L0"><span class="pp-ln"> 490 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> needDir = f.slice(-1) === '/'</span></div><div class="L1"><span class="pp-ln"> 491 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.statCache[abs] = stat</span></div><div class="L2"><span class="pp-ln"> 492 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> abs.slice(-1) === '/' && stat && !stat.isDirectory()</span></div><div class="L3"><span class="pp-ln"> 493 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> cb(null, false, stat)</span></div><div class="L4"><span class="pp-ln"> 494 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> c = true</span></div><div class="L5"><span class="pp-ln"> 495 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> stat</span></div><div class="L6"><span class="pp-ln"> 496 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> c = stat.isDirectory() ? 'DIR' : 'FILE'</span></div><div class="L7"><span class="pp-ln"> 497 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.cache[abs] = this.cache[abs] || c</span></div><div class="L8"><span class="pp-ln"> 498 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> needDir && c === 'FILE'</span></div><div class="L9"><span class="pp-ln"> 499 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> cb()</span></div><div class="L0"><span class="pp-ln"> 500 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> cb(null, c, stat)</span></div><div class="L1"><span class="pp-ln"> 501 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> inherits(Glob, EE)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d13">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/glob/inflight.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> wrappy = require('wrappy')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> reqs = Object.create(null)</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> once = require('./once')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = wrappy(inflight)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> inflight</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> key</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> reqs[key]</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> reqs[key].push(cb)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> reqs[key] = [cb]</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> makeres(key)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> makeres</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> key</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> once</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">function</span><span class="pp-pln"> RES</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> cbs = reqs[key]</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> len = cbs.length</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> args = slice(arguments)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">try</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; len; i++</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> cbs[i].apply(null, args)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">finally</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> cbs.length &gt; len</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> cbs.splice(0, len)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> RES.apply(null, args)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> delete (reqs[key])</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> slice</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> args</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> length = args.length</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> array</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; length; i++</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> array[i] = args[i]</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> array</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d14">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/glob/minimatch.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = minimatch</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> minimatch.Minimatch = Minimatch</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> path</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> sep '/'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">try</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> path = require('path')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">catch</span><span class="pp-pln"> er</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> GLOBSTAR = minimatch.GLOBSTAR = Minimatch.GLOBSTAR = {}</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> expand = require('./brace-expansion')</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> plTypes</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '!'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> open '(?:(?!(?:'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> close '))[^/]*?)'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '?'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> open '(?:'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> close ')?'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '+'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> open '(?:'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> close ')+'</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '*'</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> open '(?:'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> close ')*'</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '@'</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> open '(?:'</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> close ')'</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> qmark = '[^/]'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> star = (qmark + '*?')</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> twoStarDot = '(?:(?!(?:\\\/|^)(?:\\.{1,2})($|\\\/)).)*?'</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> twoStarNoDot = '(?:(?!(?:\\\/|^)\\.).)*?'</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> reSpecials = charSet('().*{}+?[]^$\\!')</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> charSet</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> s</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> s.split('')</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> reduce</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> set</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> c</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> set[c] = true</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> set</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> slashSplit = /\/+/</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> minimatch.filter = filter</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> filter</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> options = (options || {})</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> p</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> i</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> list</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> minimatch(p, pattern, options)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> ext</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> a</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> b</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> a = (a || {})</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> b = (b || {})</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> t</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> Object.keys(b)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> forEach</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> k</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> t[k] = b[k]</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> Object.keys(a)</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> forEach</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> k</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> t[k] = a[k]</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> t</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> minimatch.defaults =</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> def</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> (! (def) || ! (Object.keys(def).length))</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> minimatch</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> orig = minimatch</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> m</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                </span><span class="pp-tag">function</span><span class="pp-pln"> minimatch</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> p</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> orig.minimatch</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> p</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> pattern</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> ext(def, options)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> m.Minimatch =</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">function</span><span class="pp-pln"> Minimatch</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                        </span><span class="pp-tag">new</span><span class="pp-pln"> orig.Minimatch</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> pattern</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> ext(def, options)</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> m</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> Minimatch.defaults =</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> def</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> (! (def) || ! (Object.keys(def).length))</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> Minimatch</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> minimatch.defaults(def)</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                    </span><span class="pp-tag">.</span><span class="pp-pln"> Minimatch</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> minimatch</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> p</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (pattern) !== 'string'</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> TypeError('glob pattern string required')</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (options)</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> (! (options.nocomment) && (pattern.charAt(0) === '#'))</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> pattern.trim() === ''</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> p === ''</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Minimatch(pattern, options)</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> match(p)</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> Minimatch</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (this instanceof Minimatch)</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Minimatch(pattern, options)</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (pattern) !== 'string'</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> TypeError('glob pattern string required')</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (options)</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> pattern = pattern.trim()</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> path.sep !== '/'</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> pattern = pattern.split(path.sep).join('/')</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.options = options</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.set = []</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.pattern = pattern</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.regexp = null</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.negate = false</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.comment = false</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.empty = false</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.make()</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> Minimatch.prototype.debug =</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> Minimatch.prototype.make = make</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> make</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this._made</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> pattern = this.pattern</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> options = this.options</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> (! (options.nocomment) && (pattern.charAt(0) === '#'))</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.comment = true</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (pattern)</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.empty = true</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.parseNegate()</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> set = this.globSet = this.braceExpand()</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> options.debug</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.debug = console.error</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> this.pattern</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> set</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> set =</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.globParts =</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> set.map</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> s</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> s.split(slashSplit)</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> this.pattern</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> set</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> set =</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> set.map</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> s</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> si</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> set</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> s.map</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> this.parse</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> this</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> this</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> this.pattern</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> set</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> set =</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> set.filter</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> s</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> s.indexOf(false) === - (1)</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> this.pattern</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> set</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.set = set</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> Minimatch.prototype.parseNegate = parseNegate</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> parseNegate</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> pattern = this.pattern</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> negate = false</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> options = this.options</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> negateOffset = 0</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> options.nonegate</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0, l = pattern.length; ((i &lt; l) && (pattern.charAt(i) === '!')); i++</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> negate = ! (negate)</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> negateOffset++</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> negateOffset</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.pattern = pattern.substr(negateOffset)</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.negate = negate</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> minimatch.braceExpand =</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> braceExpand(pattern, options)</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> Minimatch.prototype.braceExpand = braceExpand</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> braceExpand</span></div><div class="L8"><span class="pp-ln"> 228 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L9"><span class="pp-ln"> 229 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln"> 230 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (options)</span></div><div class="L1"><span class="pp-ln"> 231 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this instanceof Minimatch</span></div><div class="L2"><span class="pp-ln"> 232 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options = this.options</span></div><div class="L3"><span class="pp-ln"> 233 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln"> 234 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L5"><span class="pp-ln"> 235 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln"> 236 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> pattern = typeof (pattern) === 'undefined' ? this.pattern : pattern</span></div><div class="L7"><span class="pp-ln"> 237 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (pattern) === 'undefined'</span></div><div class="L8"><span class="pp-ln"> 238 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span></div><div class="L9"><span class="pp-ln"> 239 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> TypeError('undefined pattern')</span></div><div class="L0"><span class="pp-ln"> 240 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> (options.nobrace || ! (pattern.match(/\{.*\}/)))</span></div><div class="L1"><span class="pp-ln"> 241 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 242 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L3"><span class="pp-ln"> 243 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> pattern</span></div><div class="L4"><span class="pp-ln"> 244 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> expand(pattern)</span></div><div class="L5"><span class="pp-ln"> 245 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> Minimatch.prototype.parse = parse</span></div><div class="L6"><span class="pp-ln"> 246 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> SUBPARSE</span></div><div class="L7"><span class="pp-ln"> 247 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln"> 248 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> parse</span></div><div class="L9"><span class="pp-ln"> 249 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L0"><span class="pp-ln"> 250 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> isSub</span></div><div class="L1"><span class="pp-ln"> 251 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> (pattern.length &gt; (1024 * 64))</span></div><div class="L2"><span class="pp-ln"> 252 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span></div><div class="L3"><span class="pp-ln"> 253 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> TypeError('pattern is too long')</span></div><div class="L4"><span class="pp-ln"> 254 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> options = this.options</span></div><div class="L5"><span class="pp-ln"> 255 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> (! (options.noglobstar) && (pattern === '**'))</span></div><div class="L6"><span class="pp-ln"> 256 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> GLOBSTAR</span></div><div class="L7"><span class="pp-ln"> 257 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> pattern === ''</span></div><div class="L8"><span class="pp-ln"> 258 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ''</span></div><div class="L9"><span class="pp-ln"> 259 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> re = ''</span></div><div class="L0"><span class="pp-ln"> 260 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> hasMagic = ! (! (options.nocase))</span></div><div class="L1"><span class="pp-ln"> 261 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> escaping = false</span></div><div class="L2"><span class="pp-ln"> 262 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> patternListStack</span></div><div class="L3"><span class="pp-ln"> 263 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln"> 264 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> negativeLists</span></div><div class="L5"><span class="pp-ln"> 265 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L6"><span class="pp-ln"> 266 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> stateChar</span></div><div class="L7"><span class="pp-ln"> 267 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> inClass = false</span></div><div class="L8"><span class="pp-ln"> 268 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> reClassStart = - (1)</span></div><div class="L9"><span class="pp-ln"> 269 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> classStart = - (1)</span></div><div class="L0"><span class="pp-ln"> 270 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> patternStart = pattern.charAt(0) === '.' ? '' : options.dot ? '(?!(?:^|\\\/)\\.{1,2}(?:$|\\\/))' : '(?!\\.)'</span></div><div class="L1"><span class="pp-ln"> 271 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> self = this</span></div><div class="L2"><span class="pp-ln"> 272 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> clearStateChar</span></div><div class="L3"><span class="pp-ln"> 273 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> stateChar</span></div><div class="L4"><span class="pp-ln"> 274 </span><span class="pp-pln">                </span><span class="pp-tag">switch</span><span class="pp-pln"> stateChar</span></div><div class="L5"><span class="pp-ln"> 275 </span><span class="pp-pln">                    </span><span class="pp-tag">case</span><span class="pp-pln"> '*'</span></div><div class="L6"><span class="pp-ln"> 276 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> re += star</span></div><div class="L7"><span class="pp-ln"> 277 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> hasMagic = true</span></div><div class="L8"><span class="pp-ln"> 278 </span><span class="pp-pln">                        </span><span class="pp-tag">break</span></div><div class="L9"><span class="pp-ln"> 279 </span><span class="pp-pln">                    </span><span class="pp-tag">case</span><span class="pp-pln"> '?'</span></div><div class="L0"><span class="pp-ln"> 280 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> re += qmark</span></div><div class="L1"><span class="pp-ln"> 281 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> hasMagic = true</span></div><div class="L2"><span class="pp-ln"> 282 </span><span class="pp-pln">                        </span><span class="pp-tag">break</span></div><div class="L3"><span class="pp-ln"> 283 </span><span class="pp-pln">                    </span><span class="pp-tag">default</span></div><div class="L4"><span class="pp-ln"> 284 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> re += ('\\' + stateChar)</span></div><div class="L5"><span class="pp-ln"> 285 </span><span class="pp-pln">                        </span><span class="pp-tag">break</span></div><div class="L6"><span class="pp-ln"> 286 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> self.debug('clearStateChar %j %j', stateChar, re)</span></div><div class="L7"><span class="pp-ln"> 287 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> stateChar = false</span></div><div class="L8"><span class="pp-ln"> 288 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0, len = pattern.length, c; ((i &lt; len) && (c = pattern.charAt(i))); i++</span></div><div class="L9"><span class="pp-ln"> 289 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('%s\t%s %s %j', pattern, i, re, c)</span></div><div class="L0"><span class="pp-ln"> 290 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> escaping && reSpecials[c]</span></div><div class="L1"><span class="pp-ln"> 291 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> re += ('\\' + c)</span></div><div class="L2"><span class="pp-ln"> 292 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> escaping = false</span></div><div class="L3"><span class="pp-ln"> 293 </span><span class="pp-pln">                </span><span class="pp-tag">continue</span></div><div class="L4"><span class="pp-ln"> 294 </span><span class="pp-pln">            </span><span class="pp-tag">switch</span><span class="pp-pln"> c</span></div><div class="L5"><span class="pp-ln"> 295 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> '/'</span></div><div class="L6"><span class="pp-ln"> 296 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L7"><span class="pp-ln"> 297 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> '\\'</span></div><div class="L8"><span class="pp-ln"> 298 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> clearStateChar()</span></div><div class="L9"><span class="pp-ln"> 299 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> escaping = true</span></div><div class="L0"><span class="pp-ln"> 300 </span><span class="pp-pln">                    </span><span class="pp-tag">continue</span></div><div class="L1"><span class="pp-ln"> 301 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> '?'</span></div><div class="L2"><span class="pp-ln"> 302 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> '*'</span></div><div class="L3"><span class="pp-ln"> 303 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> '+'</span></div><div class="L4"><span class="pp-ln"> 304 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> '@'</span></div><div class="L5"><span class="pp-ln"> 305 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> '!'</span></div><div class="L6"><span class="pp-ln"> 306 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('%s\t%s %s %j &lt;-- stateChar', pattern, i, re, c)</span></div><div class="L7"><span class="pp-ln"> 307 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> inClass</span></div><div class="L8"><span class="pp-ln"> 308 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('  in class')</span></div><div class="L9"><span class="pp-ln"> 309 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> ((c === '!') && ((i === ((classStart + 1)))))</span></div><div class="L0"><span class="pp-ln"> 310 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> c = '^'</span></div><div class="L1"><span class="pp-ln"> 311 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> re += c</span></div><div class="L2"><span class="pp-ln"> 312 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L3"><span class="pp-ln"> 313 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> self.debug('call clearStateChar %j', stateChar)</span></div><div class="L4"><span class="pp-ln"> 314 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> clearStateChar()</span></div><div class="L5"><span class="pp-ln"> 315 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> stateChar = c</span></div><div class="L6"><span class="pp-ln"> 316 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> options.noext</span></div><div class="L7"><span class="pp-ln"> 317 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> clearStateChar()</span></div><div class="L8"><span class="pp-ln"> 318 </span><span class="pp-pln">                    </span><span class="pp-tag">continue</span></div><div class="L9"><span class="pp-ln"> 319 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> '('</span></div><div class="L0"><span class="pp-ln"> 320 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> inClass</span></div><div class="L1"><span class="pp-ln"> 321 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> re += '('</span></div><div class="L2"><span class="pp-ln"> 322 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L3"><span class="pp-ln"> 323 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> ! (stateChar)</span></div><div class="L4"><span class="pp-ln"> 324 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> re += '\\('</span></div><div class="L5"><span class="pp-ln"> 325 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L6"><span class="pp-ln"> 326 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> patternListStack.push</span></div><div class="L7"><span class="pp-ln"> 327 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln"> 328 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> type stateChar</span></div><div class="L9"><span class="pp-ln"> 329 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> start (i - 1)</span></div><div class="L0"><span class="pp-ln"> 330 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> reStart re.length</span></div><div class="L1"><span class="pp-ln"> 331 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> open plTypes[stateChar].open</span></div><div class="L2"><span class="pp-ln"> 332 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> close plTypes[stateChar].close</span></div><div class="L3"><span class="pp-ln"> 333 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> re += stateChar === '!' ? '(?:(?!(?:' : '(?:'</span></div><div class="L4"><span class="pp-ln"> 334 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('plType %j %j', stateChar, re)</span></div><div class="L5"><span class="pp-ln"> 335 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> stateChar = false</span></div><div class="L6"><span class="pp-ln"> 336 </span><span class="pp-pln">                    </span><span class="pp-tag">continue</span></div><div class="L7"><span class="pp-ln"> 337 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> ')'</span></div><div class="L8"><span class="pp-ln"> 338 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> (inClass || ! (patternListStack.length))</span></div><div class="L9"><span class="pp-ln"> 339 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> re += '\\)'</span></div><div class="L0"><span class="pp-ln"> 340 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L1"><span class="pp-ln"> 341 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> clearStateChar()</span></div><div class="L2"><span class="pp-ln"> 342 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> hasMagic = true</span></div><div class="L3"><span class="pp-ln"> 343 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> pl = patternListStack.pop()</span></div><div class="L4"><span class="pp-ln"> 344 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> re += pl.close</span></div><div class="L5"><span class="pp-ln"> 345 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> pl.type === '!'</span></div><div class="L6"><span class="pp-ln"> 346 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> negativeLists.push(pl)</span></div><div class="L7"><span class="pp-ln"> 347 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> pl.reEnd = re.length</span></div><div class="L8"><span class="pp-ln"> 348 </span><span class="pp-pln">                    </span><span class="pp-tag">continue</span></div><div class="L9"><span class="pp-ln"> 349 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> '|'</span></div><div class="L0"><span class="pp-ln"> 350 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> (((inClass || ! (patternListStack.length))) || escaping)</span></div><div class="L1"><span class="pp-ln"> 351 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> re += '\\|'</span></div><div class="L2"><span class="pp-ln"> 352 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> escaping = false</span></div><div class="L3"><span class="pp-ln"> 353 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L4"><span class="pp-ln"> 354 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> clearStateChar()</span></div><div class="L5"><span class="pp-ln"> 355 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> re += '|'</span></div><div class="L6"><span class="pp-ln"> 356 </span><span class="pp-pln">                    </span><span class="pp-tag">continue</span></div><div class="L7"><span class="pp-ln"> 357 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> '['</span></div><div class="L8"><span class="pp-ln"> 358 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> clearStateChar()</span></div><div class="L9"><span class="pp-ln"> 359 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> inClass</span></div><div class="L0"><span class="pp-ln"> 360 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> re += ('\\' + c)</span></div><div class="L1"><span class="pp-ln"> 361 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L2"><span class="pp-ln"> 362 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> inClass = true</span></div><div class="L3"><span class="pp-ln"> 363 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> classStart = i</span></div><div class="L4"><span class="pp-ln"> 364 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> reClassStart = re.length</span></div><div class="L5"><span class="pp-ln"> 365 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> re += c</span></div><div class="L6"><span class="pp-ln"> 366 </span><span class="pp-pln">                    </span><span class="pp-tag">continue</span></div><div class="L7"><span class="pp-ln"> 367 </span><span class="pp-pln">                </span><span class="pp-tag">case</span><span class="pp-pln"> ']'</span></div><div class="L8"><span class="pp-ln"> 368 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> (((i === ((classStart + 1)))) || ! (inClass))</span></div><div class="L9"><span class="pp-ln"> 369 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> re += ('\\' + c)</span></div><div class="L0"><span class="pp-ln"> 370 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> escaping = false</span></div><div class="L1"><span class="pp-ln"> 371 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L2"><span class="pp-ln"> 372 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> inClass</span></div><div class="L3"><span class="pp-ln"> 373 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> cs = pattern.substring((classStart + 1), i)</span></div><div class="L4"><span class="pp-ln"> 374 </span><span class="pp-pln">                        </span><span class="pp-tag">try</span></div><div class="L5"><span class="pp-ln"> 375 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> RegExp(((('[' + cs)) + ']'))</span></div><div class="L6"><span class="pp-ln"> 376 </span><span class="pp-pln">                        </span><span class="pp-tag">catch</span><span class="pp-pln"> er</span></div><div class="L7"><span class="pp-ln"> 377 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> sp = this.parse(cs, SUBPARSE)</span></div><div class="L8"><span class="pp-ln"> 378 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> re = (((((re.substr(0, reClassStart) + '\\[')) + sp[0])) + '\\]')</span></div><div class="L9"><span class="pp-ln"> 379 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> hasMagic = (hasMagic || sp[1])</span></div><div class="L0"><span class="pp-ln"> 380 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> inClass = false</span></div><div class="L1"><span class="pp-ln"> 381 </span><span class="pp-pln">                            </span><span class="pp-tag">continue</span></div><div class="L2"><span class="pp-ln"> 382 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> hasMagic = true</span></div><div class="L3"><span class="pp-ln"> 383 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> inClass = false</span></div><div class="L4"><span class="pp-ln"> 384 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> re += c</span></div><div class="L5"><span class="pp-ln"> 385 </span><span class="pp-pln">                    </span><span class="pp-tag">continue</span></div><div class="L6"><span class="pp-ln"> 386 </span><span class="pp-pln">                </span><span class="pp-tag">default</span></div><div class="L7"><span class="pp-ln"> 387 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> clearStateChar()</span></div><div class="L8"><span class="pp-ln"> 388 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> escaping</span></div><div class="L9"><span class="pp-ln"> 389 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> escaping = false</span></div><div class="L0"><span class="pp-ln"> 390 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> reSpecials[c] && ! (((c === '^') && inClass))</span></div><div class="L1"><span class="pp-ln"> 391 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> re += '\\'</span></div><div class="L2"><span class="pp-ln"> 392 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> re += c</span></div><div class="L3"><span class="pp-ln"> 393 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> inClass</span></div><div class="L4"><span class="pp-ln"> 394 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> cs = pattern.substr((classStart + 1))</span></div><div class="L5"><span class="pp-ln"> 395 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> sp = this.parse(cs, SUBPARSE)</span></div><div class="L6"><span class="pp-ln"> 396 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> re = (((re.substr(0, reClassStart) + '\\[')) + sp[0])</span></div><div class="L7"><span class="pp-ln"> 397 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> hasMagic = (hasMagic || sp[1])</span></div><div class="L8"><span class="pp-ln"> 398 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> pl = patternListStack.pop(); pl; pl = patternListStack.pop()</span></div><div class="L9"><span class="pp-ln"> 399 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> tail = re.slice((pl.reStart + pl.open.length))</span></div><div class="L0"><span class="pp-ln"> 400 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('setting tail', re, pl)</span></div><div class="L1"><span class="pp-ln"> 401 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> tail =</span></div><div class="L2"><span class="pp-ln"> 402 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> tail.replace</span></div><div class="L3"><span class="pp-ln"> 403 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> /((?:\\{2}){0,64})(\\?)\|/g</span></div><div class="L4"><span class="pp-ln"> 404 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln"> 405 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> _</span></div><div class="L6"><span class="pp-ln"> 406 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> $1</span></div><div class="L7"><span class="pp-ln"> 407 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> $2</span></div><div class="L8"><span class="pp-ln"> 408 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> ! ($2)</span></div><div class="L9"><span class="pp-ln"> 409 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> $2 = '\\'</span></div><div class="L0"><span class="pp-ln"> 410 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> ((((($1 + $1)) + $2)) + '|')</span></div><div class="L1"><span class="pp-ln"> 411 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('tail=%j\n   %s', tail, tail, pl, re)</span></div><div class="L2"><span class="pp-ln"> 412 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> t = pl.type === '*' ? star : pl.type === '?' ? qmark : ('\\' + pl.type)</span></div><div class="L3"><span class="pp-ln"> 413 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> hasMagic = true</span></div><div class="L4"><span class="pp-ln"> 414 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> re = (((((re.slice(0, pl.reStart) + t)) + '\\(')) + tail)</span></div><div class="L5"><span class="pp-ln"> 415 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> clearStateChar()</span></div><div class="L6"><span class="pp-ln"> 416 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> escaping</span></div><div class="L7"><span class="pp-ln"> 417 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> re += '\\\\'</span></div><div class="L8"><span class="pp-ln"> 418 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> addPatternStart = false</span></div><div class="L9"><span class="pp-ln"> 419 </span><span class="pp-pln">        </span><span class="pp-tag">switch</span><span class="pp-pln"> re.charAt(0)</span></div><div class="L0"><span class="pp-ln"> 420 </span><span class="pp-pln">            </span><span class="pp-tag">case</span><span class="pp-pln"> '.'</span></div><div class="L1"><span class="pp-ln"> 421 </span><span class="pp-pln">            </span><span class="pp-tag">case</span><span class="pp-pln"> '['</span></div><div class="L2"><span class="pp-ln"> 422 </span><span class="pp-pln">            </span><span class="pp-tag">case</span><span class="pp-pln"> '('</span></div><div class="L3"><span class="pp-ln"> 423 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> addPatternStart = true</span></div><div class="L4"><span class="pp-ln"> 424 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var n = (negativeLists.length - 1); n &gt; - (1); n--</span></div><div class="L5"><span class="pp-ln"> 425 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nl = negativeLists[n]</span></div><div class="L6"><span class="pp-ln"> 426 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nlBefore</span></div><div class="L7"><span class="pp-ln"> 427 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> re.slice</span></div><div class="L8"><span class="pp-ln"> 428 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L9"><span class="pp-ln"> 429 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> nl.reStart</span></div><div class="L0"><span class="pp-ln"> 430 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nlFirst</span></div><div class="L1"><span class="pp-ln"> 431 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> re.slice</span></div><div class="L2"><span class="pp-ln"> 432 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> nl.reStart</span></div><div class="L3"><span class="pp-ln"> 433 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> (nl.reEnd - 8)</span></div><div class="L4"><span class="pp-ln"> 434 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nlLast</span></div><div class="L5"><span class="pp-ln"> 435 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> re.slice</span></div><div class="L6"><span class="pp-ln"> 436 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> (nl.reEnd - 8)</span></div><div class="L7"><span class="pp-ln"> 437 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> nl.reEnd</span></div><div class="L8"><span class="pp-ln"> 438 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nlAfter</span></div><div class="L9"><span class="pp-ln"> 439 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> re.slice</span></div><div class="L0"><span class="pp-ln"> 440 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> nl.reEnd</span></div><div class="L1"><span class="pp-ln"> 441 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> nlLast += nlAfter</span></div><div class="L2"><span class="pp-ln"> 442 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> openParensBefore = (nlBefore.split('(').length - 1)</span></div><div class="L3"><span class="pp-ln"> 443 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> cleanAfter = nlAfter</span></div><div class="L4"><span class="pp-ln"> 444 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> i = 0; i &lt; openParensBefore; i++</span></div><div class="L5"><span class="pp-ln"> 445 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> cleanAfter = cleanAfter.replace(/\)[+*?]?/, '')</span></div><div class="L6"><span class="pp-ln"> 446 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> nlAfter = cleanAfter</span></div><div class="L7"><span class="pp-ln"> 447 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> dollar = ''</span></div><div class="L8"><span class="pp-ln"> 448 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ((nlAfter === '') && (isSub !== SUBPARSE))</span></div><div class="L9"><span class="pp-ln"> 449 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> dollar = '$'</span></div><div class="L0"><span class="pp-ln"> 450 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> newRe = (((((((nlBefore + nlFirst)) + nlAfter)) + dollar)) + nlLast)</span></div><div class="L1"><span class="pp-ln"> 451 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> re = newRe</span></div><div class="L2"><span class="pp-ln"> 452 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ((re !== '') && hasMagic)</span></div><div class="L3"><span class="pp-ln"> 453 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> re = ('(?=.)' + re)</span></div><div class="L4"><span class="pp-ln"> 454 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> addPatternStart</span></div><div class="L5"><span class="pp-ln"> 455 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> re = (patternStart + re)</span></div><div class="L6"><span class="pp-ln"> 456 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> isSub === SUBPARSE</span></div><div class="L7"><span class="pp-ln"> 457 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 458 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L9"><span class="pp-ln"> 459 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> re</span></div><div class="L0"><span class="pp-ln"> 460 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> hasMagic</span></div><div class="L1"><span class="pp-ln"> 461 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (hasMagic)</span></div><div class="L2"><span class="pp-ln"> 462 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> globUnescape(pattern)</span></div><div class="L3"><span class="pp-ln"> 463 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> flags = options.nocase ? 'i' : ''</span></div><div class="L4"><span class="pp-ln"> 464 </span><span class="pp-pln">        </span><span class="pp-tag">try</span></div><div class="L5"><span class="pp-ln"> 465 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> regExp</span></div><div class="L6"><span class="pp-ln"> 466 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> RegExp(((('^' + re)) + '$'), flags)</span></div><div class="L7"><span class="pp-ln"> 467 </span><span class="pp-pln">        </span><span class="pp-tag">catch</span><span class="pp-pln"> er</span></div><div class="L8"><span class="pp-ln"> 468 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 469 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> RegExp('$.')</span></div><div class="L0"><span class="pp-ln"> 470 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> regExp._glob = pattern</span></div><div class="L1"><span class="pp-ln"> 471 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> regExp._src = re</span></div><div class="L2"><span class="pp-ln"> 472 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> regExp</span></div><div class="L3"><span class="pp-ln"> 473 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> minimatch.makeRe =</span></div><div class="L4"><span class="pp-ln"> 474 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln"> 475 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L6"><span class="pp-ln"> 476 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L7"><span class="pp-ln"> 477 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 478 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Minimatch(pattern, (options || {}))</span></div><div class="L9"><span class="pp-ln"> 479 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> makeRe()</span></div><div class="L0"><span class="pp-ln"> 480 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> Minimatch.prototype.makeRe = makeRe</span></div><div class="L1"><span class="pp-ln"> 481 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> makeRe</span></div><div class="L2"><span class="pp-ln"> 482 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> (this.regexp || (this.regexp === false))</span></div><div class="L3"><span class="pp-ln"> 483 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.regexp</span></div><div class="L4"><span class="pp-ln"> 484 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> set = this.set</span></div><div class="L5"><span class="pp-ln"> 485 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ! (set.length)</span></div><div class="L6"><span class="pp-ln"> 486 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.regexp = false</span></div><div class="L7"><span class="pp-ln"> 487 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.regexp</span></div><div class="L8"><span class="pp-ln"> 488 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> options = this.options</span></div><div class="L9"><span class="pp-ln"> 489 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> twoStar = options.noglobstar ? star : options.dot ? twoStarDot : twoStarNoDot</span></div><div class="L0"><span class="pp-ln"> 490 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> flags = options.nocase ? 'i' : ''</span></div><div class="L1"><span class="pp-ln"> 491 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> re</span></div><div class="L2"><span class="pp-ln"> 492 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> set.map</span></div><div class="L3"><span class="pp-ln"> 493 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln"> 494 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L5"><span class="pp-ln"> 495 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln"> 496 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> pattern.map</span></div><div class="L7"><span class="pp-ln"> 497 </span><span class="pp-pln">                            </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln"> 498 </span><span class="pp-pln">                                </span><span class="pp-tag">param</span><span class="pp-pln"> p</span></div><div class="L9"><span class="pp-ln"> 499 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 500 </span><span class="pp-pln">                                    </span><span class="pp-tag">iif</span><span class="pp-pln"> p === GLOBSTAR</span></div><div class="L1"><span class="pp-ln"> 501 </span><span class="pp-pln">                                        </span><span class="pp-tag">then</span><span class="pp-pln"> twoStar</span></div><div class="L2"><span class="pp-ln"> 502 </span><span class="pp-pln">                                        </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 503 </span><span class="pp-pln">                                            </span><span class="pp-tag">iif</span><span class="pp-pln"> typeof (p) === 'string'</span></div><div class="L4"><span class="pp-ln"> 504 </span><span class="pp-pln">                                                </span><span class="pp-tag">then</span></div><div class="L5"><span class="pp-ln"> 505 </span><span class="pp-pln">                                                    </span><span class="pp-tag">_</span><span class="pp-pln"> regExpEscape(p)</span></div><div class="L6"><span class="pp-ln"> 506 </span><span class="pp-pln">                                                </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 507 </span><span class="pp-pln">                                                    </span><span class="pp-tag">set</span><span class="pp-pln"> p._src</span></div><div class="L8"><span class="pp-ln"> 508 </span><span class="pp-pln">                            </span><span class="pp-tag">._</span><span class="pp-pln"> join('\\\/')</span></div><div class="L9"><span class="pp-ln"> 509 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> join('|')</span></div><div class="L0"><span class="pp-ln"> 510 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> re = ((('^(?:' + re)) + ')$')</span></div><div class="L1"><span class="pp-ln"> 511 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.negate</span></div><div class="L2"><span class="pp-ln"> 512 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> re = ((('^(?!' + re)) + ').*$')</span></div><div class="L3"><span class="pp-ln"> 513 </span><span class="pp-pln">        </span><span class="pp-tag">try</span></div><div class="L4"><span class="pp-ln"> 514 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.regexp = new RegExp(re, flags)</span></div><div class="L5"><span class="pp-ln"> 515 </span><span class="pp-pln">        </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L6"><span class="pp-ln"> 516 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.regexp = false</span></div><div class="L7"><span class="pp-ln"> 517 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> this.regexp</span></div><div class="L8"><span class="pp-ln"> 518 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> minimatch.match =</span></div><div class="L9"><span class="pp-ln"> 519 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln"> 520 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> list</span></div><div class="L1"><span class="pp-ln"> 521 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L2"><span class="pp-ln"> 522 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L3"><span class="pp-ln"> 523 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> options = (options || {})</span></div><div class="L4"><span class="pp-ln"> 524 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> mm</span></div><div class="L5"><span class="pp-ln"> 525 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Minimatch(pattern, options)</span></div><div class="L6"><span class="pp-ln"> 526 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> list =</span></div><div class="L7"><span class="pp-ln"> 527 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> list.filter</span></div><div class="L8"><span class="pp-ln"> 528 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln"> 529 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> f</span></div><div class="L0"><span class="pp-ln"> 530 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> mm.match(f)</span></div><div class="L1"><span class="pp-ln"> 531 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> mm.options.nonull && ! (list.length)</span></div><div class="L2"><span class="pp-ln"> 532 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> list.push(pattern)</span></div><div class="L3"><span class="pp-ln"> 533 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> list</span></div><div class="L4"><span class="pp-ln"> 534 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> Minimatch.prototype.match = match</span></div><div class="L5"><span class="pp-ln"> 535 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> match</span></div><div class="L6"><span class="pp-ln"> 536 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> f</span></div><div class="L7"><span class="pp-ln"> 537 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> partial</span></div><div class="L8"><span class="pp-ln"> 538 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug</span></div><div class="L9"><span class="pp-ln"> 539 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'match'</span></div><div class="L0"><span class="pp-ln"> 540 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> f</span></div><div class="L1"><span class="pp-ln"> 541 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> this.pattern</span></div><div class="L2"><span class="pp-ln"> 542 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.comment</span></div><div class="L3"><span class="pp-ln"> 543 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L4"><span class="pp-ln"> 544 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.empty</span></div><div class="L5"><span class="pp-ln"> 545 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> f === ''</span></div><div class="L6"><span class="pp-ln"> 546 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ((f === '/') && partial)</span></div><div class="L7"><span class="pp-ln"> 547 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L8"><span class="pp-ln"> 548 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> options = this.options</span></div><div class="L9"><span class="pp-ln"> 549 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> path.sep !== '/'</span></div><div class="L0"><span class="pp-ln"> 550 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> f = f.split(path.sep).join('/')</span></div><div class="L1"><span class="pp-ln"> 551 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> f = f.split(slashSplit)</span></div><div class="L2"><span class="pp-ln"> 552 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug</span></div><div class="L3"><span class="pp-ln"> 553 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> this.pattern</span></div><div class="L4"><span class="pp-ln"> 554 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'split'</span></div><div class="L5"><span class="pp-ln"> 555 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> f</span></div><div class="L6"><span class="pp-ln"> 556 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> set = this.set</span></div><div class="L7"><span class="pp-ln"> 557 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug</span></div><div class="L8"><span class="pp-ln"> 558 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> this.pattern</span></div><div class="L9"><span class="pp-ln"> 559 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'set'</span></div><div class="L0"><span class="pp-ln"> 560 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> set</span></div><div class="L1"><span class="pp-ln"> 561 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> filename</span></div><div class="L2"><span class="pp-ln"> 562 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> i</span></div><div class="L3"><span class="pp-ln"> 563 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> i = (f.length - 1); i &gt;= 0; i--</span></div><div class="L4"><span class="pp-ln"> 564 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> filename = f[i]</span></div><div class="L5"><span class="pp-ln"> 565 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> filename</span></div><div class="L6"><span class="pp-ln"> 566 </span><span class="pp-pln">                </span><span class="pp-tag">break</span></div><div class="L7"><span class="pp-ln"> 567 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> i = 0; i &lt; set.length; i++</span></div><div class="L8"><span class="pp-ln"> 568 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> pattern = set[i]</span></div><div class="L9"><span class="pp-ln"> 569 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> file = f</span></div><div class="L0"><span class="pp-ln"> 570 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> (options.matchBase && (pattern.length === 1))</span></div><div class="L1"><span class="pp-ln"> 571 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> file = [filename]</span></div><div class="L2"><span class="pp-ln"> 572 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> hit = this.matchOne(file, pattern, partial)</span></div><div class="L3"><span class="pp-ln"> 573 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> hit</span></div><div class="L4"><span class="pp-ln"> 574 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> options.flipNegate</span></div><div class="L5"><span class="pp-ln"> 575 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L6"><span class="pp-ln"> 576 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> ! (this.negate)</span></div><div class="L7"><span class="pp-ln"> 577 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> options.flipNegate</span></div><div class="L8"><span class="pp-ln"> 578 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L9"><span class="pp-ln"> 579 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> this.negate</span></div><div class="L0"><span class="pp-ln"> 580 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> Minimatch.prototype.matchOne =</span></div><div class="L1"><span class="pp-ln"> 581 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln"> 582 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> file</span></div><div class="L3"><span class="pp-ln"> 583 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L4"><span class="pp-ln"> 584 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> partial</span></div><div class="L5"><span class="pp-ln"> 585 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> options = this.options</span></div><div class="L6"><span class="pp-ln"> 586 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug</span></div><div class="L7"><span class="pp-ln"> 587 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'matchOne'</span></div><div class="L8"><span class="pp-ln"> 588 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln"> 589 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'this' this</span></div><div class="L0"><span class="pp-ln"> 590 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file file</span></div><div class="L1"><span class="pp-ln"> 591 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> pattern pattern</span></div><div class="L2"><span class="pp-ln"> 592 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug</span></div><div class="L3"><span class="pp-ln"> 593 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'matchOne'</span></div><div class="L4"><span class="pp-ln"> 594 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file.length</span></div><div class="L5"><span class="pp-ln"> 595 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> pattern.length</span></div><div class="L6"><span class="pp-ln"> 596 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var fi = 0, pi = 0, fl = file.length, pl = pattern.length; ((fi &lt; fl) && (pi &lt; pl)); fi++, pi++</span></div><div class="L7"><span class="pp-ln"> 597 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('matchOne loop')</span></div><div class="L8"><span class="pp-ln"> 598 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> p = pattern[pi]</span></div><div class="L9"><span class="pp-ln"> 599 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> f = file[fi]</span></div><div class="L0"><span class="pp-ln"> 600 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug(pattern, p, f)</span></div><div class="L1"><span class="pp-ln"> 601 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> p === false</span></div><div class="L2"><span class="pp-ln"> 602 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L3"><span class="pp-ln"> 603 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> p === GLOBSTAR</span></div><div class="L4"><span class="pp-ln"> 604 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug</span></div><div class="L5"><span class="pp-ln"> 605 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'GLOBSTAR'</span></div><div class="L6"><span class="pp-ln"> 606 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span></div><div class="L7"><span class="pp-ln"> 607 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> pattern</span></div><div class="L8"><span class="pp-ln"> 608 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> p</span></div><div class="L9"><span class="pp-ln"> 609 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> f</span></div><div class="L0"><span class="pp-ln"> 610 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> fr = fi</span></div><div class="L1"><span class="pp-ln"> 611 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> pr = (pi + 1)</span></div><div class="L2"><span class="pp-ln"> 612 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> pr === pl</span></div><div class="L3"><span class="pp-ln"> 613 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('** at the end')</span></div><div class="L4"><span class="pp-ln"> 614 </span><span class="pp-pln">                        </span><span class="pp-tag">for</span><span class="pp-pln"> ; fi &lt; fl; fi++</span></div><div class="L5"><span class="pp-ln"> 615 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> ((((file[fi] === '.') || (file[fi] === '..'))) || ((! (options.dot) && (file[fi].charAt(0) === '.'))))</span></div><div class="L6"><span class="pp-ln"> 616 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L7"><span class="pp-ln"> 617 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L8"><span class="pp-ln"> 618 </span><span class="pp-pln">                    </span><span class="pp-tag">while</span><span class="pp-pln"> fr &lt; fl</span></div><div class="L9"><span class="pp-ln"> 619 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> swallowee = file[fr]</span></div><div class="L0"><span class="pp-ln"> 620 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('\nglobstar while', file, fr, pattern, pr, swallowee)</span></div><div class="L1"><span class="pp-ln"> 621 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> this.matchOne(file.slice(fr), pattern.slice(pr), partial)</span></div><div class="L2"><span class="pp-ln"> 622 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('globstar found match!', fr, fl, swallowee)</span></div><div class="L3"><span class="pp-ln"> 623 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L4"><span class="pp-ln"> 624 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 625 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> ((((swallowee === '.') || (swallowee === '..'))) || ((! (options.dot) && (swallowee.charAt(0) === '.'))))</span></div><div class="L6"><span class="pp-ln"> 626 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('dot detected!', file, fr, pattern, pr)</span></div><div class="L7"><span class="pp-ln"> 627 </span><span class="pp-pln">                                </span><span class="pp-tag">break</span></div><div class="L8"><span class="pp-ln"> 628 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('globstar swallow a segment, and continue')</span></div><div class="L9"><span class="pp-ln"> 629 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> fr++</span></div><div class="L0"><span class="pp-ln"> 630 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> partial</span></div><div class="L1"><span class="pp-ln"> 631 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('\n&gt;&gt;&gt; no match, partial?', file, fr, pattern, pr)</span></div><div class="L2"><span class="pp-ln"> 632 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> fr === fl</span></div><div class="L3"><span class="pp-ln"> 633 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L4"><span class="pp-ln"> 634 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L5"><span class="pp-ln"> 635 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> hit</span></div><div class="L6"><span class="pp-ln"> 636 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (p) === 'string'</span></div><div class="L7"><span class="pp-ln"> 637 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> options.nocase</span></div><div class="L8"><span class="pp-ln"> 638 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> hit = f.toLowerCase() === p.toLowerCase()</span></div><div class="L9"><span class="pp-ln"> 639 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 640 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> hit = f === p</span></div><div class="L1"><span class="pp-ln"> 641 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('string match', p, f, hit)</span></div><div class="L2"><span class="pp-ln"> 642 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 643 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> hit = f.match(p)</span></div><div class="L4"><span class="pp-ln"> 644 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.debug('pattern match', p, f, hit)</span></div><div class="L5"><span class="pp-ln"> 645 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ! (hit)</span></div><div class="L6"><span class="pp-ln"> 646 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L7"><span class="pp-ln"> 647 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ((fi === fl) && (pi === pl))</span></div><div class="L8"><span class="pp-ln"> 648 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L9"><span class="pp-ln"> 649 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> fi === fl</span></div><div class="L0"><span class="pp-ln"> 650 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> partial</span></div><div class="L1"><span class="pp-ln"> 651 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> pi === pl</span></div><div class="L2"><span class="pp-ln"> 652 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> emptyFileEnd = (((fi === ((fl - 1)))) && (file[fi] === ''))</span></div><div class="L3"><span class="pp-ln"> 653 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> emptyFileEnd</span></div><div class="L4"><span class="pp-ln"> 654 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span></div><div class="L5"><span class="pp-ln"> 655 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Error('wtf?')</span></div><div class="L6"><span class="pp-ln"> 656 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> globUnescape</span></div><div class="L7"><span class="pp-ln"> 657 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> s</span></div><div class="L8"><span class="pp-ln"> 658 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> s.replace(/\\(.)/g, '$1')</span></div><div class="L9"><span class="pp-ln"> 659 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> regExpEscape</span></div><div class="L0"><span class="pp-ln"> 660 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> s</span></div><div class="L1"><span class="pp-ln"> 661 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> s.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, '\\$&')</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d15">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/glob/old.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> pathModule = require('path')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> isWindows = process.platform === 'win32'</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fs = require('fs')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> DEBUG = process.env.NODE_DEBUG && /fs/.test(process.env.NODE_DEBUG)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> rethrow</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> DEBUG</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> backtrace</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Error()</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> callback = debugCallback</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> callback = missingCallback</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> debugCallback</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> backtrace.message = err.message</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> err = backtrace</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> missingCallback(err)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> missingCallback</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> process.throwDeprecation</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">throw</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> ! (process.noDeprecation)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> msg = ('fs: missing callback ' + ((err.stack || err.message)))</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> process.traceDeprecation</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> console.trace(msg)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> console.error(msg)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> maybeCallback</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">iif</span><span class="pp-pln"> typeof (cb) === 'function'</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">then</span><span class="pp-pln"> cb</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> rethrow()</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> normalize = pathModule.normalize</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-pln"> isWindows</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> nextPartRe = /(.*?)(?:[\/\\]+|$)/g</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> nextPartRe = /(.*?)(?:[\/]+|$)/g</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-pln"> isWindows</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> splitRootRe = /^(?:[a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/][^\\\/]+)?[\\\/]*/</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">    </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> splitRootRe = /^[\/]*/</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> exports.realpathSync =</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> realpathSync</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> p</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cache</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> p = pathModule.resolve(p)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> cache && Object.prototype.hasOwnProperty.call(cache, p)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> cache[p]</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> original = p</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> seenLinks</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> knownHard</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> pos</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> current</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> base</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> previous</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> start()</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> start</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> m = splitRootRe.exec(p)</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> pos = m[0].length</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> current = m[0]</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> base = m[0]</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> previous = ''</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> isWindows && ! (knownHard[base])</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> fs.lstatSync(base)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> knownHard[base] = true</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">while</span><span class="pp-pln"> pos &lt; p.length</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> nextPartRe.lastIndex = pos</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> result = nextPartRe.exec(p)</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> previous = current</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> current += result[0]</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> base = (previous + result[1])</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> pos = nextPartRe.lastIndex</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> (knownHard[base] || ((cache && (cache[base] === base))))</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                    </span><span class="pp-tag">continue</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> resolvedLink</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> cache && Object.prototype.hasOwnProperty.call(cache, base)</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> resolvedLink = cache[base]</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> stat = fs.lstatSync(base)</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> ! (stat.isSymbolicLink())</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> knownHard[base] = true</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> cache</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> cache[base] = base</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> linkTarget = null</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> ! (isWindows)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> id = (((stat.dev.toString(32) + ':')) + stat.ino.toString(32))</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> seenLinks.hasOwnProperty(id)</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> linkTarget = seenLinks[id]</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> linkTarget === null</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.statSync(base)</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> linkTarget = fs.readlinkSync(base)</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> resolvedLink = pathModule.resolve(previous, linkTarget)</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> cache</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> cache[base] = resolvedLink</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> ! (isWindows)</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> seenLinks[id] = linkTarget</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> p = pathModule.resolve(resolvedLink, p.slice(pos))</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> start()</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> cache</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> cache[original] = p</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> p</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> exports.realpath =</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> realpath</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> p</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cache</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (cb) !== 'function'</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> cb = maybeCallback(cache)</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> cache = null</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> p = pathModule.resolve(p)</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> cache && Object.prototype.hasOwnProperty.call(cache, p)</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> cb.bind</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> cache[p]</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> original = p</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> seenLinks</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> knownHard</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> pos</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> current</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> base</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> previous</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> start()</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> start</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> m = splitRootRe.exec(p)</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> pos = m[0].length</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> current = m[0]</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> base = m[0]</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> previous = ''</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> isWindows && ! (knownHard[base])</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> fs.lstat</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> base</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span><span class="pp-pln"> cb(err)</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> knownHard[base] = true</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> LOOP()</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick(LOOP)</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> LOOP</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> pos &gt;= p.length</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> cache</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> cache[original] = p</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> cb(null, p)</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> nextPartRe.lastIndex = pos</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> result = nextPartRe.exec(p)</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> previous = current</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> current += result[0]</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> base = (previous + result[1])</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> pos = nextPartRe.lastIndex</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> (knownHard[base] || ((cache && (cache[base] === base))))</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> process.nextTick(LOOP)</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> cache && Object.prototype.hasOwnProperty.call(cache, base)</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> gotResolvedLink</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> cache[base]</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> fs.lstat(base, gotStat)</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> gotStat</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> stat</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> cb(err)</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ! (stat.isSymbolicLink())</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> knownHard[base] = true</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> cache</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> cache[base] = base</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> process.nextTick(LOOP)</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ! (isWindows)</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> id = (((stat.dev.toString(32) + ':')) + stat.ino.toString(32))</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> seenLinks.hasOwnProperty(id)</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> gotTarget</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> seenLinks[id]</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> base</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> fs.stat</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> base</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span><span class="pp-pln"> cb(err)</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.readlink</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> base</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                            </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">                                </span><span class="pp-tag">param</span><span class="pp-pln"> target</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> ! (isWindows)</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">                                    </span><span class="pp-tag">set</span><span class="pp-pln"> seenLinks[id] = target</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> gotTarget(err, target)</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> gotTarget</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> target</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> base</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> cb(err)</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> resolvedLink = pathModule.resolve(previous, target)</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> cache</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> cache[base] = resolvedLink</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> gotResolvedLink(resolvedLink)</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> gotResolvedLink</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> resolvedLink</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> p = pathModule.resolve(resolvedLink, p.slice(pos))</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> start()</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d16">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/glob/once.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> wrappy = require('./wrappy')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = wrappy(once)</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports.strict = wrappy(onceStrict)</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> once.proto =</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> once</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> Object.defineProperty</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> Function.prototype</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'once'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> value</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                            </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span><span class="pp-pln"> once(this)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> configurable true</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> Object.defineProperty</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> Function.prototype</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'onceStrict'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> value</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                            </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span><span class="pp-pln"> onceStrict(this)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> configurable true</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> once</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> fn</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> f</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> f.called</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> f.value</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> f.called = true</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> f.value = fn.apply(this, arguments)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> f.called = false</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> f</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> onceStrict</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> fn</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> f</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> f.called</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">throw</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                        </span><span class="pp-tag">new</span><span class="pp-pln"> Error</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> f.onceError</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> f.called = true</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> f.value = fn.apply(this, arguments)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> name = (fn.name || 'Function wrapped with `once`')</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> f.onceError = (name + " shouldn't be called more than once")</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> f.called = false</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> f</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d17">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/glob/path-is-absolute.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> posix</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> path.charAt(0) === '/'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> win32</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> splitDeviceRe = /^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> result = splitDeviceRe.exec(path)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> device = (result[1] || '')</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> isUnc = Boolean((device && (device.charAt(1) !== ':')))</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> Boolean((result[2] || isUnc))</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = process.platform === 'win32' ? win32 : posix</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports.posix = posix</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports.win32 = win32</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d18">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/glob/wrappy.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = wrappy</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> wrappy</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> fn</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> cb</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> fn && cb</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> wrappy(fn)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">(</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> cb</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(fn) !== 'function'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> TypeError('need wrapper function')</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> Object.keys(fn)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> forEach</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> k</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> wrapper[k] = fn[k]</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> wrapper</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> wrapper</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = fn.apply(this, arguments)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> cb = arguments[(arguments.length - 1)]</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (ret) === 'function' && ret !== cb</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> Object.keys(cb)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> forEach</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> k</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> ret[k] = cb[k]</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d19">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/t/filesystem/copyFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.copyFile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> userId</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> source_projectId</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> source_path_string</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> dest_projectId</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> dest_path_string</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isMounted == false</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Mongodb wizzi repository not mounted. Review your start procedure'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> sourceFsPath</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsBaseFolderPath</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> userId</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> source_projectId</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> source_path_string</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> destFsPath</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsBaseFolderPath</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> userId</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> dest_projectId</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> dest_path_string</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.copyFile.sourceFsPath', sourceFsPath, 'destFsPath', destFsPath</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsDoc.copyFile</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> sourceFsPath</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> destFsPath</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.copyFile.sourceFsPath', sourceFsPath, 'destFsPath', destFsPath, 'result', result</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d20">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/t/filesystem/fsstat.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> FsStat</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> fsitem</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.fsitem = fsitem</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> isDirectory</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.fsitem.kind == 0</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> isFile</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.fsitem.kind == 1</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d21">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/t/filesystem/glob.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.glob</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> userId</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> projectId</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> pattern</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isMounted == false</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Mongodb wizzi repository not mounted. Review your start procedure'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsPattern</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsBaseFolderPath</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> userId</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> projectId</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> pattern</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.glob.fsPattern', fsPattern</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> glob</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsPattern</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> this</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitems </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.glob.fsPattern', fsPattern, 'fsitems', fsitems</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, fsitems)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d22">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/t/filesystem/isFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.isFile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> userId</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> projectId</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isMounted == false</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Mongodb wizzi repository not mounted. Review your start procedure'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsPath</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsBaseFolderPath</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> userId</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> projectId</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.isFile.fsPath', fsPath</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsDoc.isFile</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsPath</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> exists </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.isFile.fsPath', fsPath, 'exists', exists</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, exists)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d23">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/t/filesystem/isFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.isFolder</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> userId</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> projectId</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isMounted == false</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Mongodb wizzi repository not mounted. Review your start procedure'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsPath</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsBaseFolderPath</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> userId</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> projectId</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.isFolder.fsPath', fsPath</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsDoc.isFolder</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsPath</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> exists </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.isFolder.fsPath', fsPath, 'exists', exists</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, exists)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d24">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/t/filesystem/mkdir.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.mkdir</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> userId</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> projectId</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isMounted == false</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Mongodb wizzi repository not mounted. Review your start procedure'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsPath</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsBaseFolderPath</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> userId</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> projectId</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.mkdir.fsPath', fsPath</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsDoc.createFolder</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsPath</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> lastInserted </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.createFolder.fsPath', fsPath, 'lastInserted', lastInserted</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, lastInserted)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d25">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/t/filesystem/readdir.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.readDir</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> userId</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> projectId</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> dirPath</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isMounted == false</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Mongodb wizzi repository not mounted. Review your start procedure'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsPath</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> fsBaseFolderPath</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> userId</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> projectId != null</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> fsPath = path.join(fsPath, projectId)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> dirPath != null</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> fsPath = path.join(fsPath, dirPath)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> fsPath = normalize(fsPath)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.readDir.fsPath', fsPath</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsDoc.getDir</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsPath</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitems </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.readDir.fsPath', fsPath, 'fsitems', fsitems</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, fsitems)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md._readDir</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> dirPath</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isMounted == false</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Mongodb wizzi repository not mounted. Review your start procedure'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsPath</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> dirPath</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.readDir.fsPath', fsPath</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsDoc.getDir</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsPath</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitems </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.readDir.fsPath', fsPath, 'fsitems', fsitems</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, fsitems)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d26">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/t/filesystem/readFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.readFile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> userId</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> projectId</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isMounted == false</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Mongodb wizzi repository not mounted. Review your start procedure'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsPath</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsBaseFolderPath</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> userId</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> projectId</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.readFile.fsPath', fsPath</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsDoc.readFile</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsPath</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.readFile.fsPath', fsPath, 'content', content</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, content)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d27">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/t/filesystem/stat.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.stat</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> userId</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> projectId</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> filePath</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isMounted == false</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Mongodb wizzi repository not mounted. Review your start procedure'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsPath</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsBaseFolderPath</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> userId</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> projectId</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> filePath</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.stat.fsPath', fsPath</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.getItemByPath</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsPath</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.stat.fsPath', fsPath, 'fsitem', fsitem</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem == null</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> er</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                        </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> code 'ENOENT'</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                                </span><span class="pp-tag">new</span><span class="pp-pln"> FsStat</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md._stat</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> filePath</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isMounted == false</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Mongodb wizzi repository not mounted. Review your start procedure'</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsPath</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> filePath</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.stat.fsPath', fsPath</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.getItemByPath</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsPath</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.stat.fsPath', fsPath, 'fsitem', fsitem</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem == null</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> er</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                                        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> code 'ENOENT'</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                                </span><span class="pp-tag">new</span><span class="pp-pln"> FsStat</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d28">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/t/filesystem/writeFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.writeFile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> userId</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> projectId</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isMounted == false</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Mongodb wizzi repository not mounted. Review your start procedure'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsPath</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsBaseFolderPath</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> userId</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> projectId</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.writeFile.fsPath', fsPath</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsDoc.writeFile</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsPath</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.writeFile.fsPath', fsPath, 'result', result</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d29">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/mongodb/filesystem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> MongoClient</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> require('mongodb')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">.</span><span class="pp-pln"> MongoClient</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> FsDb = require('./fs/fsdb')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> Document = require('./fs/document')</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> glob = require('./glob/glob')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> isMounted = false</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> dburi = null</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> mounted_db = null</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> fsBaseFolderPath = null</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> fsdb = null</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> fsDoc = null</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> filesystem/fsstat</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.isMounted</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> isMounted</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.mount</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mongoDbUri</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> baseFolderPath</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> MongoClient.connect</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mongoDbUri</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> db </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> mounted_db = db</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> dburi = mongoDbUri</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> fsBaseFolderPath = baseFolderPath</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> fsdb = new FsDb(db)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> fsDoc = new Document(fsdb)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> isMounted = true</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.mongodb.filesystem mounted. Uri: ' + mongoDbUri</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.unmount</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mounted_db.close()</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> isMounted = false</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> fsdb = null</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> fsDoc = null</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.exists</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> userId</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> projectId</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isMounted == false</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Mongodb wizzi repository not mounted. Review your start procedure'</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsPath</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalize</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsBaseFolderPath</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> userId</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> projectId</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.exists.fsPath', fsPath</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsDoc.exists</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsPath</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> exists </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.filesystem.exists.fsPath', fsPath, 'exists', exists</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, exists)</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d22"> filesystem/isFile</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d23"> filesystem/isFolder</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d26"> filesystem/readFile</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d28"> filesystem/writeFile</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d24"> filesystem/mkdir</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d25"> filesystem/readdir</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d27"> filesystem/stat</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d21"> filesystem/glob</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d19"> filesystem/copyFile</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> normalize</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> path.trim().replace(/\\/g,'/').toLowerCase()</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d30">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/repo/fsapi.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> NOT USED YET</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fs = require("fs-extra")</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> sanitize = require("./sanitize")</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> checkItemName</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> name === sanitize(name, {replacement: '_'})</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> checkPath</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> filepath</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> base_path = getBasePath(filepath)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> fs.existsSync(base_path)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> pathExists</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> filepath</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> fs.existsSync(filepath)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> isFile</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> filepath</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> pathExists(filepath) && fs.lstatSync(filepath).isDirectory() === false</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> isDir</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> filepath</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> (md.pathExists(filepath) && (fs.lstatSync(filepath).isDirectory() === true))</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> getFile</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> filepath</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.readFile</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> filepath</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> "utf8"</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> data</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err, data)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> renameFile</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> filepath</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> newname</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> base_path = getBasePath(filepath)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.rename</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> filepath</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> base_path + "/" + newname</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> data</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err, data)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> saveFile</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> filepath</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.writeFile</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> filepath</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> data</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err, data)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> copyFile</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> dirpath</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> destination</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.copy</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> dirpath</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> destination</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> deleteFile</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> dirpath</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.remove</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> dirpath</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> getDir</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> dirpath</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> basepath</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.readdir</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> dirpath</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> files</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err, null)</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> dirpath.slice(- (1)) !== "/" ? dirpath = (dirpath + "/") : dirpath = dirpath</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                        </span><span class="pp-tag">decl</span><span class="pp-pln"> output</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                        </span><span class="pp-tag">decl</span><span class="pp-pln"> output_dirs</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                            </span><span class="pp-tag">[</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                        </span><span class="pp-tag">decl</span><span class="pp-pln"> output_files</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                            </span><span class="pp-tag">[</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                        </span><span class="pp-tag">decl</span><span class="pp-pln"> current</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                        </span><span class="pp-tag">decl</span><span class="pp-pln"> relpath</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                        </span><span class="pp-tag">decl</span><span class="pp-pln"> link</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> createItem</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> current</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> relpath</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> type</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> link</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> name name</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> dirpath relpath.replace('//', '/')</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> type type</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> size</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.lstatSync(current)</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                                            </span><span class="pp-tag">.</span><span class="pp-pln"> size</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> atime</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.lstatSync(current)</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                                            </span><span class="pp-tag">.</span><span class="pp-pln"> atime</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                                            </span><span class="pp-tag">._</span><span class="pp-pln"> getTime()</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> mtime</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.lstatSync(current)</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                                            </span><span class="pp-tag">.</span><span class="pp-pln"> mtime</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                                            </span><span class="pp-tag">._</span><span class="pp-pln"> getTime()</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> link link</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> files.sort()</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                    </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0, z = (files.length - 1); i &lt;= z; i++</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> current = (dirpath + files[i])</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> current = verify.replaceAll(current, '\\', '/')</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> relpath = current.replace(basepath, "")</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> fs.lstatSync(current).isSymbolicLink() ? link = true : link = false</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> fs.lstatSync(current).isDirectory()</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> output_dirs.push</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> createItem</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> files[i]</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> current</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> relpath</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> "directory"</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> link</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> output_files.push</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> createItem</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> files[i]</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> current</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> relpath</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> "file"</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> link</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> pd = getParentDirs(dirpath, basepath)</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> output =</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> curdirname pd.curdirname</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> curdirpath pd.curdirpath</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> dirs output_dirs</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> files output_files</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> parents pd.parents</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, output)</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> createDir</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> dirpath</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> cmode</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.mkdir</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> dirpath</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> cmode</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> data</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err, data)</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> copyDir</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> dirpath</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> destination</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.copy</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> dirpath</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> destination</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> deleteDir</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> dirpath</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fs.remove</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> dirpath</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> getBasePath</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> path = verify.replaceAll(path, '\\', '/')</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> base_path = path.split("/")</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> base_path.pop()</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> base_path.join("/")</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> getParentDirs</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> basepath</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> path = normalizePath(path)</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> basepath = normalizePath(basepath)</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> relpath = path.replace(basepath, "")</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> relpath = relpath.substr(0, 1) === '/' ? relpath.substr(1) : relpath</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> relpath = relpath.substr(- (1), 1) === '/' ? relpath.substr(0, (relpath.length - 1)) : relpath</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> relpath.length == 0</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> curdirname '/'</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> curdirpath '/'</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parents</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                            </span><span class="pp-tag">[</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> console.log('getParentDirs', relpath)</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> parents = relpath.split("/")</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> curdirname = parents.pop()</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> dp = '/'</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> ret</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> name '..'</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> dirpath '/'</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> parents.forEach</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> dp += item</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> name ('.. ' + item)</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> dirpath dp</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> dp += '/'</span></div><div class="L8"><span class="pp-ln"> 228 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 229 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln"> 230 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> curdirname curdirname</span></div><div class="L1"><span class="pp-ln"> 231 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> curdirpath ('/' + relpath)</span></div><div class="L2"><span class="pp-ln"> 232 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parents ret</span></div><div class="L3"><span class="pp-ln"> 233 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> normalizePath</span></div><div class="L4"><span class="pp-ln"> 234 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln"> 235 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L6"><span class="pp-ln"> 236 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> verify.replaceAll(path, '\\', '/')</span></div><div class="L7"><span class="pp-ln"> 237 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> merge</span></div><div class="L8"><span class="pp-ln"> 238 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln"> 239 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> obj1</span></div><div class="L0"><span class="pp-ln"> 240 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> obj2</span></div><div class="L1"><span class="pp-ln"> 241 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L2"><span class="pp-ln"> 242 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> mobj</span></div><div class="L3"><span class="pp-ln"> 243 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln"> 244 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> attrname</span></div><div class="L5"><span class="pp-ln"> 245 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> attrname in obj1</span></div><div class="L6"><span class="pp-ln"> 246 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> mobj[attrname] = obj1[attrname]</span></div><div class="L7"><span class="pp-ln"> 247 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> attrname in obj2</span></div><div class="L8"><span class="pp-ln"> 248 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> mobj[attrname] = obj2[attrname]</span></div><div class="L9"><span class="pp-ln"> 249 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> mobj</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d31">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/_old/lib/repo/sanitize.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.sanitize</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> NOT USED YET</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> / ? &lt; &gt; \ : * | "</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> illegalRe = /[\/\?&lt;&gt;\\:\*\|":]/g</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> Unicode Control codes</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> C0 0x00-0x1f & C1 (0x80-0x9f)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> http://en.wikipedia.org/wiki/C0_and_C1_control_codes</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> controlRe = /[\x00-\x1f\x80-\x9f]/g</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> Reserved filenames on Unix-based systems (".", "..")</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> reservedRe = /^\.+$/</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> Reserved filenames in Windows ("CON", "PRN", "AUX", "NUL", "COM1",</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> "COM2", "COM3", "COM4", "COM5", "COM6", "COM7", "COM8", "COM9",</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> "LPT1", "LPT2", "LPT3", "LPT4", "LPT5", "LPT6", "LPT7", "LPT8", and</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> "LPT9") case-insesitively and with or without filename extensions.</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> windowsReservedRe = /^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> sanitize</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> input</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> replacement</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">optional</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> input.replace(illegalRe, replacement)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> replace(controlRe, replacement)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> replace(reservedRe, replacement)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                        </span><span class="pp-tag">._</span><span class="pp-pln"> replace(windowsReservedRe, replacement)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> input</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">optional</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> replacement = options && options.replacement || ''</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> output = sanitize(input, replacement)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> replacement === ''</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> output</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> sanitize(output, '')</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d32">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/ittf__copy/mongoDocument/bye_1.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> bye_1</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d33">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/ittf__copy/mongoDocument/bye_2.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> bye_2</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d34">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/ittf__copy/mongoDocument/bye_3.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> bye_3</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d35">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/t/base_example.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> EXAMPLE: </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> myname = '</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> stringify = require('json-stringify-safe')</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> vfile = require('wizzi-utils').vfile</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> defaults to filesystem</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsfile = vfile()</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-kwd">$hook</span><span class="pp-pln"> imports</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-kwd">$hook</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> heading1</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> ''</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '********************************************************************************'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '** Example </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln"> - ' + text</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '********************************************************************************'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> ''</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> heading2</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> ''</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '--------------------------------------------------------------------------------'</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '-- Example </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln"> - ' + text</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '--------------------------------------------------------------------------------'</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> ''</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> printArray</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> arr</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> fields</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '* array ' + name + ' : '</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in arr</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '  {', i</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> keys = fields || Object.keys(item)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> k in keys</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> k</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item[k]</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> printValue</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> k</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> v</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(v)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> lines</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> verify.splitLines</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> v</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> numbered true</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> lines.length === 1</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', k, ':', lines[0].text</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">for</span><span class="pp-pln"> var i=0; i&lt;lines.length; i++</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> i === 0</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', k, ':', lines[0].numFmt, lines[0].text</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', spaces(k.length+1), ' ', lines[i].numFmt, lines[i].text</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', k, ':', v</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> spaces</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> len</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> new Array(len).join(' ')</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d36">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/t/document_operations.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">@</span><span class="pp-pln"> file_1_path</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('clear')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.file_1'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_1_path</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'deleted.file_1'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> _clear2</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> _clear2</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _clear2</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('clear2')</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.file_2'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'deleted.file_2'</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> _clear3</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> _clear3</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _clear3</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('clear3')</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> file_3_path</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.file_3'</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> file_3_path</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'deleted.file_3'</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> _clear4</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> _clear4</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _clear4</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('clear4')</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> file_4_path</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.file_4'</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> file_4_path</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'deleted.file_4'</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> _clear5</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> _clear5</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _clear5</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('clear5')</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> file_5_path</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.file_5'</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> file_5_path</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'deleted.file_5'</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> _clear6</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> _clear6</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _clear6</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('clear6')</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> file_6_path</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.file_6'</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> file_6_path</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'deleted.file_6'</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> _writeFile</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> _writeFile</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _writeFile</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('_writeFile')</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.writeFile</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> file_1_path</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Hello wizzi factory\n\t from folder1/hello.js.ittf'</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('writeFile')</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'result'</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> _createWriteStream</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _createWriteStream</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('_createWriteStream')</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> stream</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.createWriteStream</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_7_path</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'stream'</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> stream</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> stream.write('Hello createWriteStream\n')</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> stream.write('Welcome\n')</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> stream.end</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'result'</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> _readFile</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _readFile</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('_readFile')</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.readFile</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> file_1_path</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('readFile')</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'content'</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.readFile</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_7_path</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'content'</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> _uploadFolder</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _uploadFolder</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('uploadFolder')</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.uploadFolder</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'ittf'</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'mongoDocument'</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folder_3_path</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'result'</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> _renameFile</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _renameFile</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('_renameFile')</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('renameFile')</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.before.rename'</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.renameFile</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_1_path</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'rename.result'</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.after.rename'</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> _copyFile</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _copyFile</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> file_3_path</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('copyFile')</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.before.copy'</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.copyFile</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_3_path</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'copy.result'</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> file_3_path</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.after.copy'</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> _copyFolder</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _copyFolder</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('copyFolder')</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.copyFolder</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folder_1_path</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folder_2_path</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printArray</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'copied'</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'newid'</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> _getDir</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _getDir</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.copyFile</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> file_4_path</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('getDir')</span></div><div class="L8"><span class="pp-ln"> 228 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L9"><span class="pp-ln"> 229 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'copied.file_4_path'</span></div><div class="L0"><span class="pp-ln"> 230 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L1"><span class="pp-ln"> 231 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.getDir</span></div><div class="L2"><span class="pp-ln"> 232 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> folder_1_path</span></div><div class="L3"><span class="pp-ln"> 233 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 234 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printArray</span></div><div class="L5"><span class="pp-ln"> 235 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'dir'</span></div><div class="L6"><span class="pp-ln"> 236 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L7"><span class="pp-ln"> 237 </span><span class="pp-pln">                            </span><span class="pp-tag">[</span></div><div class="L8"><span class="pp-ln"> 238 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> '_id'</span></div><div class="L9"><span class="pp-ln"> 239 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'path'</span></div><div class="L0"><span class="pp-ln"> 240 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'kind'</span></div><div class="L1"><span class="pp-ln"> 241 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.close</span></div><div class="L2"><span class="pp-ln"> 242 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> terminate</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d37">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/t/folder_data.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> baseFolder = 'c:/wz/users/docexample'</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> folder_1_path</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> baseFolder</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'folder1'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> folder_1_sub_1_path</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> baseFolder</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'folder1'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'sub1'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> folder_2_path</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> baseFolder</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'folder2'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> folder_3_path</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> baseFolder</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'folder3'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_1_path</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folder_1_path</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello.js.ittf'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_2_path</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folder_1_path</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello2.js.ittf'</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_3_path</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folder_1_path</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello3.js.ittf'</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_4_path</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folder_1_sub_1_path</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello_sub1.js.ittf'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_5_path</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folder_2_path</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello2.js.ittf'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_6_path</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folder_2_path</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello3.js.ittf'</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_7_path</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folder_2_path</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello4.js.ittf'</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d38">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/t/mongo_connect.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> FSITEMS = 'fsitems'</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> DOCUMENTS = 'documents'</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsdb, doc</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> mongoConnect</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> MongoClient.connect</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'mongodb://localhost:27017/test'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> db </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> fsdb = new FsDb(db)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> doc = new Document(fsdb)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> db.collection(FSITEMS).drop</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> 'FSITEMS.drop result', result</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> db.collection(DOCUMENTS).drop</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                                </span><span class="pp-tag">log</span><span class="pp-pln"> 'DOCUMENTS.drop result', result</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                        </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> fsdb fsdb</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> doc doc</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d39">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/jsonComponents.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d35">base_example(</span><span class="pp-arg"> wizzi-repo.examples.jsonComponents </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> json = require('../lib/json/index')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> heading1('start')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> documents = []</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> documents.push</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> path 'c:/root/folder1/index.html.ittf'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'html'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    body'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '        ul'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '            lia( stefi )'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '            lia_img( annie, photo.jpg )'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> join('\n')</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> documents.push</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> path 'c:/root/folder1/t/lia.html.ittf'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'li'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    a'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '        href'</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> join('\n')</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> documents.push</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> path 'c:/root/folder1/t/lia_img.html.ittf'</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'li'</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    a'</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '        href'</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '        img'</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> join('\n')</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> json.createJsonFsData</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">@</span><span class="pp-pln"> documents</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d133">f_cb_throw(</span><span class="pp-arg"> jsonFsData</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsonFsData</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> addDocuments</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsonFsData</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> addDocuments</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> jsonFsData</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('addDocuments')</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> documents = []</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> documents.push</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path 'c:/root/folder2/index.html.ittf'</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'module'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> '    kind react'</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                        </span><span class="pp-tag">._</span><span class="pp-pln"> join('\n')</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> json.addToJsonFsData</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> jsonFsData</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> documents</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d133">f_cb_throw(</span><span class="pp-arg"> jsonFsData</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> jsonFsData</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> extractDocuments</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> jsonFsData</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> extractDocuments</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> jsonFsData</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('extractDocuments')</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> doc</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> json.createDocumentManager</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsonFsData</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.getFiles</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'c:/'</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> deep true</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> documentContent true</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d133">f_cb_throw(</span><span class="pp-arg"> files </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> files</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d40">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/jsonDocument.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d35">base_example(</span><span class="pp-arg"> wizzi-repo.examples.jsonDocument </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> json = require('../lib/json/index')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> heading1('start')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsJson = new json.FsJson()</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> doc = new json.Document(fsJson)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d37"> folder_data</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d36"> document_operations</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> terminate</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> dump</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> dump</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'fsJson.items'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> fsJson.items</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'fsJson.documents'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> fsJson.documents</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d41">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/jsonFsImpl.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d35">base_example(</span><span class="pp-arg"> wizzi-repo.examples.jsonFsImpl </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> JsonFsImpl = require('../lib/json/index')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> heading1('start')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> jsonDirectoryTree</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> JsonFsImpl.directoryTree</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'C:/My/wizzi/v5/kernel/wizzi-repo/src/ittf/examples'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">@</span><span class="pp-pln"> 'json DirectoryTree'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">@</span><span class="pp-pln"> jsonDirectoryTree</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d42">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/jsonFsJson.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d35">base_example(</span><span class="pp-arg"> wizzi-repo.examples.jsonFsJson </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> json = require('../lib/json/index')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> heading1('start')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsJson = new json.FsJson()</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> dump</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> fsJson.insertItem</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> basename 'alpha.js.ittf'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> dirname 'w:/zero'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> kind 1</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'insert.alpha.js.ittf.result', result</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> insertedId = result.insertedId</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> dump</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> result.item.basename = 'beta.js.ittf'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsJson.updateItem</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> result.item</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'update.beta.js.ittf.result', result</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> dump</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> fsJson.writeDocument</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> result.item._id</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'My content'</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> 'write.beta.js.ittf.result', result</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> dump</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> fsJson.readDocument</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> result.item._id</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'read.beta.js.ittf.result', result</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> fsJson.deleteItem</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> insertedId</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                                            </span><span class="pp-tag">log</span><span class="pp-pln"> 'delete.beta.js.ittf.result', result</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> dump</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> dump</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'fsJson.items'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> fsJson.items</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'fsJson.documents'</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> fsJson.documents</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d43">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/mongoDocument.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d35">base_example(</span><span class="pp-arg"> wizzi-repo.examples.mongoDocument </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> Document = require('../lib/mongodb/fs/document')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d37"> folder_data</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> heading1('start')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> Document.create</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> doc </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_1_path</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('clear')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.file_1'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> file_1_path</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'deleted.file_1'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> _clear2</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> _clear2</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _clear2</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.file_2'</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'deleted.file_2'</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> _clear3</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> _clear3</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _clear3</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_3_path</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.file_3'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> file_3_path</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'deleted.file_3'</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> _clear4</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> _clear4</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _clear4</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_4_path</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.file_4'</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> file_4_path</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'deleted.file_4'</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> _clear5</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> _clear5</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _clear5</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_5_path</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.file_5'</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> file_5_path</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'deleted.file_5'</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> _clear6</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> _clear6</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _clear6</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_6_path</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.file_6'</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> file_6_path</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'deleted.file_6'</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> _writeFile</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> _writeFile</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _writeFile</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.writeFile</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_1_path</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Hello wizzi factory\n\t from folder1/hello.js.ittf'</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('writeFile')</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'result'</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> _createWriteStream</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _createWriteStream</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.createWriteStream</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_7_path</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> stream </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('createWriteStream')</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'stream'</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> stream</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> stream.write('Hello createWriteStream\n')</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> stream.write('Welcome\n')</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> stream.end</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'result'</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> _readFile</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _readFile</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.readFile</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_1_path</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('readFile')</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'content'</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.readFile</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> file_7_path</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'content'</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> _uploadFolder</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _uploadFolder</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('uploadFolder')</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.uploadFolder</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'ittf'</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'mongoDocument'</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> folder_3_path</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'result'</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> _renameFile</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _renameFile</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('renameFile')</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.before.rename'</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.renameFile</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> file_1_path</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'rename.result'</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.after.rename'</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> _copyFile</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _copyFile</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_3_path</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('copyFile')</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.before.copy'</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.copyFile</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> file_3_path</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'copy.result'</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_3_path</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFile.after.copy'</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> _copyFolder</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _copyFolder</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('copyFolder')</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.copyFolder</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> folder_1_path</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> folder_2_path</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printArray</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'copied'</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">                            </span><span class="pp-tag">[</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'newid'</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> _getDir</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _getDir</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.copyFile</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_2_path</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> file_4_path</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('getDir')</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'copied.file_4_path'</span></div><div class="L8"><span class="pp-ln"> 228 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln"> 229 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> doc.getDir</span></div><div class="L0"><span class="pp-ln"> 230 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> folder_1_path</span></div><div class="L1"><span class="pp-ln"> 231 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 232 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> printArray</span></div><div class="L3"><span class="pp-ln"> 233 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'dir'</span></div><div class="L4"><span class="pp-ln"> 234 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L5"><span class="pp-ln"> 235 </span><span class="pp-pln">                                    </span><span class="pp-tag">[</span></div><div class="L6"><span class="pp-ln"> 236 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> '_id'</span></div><div class="L7"><span class="pp-ln"> 237 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'path'</span></div><div class="L8"><span class="pp-ln"> 238 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'kind'</span></div><div class="L9"><span class="pp-ln"> 239 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> doc.close</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d44">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/mongoFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d35">base_example(</span><span class="pp-arg"> wizzi-repo.examples.mongoFile </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MongoFsImpl = require('../lib/mongodb/mongoFsimpl')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsimpl</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> MongoFsImpl</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'c:/wz/users'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> heading1('start')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.open</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> file = vfile(fsimpl)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'db://stefi/wf/folder1/hello.js.ittf'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Hello wizzi factory from mongoFile'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('write')</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'result'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> _openWrite</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _openWrite</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('openWrite')</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> file.openWrite</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'db://stefi/wf/folder1/helloOpenWrite.js.ittf'</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> stream </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('openWrite')</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'stream'</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> stream</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> stream.write('Hello openWrite\n')</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> stream.write('Welcome\n')</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> stream.end</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'result'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> _read</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _read</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> file.read</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'db://stefi/wf/folder1/hello.js.ittf'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('read')</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'content'</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> _getFiles</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _getFiles</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> file.getFiles</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'db://stefi/wf'</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> deep true</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> documentContent true</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> files </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'files', files</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('getFiles')</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printArray</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'files'</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> files</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                            </span><span class="pp-tag">[</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'fullPath'</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'content'</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> _getFolders</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _getFolders</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> file.getFolders</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'db://stefi/wf'</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> deep true</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> folders </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'folders', folders</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('getFolders')</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printArray</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'folders'</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> folders</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                            </span><span class="pp-tag">[</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'fullPath'</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.close</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d45">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/mongoFsDb.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d35">base_example(</span><span class="pp-arg"> wizzi-repo.examples.mongoFsDb </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> FsDb = require('../lib/mongodb/fs/fsdb')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> baseFolder = 'c:/wz/users/docexample'</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_1_path</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> baseFolder</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'folder1'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello.js.ittf'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> heading1('start')</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> FsDb.create</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> fsdb </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.insertItem</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parentId null</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> basename 'f'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> dirname null</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> kind 0</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('insertItem')</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'result'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> _updateItem(result.item)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _updateItem</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> _deleteItem(item)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _deleteItem</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.deleteItem</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item._id</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('deleteItem')</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'result'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> _getAll</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _getAll</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.getItem</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> items </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('getAll / getItem(null)')</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printArray</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'items'</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> items</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                            </span><span class="pp-tag">[</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'path'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'kind'</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.close</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d46">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/examples/mongoFsImpl.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d35">base_example(</span><span class="pp-arg"> wizzi-repo.examples.mongoFsImpl </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MongoFsImpl = require('../lib/mongodb/mongoFsimpl')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsimpl</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> MongoFsImpl</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'c:/wz/users'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> heading1('start')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.open</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.writeFile</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'db://stefi/wf/folder1/hello.js.ittf'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Hello wizzi factory'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('writeFile')</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'result'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> _readFile</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> _readFile</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.readFile</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'db://stefi/wf/folder1/hello.js.ittf'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> heading2('readFile')</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'content'</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.close</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d47">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/fs/t/fsjson/deleteItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> deleteItem</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> id</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getItemById</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> id</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem == null</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> JsonRepoError</span><span class="pp-pln">,</span><span class="pp-arg">  deleteItem </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'FsJson item not found: ' + id</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> that._deleteDocument</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> id</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> that.items.deleteOne</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                                </span><span class="pp-tag">log</span><span class="pp-pln"> '*** wizzi-repo.json.FsJson.deleteItem,r', r</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> r.deletedCount == 1 && r.result.ok == 1</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                                        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> code 'FSITEM_DELETED'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> deletedCount r.deletedCount</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> ok r.ok</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> JsonRepoError</span><span class="pp-pln">,</span><span class="pp-arg">  deleteItem </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'FsJson error deleting item. Result: ' + util.inspect( r )</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> _deleteDocument</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> id</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.documents.deleteOne</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> '*** wizzi-repo.json.FsJson._deleteDocument.r', r</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> r.deletedCount == 1 && r.result.ok == 1</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson._deleteDocument', true</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> true</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson._deleteDocument', false</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> false</span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d48">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/fs/t/fsjson/getItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getItem</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> key</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">optional</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> key == null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.items.find</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> toArray</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.items.find</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> key</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> toArray</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.getItem.r', key, r</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> r.length == 1</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> r[0] </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> null </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getItemById</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> id</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getItem</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getItemByPath</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> path</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getItem</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path path</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getItemByNameAndParent</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> basename</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> parentId</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">optional</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getItem</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> basename basename</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parentId parentId</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getItemChildren</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> parentId</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.getItemChildren.enter', parentId</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.items.find</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parentId parentId</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> toArray</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.getItemChildren.r', parentId, r</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d49">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/fs/t/fsjson/insertItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> insertItem</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> fsItem</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> basename</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">number</span><span class="pp-pln"> kind</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.insertItem. fsItem:', fsItem</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> basename = fsItem.basename</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> dirname = fsItem.dirname</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> parentId = fsItem.parentId</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> fsItem.path = dirname ? normalize(path.join(dirname, basename)) : basename</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">const</span><span class="pp-pln"> that = this</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getItemByNameAndParent</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> basename</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> parentId</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> item </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> item == null</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.insertItem. Item does not exists. So insertOne'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.items.insertOne</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsItem</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.insertItem.insertOne', r</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> assert.equal(1, r.insertedCount)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> assert.equal(1, r.ops.length)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> code 'FSITEM_INSERTED'</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> insertedId r.insertedId</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> insertedCount r.insertedCount</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> item r.ops[0]</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.insertItem. Item exists. So return it'</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> code 'FSITEM_EXISTS'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> item item</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d50">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/fs/t/fsjson/read.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> readDocument</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> id</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.documents.find</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> toArray</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.read.r', id, r</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> r.length == 1</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> r[0].content </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> null </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d51">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/fs/t/fsjson/updateItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> updateItem</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> fsitem</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> _id</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> upd_item</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> Object.assign</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> upd_item.path = fsitem.dirname ? normalize(path.join(fsitem.dirname, fsitem.basename)) : fsitem.basename</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.items.replaceOne</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> _id upd_item._id</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> upd_item</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r_upd </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.updateItem', r_upd.result</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> r_upd.modifiedCount == 1</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> code 'FSITEM_UPDATED'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> updatedCount r_upd.modifiedCount</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> item r_upd.ops[0]</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> JsonRepoError</span><span class="pp-pln">,</span><span class="pp-arg">  updateItem </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> util.inspect( r_upd.result )</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> updateItemLastModified</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> id</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> lastModified</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getItemById</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> id</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> r != null</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> r.lastModified = lastModified</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.items.replaceOne</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> r</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r_upd </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.updateItemLastModified', r_upd.result</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> r_upd.modifiedCount == 1</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> code 'FSITEM_LASTMODIFIED_UPDATED'</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> updatedCount r_upd.modifiedCount</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> item r_upd.ops[0]</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> JsonRepoError</span><span class="pp-pln">,</span><span class="pp-arg">  updateItemLastModified </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> util.inspect( r_upd.result )</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> JsonRepoError</span><span class="pp-pln">,</span><span class="pp-arg">  updateItemLastModified </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'FsJson item not found, id: ' + id</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d52">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/fs/t/fsjson/write.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> writeDocument</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> id</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> content</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">optional</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.readDocument</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> id</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.writeDocument.readDocument.f', id, f, content === f</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> f === content</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.writeDocument not modified', f</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> code 'DOCUMENT_NOT_MODIFIED'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.writeDocument.readDocument.upsert', id, content</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> lastModified = new Date()</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> that.documents.replaceOne</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> content content</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> lastModified lastModified</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> upsert true</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.writeDocument', r</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> modified = r.modifiedCount + r.upsertedCount</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> assert.equal(1, modified)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> that.updateItemLastModified</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> id</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> lastModified</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> rUpd </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.FsJson.writeDocument upd', rUpd</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> code 'DOCUMENT_WRITTEN'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> item r.ops[0]</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d53">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/fs/document.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.fs.json.Document</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> assert</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> async</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> vfile = require('wizzi-utils').vfile</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../../errors')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> FsStream = require('../../utils/fsstream')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = vfile()</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> Promise = require('promise')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> JSZip = require('jszip')</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> FsDb = null</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> Document</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> fsdb</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> assert( true, fsdb.classType === 'wizzi-repo.json.FsJson' );</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> assert( true, !!fsdb.items && fsdb.items.classType === 'wizzi-repo.utils.Collection');</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> assert( true, !!fsdb.documents && fsdb.documents.classType === 'wizzi-repo.utils.Collection');</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.classType = 'wizzi-repo.json.Document'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.fsdb = fsdb</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d100">fscommon/document/upload(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">fscommon/document/createFolder(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d93">fscommon/document/getFolder(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d91">fscommon/document/getDir(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d92">fscommon/document/getFiles(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d90">fscommon/document/getContent(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">fscommon/document/exists(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d95">fscommon/document/isFolder(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d94">fscommon/document/isFile(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d82">fscommon/document/copyFile(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d83">fscommon/document/copyFolder(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d86">fscommon/document/deleteFile(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d87">fscommon/document/deleteFolder(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d97">fscommon/document/renameFile(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d98">fscommon/document/renameFolder(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d100">fscommon/document/upload(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">fscommon/document/download(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d101">fscommon/document/writeFile(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d85">fscommon/document/createWriteStream(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d96">fscommon/document/readFile(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d99">fscommon/document/stat(</span><span class="pp-arg"> fs.json</span><span class="pp-pln">,</span><span class="pp-arg">  JsonFS </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> toJson</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.toJson</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> close</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.fsdb</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.close</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.fsdb = null</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Creates a Document instance</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> Document.create</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> jsonFsData</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isUndefined(callback) && verify.isFunction(jsonFsData)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = jsonFsData</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> jsonFsData = null</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> FsDb == null</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> FsDb = require('./fsjson')</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> Document</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                        </span><span class="pp-tag">new</span><span class="pp-pln"> FsDb(jsonFsData)</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> error</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> method</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> message</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> method 'Json.Fs.Document.' + method</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> message message</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> normalize</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> stripEndingSlash</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> stripEndingSlash</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = path.trim().replace(/\\/g,'/').toLowerCase()</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret.substr(-1) === '/' ? ret.substr(0, ret.length-1) : ret</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> path.trim().replace(/\\/g,'/').toLowerCase()</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> denormalize</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> path.trim().replace(/\//g,'\\').toLowerCase()</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = Document</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d54">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/fs/fsjson.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.json.FsJson</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> assert</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> Collection = require('../../utils/collection')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> class FsJson (Filesystem Json)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Filesystem item</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { fsitem</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> ObjectId _id</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string basename</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> ObjectId parentId</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string dirname</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string path</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> integer kind</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> one-of 0 (directory), 1 (file)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Document</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { document</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> ObjectId _id</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string content</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> ISODate lastModified</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> FsJson</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> db</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.classType = 'wizzi-repo.json.FsJson'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isObject(db)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isArray(db.items) === false</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">throw</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">new</span><span class="pp-pln"> Error</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidArgument'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'ctor'</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'db.items'</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> message 'The db.items parameter must be an array. Received: ' + db.items</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isArray(db.documents) === false</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">throw</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                        </span><span class="pp-tag">new</span><span class="pp-pln"> Error</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidArgument'</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'ctor'</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'db.documents'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> message 'The db.documents parameter must be an array. Received: ' + db.documents</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.items = new Collection(db.items)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.documents = new Collection(db.documents)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.items = new Collection([])</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.documents = new Collection([])</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d48"> fsjson/getItem</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d49"> fsjson/insertItem</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d51"> fsjson/updateItem</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d47"> fsjson/deleteItem</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d50"> fsjson/read</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d52"> fsjson/write</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> toJson</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> that.items.toArray</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> items </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.documents.toArray</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> documents </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> items items</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> documents documents</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> close</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> nothing to do</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Creates a FsJson instance</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> FsJson.create</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> jsonData</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isUndefined(callback) && verify.isFunction(mongoUri)</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = jsonData</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> jsonData = null</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> jsonData == null</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> jsonData</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> items []</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> documents []</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isObject(jsonData) == false</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> error('create', 'parameter jsondata must be an object')</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isArray(jsonData.items) == false</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> error('create', 'parameter jsondata must contain an item property')</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isArray(jsonData.documents) == false</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> error('create', 'parameter jsondata must contain a documents property')</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> FsJson(jsonData)</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> error</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> method</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> message</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> method 'Json.JsonDb.' + method</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> message message</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> normalize</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> path.trim().replace(/\\/g,'/').toLowerCase()</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = FsJson</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d55">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/t/jsonFsimpl/m.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, arg1|@@null, arg2|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> documentUri</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg1 != null</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg1</span><span class="pp-kwd">}</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg2 != null</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg2</span><span class="pp-kwd">}</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.jsonFsImpl.</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">.documentUri', documentUri</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg1 === 'options' || arg2 === 'options'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(callback) === 'undefined' && verify.isFunction(options)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = options</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options = {}</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isFunction(callback) === false</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Error</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidArgument'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'The callback parameter must be a function. Received: ' + callback</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(documentUri) === false</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidArgument'</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'documentUri'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'The documentUri parameter must be a string. Received: ' + documentUri</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d128">checked_call(</span><span class="pp-arg"> parsedUri </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsonUriParser</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> documentUri</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> this.jsondbBaseFolder</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.db</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> jsonDb </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d56">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/directoryTree.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> es6</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> forked from https://raw.githubusercontent.com/mihneadb/node-directory-tree/master/lib/directory-tree.js</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">const</span><span class="pp-pln"> FS = require('fs')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">const</span><span class="pp-pln"> PATH = require('path')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">const</span><span class="pp-pln"> constants</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> DIRECTORY 1</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> FILE 2</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> safeReadDirSync</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">let</span><span class="pp-pln"> dirData = {}</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">try</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> dirData = FS.readdirSync(path)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ex.code == "EACCES"</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> User does not have permissions, ignore directory</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> ex</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> dirData</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> normalizePath</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> path.replace(/\\/g, '/')</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> isRegExp</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> regExp</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> typeof regExp === "object" && regExp.constructor == RegExp</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> directoryTree</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">const</span><span class="pp-pln"> name = PATH.basename(path);</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> path = normalizePath(path)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">const</span><span class="pp-pln"> item</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> name</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">let</span><span class="pp-pln"> stats</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">try</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> stats = FS.statSync(path)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">catch</span><span class="pp-pln"> e</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'stats', stats</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> stats.isFile()</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">const</span><span class="pp-pln"> ext = PATH.extname(path).toLowerCase();</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> Skip if it does not match the extension regex</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'ext', ext</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ext != '.ittf'</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> File size in bytes</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> set item.size = stats.size</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> set item.extension = ext</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> item.type = constants.FILE</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> stats.isDirectory()</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">let</span><span class="pp-pln"> dirData = safeReadDirSync(path)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> dirData === null</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> item.children = []</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> item.type = constants.DIRECTORY</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> child in dirData</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> item.children.push</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> directoryTree</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> PATH.join</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> path</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> child</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> item</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = directoryTree</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d57">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/index.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> es6</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> async = require('async')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = {}</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = md</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> Collection = require('../utils/collection')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.directoryTree = require('./directoryTree')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.FsJson = require('./fs/fsjson')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.Document = require('./fs/document')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.createDocumentManager</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> fsJsonData</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> fsJsonData = fsJsonData || {}</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> fsJsonData.items = fsJsonData.items || []</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> fsJsonData.documents = fsJsonData.documents || []</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsJson = new md.FsJson(fsJsonData)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> new md.Document(fsJson)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.createJsonFsData</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> documents</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">const</span><span class="pp-pln"> doc = this.createDocumentManager()</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> async.map</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> documents</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">=></span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> document</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.writeFile</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> document.path</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> document.content</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.toJson</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.addToJsonFsData</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> fsJsonData</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> documents</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">const</span><span class="pp-pln"> doc = this.createDocumentManager(fsJsonData)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> async.map</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> documents</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">=></span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> document</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.writeFile</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> document.path</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> document.content</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.toJson</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d58">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/jsonFsimpl.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.json.jsonFsImpl</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Implements the `fsimpl` interface for a json backed file system.</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> FsDb = require('./fs/fsjson')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> Document = require('./fs/document')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> jsonUriParser = require('./jsonUriParser')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> JsonFsImpl</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> jsonFsData</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.jsonFsData = jsonFsData</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.fsjson = null</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.jsonDb = null</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> db</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.jsonDb == null</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidOperation</span><span class="pp-pln">,</span><span class="pp-arg">  db </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Connection not opened. The method `open` must be called before calling `db`.'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> this.jsonDb</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> open</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.jsonDb</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> this.jsonDb</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.fsjson = new FsDb(this.jsonFsData)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> that.jsonDb = new Document(this.fsjson)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log '***** json connected'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> that.jsonDb</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> close</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.jsonDb</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log '***** json start closing'</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.jsonDb = null</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log '***** json closed'</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d55">jsonFsimpl/m(</span><span class="pp-arg"> stat </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsonDb.stat</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d55">jsonFsimpl/m(</span><span class="pp-arg"> lstat </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsonDb.stat</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d55">jsonFsimpl/m(</span><span class="pp-arg"> readFile</span><span class="pp-pln">,</span><span class="pp-arg">  options </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsonDb.readFile</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d55">jsonFsimpl/m(</span><span class="pp-arg"> writeFile</span><span class="pp-pln">,</span><span class="pp-arg">  content</span><span class="pp-pln">,</span><span class="pp-arg">  options </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsonDb.writeFile</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d55">jsonFsimpl/m(</span><span class="pp-arg"> readdir</span><span class="pp-pln">,</span><span class="pp-arg">  options </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsonDb.getDir</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> dir = []</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                    </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in result</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.json.jsonFsImpl.readdir.parsedUri.internalPath, item', parsedUri.internalPath, item</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> dir.push(item.basename)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, dir)</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d55">jsonFsimpl/m(</span><span class="pp-arg"> mkdir</span><span class="pp-pln">,</span><span class="pp-arg">  options </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsonDb.createFolder</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d55">jsonFsimpl/m(</span><span class="pp-arg"> unlink </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsonDb.deleteFile</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> createWriteStream</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> documentUri</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d127">checked_call_return(</span><span class="pp-arg"> parsedUri </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> jsonUriParser</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> documentUri</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> this.jsonBaseFolder</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.jsonDb.createWriteStream</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> toJson</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsjson.toJson</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> json </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, json)</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = JsonFsImpl</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d59">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/json/jsonUriParser.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.json.jsonUriParser</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> parse</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> uri</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> internalPath uri</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d60">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/mongodb/fs/t/fsdb/deleteItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> deleteItem</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> id</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getItemById</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> id</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem == null</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> MongoRepoError</span><span class="pp-pln">,</span><span class="pp-arg">  deleteItem </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'FsDb item not found: ' + id</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> that._deleteDocument</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> id</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> that.db.collection(FSITEMS).deleteOne</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                                </span><span class="pp-tag">delete</span><span class="pp-pln"> r.connection</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                                </span><span class="pp-tag">delete</span><span class="pp-pln"> r.message</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.FsDb.deleteItem,r', r</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> r.deletedCount == 1 && r.result.ok == 1</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                                        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> code 'FSITEM_DELETED'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> deletedCount r.deletedCount</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> MongoRepoError</span><span class="pp-pln">,</span><span class="pp-arg">  deleteItem </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'FsDb error deleting item. Result: ' + util.inspect( r.result )</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> _deleteDocument</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> id</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.db.collection(DOCUMENTS).deleteOne</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">delete</span><span class="pp-pln"> r.connection</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">delete</span><span class="pp-pln"> r.message</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.FsDb._deleteDocument.r', r</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> r.deletedCount == 1 && r.result.ok == 1</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.mongodb.FsDb._deleteDocument', true</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> true</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.mongodb.FsDb._deleteDocument', false</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> false</span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d61">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/mongodb/fs/t/fsdb/getItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getItem</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> key</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">optional</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> key == null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.db.collection(FSITEMS).find</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> toArray</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.db.collection(FSITEMS).find</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> key</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> toArray</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.mongodb.FsDb.getItem.r', key, r</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> r.length == 1</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> r[0] </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> null </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getItemById</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> id</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getItem</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getItemByPath</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> path</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getItem</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path path</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getItemByNameAndParent</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> basename</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> parentId</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">optional</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getItem</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> basename basename</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parentId parentId</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getItemChildren</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> parentId</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.db.collection(FSITEMS)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> find</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parentId parentId</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> toArray</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.mongodb.FsDb.getItemChildren.r', parentId, r</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d62">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/mongodb/fs/t/fsdb/insertItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> insertItem</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> fsItem</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> basename</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">number</span><span class="pp-pln"> kind</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.mongodb.FsDb.FsDb.insertItem.fsItem', fsItem</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> basename = fsItem.basename</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> dirname = fsItem.dirname</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> parentId = fsItem.parentId</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> fsItem.path = dirname ? normalize(path.join(dirname, basename)) : basename</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">const</span><span class="pp-pln"> that = this</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getItemByNameAndParent</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> basename</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> parentId</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> item </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> item == null</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.db.collection(FSITEMS).insertOne</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsItem</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                            </span><span class="pp-tag">delete</span><span class="pp-pln"> r.connection</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                            </span><span class="pp-tag">delete</span><span class="pp-pln"> r.message</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.FsDb.insertItem.insertOne.r', r</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> assert.equal(1, r.insertedCount)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> assert.equal(1, r.ops.length)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> code 'FSITEM_INSERTED'</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> insertedId r.insertedId</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> insertedCount r.insertedCount</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> item r.ops[0]</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> code 'FSITEM_EXISTS'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> item item</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d63">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/mongodb/fs/t/fsdb/read.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> readDocument</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> id</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.db.collection(DOCUMENTS).find</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> toArray</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.mongodb.FsDb.read.r', id, r</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> r.length == 1</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> r[0].content </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> MongoRepoError</span><span class="pp-pln">,</span><span class="pp-arg">  readDocument </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document not found, id: ' + id</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d64">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/mongodb/fs/t/fsdb/updateItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> updateItem</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> fsitem</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> basename</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">number</span><span class="pp-pln"> kind</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.db.collection(FSITEMS).replaceOne</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> _id fsitem._id</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r_upd </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">delete</span><span class="pp-pln"> r_upd.connection</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">delete</span><span class="pp-pln"> r_upd.message</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.FsDb.updateItem', r_upd</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> r_upd.result.nModified == 1</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> code 'FSITEM_UPDATED'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> updatedCount r_upd.result.nModified</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> item r_upd.ops[0]</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> MongoRepoError</span><span class="pp-pln">,</span><span class="pp-arg">  updateItem </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> util.inspect( r_upd.result )</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> updateItemLastModified</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> id</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> lastModified</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getItemById</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> id</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.FsDb.updateItemLastModified, getItemById', id, r</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> r != null</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> r.lastModified = lastModified</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.db.collection(FSITEMS).replaceOne</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> r</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r_upd </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                            </span><span class="pp-tag">delete</span><span class="pp-pln"> r_upd.connection</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                            </span><span class="pp-tag">delete</span><span class="pp-pln"> r_upd.message</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.FsDb.updateItemLastModified', r_upd</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> r_upd.result.nModified == 1</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> code 'FSITEM_LASTMODIFIED_UPDATED'</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> updatedCount r_upd.result.nModified</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> item r_upd.ops[0]</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> MongoRepoError</span><span class="pp-pln">,</span><span class="pp-arg">  updateItemLastModified </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> util.inspect( r_upd.result )</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> MongoRepoError</span><span class="pp-pln">,</span><span class="pp-arg">  updateItemLastModified </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'FsDb item not found, id: ' + id</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d65">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/mongodb/fs/t/fsdb/write.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> writeDocument</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> id</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> content</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">optional</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.readDocument</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> id</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.FsDb.writeDocument.readDocument.f', id, f, content === f</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> err && err.code == 'MongoRepoError'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> f === content</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.FsDb.writeDocument not modified', f</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'DOCUMENT_NOT_MODIFIED'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.FsDb.writeDocument.readDocument.upsert', id, content, lastModified</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> lastModified = new Date()</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> that.db.collection(DOCUMENTS).replaceOne</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> _id id</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> content content</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> lastModified lastModified</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> upsert true</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                        </span><span class="pp-tag">delete</span><span class="pp-pln"> r.connection</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">delete</span><span class="pp-pln"> r.message</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.mongodb.FsDb.writeDocument.r', r</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> modified = r.modifiedCount + r.upsertedCount</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> assert.equal(1, modified)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> that.updateItemLastModified</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> id</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> lastModified</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> rUpd </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.mongodb.FsDb.writeDocument upd', rUpd</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> code 'DOCUMENT_WRITTEN'</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> item r.ops[0]</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d66">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/mongodb/fs/document.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.fs.mongodb.Document</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> assert</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> async</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> vfile = require('wizzi-utils').vfile</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../errors')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> FsStream = require('../../utils/fsstream')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = vfile()</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> Promise = require('promise')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> JSZip = require('jszip')</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MongoClient = null</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> FsDb = null</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> Document</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> fsdb</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.fsdb = fsdb</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d100">fscommon/document/upload(</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">fscommon/document/createFolder(</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d93">fscommon/document/getFolder(</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d91">fscommon/document/getDir(</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d92">fscommon/document/getFiles(</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d90">fscommon/document/getContent(</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">fscommon/document/exists(</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d95">fscommon/document/isFolder(</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d94">fscommon/document/isFile(</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d82">fscommon/document/copyFile(</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d83">fscommon/document/copyFolder(</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d86">fscommon/document/deleteFile(</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d87">fscommon/document/deleteFolder(</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d97">fscommon/document/renameFile(</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d98">fscommon/document/renameFolder(</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d100">fscommon/document/upload(</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">fscommon/document/download(</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d101">fscommon/document/writeFile(</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d85">fscommon/document/createWriteStream(</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d96">fscommon/document/readFile(</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d99">fscommon/document/stat(</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> close</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.fsdb</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.close</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.fsdb = null</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Creates a Document instance</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> Document.create</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mongoUri</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isUndefined(callback) && verify.isFunction(mongoUri)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = mongoUri</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> mongoUri = null</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> MongoClient == null</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> MongoClient = require('mongodb').MongoClient</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> FsDb = require('./fsdb')</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> mongoUri = mongoUri || 'mongodb://localhost:27017/test'</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> MongoClient.connect</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mongoUri</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> mongoDb </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                            </span><span class="pp-tag">new</span><span class="pp-pln"> Document</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                                </span><span class="pp-tag">new</span><span class="pp-pln"> FsDb(mongoDb)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> error</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> method</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> message</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> method 'Mongo.Document.' + method</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> message message</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> normalize</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> path.trim().replace(/\\/g,'/').toLowerCase()</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> denormalize</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> path.trim().replace(/\//g,'\\').toLowerCase()</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = Document</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d67">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/mongodb/fs/fsdb.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.mongodb.FsDb</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> assert</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MongoClient = null</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> FSITEMS = 'fsitems'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> DOCUMENTS = 'documents'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> class FsDb (Filesystem Db)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Filesystem item</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { fsitem</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> ObjectId _id</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string basename</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> ObjectId parentId</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string dirname</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string path</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> integer kind</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> one-of 0 (directory), 1 (file)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Document</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { document</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> ObjectId _id</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string content</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> ISODate lastModified</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> FsDb</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> db</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.db = db</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d61"> fsdb/getItem</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d62"> fsdb/insertItem</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d64"> fsdb/updateItem</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d60"> fsdb/deleteItem</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d63"> fsdb/read</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d65"> fsdb/write</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> close</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.db</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log '***** wizzi-repo.mongodb.FsDb start closing'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.db.close</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.db = null</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log '***** wizzi-repo.mongodb.FsDb closed'</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Creates a FsDb instance</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> FsDb.create</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mongoUri</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isUndefined(callback) && verify.isFunction(mongoUri)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = mongoUri</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> mongoUri = null</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> MongoClient == null</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> MongoClient = require('mongodb').MongoClient</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> mongoUri = mongoUri || 'mongodb://localhost:27017/test'</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> MongoClient.connect</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mongoUri</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> mongoDb </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                            </span><span class="pp-tag">new</span><span class="pp-pln"> FsDb(mongoDb)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> error</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> method</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> message</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> method 'Mongo.FsDb.' + method</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> message message</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> normalize</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> path.trim().replace(/\\/g,'/').toLowerCase()</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = FsDb</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d68">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/mongodb/t/mongoFsimpl/m.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, arg1|@@null, arg2|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> documentUri</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg1 != null</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg1</span><span class="pp-kwd">}</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg2 != null</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg2</span><span class="pp-kwd">}</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.mongodb.mongoFsImpl.</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">.documentUri', documentUri</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg1 === 'options' || arg2 === 'options'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(callback) === 'undefined' && verify.isFunction(options)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = options</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options = {}</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isFunction(callback) === false</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Error</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidArgument'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'The callback parameter must be a function. Received: ' + callback</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(documentUri) === false</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidArgument'</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'documentUri'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'The documentUri parameter must be a string. Received: ' + documentUri</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d128">checked_call(</span><span class="pp-arg"> parsedUri </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mongoUriParser</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> documentUri</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> this.mongodbBaseFolder</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.db</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> mongoDb </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d69">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/mongodb/errors.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = module.exports = {}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d106">error(</span><span class="pp-arg"> NotImplemented</span><span class="pp-pln">,</span><span class="pp-arg">  message </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'message', message</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d106">error(</span><span class="pp-arg"> InvalidRequest</span><span class="pp-pln">,</span><span class="pp-arg">  message</span><span class="pp-pln">,</span><span class="pp-arg">  code </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'message', message</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.code = code</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d106">error(</span><span class="pp-arg"> FsItemNotFound</span><span class="pp-pln">,</span><span class="pp-arg">  resourceType</span><span class="pp-pln">,</span><span class="pp-arg">  uri </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = resourceType + ': ' + uri + ' not found '</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d70">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/mongodb/mongoFsimpl.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.mongodb.mongoFsImpl</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Implements the `fsimpl` interface for a mongodb backed file system.</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> MongoClient</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> require('mongodb')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">.</span><span class="pp-pln"> MongoClient</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> FsDb = require('./fs/fsdb')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> Document = require('./fs/document')</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> mongoUriParser = require('./mongoUriParser')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> MongoFsImpl</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mongoUri</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> mongodbBaseFolder</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.mongoUri = mongoUri || 'mongodb://localhost:27017/test'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.mongodbBaseFolder = mongodbBaseFolder</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.mongoDb = null</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.connecting = false</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> db</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.mongoDb == null</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidOperation</span><span class="pp-pln">,</span><span class="pp-arg">  db </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Connection not opened. The method `open` must be called before calling `db`.'</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> this.mongoDb</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> open</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.mongoDb</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> this.mongoDb</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> MongoClient.connect</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> this.mongoUri</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> db </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> that.mounted_db = db</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> fsdb = new FsDb(db)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> that.mongoDb = new Document(fsdb)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log '***** mongodb connected'</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> that.mongoDb</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> close</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.mounted_db</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log '***** mongodb start closing'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.mounted_db.close</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.mounted_db = null</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.mongoDb = null</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log '***** mongodb closed'</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d68">mongoFsimpl/m(</span><span class="pp-arg"> stat </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mongoDb.stat</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d68">mongoFsimpl/m(</span><span class="pp-arg"> lstat </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mongoDb.stat</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d68">mongoFsimpl/m(</span><span class="pp-arg"> readFile</span><span class="pp-pln">,</span><span class="pp-arg">  options </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mongoDb.readFile</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d68">mongoFsimpl/m(</span><span class="pp-arg"> writeFile</span><span class="pp-pln">,</span><span class="pp-arg">  content</span><span class="pp-pln">,</span><span class="pp-arg">  options </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mongoDb.writeFile</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d68">mongoFsimpl/m(</span><span class="pp-arg"> readdir</span><span class="pp-pln">,</span><span class="pp-arg">  options </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mongoDb.getDir</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> options</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> dir = []</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                    </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in result</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.mongodb.mongoFsImpl.readdir.parsedUri.internalPath, item', parsedUri.internalPath, item</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> dir.push(item.basename)</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, dir)</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d68">mongoFsimpl/m(</span><span class="pp-arg"> mkdir</span><span class="pp-pln">,</span><span class="pp-arg">  options </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mongoDb.createFolder</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d68">mongoFsimpl/m(</span><span class="pp-arg"> unlink </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mongoDb.deleteFile</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> createWriteStream</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> documentUri</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d127">checked_call_return(</span><span class="pp-arg"> parsedUri </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> mongoUriParser</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> documentUri</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> this.mongodbBaseFolder</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.mongoDb.createWriteStream</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parsedUri.internalPath</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = MongoFsImpl</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d71">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/mongodb/mongoUriParser.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.mongodb.mongoUriParser</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> url</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> In a mongodb repo, documents are stored</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> per user and per project.</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Document uris must be in the form</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> db://userName/projectName/documentPath</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The internal db path will be</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> `config.mongoDbBaseFolder`/userName/projectName/documentPath</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string uri</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string mongodbBaseFolder</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> returns</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> {</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string originalUri</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string userId</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string projectId</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string path</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string storeKind</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> boolean isIttfDocument</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string basename</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string schema</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string extension</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> parse</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> uri</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> mongodbBaseFolder</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> uri = uri.toLowerCase()</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> originalUri uri</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> parsedUri = url.parse(uri)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(parsedUri.protocol) !== 'string'</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d138">r_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  parse </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Uri must have a protocol (must be an absolute url). Received: ' + uri</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> protocol</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> parsedUri.protocol.substr(-1, 1) === ':'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> parsedUri.protocol.substr(0, (parsedUri.protocol.length - 1))</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> parsedUri.protocol</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> protocol !== 'db'</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d138">r_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  parse </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Invalid uri protocol. Must be `db`. Received: ' + uri</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'parseuri.parsedUri', parsedUri</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> name</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> parts = parsedUri.pathname ? parsedUri.pathname.split('/') : []</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> parsedUri.pathname && parsedUri.pathname.length &gt; 0 && parsedUri.pathname[0] == '/'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> parts.shift()</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> name = parts[parts.length-1]</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ret.basename = name</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nameparts = name.split('.')</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> nameparts.length &gt; 2 && nameparts[nameparts.length -1] === 'ittf'</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.isIttfDocument = true</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.schema = nameparts[nameparts.length -2]</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.isIttfDocument = false</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.extension = nameparts[nameparts.length -1]</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> parts.length &lt; 1</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d138">r_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  parse </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'uri'</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> message 'A mongodb uri must be in the form `db://userName/projectName/documentPath`. Received: ' + uri</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.mongodb.uriparser.parsedUri.parts', parts</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.mongodb.uriparser.parsedUri', parsedUri</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ret.storeKind = 'mongodb'</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ret.userId = parsedUri.host</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ret.projectId = parts[0]</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> parts.shift();</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ret.path = parts.join('/')</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> mongodbBaseFolder && mongodbBaseFolder.length &gt; 0</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.internalPath</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> verify.unixifyPath</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> mongodbBaseFolder</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ret.userId</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ret.projectId</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ret.path</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'parseuri.ret', ret</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d72">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/repo/t/ittfDocumentFinder/recurserTFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> recurserTFolder</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> basePath</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> relPath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'recurserTFolder enter', basePath, relPath</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Promise</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> resolve</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> ittfDocumentUri = path.join(basePath, 't', relPath)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.tryExists</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> that.schema</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> result.found</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> return callback(null, result)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'recurserTFolder resolve found', result</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> resolve(result)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> basePath = path.dirname(basePath)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> basePath.length &gt; 3</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'recurserTFolder try parent', basePath</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> recurserTFolder</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> basePath</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> relPath</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                            </span><span class="pp-tag">._</span><span class="pp-pln"> then</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                                </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                                    </span><span class="pp-tag">param</span><span class="pp-pln"> result</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'recurserTFolder transmit resolve result', basePath, result</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                                                    </span><span class="pp-tag">_</span><span class="pp-pln"> resolve(result)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                                    </span><span class="pp-tag">#</span><span class="pp-pln"> return that.resolvePathInTFolders(basePath, relPath, callback)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                                </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'recurserTFolder resolve not found', basePath</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> resolve</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                                            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> found false</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d73">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/repo/errors.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> globalErrors = require('../errors')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> utils = require('./utils')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = module.exports = globalErrors</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d106">error(</span><span class="pp-arg"> RepoIO</span><span class="pp-pln">,</span><span class="pp-arg">  message</span><span class="pp-pln">,</span><span class="pp-arg">  uri</span><span class="pp-pln">,</span><span class="pp-arg">  innerEx </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message + '\nuri: ' + uri</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d74">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/repo/fileSystemStore.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.fileSystemStore</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('wizzi-utils').file</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('./errors')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> FileSystemStore</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeKind = 'filesystem'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> documentExists</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> filepath</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> documentExists</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> documentExists = file.isFile(filepath)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> RepoIOError</span><span class="pp-pln">,</span><span class="pp-arg">  documentExists</span><span class="pp-pln">,</span><span class="pp-arg">  ex </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Checking the existence of document: ' + filepath + '. Message: ' + ex.message</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, documentExists)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> folderExistsSync</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> folderpath</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> folderExists</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> folderExists = file.isDirectory(folderpath)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d138">r_wz_err(</span><span class="pp-arg"> RepoIOError</span><span class="pp-pln">,</span><span class="pp-arg">  folderExistsSync</span><span class="pp-pln">,</span><span class="pp-arg">  ex </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Checking the existence of folder: ' + folderpath + '. Message: ' + ex.message</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> folderExists</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getFoldersSync</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> parentFolderPath</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> folders</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> folders = file.getFolders(parentFolderPath, options)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d138">r_wz_err(</span><span class="pp-arg"> RepoIOError</span><span class="pp-pln">,</span><span class="pp-arg">  getFoldersSync</span><span class="pp-pln">,</span><span class="pp-arg">  ex </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Getting folder: ' + parentFolderPath + '. Message: ' + ex.message</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> folders</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getModelContent</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> filepath</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> content</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> content = file.read(filepath)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> RepoIOError</span><span class="pp-pln">,</span><span class="pp-arg">  getModelContent</span><span class="pp-pln">,</span><span class="pp-arg">  ex </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Reading filepath: ' + filepath + '. Message: ' + ex.message</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, content)</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = FileSystemStore</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d75">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/repo/fragmentsFinder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.fragmentsFinder</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> config = require('../../config')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('./errors')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> IttfDocumentStore = require('./ittfDocumentStore')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> FragmentsFinder</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> store</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> schema</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.store = store</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.schema = schema</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.ext = '.' + schema + '.ittf'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.baseFolder = config.get('wfBaseFolder')</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getFragmentsInScope</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> folderUri = path.dirname(ittfDocumentUri)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = []</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this._search_up(folderUri, ret)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this._search_down(folderUri, ret)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret;</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _search_down</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> folderUri</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> resultByRef</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">[</span><span class="pp-pln"> folders</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> folders</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.store.getFoldersSync</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> folderUri</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> deep true</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> tFoldersOnly true</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> documentNames true</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in folders</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> resultByRef.folders.push(item)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _search_up</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> folderUri</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> resultByRef</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">[</span><span class="pp-pln"> folders</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> parentUri = path.dirname(folderUri)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !verify.startsWith(parentUri, this.baseFolder)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> folders</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.store.getFoldersSync</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parentUri</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> deep false</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> tFoldersOnly true</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> documentNames true</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in folders</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> resultByRef.folders.push(item)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> createFileSystemFragmentFinder</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">static</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> schema</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> store = IttfDocumentStore.createFileSystemDocumentStore()</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = new FragmentsFinder(store, schema)</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = FragmentsFinder</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d76">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/repo/ittfDocumentFinder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.ittfDocumentFinder</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('./errors')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> IttfDocumentFinder</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> store</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> schema</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.store = store</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.schema = schema</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> { options</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> string ittfDocumentUri</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> |</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> string basedir</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> string relpath</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> resolvePath</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> ittfDocumentUri = options.ittfDocumentUri</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> relpath = options.relpath</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(ittfDocumentUri) === false</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> basedir = options.basedir</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty (basedir) === false || verify.isAbsolutePath(basedir) === false</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  resolvePath </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'An "options.ittfDocumentUri" parameter or an "options.basedir" parameter with an absolute path is required to load an ITTF document. Received: ' + 'ittfDocumentUri: ' + options.ittfDocumentUri + ', basedir: ' + options.basedir + ', relpath: ' + options.relpath</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> (verify.isNotEmpty(relpath) === false) || (relpath[0] === '/')</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  resolvePath </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'An "options.ittfDocumentUri" parameter or an "options.relpath" parameter with a relative path is required to load an ITTF document. Received: ' + 'ittfDocumentUri: ' + options.ittfDocumentUri + ', basedir: ' + options.basedir + ', relpath: ' + options.relpath</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ittfDocumentUri = path.join(basedir, relpath)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.tryExists</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> this.schema</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> result.found</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> result.ittfDocumentUri</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(relpath) === false</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> IttfNotFound</span><span class="pp-pln">,</span><span class="pp-arg">  resolvePath </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> parameter ittfDocumentUri</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Cannot resolve ittf document: ' + ittfDocumentUri</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> that.resolvePathInTFolders</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> path.dirname(ittfDocumentUri)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> relpath</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> tresult </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> tresult.found</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> tresult.ittfDocumentUri</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                                </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'IttfDocumentFinder.resolvePath options', options, that.schema</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> IttfNotFound</span><span class="pp-pln">,</span><span class="pp-arg">  resolvePath </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Cannot find ittf document: ' + ittfDocumentUri</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> resolvePathInTFolders</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> basePath</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> relPath</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d72"> ittfDocumentFinder/recurserTFolder</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> recurserTFolder</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> basePath</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> relPath</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> then</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> result</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> tryExists</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> test</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> schema</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.store.documentExists</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> test</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> found true</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri test</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> test.toLowerCase().substr(-5, 5) !== '.ittf'</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> schema</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> that.store.documentExists</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> test + '.' + schema + '.ittf'</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                                        </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                                            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                                                    </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                                                        </span><span class="pp-tag">@</span><span class="pp-pln"> found true</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                                                        </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri test + '.' + schema + '.ittf'</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                                        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> that.store.documentExists</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> test + '.ittf'</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                                                    </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                                                        </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                                                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                                                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                                                                </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> found true</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri test + '.ittf'</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                                                    </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                                                        </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                                                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                                                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                                                                </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> found false</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                                        </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> found false</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> found false</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = IttfDocumentFinder</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d77">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/repo/ittfDocumentStore.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.ittfDocumentStore</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('./errors')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> uriParser = require('./uriParser')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> FileSystemStore = require('./fileSystemStore')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-kwd">$if</span><span class="pp-expr"> gctx_useMongo</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MongoDbStore = require('./mongoDbStore')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-kwd">$else</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MongoDbStore = {}</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> JsonDbStore = require('./jsonDbStore')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> IttfDocumentStore</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> parseUri</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriParser</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> { storeInfo</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> string storeKind</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> oneOf filesystem, mongodb, localstorage</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> string storeUri</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> # when storeKind === 'mongodb'</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> string storeBaseFolder</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> # when storeKind === 'mongodb'</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> string storeJsonFsData</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> # when storeKind === 'json'</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> init</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> storeInfo</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">string</span><span class="pp-pln"> storeKind</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> storeInfo.storeKind === 'filesystem'</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeImpl = new FileSystemStore()</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeKind = this.storeImpl.storeKind</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-kwd">$if</span><span class="pp-expr"> gctx_useMongo</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> storeInfo.storeKind === 'mongodb'</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeImpl = new MongoDbStore()</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.storeImpl.init</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> mongoUri storeInfo.storeUri</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> mongodbBaseFolder storeInfo.storeBaseFolder</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> that.storeKind = that.storeImpl.storeKind</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> storeInfo.storeKind === 'json'</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'storeInfo', storeInfo</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeImpl = new JsonDbStore()</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.storeImpl.init</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> jsonFsData storeInfo.storeJsonFsData</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> that.storeKind = that.storeImpl.storeKind</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> storeInfo.storeKind === 'localstorage'</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  init </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'storeKind'</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> message "storeKind not implemented yet: " + storeInfo.storeKind</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  init </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'storeKind'</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> message "Unknown storeKind: " + storeInfo.storeKind</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> initSync</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> storeInfo</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">string</span><span class="pp-pln"> storeKind</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> storeInfo.storeKind === 'filesystem'</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeImpl = new FileSystemStore()</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  initSync </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'storeInfo.storeKind'</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Method "initSync" is for storeKind "filesystem" only. ' + 'Received: ' + storeInfo.storeKind</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeKind = this.storeImpl.storeKind</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> close</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.storeImpl && this.storeImpl.close</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.storeImpl.close</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> documentExists</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> documentUri</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.storeImpl.documentExists(documentUri, callback)</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getModelContent</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> documentUri</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.storeImpl.getModelContent(documentUri, callback)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> folderExistsSync</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> folderUri</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.storeKind !== 'filesystem'</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidRequest</span><span class="pp-pln">,</span><span class="pp-arg">  folderExistsSync </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Method "folderExistsSync" is for storeKind "filesystem" only. ' + 'Current storeKind is: ' + this.storeKind</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.storeImpl.folderExists(folderUri)</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getFoldersSync</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> parentFolderUri</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.storeKind !== 'filesystem'</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidRequest</span><span class="pp-pln">,</span><span class="pp-arg">  getFoldersSync </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Method "getFoldersSync" is for storeKind "filesystem" only. ' + 'Current storeKind is: ' + this.storeKind</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.storeImpl.getFoldersSync(parentFolderUri, options)</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> createFileSystemDocumentStore</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">            </span><span class="pp-tag">static</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = new IttfDocumentStore()</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.initSync</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind "filesystem"</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getInfo</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.storeImpl.getInfo</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.storeImpl.getInfo()</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind this.storeKind</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = IttfDocumentStore</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d78">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/repo/jsonDbStore.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.jsonDbStore</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> vfile = require('wizzi-utils').vfile</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> JsonFsImpl = require('../json/jsonFsimpl')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('./errors')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> JsonDbStore</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeKind = 'json'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.fsimpl = null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.file = null</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> init</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">{</span><span class="pp-pln"> jsonFsData</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.fsimpl</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> JsonFsImpl</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> options.jsonFsData</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsimpl.open</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> that.file</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> vfile</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> that.fsimpl</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> close</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.fsimpl</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsimpl.close</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> documentExists</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> documentPath</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.file.isFile</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> documentPath</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> RepoIOError</span><span class="pp-pln">,</span><span class="pp-arg">  documentExists</span><span class="pp-pln">,</span><span class="pp-arg">  err </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'documentPath'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Checking existence of document: ' + documentPath</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, result)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getModelContent</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> documentPath</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.file.read</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> documentPath</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> RepoIOError</span><span class="pp-pln">,</span><span class="pp-arg">  getModelContent</span><span class="pp-pln">,</span><span class="pp-arg">  err </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'documentPath'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Getting content of document: ' + documentPath</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'getModelContent.received', result</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, result)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = JsonDbStore</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d79">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/repo/mongoDbStore.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.mongoDbStore</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> vfile = require('wizzi-utils').vfile</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MongoFsImpl = require('../mongodb/mongoFsimpl')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('./errors')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> MongoDbStore</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeKind = 'mongodb'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.fsimpl = null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.file = null</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> init</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">string</span><span class="pp-pln"> mongoUri</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">string</span><span class="pp-pln"> mongodbBaseFolder</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.fsimpl</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> MongoFsImpl</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> options.mongoUri</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> options.mongodbBaseFolder</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsimpl.open</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> that.file</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> vfile</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> that.fsimpl</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> close</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.fsimpl</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsimpl.close</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> documentExists</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> documentPath</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.file.isFile</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> documentPath</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> RepoIOError</span><span class="pp-pln">,</span><span class="pp-arg">  documentExists</span><span class="pp-pln">,</span><span class="pp-arg">  err </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'documentPath'</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Checking existence of document: ' + documentPath</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, result)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getModelContent</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> documentPath</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.file.read</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> documentPath</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> RepoIOError</span><span class="pp-pln">,</span><span class="pp-arg">  getModelContent</span><span class="pp-pln">,</span><span class="pp-arg">  err </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'documentPath'</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Getting content of document: ' + documentPath</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'getModelContent.received', result</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, result)</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = MongoDbStore</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d80">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/repo/uriParser.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.uriParser</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string uri</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> returns</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> {</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string originalUri</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string protocol</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> one-of 'db', 'ls', drive letter</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string storeKind</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> one-of 'mongodb', 'localstorage', 'filesystem'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string userId</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> # if storeKind === 'mongodb'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string projectId</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> # if storeKind === 'mongodb'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string path</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> boolean isIttfDocument</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string basename</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string schema</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> # if isIttfDocument === true</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string extension</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> # if isIttfDocument === false</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> url</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> parse</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> uri</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> uri = uri.toLowerCase()</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> originalUri uri</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> parsedUri = url.parse(uri)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(parsedUri.protocol) !== 'string'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  parse </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Uri must have a protocol (must be an absolute url). Received: ' + uri</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> protocol</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> parsedUri.protocol.substr(-1, 1) === ':'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> parsedUri.protocol.substr(0, (parsedUri.protocol.length - 1))</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> parsedUri.protocol</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'parseuri.parsedUri', parsedUri</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ret.protocol = protocol</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> protocol === 'db'</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.storeKind = 'mongodb'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> protocol === 'ls'</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.storeKind = 'localstorage'</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> protocol.length === 1</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> ret.storeKind = 'filesystem'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  parse </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Uri protocol must be `db` or `ls` or a filesystem drive letter. Received: ' + protocol</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> name, parts = parsedUri.pathname ? parsedUri.pathname.split('/') : []</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> parsedUri.pathname && parsedUri.pathname.length &gt; 0 && parsedUri.pathname[0] == '/'</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> parts.shift()</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> name = parts[parts.length-1]</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ret.basename = name</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nameparts = name.split('.')</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> nameparts.length &gt; 2 && nameparts[nameparts.length -1] === 'ittf'</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.isIttfDocument = true</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.schema = nameparts[nameparts.length -2]</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.isIttfDocument = false</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.extension = nameparts[nameparts.length -1]</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ret.storeKind === 'mongodb'</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> parts.length &lt; 1</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  parse </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'uri'</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> message 'A mongodb uri must be in the form `db://userName/projectName/documentPath`. Received: ' + uri</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.fs.uriparser.parsedUri.parts', parts</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.fs.uriparser.parsedUri', parsedUri</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.userId = parsedUri.host</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.projectId = parts[0]</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> parts.shift();</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.path = parts.join('/')</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.path = parts.join('/')</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'parseuri.ret', ret</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ret</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d81">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/repo/utils.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = module.exports = {}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.getSrcPathInfo</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> srcPath</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (srcPath) === 'string'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> srcPath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> (srcPath && (typeof (srcPath) === 'object'))</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> msg = md.getSrcPathInfoFromNode(srcPath)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">iif</span><span class="pp-pln"> msg</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">then</span><span class="pp-pln"> msg</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> srcPath.toString()</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> 'unavailable'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.getSrcPathInfoFromNode</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> msg</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> node</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> node.wzSourceLineInfo</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> info = node.wzSourceLineInfo</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> filePath = 'TODO'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> node.wzSourceFilepath</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> filePath = node.wzSourceFilepath(info.sourceKey)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push((' at row: ' + info.row))</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push((', col: ' + info.col))</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push((', source: ' + info.sourceKey))</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push((', in file: ' + filePath))</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> msg.length == 0</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span><span class="pp-pln"> null</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> msg.join('')</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d82">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/copyFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> copyFile</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> sourcePath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> destPath</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> sourcePath = normalize(sourcePath)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> destPath = normalize(destPath)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> sourcePath === destPath</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> {} </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.readFile</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> sourcePath</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> source </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.copyFile.source', source</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> that.exists</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> destPath</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> result === true</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  copyFile </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document copy file error. The destination path already exists: ' + destPath</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> that.writeFile</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> destPath</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> source</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.copyFile.r', r</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                        </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> code "DOCUMENT_COPIED"</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d83">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/copyFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> copyFolder</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> sourcePath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> destPath</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> sourcePath = normalize(sourcePath)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> destPath = normalize(destPath)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> sourcePath === destPath</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.t.fscommon.document.copyFolder. sourcePath === destPath'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> {} </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> copies = []</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.t.fscommon.document.getFiles.before'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getFiles</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> sourcePath</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> deep true</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> files </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.t.fscommon.document.copyFolder. files', files.length</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">var</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">decl</span><span class="pp-pln"> sourcefile</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-tag">decl</span><span class="pp-pln"> destfile</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">decl</span><span class="pp-pln"> files_len = files.length</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">function</span><span class="pp-pln"> repeater</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> index === files_len</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> copies </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> sourcefile = files[index]</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> destfile = sourcefile.replace(sourcePath, destPath)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.copyFile</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> sourcefile</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> destfile</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> copies.push(r)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(index + 1)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(0)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d84">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/createFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> createFolder</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> folderPath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> folderPath = normalize(folderPath)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> parts = folderPath.split('/')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> dirname = []</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> insertedId = null</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> parentFsItemId = null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> lastInserted = null</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.createFolder.parts', parts</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> item, len = parts.length</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> repeater</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> index === len</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, lastInserted)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> item = parts[index]</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> dirnameS = dirname.join('/')</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> dirname.push(item)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> pathS = dirname.join('/')</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.insertItem</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> basename item</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parentId parentFsItemId</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> dirname dirnameS</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> path pathS</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> kind 0</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.createFolder.r', r</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> lastInserted = r</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> r.code === 'FSITEM_EXISTS'</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> r.kind == 1</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                            </span><span class="pp-tag">throw</span><span class="pp-pln"> Error('</span><span class="pp-kwd">${</span><span class="pp-expr">fsname</span><span class="pp-kwd">}</span><span class="pp-pln"> createFolder error: ' + folderPath + ' is or contains a document path')</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> insertedId = r.item._id</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> insertedId = r.insertedId</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> parentFsItemId = insertedId</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(index + 1)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(0)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d85">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/createWriteStream.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> createWriteStream</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> filePath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> filePath = normalize(filePath)</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> FsStream</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> filePath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> this</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d86">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/deleteFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> deleteFile</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> filePath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> filePath = normalize(filePath)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> filePath</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem == null</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  deleteFolder </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document delete file error. Item not found: ' + filePath</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem.kind == 0</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  deleteFolder </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document delete file error. Is a folder path, not a file path: ' + filePath</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.deleteItem</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem._id</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.deleteFile.r', r</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d87">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/deleteFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> deleteFolder</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> folderPath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> folderPath = normalize(folderPath)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folderPath</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem == null</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  deleteFolder </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document folder not found: ' + folderPath</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem.kind == 1</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  deleteFolder </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Is a file path, not a folder path: ' + folderPath</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.getItemChildren</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem._id</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> children </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.deleteFolder.children', children</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> children.length &gt; 0</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  deleteFolder </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Folder not empty: ' + folderPath</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.deleteItem</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem._id</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.deleteFolder.r', r</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> assert( true, r.deleted )</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d88">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/download.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> downloadFolder</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> folderPath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">options-callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">+</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> read_file_Async</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> singleFilePath</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> that.readFile</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> singleFilePath</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">fsname</span><span class="pp-kwd">}</span><span class="pp-pln">.document.download.content', content</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> path singleFilePath</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> content content</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.getFiles</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folderPath</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> deep true</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> files </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> async.map</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> files</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> read_file_Async</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fileContents </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">fsname</span><span class="pp-kwd">}</span><span class="pp-pln">.document.download.fileContents', fileContents</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> zip = new JSZip()</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in fileContents</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> zip.file</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> item.path</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> item.content</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> zip</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d89">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/exists.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> exists</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> itemPath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> itemPath = normalize(path.resolve(itemPath))</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> itemPath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> true </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> false </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d90">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/getContent.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getContentsByIds</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">[</span><span class="pp-pln"> ids</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> fsdb = this.fsdb</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">+</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> async.map</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> ids</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> id</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.getContentsByIds', id</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.readDocument</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> id</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d91">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/getDir.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getDir</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> folderPath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">options-callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> folderPath = normalize(folderPath)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">+</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folderPath</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> r</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.getItemChildren</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> r._id</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitems </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> fsitems </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> [] </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d92">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/getFiles.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getFiles</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> folderPath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">options-callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> folderPath = normalize(folderPath, true)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> deep = options.deep</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> extension = options.extension</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> documentContent = options.documentContent || false</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">+</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> get_files_Async</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> singleFolderPath</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.get_files_Async', singleFolderPath</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.getItemByPath</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> singleFolderPath</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.get_files_Async.r', r</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> r</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.getItemChildren</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> r._id</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> r2 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.getItemChildren.err.r2', err, r2</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> r2</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> null </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> recurser</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> folderPaths</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> files</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ids</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> basenames</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Promise</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> resolve</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> reject</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> async.map</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> folderPaths</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> get_files_Async</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> fsitemsArray </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.getfiles err, fsitemsArray', err, fsitemsArray</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> reject</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> err</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                </span><span class="pp-tag">var</span><span class="pp-pln"> subfolders = []</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                </span><span class="pp-tag">foreach</span><span class="pp-pln"> fsitems in fsitemsArray</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                    </span><span class="pp-tag">if</span><span class="pp-pln"> fsitems != null</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                        </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in fsitems</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                                            </span><span class="pp-tag">if</span><span class="pp-pln"> item.kind == 0</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                                                </span><span class="pp-tag">_</span><span class="pp-pln"> subfolders.push(item.path)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                                            </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                                                </span><span class="pp-tag">if</span><span class="pp-pln"> !extension || item.path.substr(-extension.length) === extension</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                                                    </span><span class="pp-tag">_</span><span class="pp-pln"> files.push(item.path)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                                                    </span><span class="pp-tag">_</span><span class="pp-pln"> ids.push(item._id)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                                                    </span><span class="pp-tag">_</span><span class="pp-pln"> basenames.push(item.basename)</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> deep && subfolders.length &gt; 0</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> recurser</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> subfolders</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> files</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> ids</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> basenames</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                                        </span><span class="pp-tag">._</span><span class="pp-pln"> then</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                                            </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                                                </span><span class="pp-tag">_</span><span class="pp-pln"> resolve()</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                                </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> resolve()</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> files = []</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> ids = []</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> basenames = []</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> recurser</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> [folderPath]</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> files</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> ids</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> basenames</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> then</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.getfiles', 'folderPath', folderPath, 'files', files, 'ids', ids, 'documentContent', documentContent</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> !documentContent</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, files)</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> that.getContentsByIds</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ids</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> contents </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.getfiles.contents', contents</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                                </span><span class="pp-tag">var</span><span class="pp-pln"> ret = []</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                                </span><span class="pp-tag">for</span><span class="pp-pln"> var i=0; i&lt;files.length; i++</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                                        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> basename basenames[i]</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> path files[i]</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> fullPath files[i]</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> content contents[i]</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, ret)</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> catch</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d93">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/getFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getFolder</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> folderPath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> folderPath = normalize(folderPath)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folderPath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.getFolder.r', r</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> r.kind == 1</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  getFolder </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document getFolder error: ' + folderPath + ' is a file path'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d94">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/isFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> isFile</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> filePath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> filePath = normalize(filePath)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> filePath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem && fsitem.kind == 1</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> true </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> false </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d95">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/isFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> isFolder</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> folderPath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> folderPath = normalize(folderPath)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> folderPath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem && fsitem.kind == 0</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> true </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> false </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d96">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/readFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> readFile</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> filePath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.t.fscommon.readFile.filePath before', filePath</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> set filePath = denormalize(filePath)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> VIA set filePath = normalize(filePath)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> filePath = normalize(filePath)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> filePath</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem == null</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.toJson</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> json </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'fsjson.readFile not found', JSON.stringify(json, null, 4)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  readFile </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document read file error. Not found: ' + filePath</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> fsitem.kind == 0</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  readFile </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document read file error. Cannot read a folder: ' + filePath</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.readDocument</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem._id</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d97">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/renameFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> renameFile</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> oldPath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> newPath</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> oldPath = normalize(path.resolve(oldPath))</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> newPath = normalize(path.resolve(newPath))</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> oldPath === newPath</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> oldDirname = normalize(path.dirname(oldPath))</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> newDirname = normalize(path.dirname(newPath))</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> oldName = path.basename(oldPath)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> newName = path.basename(newPath)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> oldDirname !== newDirname</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  renameFile </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document rename file error. Old and new path must have the same base folder: ' + oldDirname + ' !== ' + newDirname</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> oldName === newName</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> renamed false</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> message 'oldPath and newPath are the same'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> oldPath</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem == null</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  renameFile </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document rename file error. Old path not found: ' + oldPath</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem.kind == 0</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  renameFile </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document rename file error. Is a folder path, not a file path: ' + oldPath</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.renameFile.fsitem', fsitem</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> that.exists</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> newPath</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> r === true</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  renameFile </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document rename file error. The new path already exists: ' + newPath</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> fsitem.basename = newName</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> fsitem.path = normalize(path.join(fsitem.dirname, fsitem.basename))</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.updateItem</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                        </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> code "DOCUMENT_RENAMED"</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> id r.item._id</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d98">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/renameFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> renameFolder</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> oldPath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> newPath</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> oldPath = normalize(path.resolve(oldPath))</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> newPath = normalize(path.resolve(newPath))</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> oldPath === newPath</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> oldDirname = normalize(path.dirname(oldPath))</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> newDirname = normalize(path.dirname(newPath))</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> oldName = path.basename(oldPath)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> newName = path.basename(newPath)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> oldDirname !== newDirname</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  renameFile </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document rename folder error. Old and new path must have the same base folder: ' + oldDirname + ' !== ' + newDirname</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> oldName === newName</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> renamed false</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> message 'oldPath and newPath are the same'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> oldPath</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem == null</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  renameFolder </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document rename folder error. Old path not found: ' + oldPath</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem.kind == 1</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  renameFolder </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document rename folder error. Is a file path, not a folder path: ' + oldPath</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.renameFolder.fsitem', fsitem</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> that.exists</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> newPath</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> r === true</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> ${fsname}RepoError</span><span class="pp-pln">,</span><span class="pp-arg">  renameFile </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Document rename folder error. The new path already exists: ' + newPath</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> fsitem.basename = newName</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> fsitem.path = normalize(path.join(fsitem.dirname, fsitem.basename))</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> that._changeParentFolder</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> changes </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.renameFolder.changes', changes</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.updateItem</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> _changeParentFolder</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> fsitemParent</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> change_dirnames_Async</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> fsitems</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> newDirname</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in fsitems</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.renameFolder.change_dirnames_Async', item</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> item.dirname = newDirname</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> item.path = normalize(path.join(item.dirname, item.basename))</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> async.mapSeries</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> fsitems</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> fsitem</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.updateItem</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, r.item)</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> newfsitems </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, newfsitems)</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> recurser</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> fsitemParent</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> changes</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Promise</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> resolve</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.getItemChildren</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> fsitemParent._id</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitems </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.renameFolder.children of ', fsitemParent._id, fsitemParent.path, fsitems.length</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitems.length &gt; 0</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> change_dirnames_Async</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsitems</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsitemParent.path</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> updfsitems </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                                            </span><span class="pp-tag">foreach</span><span class="pp-pln"> upd in updfsitems</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                                                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.renameFolder.upd', upd</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                                                </span><span class="pp-tag">_</span><span class="pp-pln"> changes.push(upd.path)</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                                                </span><span class="pp-tag">_</span><span class="pp-pln"> recurser</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> upd</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> changes</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                                                    </span><span class="pp-tag">._</span><span class="pp-pln"> then</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                                                        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                                                            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.renameFolder.resolve'</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                                                            </span><span class="pp-tag">_</span><span class="pp-pln"> resolve()</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                                </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.renameFolder.last resolve'</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> resolve()</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> changes = []</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> recurser</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> fsitemParent</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> changes</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> then</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.renameFolder._changeParentFolder ended', changes</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, changes)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d99">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/stat.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> stat</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> filePath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> filePath</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.stat.filePath', filePath, 'fsitem', fsitem</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem == null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> isDirectory</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> isFile</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> isDirectory</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span><span class="pp-pln"> fsitem.kind == 0</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> isFile</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span><span class="pp-pln"> fsitem.kind == 1</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d100">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/upload.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> uploadFolder</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> sourcePath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> destPath</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">options-callback</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> options.documentContent = true</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> sourcePath = normalize(sourcePath)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> destPath = normalize(destPath)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> documents</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.getFiles</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> sourcePath</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> deep true</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> documentContent true</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.uploadFolder.documents', sourcePath, options, documents</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> d, destFilePath, len = documents.length</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> uploaded = []</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> repeater</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> index === len</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, uploaded)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> d = documents[index]</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> destFilePath</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> destPath</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> d.relPath</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> that.writeFile</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> destFilePath</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> d.content</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> uploaded.push</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> relPath d.relPath</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> dest destFilePath</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> result r</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(index + 1)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(0)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d101">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/fscommon/document/writeFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> source|fs.mongodb, fsname|MongoFS</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> _createFile</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> parentId</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> dirname</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> basename</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.insertItem</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> basename basename</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parentId parentId</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> dirname dirname</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path normalize(path.join(dirname, basename))</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> kind 1</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.writeFile._createFile.r', r</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> r.code === 'FSITEM_EXISTS'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.writeDocument</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> r.item._id</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.writeDocument</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> r.insertedId</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> _updateFile</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> id</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.writeFile._updateFile', id, content</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.writeDocument</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> id</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> writeFile</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> filePath</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> content</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">optional</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">callback</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.writeFile.writeFile.init', filePath</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> filePath = normalize(filePath)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.writeFile.writeFile.normalized', filePath</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> filePath</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem != null</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.writeFile.writeFile.1.exists, so update', filePath</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> that._updateFile</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem._id</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> dirname = path.dirname(filePath)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.writeFile.writeFile.2.not exists. try get dirname', dirname</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.fsdb.getItemByPath</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> dirname</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem != null</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.writeFile.writeFile.3. dirname exists create file', fsitem._id, dirname, path.basename(filePath)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> that._createFile</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem._id</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> dirname</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> path.basename(filePath)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.writeFile.writeFile.4.dirname not exists.create dirname', dirname</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> that.createFolder</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> dirname</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                                        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.</span><span class="pp-kwd">${</span><span class="pp-expr">source</span><span class="pp-kwd">}</span><span class="pp-pln">.document.writeFile.writeFile.5.dirname created. so create file', fsitem.item._id, dirname, path.basename(filePath)</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                                        </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> that._createFile</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem.item._id</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> dirname</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> path.basename(filePath)</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d102">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/check_wz_callback.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> method</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(callback) !== 'function'</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">throw</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Error</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidArgument'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">method</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'The callback parameter must be a function. Received: ' + callback</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d103">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/check_wz_not_empty.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> varName, method</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> resolved_</span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln"> = verify.resolveToString(</span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'resolved_</span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">', resolved_</span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(resolved_</span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">) === false</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidArgument'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">method</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parameter '</span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> message "'</span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">' must be a not empty string. Received: " + util.inspect(</span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">, { depth: null })</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln"> = resolved_</span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d104">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/co_run_test.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> method</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-kwd"> ${</span><span class="pp-expr">method</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> co</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">function*</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-kwd">$hook</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> then</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> catch</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> console.log</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'catched in </span><span class="pp-kwd">${</span><span class="pp-expr">method</span><span class="pp-kwd">}</span><span class="pp-pln">.co'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> err.message</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">throw</span><span class="pp-pln"> err</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d105">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/co_run.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> method</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> co</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">function*</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">._</span><span class="pp-pln"> catch</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> console.log</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'catched in </span><span class="pp-kwd">${</span><span class="pp-expr">method</span><span class="pp-kwd">}</span><span class="pp-pln">.co'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> err.message</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> err.stack</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-kwd">$hook</span><span class="pp-pln"> oncatch</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> err</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d106">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/error.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, arg1|@@null, arg2|@@null, arg3|@@null, arg4|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg1 != null</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg1</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg2 != null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg2</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg3 != null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg3</span><span class="pp-kwd">}</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg4 != null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg4</span><span class="pp-kwd">}</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.name = '</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 5/8/17 set this.stack = (new Error()).stack</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error.prototype.toString</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.message</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error.prototype = Object.create(Error.prototype)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error.prototype.constructor = </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error = </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d107">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/repeater.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> coll, retval</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-kwd"> ${</span><span class="pp-expr">coll</span><span class="pp-kwd">}</span><span class="pp-pln">_item</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-kwd"> ${</span><span class="pp-expr">coll</span><span class="pp-kwd">}</span><span class="pp-pln">_len = </span><span class="pp-kwd">${</span><span class="pp-expr">coll</span><span class="pp-kwd">}</span><span class="pp-pln">.length</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> repeater</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> index === </span><span class="pp-kwd">${</span><span class="pp-expr">coll</span><span class="pp-kwd">}</span><span class="pp-pln">_len</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, </span><span class="pp-kwd">${</span><span class="pp-expr">retval</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">coll</span><span class="pp-kwd">}</span><span class="pp-pln">_item = </span><span class="pp-kwd">${</span><span class="pp-expr">coll</span><span class="pp-kwd">}</span><span class="pp-pln">[index]</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(index + 1)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(0)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d108">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/throw_error.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> errorName</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">throw</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> errors.</span><span class="pp-kwd">${</span><span class="pp-expr">errorName</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d109">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/var_cb_error.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> errorName</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> error</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> errors.</span><span class="pp-kwd">${</span><span class="pp-expr">errorName</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> error</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d110">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/t/var_error.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> errorName</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> error</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> errors.</span><span class="pp-kwd">${</span><span class="pp-expr">errorName</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d111">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/utils/_ild_objectId.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">const</span><span class="pp-pln"> os = require('os')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">const</span><span class="pp-pln"> crypto = require('crypto')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> ObjectId</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> id</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> id</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.id = id</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.generationTime = new Date()</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> Generates a MongoDB-style ObjectId in Node.js. Uses nanosecond timestamp in place of counter;</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> should be impossible for same process to generate multiple objectId in same nanosecond? (clock</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> drift can result in an *extremely* remote possibility of id conflicts).</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> @returns {string} Id in same format as MongoDB ObjectId.</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">const</span><span class="pp-pln"> seconds = Math.floor(new Date()/1000).toString(16)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">const</span><span class="pp-pln"> machineId = crypto.createHash('md5').update(os.hostname()).digest('hex').slice(0, 6)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">const</span><span class="pp-pln"> processId = process.pid.toString(16).slice(0, 4).padStart(4, '0')</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">const</span><span class="pp-pln"> counter = process.hrtime()[1].toString(16).slice(0, 6).padStart(6, '0')</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.id = seconds + machineId + processId + counter</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.generationTime = new Date()</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> equals</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> otherID</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.id == otherID.id</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> toString</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.id</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = ObjectId</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d112">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/utils/collection.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">const</span><span class="pp-pln"> errors = require('./errors')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">const</span><span class="pp-pln"> ObjectID = require('./objectid')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> match</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> key</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.utils.collection.match', key, item</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> !key</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.utils.collection.match: true'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> key.hasOwnProperty('_id')</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> item._id == null && key._id == null</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> item._id && item._id.equals(key._id)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.utils.collection.match: true'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> key.hasOwnProperty('path')</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> item.path == normalize(key.path)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.utils.collection.match: true'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> key.hasOwnProperty('basename') && key.hasOwnProperty('parentId')</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> item.basename === key.basename</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> item.parentId == null && key.parentId == null</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.utils.collection.match: true'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> item.parentId && item.parentId.equals(key.parentId)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.utils.collection.match: true'</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> key.hasOwnProperty('parentId')</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> item.parentId == null && key.parentId == null</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> item.parentId && item.parentId.equals(key.parentId)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.utils.collection.match: true'</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.utils.collection.match: false'</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> Collection</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> items</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> items = items || []</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> items.classType === 'wizzi-repo.utils.Collection'</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.items = items.items</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.items = items</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.restoreIds</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.classType = 'wizzi-repo.utils.Collection'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> restoreIds</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in this.items</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> item._id && item._id.length</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'restoreIds._id', item._id, item._id.length</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> item._id = ObjectID.createFromHexString(item._id)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> item.parentId && item.parentId.length</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'restoreIds.parentId', item.parentId, item.parentId.length</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> item.parentId = ObjectID.createFromHexString(item.parentId)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> count</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> key</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.items.length</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> find</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> key</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.utils.collection.find', key</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> result = []</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in this.items</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> match(key, item)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> result.push(item)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> new Collection(result)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> insertOne</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> doc</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(callback) == 'undefined'</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = options</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options = null</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'insertOne.doc', doc</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !doc._id</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> doc._id = new ObjectID()</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> items</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.find</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> _id doc._id</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> items.count() &gt; 0</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                        </span><span class="pp-tag">new</span><span class="pp-pln"> errors.RepoCollectionError('Duplicated key')</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.items.push</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> doc</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> insertedCount 1</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> insertedId doc._id</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span><span class="pp-pln"> ops</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> doc</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span><span class="pp-pln"> result</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ok 1</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> n 1</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> replaceOne</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> key</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> doc</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(callback) == 'undefined'</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> callback = options</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options = {}</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> temp = []</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> scannedCount = 0</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> modifiedCount = 0</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> upsertedCount = 0</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ops = []</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in this.items</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> scannedCount++</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> match(key, item)</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> modifiedCount == 0</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> temp.push(doc)</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> modifiedCount++</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> ops.push(doc)</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                                </span><span class="pp-tag">new</span><span class="pp-pln"> errors.RepoCollectionError('More than one item key match replaceOne')</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> temp.push(item)</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> modifiedCount == 0</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> options.upsert</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> !doc._id</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> doc._id = new ObjectID()</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> temp.push(doc)</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> upsertedCount++</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ops.push(doc)</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                            </span><span class="pp-tag">new</span><span class="pp-pln"> errors.RepoCollectionError('Key not found')</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.items = temp</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> modifiedCount modifiedCount</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> upsertedCount upsertedCount</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span><span class="pp-pln"> upsertedId</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> _id (upsertedCount &gt; 0 ? doc._id : null )</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ops ops</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span><span class="pp-pln"> result</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ok 1</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> n scannedCount</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> nModified (modifiedCount + upsertedCount)</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> deleteOne</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> key</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> temp = []</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> deletedCount = 0</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in this.items</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> match(key, item)</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> deletedCount == 0</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> deletedCount++</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                                </span><span class="pp-tag">new</span><span class="pp-pln"> errors.RepoCollectionError('More than one item key match deleteOne')</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> temp.push(item)</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.items = temp</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> deletedCount deletedCount</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span><span class="pp-pln"> result</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ok 1</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> n deletedCount</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> deleteMany</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> key</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> temp = []</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> deletedCount = 0</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in this.items</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> match(key, item)</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> deletedCount++</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> temp.push(item)</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.items = temp</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> deletedCount deletedCount</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span><span class="pp-pln"> result</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ok 1</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> n deletedCount</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> toArray</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.utils.collection.toArray'</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, this.items)</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> normalize</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> path</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> path.trim().replace(/\\/g,'/').toLowerCase()</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = Collection</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d113">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/utils/errors.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = module.exports = {}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d106">error(</span><span class="pp-arg"> RepoCollection</span><span class="pp-pln">,</span><span class="pp-arg">  message </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'message', message</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d114">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/utils/fsstream.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.lib.utils.FsStream</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> FsStream</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> filePath</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> document</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.filePath = filePath</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.document = document</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.buffer = []</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> write</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.buffer.push(text)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> end</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.document.writeFile</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> this.filePath</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.buffer.join('')</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> result</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(callback) === 'function'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = FsStream</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d115">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/utils/objectId.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MACHINE_ID = parseInt(Math.random() * 0xffffff, 10)</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> checkForHexRegExp</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> RegExp('^[0-9a-fA-F]{24}$')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">try</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> Buffer && Buffer.from</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> hasBufferType = true</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">catch</span><span class="pp-pln"> err</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> hasBufferType = false</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> ObjectID</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> ObjectID</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> id</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> id instanceof ObjectID</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> id</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ! (this instanceof ObjectID)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> ObjectID(id)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this._bsontype = 'ObjectID'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> (id == null) || (typeof (id) === 'number')</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.id = this.generate(id)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ObjectID.cacheHexString</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> this.__id = this.toString('hex')</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> valid = ObjectID.isValid(id)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> (! (valid) && (id != null))</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> Error('Argument passed in must be a single String of 12 bytes or a string of 24 hex characters')</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> valid && (typeof (id) === 'string') && id.length === 24 && hasBufferType</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> ObjectID</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">new</span><span class="pp-pln"> Buffer(id, 'hex')</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> valid && (typeof (id) === 'string') && id.length === 24</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> ObjectID.createFromHexString(id)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> id != null && id.length === 12</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.id = id</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> id != null && id.toHexString</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> id</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> Error('Argument passed in must be a single String of 12 bytes or a string of 24 hex characters')</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ObjectID.cacheHexString</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.__id = this.toString('hex')</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> hexTable</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">    </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; 256; i++</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> hexTable[i] = ((i &lt;= 15 ? '0' : '') + i.toString(16))</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.prototype.toHexString =</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ObjectID.cacheHexString && this.__id</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.__id</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> hexString = ''</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> (! (this.id) || ! (this.id.length))</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> Error(((('invalid ObjectId, ObjectId.id must be either a string or a Buffer, but is [' + JSON.stringify(this.id))) + ']'))</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.id instanceof _Buffer</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> hexString = convertToHex(this.id)</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ObjectID.cacheHexString</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> this.__id = hexString</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> hexString</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; this.id.length; i++</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> hexString += hexTable[this.id.charCodeAt(i)]</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ObjectID.cacheHexString</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.__id = hexString</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> hexString</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.prototype.get_inc =</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ObjectID.index = (ObjectID.index + 1) % 0xffffff</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.prototype.getInc =</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.get_inc()</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.prototype.generate =</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> time</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> 'number' !== typeof (time)</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> time = ~ (~ (Date.now() / 1000))</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> pid = (((typeof (process) === 'undefined') || (process.pid === 1)) ? Math.floor(Math.random() * 100000) : process.pid) % 0xffff</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> inc = this.get_inc()</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> buffer</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Buffer(12)</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[3] = time & 0xff</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[2] = (((time &gt;&gt; 8)) & 0xff)</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[1] = (((time &gt;&gt; 16)) & 0xff)</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[0] = (((time &gt;&gt; 24)) & 0xff)</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[6] = MACHINE_ID & 0xff</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[5] = (((MACHINE_ID &gt;&gt; 8)) & 0xff)</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[4] = (((MACHINE_ID &gt;&gt; 16)) & 0xff)</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[8] = pid & 0xff</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[7] = (((pid &gt;&gt; 8)) & 0xff)</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[11] = inc & 0xff</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[10] = (((inc &gt;&gt; 8)) & 0xff)</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[9] = (((inc &gt;&gt; 16)) & 0xff)</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> buffer</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.prototype.toString =</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> format</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.id && this.id.copy</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.id.toString(typeof (format) === 'string' ? format : 'hex')</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.toHexString()</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.prototype.inspect = ObjectID.prototype.toString</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.prototype.toJSON =</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.toHexString()</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.prototype.equals =</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> equals</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> otherId</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> otherId instanceof ObjectID</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.toString() === otherId.toString()</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> typeof (otherId) === 'string' && ObjectID.isValid(otherId) && otherId.length === 12 && (this.id instanceof _Buffer)</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> otherId === this.id.toString('binary')</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> typeof (otherId) === 'string' && ObjectID.isValid(otherId) && otherId.length === 24</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> otherId.toLowerCase() === this.toHexString()</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> typeof (otherId) === 'string' && ObjectID.isValid(otherId) && otherId.length === 12</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> otherId === this.id</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> otherId != null && (otherId instanceof ObjectID || otherId.toHexString)</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> otherId.toHexString() === this.toHexString()</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.prototype.getTimestamp =</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> timestamp</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Date()</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> time = (((this.id[3] | (this.id[2] &lt;&lt; 8)) | (this.id[1] &lt;&lt; 16))) | (this.id[0] &lt;&lt; 24)</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> timestamp.setTime(Math.floor(time) * 1000)</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> timestamp</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.index = ~ (~ (Math.random() * 0xffffff))</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.createPk =</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> createPk</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> ObjectID()</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.createFromTime =</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> createFromTime</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> time</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> buffer</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Buffer</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[3] = time & 0xff</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[2] = (((time &gt;&gt; 8)) & 0xff)</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[1] = (((time &gt;&gt; 16)) & 0xff)</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> buffer[0] = (((time &gt;&gt; 24)) & 0xff)</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> ObjectID(buffer)</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> decodeLookup</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> i = 0</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">    </span><span class="pp-tag">while</span><span class="pp-pln"> i &lt; 10</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> decodeLookup[(0x30 + i)] = i++</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">    </span><span class="pp-tag">while</span><span class="pp-pln"> i &lt; 16</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> decodeLookup[(((0x41 - 10)) + i)] = decodeLookup[(((0x61 - 10)) + i)] = i++</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> _Buffer = Buffer</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> convertToHex</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> bytes</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> bytes.toString('hex')</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.createFromHexString =</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> createFromHexString</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> string</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(string) === 'undefined' || (string != null && string.length !== 24)</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> Error('Argument passed in must be a single String of 12 bytes or a string of 24 hex characters')</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> hasBufferType</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> ObjectID</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                        </span><span class="pp-tag">new</span><span class="pp-pln"> Buffer(string, 'hex')</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> array</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> _Buffer(12)</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> n = 0</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> i = 0</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">            </span><span class="pp-tag">while</span><span class="pp-pln"> i &lt; 24</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> array[n++] = ((decodeLookup[string.charCodeAt(i++)] &lt;&lt; 4) | decodeLookup[string.charCodeAt(i++)])</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> ObjectID(array)</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> ObjectID.isValid =</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> isValid</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> id</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> id == null</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (id) === 'number'</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (id) === 'string'</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> ((id.length === 12) || (((id.length === 24) && checkForHexRegExp.test(id))))</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> id instanceof ObjectID</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> id instanceof _Buffer</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> id.toHexString</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> ((id.id.length === 12) || (((id.id.length === 24) && checkForHexRegExp.test(id.id))))</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> Object.defineProperty</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">        </span><span class="pp-tag">@</span><span class="pp-pln"> ObjectID.prototype</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">        </span><span class="pp-tag">@</span><span class="pp-pln"> 'generationTime'</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> enumerable true</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> get</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> (((((this.id[3] | (this.id[2] &lt;&lt; 8))) | (this.id[1] &lt;&lt; 16))) | (this.id[0] &lt;&lt; 24))</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> set</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> this.id[3] = value & 0xff</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> this.id[2] = (((value &gt;&gt; 8)) & 0xff)</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> this.id[1] = (((value &gt;&gt; 16)) & 0xff)</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> this.id[0] = (((value &gt;&gt; 24)) & 0xff)</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = ObjectID</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports.ObjectID = ObjectID</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports.ObjectId = ObjectID</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d116">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/lib/errors.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> utils = require('./repo/utils')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = module.exports = {}</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d106">error(</span><span class="pp-arg"> NotImplemented</span><span class="pp-pln">,</span><span class="pp-arg">  message </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'message', message</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d106">error(</span><span class="pp-arg"> InvalidRequest</span><span class="pp-pln">,</span><span class="pp-arg">  message</span><span class="pp-pln">,</span><span class="pp-arg">  code </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'message', message</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.code = code</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d106">error(</span><span class="pp-arg"> FsItemNotFound</span><span class="pp-pln">,</span><span class="pp-arg">  resourceType</span><span class="pp-pln">,</span><span class="pp-arg">  uri </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = resourceType + ': ' + uri + ' not found '</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d106">error(</span><span class="pp-arg"> IttfNotFound</span><span class="pp-pln">,</span><span class="pp-arg">  resourceType</span><span class="pp-pln">,</span><span class="pp-arg">  name</span><span class="pp-pln">,</span><span class="pp-arg">  sourceUri </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = resourceType + ': ' + name +' not found, processing document ' + utils.getSrcPathInfo(sourceUri)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d117">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/meta/index.json.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">name</span><span class="pp-pln"> 'wizzi-repo'</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">version</span><span class="pp-pln"> '0.5.4'</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">title</span><span class="pp-pln"> 'Ittf documents repository manager for the wizzi factory'</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">license</span><span class="pp-pln"> 'MIT'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">[</span><span class="pp-pln"> schemas</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d118">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/root/t/json.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Create an instance of the mongoDb Document class</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> for managing files and directory</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.jsonDirectoryTreeFromFilesystem = JsonFsImpl.directoryTree</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> json virtual file service</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { options</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { jsonFsData</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.jsonfile</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> jsonfile</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">{</span><span class="pp-pln"> jsonFsData</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsimpl</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> JsonFsImpl</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> options.jsonFsData</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.open</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> dbfile = vfile(fsimpl)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> dbfile</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d119">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/root/t/mongoDb.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Create an instance of the mongoDb Document class</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> for managing files and directory</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.mongoDbDocumentManager</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> mongoDbDocumentManager</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> mongoUri</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> MongoDocument.create</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mongoUri</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> docman </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d137">r_cb(</span><span class="pp-arg"> docman </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> mongoDb virtual file service</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { options</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string mongoUri</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string mongodbBaseFolder</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.dbfile</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> dbfile</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">string</span><span class="pp-pln"> mongoUri</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">string</span><span class="pp-pln"> mongodbBaseFolder</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsimpl</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> MongoFsImpl</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> options.mongoUri</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> options.mongodbBaseFolder</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.open</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> dbfile = vfile(fsimpl)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> dbfile</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d120">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/root/t/readme_content.md.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d121">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/root/.gitignore.text.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">common/proj_gitignore(</span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d122">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/root/index.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-repo.index</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> chalk = require('chalk')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> vfile = require('wizzi-utils').vfile</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = module.exports = {}</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-kwd">$if</span><span class="pp-expr"> gctx_useMongo</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MongoDocument = require('./lib/mongodb/fs/document')</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MongoFsImpl = require('./lib/mongodb/mongoFsImpl')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-kwd">$else</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MongoDocument = {}</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MongoFsImpl = {}</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> JsonFsImpl = require('./lib/json/jsonFsImpl')</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> IttfDocumentStore = require('./lib/repo/ittfDocumentStore')</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.ObjectId = require('./lib/utils/objectid')</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.MongoFsImpl = MongoFsImpl</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Filesystem virtual file service</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> noparams</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.fsfile</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> fsfile</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> vfile default</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> fsfile = vfile()</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> fsfile</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d119"> mongoDb</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d118"> json</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.JsonComponents = require('./lib/json/index')</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { options</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string storeKind</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> oneOf filesystem, mongodb, localstorage</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string storeUri</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> when storeKind == mongodb</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string storeBaseFolder</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> when storeKind == mongodb</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.createStoreFactory</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> createStoreFactory</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">string</span><span class="pp-pln"> storeKind</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">optional</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-repo.index.createStoreFactory.options', options</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> storeKind = options.storeKind || 'filesystem'</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> checkStoreKind(storeKind) == false</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidArgument'</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'createStoreFactory'</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'storeKind'</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> message 'invalid storeKind: ' + storeKind + '. Received: ' + storeKind</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> storeKind == 'mongodb'</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(options.storeUri) === false</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  createStoreFactory </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'The parameter `options.storeUri` is required and must be a string. Received: ' + options.storeUri</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(options.storeBaseFolder) === false</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  createStoreFactory </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'The parameter `options.storeBaseFolder` is required and must be a string. Received: ' + options.storeUri</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> storeKind == 'json'</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isObject(options.storeJsonFsData) === false</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d136">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  createStoreFactory </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'The parameter `options.storeJsonFsData` is required and must be an object. Received: ' + options.storeJsonFsData</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> getCreateStore</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> options</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> getCreateStore</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> storeKind</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">        </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> createStore</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> store</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> IttfDocumentStore()</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> store.init</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind storeKind</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> storeUri options.storeUri</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> storeBaseFolder options.storeBaseFolder</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> storeJsonFsData options.storeJsonFsData</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> store</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> checkStoreKind</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> kind</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> ['filesystem', 'mongodb', 'json', 'localstorage'].indexOf(kind) &gt; -1</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d123">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/root/license.text.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">common/mit_license(</span><span class="pp-arg"> 1982 - 2018 The Wizzi Team </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d124">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/root/package.json.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">common/kernel_package(</span><span class="pp-arg"> wizzi-repo</span><span class="pp-pln">,</span><span class="pp-arg">  ${wfpackage.version}</span><span class="pp-pln">,</span><span class="pp-arg">  ${wfpackage.title}.</span><span class="pp-pln">,</span><span class="pp-arg">  ${wfpackage.license} </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">co</span><span class="pp-pln"> "4.6.0"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">escodegen</span><span class="pp-pln"> "1.8.1"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">esprima</span><span class="pp-pln"> "3.1.3"</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">fs-extra</span><span class="pp-pln"> "2.0.0"</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">glob</span><span class="pp-pln"> "7.1.2"</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">i</span><span class="pp-pln"> "0.3.5"</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">jszip</span><span class="pp-pln"> "3.1.3"</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">minimatch</span><span class="pp-pln"> "3.0.4"</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-kwd">$if</span><span class="pp-expr"> gctx_useMongo</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">mongodb</span><span class="pp-pln"> "2.2.26"</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">promise</span><span class="pp-pln"> "7.1.1"</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> devDependencies</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d125">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/root/readme.md.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">common/kernel(</span><span class="pp-arg"> wizzi-repo</span><span class="pp-pln">,</span><span class="pp-arg">  ${wfpackage.title}. </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">h2</span><span class="pp-pln"> Features</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">ul</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">li</span><span class="pp-pln"> Filesystem ittf documents store</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">li</span><span class="pp-pln"> MongoDb ittf documents store</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">h3</span><span class="pp-pln"> Interface</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">js</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> repo.createStoreFactory(</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> options,</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> );</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">h4</span><span class="pp-pln"> Options</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">table</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">tr</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">td</span><span class="pp-pln"> storeKind</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">td</span><span class="pp-pln"> oneOf 'filesystem', 'mongodb'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">tr</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">td</span><span class="pp-pln"> storeUri</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">td</span><span class="pp-pln"> when storeKind == 'mongodb'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">br</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">span</span><span class="pp-pln"> the uri of the mongodb instance</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">tr</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">td</span><span class="pp-pln"> storeBaseFolder</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">td</span><span class="pp-pln"> when storeKind == 'mongodb'</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">br</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">span</span><span class="pp-pln"> the virtual filesystem base folder</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">    </span><span class="pp-tag">h4</span><span class="pp-pln"> Returns</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">    </span><span class="pp-tag">p</span><span class="pp-pln"> A function that can be called to obtain a</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">a</span><span class="pp-pln"> wizzi-repo.ittfDocumentStore</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">href</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">span</span><span class="pp-pln"> interface.</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">    </span><span class="pp-tag">h3</span><span class="pp-pln"> Usage</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">    </span><span class="pp-tag">js</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> var repo = require('wizzi-repo');</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">+</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> ...</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">+</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> repo.createStoreFactory(</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> {</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> storeKind: 'filesystem'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> },</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> function (err, createStore) {</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> }</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> );</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d126">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/checked_call_return_set.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> varName</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln"> && </span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">.__is_error</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d127">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/checked_call_return.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> varName</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln"> && </span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">.__is_error</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d128">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/checked_call.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> varName, message|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln"> && </span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">.__is_error</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '__is_error </span><span class="pp-kwd">${</span><span class="pp-expr">message</span><span class="pp-kwd">}</span><span class="pp-pln">', </span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> callback(</span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d129">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/error.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, arg1|@@null, arg2|@@null, arg3|@@null, arg4|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg1 != null</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg1</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg2 != null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg2</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg3 != null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg3</span><span class="pp-kwd">}</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg4 != null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg4</span><span class="pp-kwd">}</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.name = '</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 5/8/17 set this.stack = (new Error()).stack</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error.prototype.toString</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.message</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error.prototype = Object.create(Error.prototype)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error.prototype.constructor = </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error = </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d130">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/f_cb_done.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result|notUsed</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'err', err</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error(err.message)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d131">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/f_cb_no_err.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result|notUsed</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d132">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/f_cb_test.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result|notUsed</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'err', err</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error(err.message)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d133">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/f_cb_throw.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result|notUsed</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'err', err</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Error</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> JSON.stringify</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> err</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 2</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d134">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/f_cb.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result|notUsed</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> err</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d135">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/r_cb_error.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.error</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d136">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/r_cb_wz_err.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> errorCode, method, inner|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">errorCode</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">method</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-kwd">$hook</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> inner != null</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">inner</span><span class="pp-kwd">}</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d137">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/r_cb.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-kwd">$if</span><span class="pp-expr"> result !== null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d138">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/r_wz_err.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> errorCode, method, inner|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">errorCode</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">method</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-kwd">$if</span><span class="pp-expr"> inner != null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">inner</span><span class="pp-kwd">}</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d139">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/var_cb_error.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> errorName</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> error</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> errors.</span><span class="pp-kwd">${</span><span class="pp-expr">errorName</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> error</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d140">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/t/var_error.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> errorName</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> error</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> errors.</span><span class="pp-kwd">${</span><span class="pp-expr">errorName</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d141">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/json/t/fsjson/createItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> insert a filesystem item</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should insert a root folder</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsjson.insertItem</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parentId null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> basename 'c:'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> dirname null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> kind 0</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'insertItem.r', err, r</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> r.insertedCount</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  FSITEM_INSERTED </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_object(</span><span class="pp-arg"> r.item </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> r.item.path</span><span class="pp-pln">,</span><span class="pp-arg">  c: </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_typeof(</span><span class="pp-arg"> r.item._id</span><span class="pp-pln">,</span><span class="pp-arg">  object</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get an existing item</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsjson.getItem</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parentId null</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> basename 'c:'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'getItem.r', err, r</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_object(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_null(</span><span class="pp-arg"> r.parentId </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> r.basename</span><span class="pp-pln">,</span><span class="pp-arg">  c: </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should say the item already exists</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsjson.insertItem</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parentId null</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> basename 'c:'</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> dirname null</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> kind 0</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'insertItem.r', err, r</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  FSITEM_EXISTS </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_object(</span><span class="pp-arg"> r.item </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> r.item.path</span><span class="pp-pln">,</span><span class="pp-arg">  c: </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should insert a root child</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsjson.getItem</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parentId null</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> basename 'c:'</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> fsjson.insertItem</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> parentId r.parentId</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> basename 'hello.txt'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> dirname r.basename</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> kind 1</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> 'insertItem.r', err, r</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> r.insertedCount</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  FSITEM_INSERTED </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a">tobe_object(</span><span class="pp-arg"> r.item </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> r.item.path</span><span class="pp-pln">,</span><span class="pp-arg">  c:/hello.txt </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> hellotxt_item = r.item</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d142">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/json/t/fsjson/deleteItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> delete a filesystem item</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should delete a root child</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsjson.deleteItem</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> hellotxt_item._id</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'deletedItem.r', err, r</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> r.n</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  FSITEM_DELETED </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d143">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/json/t/fsjson/updateItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> update a filesystem item</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should update a root child</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> hellotxt_item.basename = 'hello2.txt'</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsjson.updateItem</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> hellotxt_item</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'updateItem.r', err, r</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> tobe_number( r.n, 1 )</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  FSITEM_UPDATED </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d144">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/json/t/fsjson/writeFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> update a filesystem item</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should write a document content</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> hellotxt_item.basename = 'hello2.txt'</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsjson.writeFile</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> hellotxt_item._id</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello world'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'writeFile.r', err, r</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> tobe_number( r.n, 1 )</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  DOCUMENT_WRITTEN </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d145">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/json/document.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">base_test(</span><span class="pp-arg"> json.fs.document </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> assert = require('assert')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> FsDb = require('../../lib/json/fs/fsjson')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> Document = require('../../lib/json/fs/document')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> FSITEMS = 'fsitems'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> DOCUMENTS = 'documents'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsdb, doc</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> json_before_async</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/createFolder(</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/write_read_File(</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/isFile(</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/copyFile(</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/deleteFile(</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/renameFile(</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/getFolder(</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/isFolder(</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> json_after_async</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-kwd">$*</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/isFile</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/copyFile</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/deleteFile</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/renameFile</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/createFolder</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/readFile</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/writeFile</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">    </span><span class="pp-tag">*$</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d146">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/json/fsjson.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">base_test(</span><span class="pp-arg"> json.fsjson </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> FsJson = require('../../lib/json/fs/fsjson')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsjson</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> FsJson</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> hellotxt_item = null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d141"> fsjson/createItem</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d143"> fsjson/updateItem</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d144"> fsjson/writeFile</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d142"> fsjson/deleteItem</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-kwd">$*</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d143"> fsjson/updateItem</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> fsjson/getItem</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> fsjson/read</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> fsjson/write</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">*$</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d147">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/mongodb/document.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">base_test(</span><span class="pp-arg"> mongodb.fs.document </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> MongoClient</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> require('mongodb')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">.</span><span class="pp-pln"> MongoClient</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> assert = require('assert')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> FsDb = require('../../lib/mongodb/fs/fsdb')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> Document = require('../../lib/mongodb/fs/document')</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mounted_db</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> FSITEMS = 'fsitems'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> DOCUMENTS = 'documents'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsdb, doc</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> mongo_before_async</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/createFolder(</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/write_read_File(</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/isFile(</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/copyFile(</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/deleteFile(</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/renameFile(</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/getFolder(</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/document/isFolder(</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> mongo_after_async</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">    </span><span class="pp-kwd">$*</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/isFile</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/copyFile</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/deleteFile</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/renameFile</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/createFolder</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/readFile</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> file/writeFile</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">    </span><span class="pp-tag">*$</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d148">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/mongodb/folder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">base_test(</span><span class="pp-arg"> mongodb.document.folder </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('../../lib/mongodb/fs/file')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> MongoClient</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> require('mongodb')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-tag">.</span><span class="pp-pln"> MongoClient</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> FsDb = require('../../lib/mongodb/fs/fsdb')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> Document = require('../../lib/mongodb/fs/document')</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mounted_db</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> FSITEMS = 'fsitems'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> DOCUMENTS = 'documents'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsdb, doc</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> mongo_before_async</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> folder/createFolder</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> folder/upload</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> folder/download</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> folder/getFiles</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> folder/copyFolder</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> folder/deleteFolder</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> folder/renameFolder</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-kwd">$*</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> document/getFolder</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> document/isFolder</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">*$</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d149">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/mongodb/fsdb.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">base_test(</span><span class="pp-arg"> mongodb.document.fsdb </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> MongoClient</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> require('mongodb')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">.</span><span class="pp-pln"> MongoClient</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> FsDb = require('../../lib/mongodb/fs/fsdb')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> Document = require('../../lib/mongodb/fs/document')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mounted_db</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> FSITEMS = 'fsitems'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> DOCUMENTS = 'documents'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsdb, doc</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> hellotxt_item = null</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> mongo_before_async</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> fsdb/createItem</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> fsdb/updateItem</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> fsdb/writeDocument</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> fsdb/readDocument</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> fsdb/deleteItem</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> mongo_after_async</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">    </span><span class="pp-kwd">$*</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> fsdb/updateItem</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> fsdb/getItem</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> fsdb/read</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> fsdb/write</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">    </span><span class="pp-tag">*$</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d150">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/mongodb/fsimpl.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">base_test(</span><span class="pp-arg"> mongodb.fsimpl </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> MongoFsImpl = require('../../lib/mongodb/mongoFsimpl')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> MongoClient</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> require('mongodb')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-tag">.</span><span class="pp-pln"> MongoClient</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> FsDb = require('../../lib/mongodb/fs/fsdb')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> Document = require('../../lib/mongodb/fs/document')</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> mounted_db</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> FSITEMS = 'fsitems'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> DOCUMENTS = 'documents'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> fsdb</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> doc</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsimpl</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> MongoFsImpl</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'c:/wz/users'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> mongo_before_async</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-tag">before-async</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.open</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">fscommon/fsimpl/writeFile(</span><span class="pp-arg"> db://stefi/wf </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">after-async</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.close</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> mongo_after_async</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d151">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/mongodb/index.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">base_test(</span><span class="pp-arg"> mongodb.document.index </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> index = require('../../index')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should return a filesystem store</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> index.createStoreFactory</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> createStore </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_null(</span><span class="pp-arg"> err </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> createStore</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> store </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a">tobe_null(</span><span class="pp-arg"> err </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> store.storeKind</span><span class="pp-pln">,</span><span class="pp-arg">  filesystem </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should return InvalidStoreKind error 2</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> index.createStoreFactory</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'happy'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_object(</span><span class="pp-arg"> err </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_true(</span><span class="pp-arg"> err.__is_error </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'should return InvalidStoreKind error 2.err', err</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> err.name</span><span class="pp-pln">,</span><span class="pp-arg">  InvalidArgument </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> err.info.parameter</span><span class="pp-pln">,</span><span class="pp-arg">  storeKind </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should return MissingStoreUri</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> index.createStoreFactory</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'mongodb'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_object(</span><span class="pp-arg"> err </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_true(</span><span class="pp-arg"> err.__is_error </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> err.name</span><span class="pp-pln">,</span><span class="pp-arg">  InvalidArgument </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> err.info.parameter</span><span class="pp-pln">,</span><span class="pp-arg">  options.storeUri </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should return MissingBaseFolder</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> index.createStoreFactory</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'mongodb'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeUri 'bla://bla'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_object(</span><span class="pp-arg"> err </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_true(</span><span class="pp-arg"> err.__is_error </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> err.name</span><span class="pp-pln">,</span><span class="pp-arg">  InvalidArgument </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> err.info.parameter</span><span class="pp-pln">,</span><span class="pp-arg">  options.baseFolder </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should return InvalidStoreUri</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> index.createStoreFactory</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'mongodb'</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeUri 'mongodb://localhost:27017/test'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> baseFolder 'c:/alfa'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_null(</span><span class="pp-arg"> err </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> index.createStoreFactory</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'mongodb'</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> storeUri 'mongodb://localhost:27017/ciccia'</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> baseFolder 'c:/alfa'</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a">tobe_object(</span><span class="pp-arg"> err </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a">tobe_true(</span><span class="pp-arg"> err.__is_error </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> err.name</span><span class="pp-pln">,</span><span class="pp-arg">  InvalidRequest </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> err.info.parameter</span><span class="pp-pln">,</span><span class="pp-arg">  storeUri </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d152">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/mongodb/uriParser.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">base_test(</span><span class="pp-arg"> mongodb.uriParser </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> uriParser = require('../../lib/mongodb/uriParser')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should parse a valid uri</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> parsed</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriParser</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'db://stefi/wf/utils/hello.js.ittf'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'c://wf/users'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'parsed', parsed</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> parsed.userId</span><span class="pp-pln">,</span><span class="pp-arg">  stefi </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> parsed.projectId</span><span class="pp-pln">,</span><span class="pp-arg">  wf </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> parsed.schema</span><span class="pp-pln">,</span><span class="pp-arg">  js </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_true(</span><span class="pp-arg"> parsed.isIttfDocument </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> parsed.path</span><span class="pp-pln">,</span><span class="pp-arg">  utils/hello.js.ittf </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should throw parsing an invalid uri</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> parsed</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriParser</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '/stefi/wf/utils/hello.js.ittf'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'c://wf/users'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'parsed', parsed</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_true(</span><span class="pp-arg"> parsed.__is_error </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> parsed.name</span><span class="pp-pln">,</span><span class="pp-arg">   InvalidArgument </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d153">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/mongodb/vfile_db.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">base_test(</span><span class="pp-arg"> vfile_db </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> async = require('async')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> vfile = require('wizzi-utils').vfile</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MongoFsImpl = require('../../lib/mongodb/mongoFsimpl')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsimpl</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> MongoFsImpl</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'c:/wz/users'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = vfile(fsimpl)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> db_dirname = 'db://stefi/wf'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> vfile_db/glob</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d154">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/t/frag1.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">property</span><span class="pp-pln"> Nemo</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d155">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/t/frag2.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">property</span><span class="pp-pln"> Nemo</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d156">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/t/ittf_object_args_item.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">gamma</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> &item</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> tau_</span><span class="pp-kwd">${</span><span class="pp-expr">item.name</span><span class="pp-kwd">}</span><span class="pp-pln"> = </span><span class="pp-kwd">${</span><span class="pp-expr">item.value</span><span class="pp-kwd">}</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d157">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/t/mixin_1.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">tau</span><span class="pp-pln"> 1</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">boss</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d158">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/t/mixin_2_appender.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">leaf</span><span class="pp-pln"> 1</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-pln"> 1.1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span><span class="pp-pln"> alpha</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d159">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/t/mixin_2_evaluator.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">root</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> team|milan</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-kwd"> ${</span><span class="pp-expr">team</span><span class="pp-kwd">}</span><span class="pp-pln"> 1</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span><span class="pp-pln"> alpha</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-kwd"> ${</span><span class="pp-expr">team</span><span class="pp-kwd">}</span><span class="pp-pln"> 2</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d160">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/t/mixin_3_evaluator.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d159">mixin_2_evaluator(</span><span class="pp-arg"> ${team} </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> team|milan</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">team</span><span class="pp-kwd"> ${</span><span class="pp-expr">team</span><span class="pp-kwd">}</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d161">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/appender_1.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">root</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">mixin_2_appender(</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-kwd">$appendto</span><span class="pp-pln"> alpha</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">leaf</span><span class="pp-pln"> 1.1.1</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d162">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/doc1.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">tests</span><span class="pp-pln"> School</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">table</span><span class="pp-pln"> Teacher</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">table</span><span class="pp-pln"> Course</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">table</span><span class="pp-pln"> student</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d163">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/doc2.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">tests</span><span class="pp-pln"> School</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d164">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/evaluator_1.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">test</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">team</span><span class="pp-kwd"> ${</span><span class="pp-expr"> 'inter'.toUpperCase() </span><span class="pp-kwd">}</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d165">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/evaluator_2.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d160">mixin_3_evaluator(</span><span class="pp-arg"> inter </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-pln"> 2.1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> alpha</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">leaf</span><span class="pp-pln"> 1.1</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d166">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/evaluator_3.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d160">mixin_3_evaluator(</span><span class="pp-arg"> inter </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-pln"> 2.1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> alpha</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">leaf</span><span class="pp-pln"> 1.1</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d167">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/evaluator_4.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d160">mixin_3_evaluator(</span><span class="pp-arg"> inter </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-pln"> 2.1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> alpha</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">leaf</span><span class="pp-pln"> 1.1</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d168">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/evaluator_5.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d160">mixin_3_evaluator(</span><span class="pp-arg"> inter </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-pln"> 2.1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> alpha</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">leaf</span><span class="pp-pln"> 1.1</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d169">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/ittf_object_args.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">alpha</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">beta</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-kwd">$foreach</span><span class="pp-pln"> item in items</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d156">ittf_object_args_item(</span><span class="pp-arg"> &item </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d170">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/lexer_1.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">alpha</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$*</span><span class="pp-pln"> bla bla *$beta 1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">beta</span><span class="pp-pln"> 2</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">gamma</span><span class="pp-pln"> 2.1</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-kwd">$*</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag"><</span><span class="pp-pln"> *</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">margin</span><span class="pp-pln"> 0</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">padding</span><span class="pp-pln"> 0</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">*$</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag"><</span><span class="pp-pln"> body</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">margin</span><span class="pp-pln"> 0</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">padding</span><span class="pp-pln"> 0</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d171">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/data/mixer_1.tests.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">sigma</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">mixin_1(</span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d172">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/ittfDocumentFinder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">test_base_kernel(</span><span class="pp-arg"> ittfDocumentFinder </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> IttfDocumentStore = require('../../lib/repo/ittfDocumentStore')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> IttfDocumentFinder = require('../../lib/repo/ittfDocumentFinder')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../../lib/repo/errors')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> store</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> IttfDocumentStore</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> finder</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">before-async</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> del.sync</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> [__dirname + '/dummydocfinder/**']</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> force true</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> store.init</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'filesystem'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'err, result', err, result</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> finder = new IttfDocumentFinder(store, 'js')</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get an invalid path error</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> finder.resolvePath</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri null</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> include false</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> includerModelKey null</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> basedir null</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> relpath null</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">cb_no_err(</span><span class="pp-arg"> foundUri </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err.name).to.be('InvalidArgument')</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get an invalid path error</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> finder.resolvePath</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri null</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> include false</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> includerModelKey null</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> basedir null</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> relpath '/ass.fidanken.ittf'</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">cb_no_err(</span><span class="pp-arg"> foundUri </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err.name).to.be('InvalidArgument')</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get an invalid path error</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> finder.resolvePath</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri null</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> include false</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> includerModelKey null</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> basedir null</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> relpath 'ass.fidanken.ittf'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">cb_no_err(</span><span class="pp-arg"> foundUri </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err.name).to.be('InvalidArgument')</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get an invalid path error</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> finder.resolvePath</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri null</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> include false</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> includerModelKey null</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> basedir '/hello'</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> relpath null</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">cb_no_err(</span><span class="pp-arg"> foundUri </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err.name).to.be('InvalidArgument')</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get a valid uri</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> finder.resolvePath</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'doc1.tests.ittf'</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> include false</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> includerModelKey null</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> basedir null</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> relpath null</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">cb_no_err(</span><span class="pp-arg"> foundUri </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err).to.be(null)</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(foundUri).to.be.a('string')</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get a valid uri for a call to a down t fragment</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> finder.resolvePath</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri null</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> include false</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> includerModelKey null</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> basedir</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> relpath 'frag1.tests.ittf'</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> foundUri </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err).to.be(null)</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(foundUri).to.be.a('string')</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get a valid uri for a call to an up t fragment</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> finder.resolvePath</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri null</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> include false</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> includerModelKey null</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> basedir</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'sub'</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'sub'</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> relpath 'frag2.tests.ittf'</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> foundUri </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err).to.be(null)</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(foundUri).to.be.a('string')</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d173">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/repo/ittfDocumentStore.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">test_base_kernel(</span><span class="pp-arg"> IttfDocumentStore </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> IttfDocumentStore = require('../../lib/repo/ittfDocumentStore')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> IttfDocumentFinder = require('../../lib/repo/ittfDocumentFinder')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../../lib/repo/errors')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> store</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> IttfDocumentStore</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> finder</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">before-async</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> del.sync</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> [__dirname + '/dummydocfinder/**']</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> force true</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> store.init</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'filesystem'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'err, result', err, result</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> finder = new IttfDocumentFinder(store, 'js')</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get an ittf model content</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> store.getModelContent</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'doc2.tests.ittf'</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> content</span><span class="pp-pln">,</span><span class="pp-arg">  tests School </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get an ittf model content</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> store.documentExists</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'doc1.tests.ittf'</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_true(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d174">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/utils/collection.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">base_test(</span><span class="pp-arg"> utils.collection </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../../lib/utils/errors')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> ObjectId = require('../../lib/utils/objectId')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> Collection = require('../../lib/utils/collection')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> rootId = new ObjectId</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> child_aId = new ObjectId</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> item_root</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> _id rootId</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> parentId null</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> path '/'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> item_a</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> _id child_aId</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> parentId rootId</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> path '/a'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> item_a_1</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> _id new ObjectId()</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> parentId child_aId</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> path '/a/1'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> item_a_2</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> _id new ObjectId()</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> parentId child_aId</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> path '/a/1'</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should create a collection and extract it with the toArray() async method</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> c</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Collection</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_root</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_a</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> c.toArray</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> items </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_array(</span><span class="pp-arg"> items</span><span class="pp-pln">,</span><span class="pp-arg">  2</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should create a collection and insert one item without _id</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> c</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Collection</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> c.insertOne</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_object(</span><span class="pp-arg"> result</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.insertedCount</span><span class="pp-pln">,</span><span class="pp-arg">  1</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.result.ok</span><span class="pp-pln">,</span><span class="pp-arg">  1</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.result.n</span><span class="pp-pln">,</span><span class="pp-arg">  1</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.insertedId.id.length</span><span class="pp-pln">,</span><span class="pp-arg">  24</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> c.toArray</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> items </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a">tobe_array(</span><span class="pp-arg"> items</span><span class="pp-pln">,</span><span class="pp-arg">  1</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should create a collection and insert one item with _id</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> c</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Collection</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> c.insertOne</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> item_root</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_object(</span><span class="pp-arg"> result</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.insertedCount</span><span class="pp-pln">,</span><span class="pp-arg">  1</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.result.ok</span><span class="pp-pln">,</span><span class="pp-arg">  1</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.result.n</span><span class="pp-pln">,</span><span class="pp-arg">  1</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_equal(</span><span class="pp-arg"> result.insertedId</span><span class="pp-pln">,</span><span class="pp-arg">  rootId</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> c.toArray</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> items </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a">tobe_array(</span><span class="pp-arg"> items</span><span class="pp-pln">,</span><span class="pp-arg">  1</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a">tobe_equal(</span><span class="pp-arg"> items[0]._id.toString()</span><span class="pp-pln">,</span><span class="pp-arg">  item_root._id.toString()</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should give a Duplicated key error</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> c</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Collection</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_root</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> c.insertOne</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> item_root</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'err', err, 'result', result</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_typeof(</span><span class="pp-arg"> err</span><span class="pp-pln">,</span><span class="pp-arg">  errors.RepoCollectionError </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> err.message</span><span class="pp-pln">,</span><span class="pp-arg">  Duplicated key </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should delete one item</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> c</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Collection</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_root</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_a</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> c.count()</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> c.deleteOne</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> _id item_root._id</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.deletedCount</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.result.n</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.result.ok</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> c.count()</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should delete many items</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> c</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Collection</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_root</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_a</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_a_1</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_a_2</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> c.count()</span><span class="pp-pln">,</span><span class="pp-arg">  4 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> c.deleteMany</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parentId item_a._id</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> result</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.deletedCount</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.result.n</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.result.ok</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> c.count()</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should replace one item</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> c</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Collection</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_root</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_a</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> item_root.newField = 20</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> c.replaceOne</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> _id item_root._id</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> item_root</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> result</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.modifiedCount</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.upsertedCount</span><span class="pp-pln">,</span><span class="pp-arg">  0 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.result.ok</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> scanned</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.result.n</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.result.nModified</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_array(</span><span class="pp-arg"> result.ops</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> c.count()</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should replace upsert an item</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> c</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Collection</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_root</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> c.replaceOne</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> _id item_a._id</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> item_a</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> upsert true</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d132">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> result</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.modifiedCount</span><span class="pp-pln">,</span><span class="pp-arg">  0 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> result.upsertedCount</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_array(</span><span class="pp-arg"> result.ops</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> c.count()</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should give an error trying to replace a non existing item</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> c</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Collection</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_root</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> c.replaceOne</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> _id item_a._id</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> item_a</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d131">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_typeof(</span><span class="pp-arg"> err</span><span class="pp-pln">,</span><span class="pp-arg">  errors.RepoCollectionError </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> err.message</span><span class="pp-pln">,</span><span class="pp-arg">  Key not found </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should find an item by id</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> c</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Collection</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_root</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_a</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> items</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> c.find</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> _id item_root._id</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> items.count()</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> items.toArray</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_array(</span><span class="pp-arg"> result</span><span class="pp-pln">,</span><span class="pp-arg">  1</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should find an item by path</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> c</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Collection</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_root</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_a</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> items</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> c.find</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> path item_root.path</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> items.count()</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> items.toArray</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> result</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_array(</span><span class="pp-arg"> result</span><span class="pp-pln">,</span><span class="pp-arg">  1</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d175">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests_stop/utils/objectid.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">base_test(</span><span class="pp-arg"> utils.objectId </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> ObjectId = require('../../lib/utils/objectId')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should create an objectId</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> id = new ObjectId</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'ObjectId.id', id</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_object(</span><span class="pp-arg"> id</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">tobe_number(</span><span class="pp-arg"> id.toString().length</span><span class="pp-pln">,</span><span class="pp-arg">  24</span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d176">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/json/t/json_after_async.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">after-async</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(fsimpl) != 'undefined'</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.toJson</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> json </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> console.log</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> JSON.stringify(json, null, 2)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.toJson</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> json </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> console.log</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> JSON.stringify(json, null, 2)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d177">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/json/t/json_before_async.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">before-async</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> fsdb = new FsDb()</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> doc = new Document(fsdb)</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d178">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/json/fsimpl.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d209">base_test(</span><span class="pp-arg"> json.fsimpl </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> JsonFsImpl = require('../../lib/json/jsonFsimpl')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> FsDb = require('../../lib/json/fs/fsjson')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> Document = require('../../lib/json/fs/document')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> fsdb</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> doc</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fsimpl</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> JsonFsImpl</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d177"> json_before_async</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">before-async</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.open</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d208">fscommon/fsimpl/writeFile(</span><span class="pp-arg"> c: </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">after-async</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.close</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d176"> json_after_async</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d179">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mocks/misc.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('wizzi-utils').file</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> IttfDocumentStore = require('../../lib/repo/ittfDocumentStore')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> IttfDocumentStore IttfDocumentStore</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> ProductionManager</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> aclstat</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> addIttfDocument</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> addMixedIttfModel</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> addEvaluatedIttfModel</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> addIttfModelBuildUpScript</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> ProductionContext</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> IttfDocumentStoreType IttfDocumentStore</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> dump true</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> addIttfDocument</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ittfModelBuildUpScripts</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> addIttfModelBuildUpScript</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> uri = uri</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> script = jsScriptCoder.toCode()</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> this.ittfModelBuildUpScripts[uri]</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> uri uri</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> script script</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> this.dump</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> path.dirname(uri)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> '_debug'</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> path.basename(uri) + '.js.dump'</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> script</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> raiseIttfEvaluationScriptError</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> exception</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> uri = uri</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> script = this.ittfModelBuildUpScripts[uri]</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> script && script.ittfEvalScript && exception && exception.lineNumber</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                                </span><span class="pp-tag">var</span><span class="pp-pln"> lines = script.ittfEvalScript.getErrorLines(exception).join('\n')</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> exception.message = '\nError evaluating ittf in uri: ' + uri + '\n' + lines + '\n'</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> exception.message = '\nError evaluating ittf in uri: ' + uri + '\n' + exception.message + '\n'</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> In case of --force proceed inside the try/catch flow</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                            </span><span class="pp-tag">throw</span><span class="pp-pln"> exception</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d180">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/folder/copyFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> sourceFolder = "c:/my/starters/copyFolder/source"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> destFolder = "c:/my/starters/copyFolder/dest"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_1 = sourceFolder + "/f_1.ittf"</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_2 = sourceFolder + "/f_2.ittf"</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_3 = sourceFolder + "/fold/f_3.ittf"</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_4 = sourceFolder + "/fold/f_4.ittf"</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_5 = sourceFolder + "/fold/sub/f_5.ittf"</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> content = "Hello copyFolder "</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> copy a folder</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">before-async</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_1</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_1'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_2</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_2'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_3</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_3'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_4</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_4'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_5</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_5'</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.uploadFolder</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> sourceFolder</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.uploadFolder', r</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should copy a folder</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.copyFolder</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> sourceFolder</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> destFolder</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.copyFolder', r</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d215">tobe_array(</span><span class="pp-arg"> r</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d181">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/folder/deleteFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> deleteFolderEmpty = "c:/my/starters/mongotest/delete/empty"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> deleteFolder = "c:/my/starters/mongotest/delete"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_1 = deleteFolder + "/f_1.js"</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_2 = deleteFolder + "/f_2.js"</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> content = "Hello "</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> delete a folder</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">before-async</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_1</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_1'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_2</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_2'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.createFolder</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> deleteFolderEmpty</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.createFolder', r</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.uploadFolder</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> deleteFolder</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.uploadFolder', r</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should delete an empty folder</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFolder</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> deleteFolderEmpty</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.deleteFolder', err, r</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d224">tobe_true(</span><span class="pp-arg"> r.deleted </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d220">tobe_number(</span><span class="pp-arg"> r.n</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d220">tobe_number(</span><span class="pp-arg"> r.ok</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should not delete a not empty folder</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFolder</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> deleteFolder</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d212">f_cb_no_err(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.deleteFolder', err, r</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d224">tobe_true(</span><span class="pp-arg"> err.__is_error </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d182">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/folder/download.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> downloadFolder = "c:/my/starters/download"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_1 = downloadFolder + "/f_1.js"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_2 = downloadFolder + "/f_2.js"</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_3 = downloadFolder + "/fold/f_3.js"</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_4 = downloadFolder + "/fold/f_4.js"</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_5 = downloadFolder + "/fold/sub/f_5.js"</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> content = "Hello "</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> downloadZipFile = "c:/my/starters/download/zip/zipped.zip"</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> download a folder</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">before-async</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_1</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_1'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_2</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_2'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_3</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_3'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_4</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_4'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_5</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_5'</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.uploadFolder</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> downloadFolder</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.uploadFolder', r</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should download c:/my/starters/download</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.mkpath(downloadZipFile)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.downloadFolder</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> downloadFolder</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> zip </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.downloadFolder', zip</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> zip.generateNodeStream</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> type 'nodebuffer'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> streamFiles true</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                        </span><span class="pp-tag">._</span><span class="pp-pln"> pipe</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> fs.createWriteStream(downloadZipFile)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                            </span><span class="pp-tag">._</span><span class="pp-pln"> on</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'finish'</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                    </span><span class="pp-tag">log</span><span class="pp-pln"> downloadZipFile + " written."</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d183">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/folder/getFiles.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> uploadFolder = "c:/my/starters/getFiles"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_1 = "c:/my/starters/getFiles/f_1.ittf"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_2 = "c:/my/starters/getFiles/f_2.ittf"</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_3 = "c:/my/starters/getFiles/fold/f_3.ittf"</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_4 = "c:/my/starters/getFiles/fold/f_4.ittf"</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_5 = "c:/my/starters/getFiles/fold/sub/f_5.ittf"</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> content = "Hello getFiles "</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> search a folder</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">before-async</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_1</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_1'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_2</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_2'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_3</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_3'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_4</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_4'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_5</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_5'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.uploadFolder</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> uploadFolder</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.uploadFolder', r</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get all files of c:/my/starters/getFiles</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.getFiles</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> uploadFolder</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> deep true</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.getFiles', r</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d215">tobe_array(</span><span class="pp-arg"> r</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d184">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/folder/renameFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> oldFolder = "c:/my/starters/darvin/test/rename/old"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> newFolder = "c:/my/starters/darvin/test/rename/new"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_1 = oldFolder + "/f1.txt"</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_2 = oldFolder + "/l1/f2a.txt"</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_3 = oldFolder + "/l1/f2b.txt"</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_4 = oldFolder + "/l1/l2/f3a.txt"</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> content = "Hello oldFolder "</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> rename a folder</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">before-async</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_1</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_1'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_2</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_2'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_3</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_3'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_4</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_4'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.uploadFolder</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> oldFolder</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.uploadFolder', r</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should rename a folder</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.renameFolder</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> oldFolder</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> newFolder</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.renameFolder', r</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d185">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/folder/upload.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> uploadFolder = "c:/my/starters/upload"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_1 = "c:/my/starters/upload/f_1.ittf"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_2 = "c:/my/starters/upload/f_2.ittf"</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_3 = "c:/my/starters/upload/fold/f_3.ittf"</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_4 = "c:/my/starters/upload/fold/f_4.ittf"</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_5 = "c:/my/starters/upload/fold/sub/f_5.ittf"</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> content = "Hello "</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> upload a folder</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">before-async</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_1</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_1'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_2</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_2'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_3</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_3'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_4</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_4'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_5</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file_5'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should upload c:/my/starters/upload</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.uploadFolder</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> uploadFolder</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.uploadFolder', r</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d215">tobe_array(</span><span class="pp-arg"> r</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d186">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/fsdb/createItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> insert a filesystem item</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should insert a root folder</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.insertItem</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parentId null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> basename 'c:'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> dirname null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> kind 0</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'insertItem.r', err, r</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d220">tobe_number(</span><span class="pp-arg"> r.insertedCount</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  FSITEM_INSERTED </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d221">tobe_object(</span><span class="pp-arg"> r.item </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.item.path</span><span class="pp-pln">,</span><span class="pp-arg">  c: </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get an existing item</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.getItem</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parentId null</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> basename 'c:'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'getItem.r', err, r</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d221">tobe_object(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d219">tobe_null(</span><span class="pp-arg"> r.parentId </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.basename</span><span class="pp-pln">,</span><span class="pp-arg">  c: </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should say the item already exists</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.insertItem</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parentId null</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> basename 'c:'</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> dirname null</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> kind 0</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'insertItem.r', err, r</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  FSITEM_EXISTS </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d221">tobe_object(</span><span class="pp-arg"> r.item </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.item.path</span><span class="pp-pln">,</span><span class="pp-arg">  c: </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should insert a root child</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.getItem</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> parentId null</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> basename 'c:'</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.insertItem</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> parentId r.parentId</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> basename 'hello.txt'</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> dirname r.basename</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> kind 1</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> 'insertItem.r', err, r</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d220">tobe_number(</span><span class="pp-arg"> r.insertedCount</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  FSITEM_INSERTED </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d221">tobe_object(</span><span class="pp-arg"> r.item </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.item.path</span><span class="pp-pln">,</span><span class="pp-arg">  c:/hello.txt </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> hellotxt_item = r.item</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d187">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/fsdb/deleteItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> delete a filesystem item</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should delete a root child</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.deleteItem</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> hellotxt_item._id</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'deletedItem.r', err, r</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d220">tobe_number(</span><span class="pp-arg"> r.n</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  FSITEM_DELETED </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d188">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/fsdb/readDocument.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> read a document item</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should read a document content</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'hellotxt_item', hellotxt_item</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d221">tobe_object(</span><span class="pp-arg"> hellotxt_item._id </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.readDocument</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> hellotxt_item._id</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'readDocument.r', err, r</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> tobe_number( r.n, 1 )</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r</span><span class="pp-pln">,</span><span class="pp-arg">  hello world </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d189">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/fsdb/updateItem.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> update a filesystem item</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should update a root child</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> hellotxt_item.basename = 'hello2.txt'</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.updateItem</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> hellotxt_item</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'updateItem.r', err, r</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> tobe_number( r.n, 1 )</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  FSITEM_UPDATED </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d190">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/fsdb/writeDocument.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> write a document item</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should write a document content</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'hellotxt_item', hellotxt_item</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d221">tobe_object(</span><span class="pp-arg"> hellotxt_item._id </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> hellotxt_item.basename = 'hello2.txt'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsdb.writeDocument</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> hellotxt_item._id</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello world'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'writeDocument.r', err, r</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> tobe_number( r.n, 1 )</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  DOCUMENT_WRITTEN </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d191">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/vfile_db/glob.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should async glob a folder</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> file.getGlobbedFilesEx</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> db_dirname</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'ittf'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'globs2'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '**/*.ittf'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> file</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d215">tobe_array(</span><span class="pp-arg"> result</span><span class="pp-pln">,</span><span class="pp-arg">  3</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d192">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/async.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> call, arg1|@@null, arg2|@@null, arg3|@@null, arg4|@@null, arg5|@@null, arg6|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-kwd"> ${</span><span class="pp-expr">call</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg1 != null</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg1</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg2 != null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg2</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg3 != null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg3</span><span class="pp-kwd">}</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg4 != null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg4</span><span class="pp-kwd">}</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg5 != null</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg5</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg6 != null</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg6</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error()</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d193">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/co_run_test.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> method</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-kwd"> ${</span><span class="pp-expr">method</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> co</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">function*</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-kwd">$hook</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> then</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">._</span><span class="pp-pln"> catch</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> console.log</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'catched in </span><span class="pp-kwd">${</span><span class="pp-expr">method</span><span class="pp-kwd">}</span><span class="pp-pln">.co'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> err.message</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">throw</span><span class="pp-pln"> err</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d194">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/co_run.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> method</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> co</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">function*</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">._</span><span class="pp-pln"> catch</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> console.log</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'catched in </span><span class="pp-kwd">${</span><span class="pp-expr">method</span><span class="pp-kwd">}</span><span class="pp-pln">.co'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> err.message</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> err.stack</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-kwd">$hook</span><span class="pp-pln"> oncatch</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> err</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d195">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/expect_throw_error.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> error</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> fn</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">.</span><span class="pp-pln"> to</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">._</span><span class="pp-pln"> throwException</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> e</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(e).to.be.a(errors.</span><span class="pp-kwd">${</span><span class="pp-expr">error</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d196">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/itasync.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> title, call, arg1|@@null, arg2|@@null, arg3|@@null, arg4|@@null, arg5|@@null, arg6|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> it</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">@</span><span class="pp-pln"> "</span><span class="pp-kwd">${</span><span class="pp-expr">title</span><span class="pp-kwd">}</span><span class="pp-pln">"</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> done</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-kwd"> ${</span><span class="pp-expr">call</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg1 != null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg1</span><span class="pp-kwd">}</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg2 != null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg2</span><span class="pp-kwd">}</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg3 != null</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg3</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg4 != null</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg4</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg5 != null</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg5</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg6 != null</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg6</span><span class="pp-kwd">}</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d197">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/mongo_after_async.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">after-async</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-pln"> mounted_db</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '***** mongodb start closing'</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> mounted_db.close</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> mounted_db = null</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '***** mongodb closed'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d198">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/mongodb/t/mongo_before_async.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">before-async</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> MongoClient.connect</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">@</span><span class="pp-pln"> 'mongodb://localhost:27017/test'</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> db </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> mounted_db = db</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> fsdb = new FsDb(db)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> doc = new Document(fsdb)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> db.collection(FSITEMS).drop</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> result</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> 'FSITEMS.drop failed'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> 'FSITEMS.drop result', result</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> db.collection(DOCUMENTS).drop</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> result</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                </span><span class="pp-tag">log</span><span class="pp-pln"> 'DOCUMENTS.drop failed'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                                </span><span class="pp-tag">log</span><span class="pp-pln"> 'DOCUMENTS.drop result', result</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d199">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/fscommon/document/copyFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> sourceFilePath = "c:/my/from/hello.txt"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> destFilePath = "c:/my/to/hello.txt"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> content = 'Hello'</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> copy a file</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">before-async</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.writeFile</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> sourceFilePath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> copy hello from to</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.copyFile</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> sourceFilePath</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> destFilePath</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'copy hello from to', r</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d200">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/fscommon/document/createFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> folder creation</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should create a folder</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.createFolder</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'c:/my/starters/darvin'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should create a folder', err, f</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d220">tobe_number(</span><span class="pp-arg"> f.insertedCount</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-kwd">$*</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should verify that folder exists</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFolder</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'c:/my/starters/darvin'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should verify that folder exists', err, f</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d224">tobe_true(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should retrieve a folder</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.getFolder</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'c:/my/starters'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should retrieve a folder', f</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d220">tobe_number(</span><span class="pp-arg"> f.kind</span><span class="pp-pln">,</span><span class="pp-arg">  0 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> f.path</span><span class="pp-pln">,</span><span class="pp-arg">  c:/my/starters </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should delete a folder</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFolder</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'c:/my/starters/darvin'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should delete a folder', err, f</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d224">tobe_true(</span><span class="pp-arg"> f.deleted </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d220">tobe_number(</span><span class="pp-arg"> f.n</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d220">tobe_number(</span><span class="pp-arg"> f.ok</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should verify that folder does not exists</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFolder</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'c:/my/starters/darvin'</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should verify that folder does not exists', f</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d218">tobe_false(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">*$</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d201">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/fscommon/document/deleteFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> filePathDelete = "c:/my/starters/darvin/hello.md"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> content = "Hello world"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> delete a file</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">before-async</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.writeFile</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> filePathDelete</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should delete a file</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.deleteFile</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> filePathDelete</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should delete a file', err, r</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  FSITEM_DELETED </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d220">tobe_number(</span><span class="pp-arg"> r.deletedCount</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d202">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/fscommon/document/getFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> get a folder</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get a folder</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.getFolder</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'c:/my/starters'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should get a folder', err, f</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> f.path</span><span class="pp-pln">,</span><span class="pp-arg">  c:/my/starters </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d203">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/fscommon/document/isFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> folderPath = "c:/my/hello"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> filePath = "c:/my/hello.txt"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> content = 'Hello'</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> write a file</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">before-async</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.createFolder</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> folderPath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.writeFile</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> filePath</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should be a file item</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFile</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> filePath</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.isFile', r</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d224">tobe_true(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should be a folder item</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFolder</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> folderPath</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.isFolder', r</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d224">tobe_true(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d204">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/fscommon/document/isFolder.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> folder existence test</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should test if a folder exists</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.isFolder</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'c:/my/starters'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should test if a folder exists', err, f</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d224">tobe_true(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d205">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/fscommon/document/readFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> readFile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> filePath</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> filePath = normalize(filePath)</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.fsdb.getItemByPath</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> filePath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> fsitem </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> fsitem == null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">throw</span><span class="pp-pln"> Error('MongoFS error. Document does not exists: ' + path)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> fsitem.kind == 0</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">throw</span><span class="pp-pln"> Error('MongoFS error. Cannot read a folder: ' + path)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">that.fsdb.readDocumentile</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> fsitem._id</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d134">f_cb(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(content)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d206">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/fscommon/document/renameFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> oldFolder = "c:/my/starters/darvin/test/rename/old"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_1 = oldFolder + "/f1.txt"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file_1renamed = oldFolder + "/fr.txt"</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> content = "Hello rename file "</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> rename a file</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">before-async</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.writeFile</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_1</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + 'file 1'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should rename a file</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.renameFile</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_1</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> file_1renamed</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.renameFile', r</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> doc.readFile</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> file_1renamed</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> read </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> 'doc.renameFile read', read</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d207">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/fscommon/document/write_read_File.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> folderPathOld = "c:/my/starters/darvin"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> filePathOld = "c:/my/starters/darvin/hello.md"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> filePathNew = "c:/my/newfolder/readme.md"</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> content = "Hello world"</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> write a file</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">before-async</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.createFolder</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> folderPathOld</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> f </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should write into a non existing folder</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.writeFile</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> filePathNew</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should write a file', err, r</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  DOCUMENT_WRITTEN </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d222">tobe_string_value(</span><span class="pp-arg"> r.item.content</span><span class="pp-pln">,</span><span class="pp-arg">  content </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-kwd">$*</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should be not modified</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.writeFile</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> filePathNew</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should be not modified', err, r</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  DOCUMENT_NOT_MODIFIED </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should write into an existing folder</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.writeFile</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> filePathOld</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should write into an existing folder', err, r</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  DOCUMENT_WRITTEN </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d222">tobe_string_value(</span><span class="pp-arg"> r.item.content</span><span class="pp-pln">,</span><span class="pp-arg">  content </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should read</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.readFile</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> filePathOld</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should read', err, r</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d222">tobe_string_value(</span><span class="pp-arg"> r</span><span class="pp-pln">,</span><span class="pp-arg">  content </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should overwrite an existing file</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> doc.writeFile</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> filePathOld</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content + ' ' + content</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d211">f_cb_done(</span><span class="pp-arg"> r </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'should overwrite an existing file', err, r</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> r.code</span><span class="pp-pln">,</span><span class="pp-arg">  DOCUMENT_WRITTEN </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d222">tobe_string_value(</span><span class="pp-arg"> r.item.content</span><span class="pp-pln">,</span><span class="pp-arg">  content + ' ' + content </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">*$</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d208">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/fscommon/fsimpl/writeFile.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> folder:string|""</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-pln"> fs write a file</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should write an hello file</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.writeFile</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">folder</span><span class="pp-kwd">}</span><span class="pp-pln">/folder1/hello.js.ittf'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Hello wizzi factory'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'tests.mongodb.fsimpl.writeFile, result:', result</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> result.code</span><span class="pp-pln">,</span><span class="pp-arg">  'DOCUMENT_WRITTEN' </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> result.item.content</span><span class="pp-pln">,</span><span class="pp-arg">  'Hello wizzi factory' </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> should read an hello file</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.readFile</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">folder</span><span class="pp-kwd">}</span><span class="pp-pln">/folder1/hello.js.ittf'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'tests.mongodb.fsimpl.readFile, content:', content</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d223">tobe_string(</span><span class="pp-arg"> content</span><span class="pp-pln">,</span><span class="pp-arg">  'Hello wizzi factory' </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-pln"> hello.js.ittf should be a file not a directory</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.stat</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">folder</span><span class="pp-kwd">}</span><span class="pp-pln">/folder1/hello.js.ittf'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> stat </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'tests.mongodb.fsimpl.stat, stat:', stat</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d224">tobe_true(</span><span class="pp-arg"> stat.isFile() </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d218">tobe_false(</span><span class="pp-arg"> stat.isDirectory() </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">it-async</span><span class="pp-kwd"> ${</span><span class="pp-expr">folder</span><span class="pp-kwd">}</span><span class="pp-pln"> should be a directory not a file</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fsimpl.stat</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">folder</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d213">f_cb_test(</span><span class="pp-arg"> stat </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'tests.mongodb.fsimpl.stat, stat:', stat</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d218">tobe_false(</span><span class="pp-arg"> stat.isFile() </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d224">tobe_true(</span><span class="pp-arg"> stat.isDirectory() </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d209">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/base_test.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> del = require('del')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> expect = require('expect.js')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> _ = require('lodash')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('wizzi-utils').file</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-kwd">$hook</span><span class="pp-pln"> imports</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d210">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/expect_throw_error.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> error</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> fn</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">.</span><span class="pp-pln"> to</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">._</span><span class="pp-pln"> throwException</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> e</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(e).to.be.a(errors.</span><span class="pp-kwd">${</span><span class="pp-expr">error</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d211">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/f_cb_done.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result|notUsed</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'err', err</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error(err.message)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d212">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/f_cb_no_err.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result|notUsed</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d213">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/f_cb_test.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result|notUsed</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'err', err</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error(err.message)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d214">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/f_cb_throw.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result|notUsed</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'err', err</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> Error</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> JSON.stringify</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> err</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 2</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d215">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/tobe_array.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, length</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.an('array')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">.length).to.be(</span><span class="pp-kwd">${</span><span class="pp-expr">length</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d216">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/tobe_eql.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, value</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> loose equality works for objects</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.eql(</span><span class="pp-kwd">${</span><span class="pp-expr">value</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d217">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/tobe_equal.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> a, b</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">a</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.equal(</span><span class="pp-kwd">${</span><span class="pp-expr">b</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d218">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/tobe_false.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be(false)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d219">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/tobe_null.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be(null)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d220">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/tobe_number.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, value</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.a('number')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be(</span><span class="pp-kwd">${</span><span class="pp-expr">value</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d221">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/tobe_object.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.an('object')</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d222">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/tobe_string_value.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, value</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.a('string')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be(</span><span class="pp-kwd">${</span><span class="pp-expr">value</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d223">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/tobe_string.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, value|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.a('string')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-kwd">$if</span><span class="pp-expr"> value != null</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be('</span><span class="pp-kwd">${</span><span class="pp-expr">value</span><span class="pp-kwd">}</span><span class="pp-pln">')</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d224">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/tobe_true.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be(true)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d225">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/tobe_typeof.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, type</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.a(</span><span class="pp-kwd">${</span><span class="pp-expr">type</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d226">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/ittf/tests/t/tobe_undefined.js.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be(undefined)</span></div></pre>
                        </div>
                    </div>
                    <div class="code-panel" id="d227">
                        <div class="modal-view-container">
                            <h4 class="d-h2">/src/generate.wfjob.ittf</h4>
                            <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">wfjob</span><span class="pp-pln"> wizzi-repo</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> ittf_meta_folder     = path.join(__dirname, 'ittf', 'meta');</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> ittf_lib_folder      = path.join(__dirname, 'ittf', 'lib');</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> ittf_root_folder     = path.join(__dirname, 'ittf', 'root');</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> ittf_examples_folder = path.join(__dirname, 'ittf', 'examples');</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> ittf_tests_folder    = path.join(__dirname, 'ittf', 'tests');</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> dest_folder           = path.join(__dirname, '..', 'dist');</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">model</span><span class="pp-pln"> meta</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">schema</span><span class="pp-pln"> json</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">src</span><span class="pp-kwd"> ${</span><span class="pp-expr">ittf_meta_folder</span><span class="pp-kwd">}</span><span class="pp-pln">/index.json.ittf</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="unknown"> wfjob/lib</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="unknown"> wfjob/examples</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="unknown"> wfjob/root</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="unknown"> wfjob/tests</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">production</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">dest-folder</span><span class="pp-kwd"> ${</span><span class="pp-expr">dest_folder</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">line-ref</span><span class="pp-pln"> ittf-lib</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">line-ref</span><span class="pp-pln"> ittf-root</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">line-ref</span><span class="pp-pln"> ittf-examples</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">line-ref</span><span class="pp-pln"> ittf-tests</span></div></pre>
                        </div>
                    </div>
                    <div id="frag-modal" class="modal">
                        <div id="frag-modal-content" class="modal-content">
                            <span class="modal-close">&times;</span>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </main>
    <script src="../jquery-3.2.1.js"></script>
    <script src="../wizzifactory.js"></script>
</body>

</html>
