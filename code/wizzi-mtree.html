<!doctype html>
<html VERSION-5="5" VERSION-4="4" version="5">
    <head>
        <title>The Wizzi Factory</title>
        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
        <link href="../normalize.css" rel="stylesheet">
        <link href="../wizzifactory.css" rel="stylesheet">
        <link href="styles.css" rel="stylesheet">
    </head>
    <body>
        <div class="site">
            <header class="navigation">
                <div class="container navigation__inner">
                    <div class="logo">
                        <span class="logo-w">W</span>
                        <span class="logo-i1">i</span>
                        <span class="logo-z1">z</span>
                        <span class="logo-z2">z</span>
                        <span class="logo-i2">i</span>
                        <span>&nbsp;</span>
                        <span class="logo-f">f</span>
                        <span class="logo-a">a</span>
                        <span class="logo-c">c</span>
                        <span class="logo-t">t</span>
                        <span class="logo-o">o</span>
                        <span class="logo-r">r</span>
                        <span class="logo-y">y</span>
                    </div>
                    <nav class="navigation__links">
                        <a title="code concepts" href="../concepts.html" class="navigation__link">Concepts</a>
                        <a title="code docs" href="../docs.html" class="navigation__link">Docs</a>
                        <a title="code api" href="../api.html" class="navigation__link">Api</a>
                        <a title="code code" href="../code/wizzi.html" class="navigation__link navigation__link--active">Code</a>
                        <a title="code starters" href="../starters.html" class="navigation__link">Starters</a>
                        <a title="code project" href="../project.html" class="navigation__link">Project</a>
                    </nav>
                    <div class="navigation__search">
                        <span class="algolia-autocomplete" style="position: relative; display: inline-block; direction: ltr;">
                            <input type="text" class="navigation__search-input ds-input" placeholder="Search documentationâ€¦" autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0" dir="auto" style="position: relative; vertical-align: top;">
                            <pre aria-hidden="true" style="position: absolute; visibility: hidden; white-space: pre; font-family: Arial; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; word-spacing: 0px; letter-spacing: normal; text-indent: 7px; text-rendering: auto; text-transform: none;"></pre>
                            <span class="ds-dropdown-menu" role="listbox" id="algolia-autocomplete-listbox-0" style="position: absolute; top: 100%; z-index: 100; display: none; left: 0px; right: auto;">
                                <div class="ds-dataset-1"></div>
                            </span>
                        </span>
                        <button class="navigation__search-icon icon-search"></button>
                        <button class="navigation__search-icon icon-cross"></button>
                    </div>
                    <a href="https://github.com/wizzifactory" target="_blank" class="navigation__icon" title="GitHub Repository"><i class="sidecar__icon icon-github"></i>
                    </a>
                    <a href="https://stackoverflow.com/questions/tagged/wizzifactory" target="_blank" class="navigation__icon" title="See Questions on Stack Overflow"><i class="sidecar__icon icon-stackoverflow"></i>
                    </a>
                    <a href="#" target="_blank" class="navigation__icon" title="Follow on twitter"><i class="sidecar__icon icon-twitter"></i>
                    </a>
                    <a href="#" target="_blank" class="navigation__icon" title="Follow on facebook"><i class="sidecar__icon icon-facebook"></i>
                    </a>
                </div>
                <div class="navigation__bottom">
                    <div class="container navigation__inner">
                        <a class="navigation__child" title="intro ittf source code" href="intro.html">intro</a>
                        <a class="navigation__child" title="wizzi ittf source code" href="wizzi.html">wizzi</a>
                        <a class="navigation__child navigation__child--active" title="wizzi-mtree ittf source code" href="wizzi-mtree.html">mtree</a>
                        <a class="navigation__child" title="wizzi-repo ittf source code" href="wizzi-repo.html">repo</a>
                        <a class="navigation__child" title="wizzi-mongodb ittf source code" href="wizzi-mongodb.html">mongodb</a>
                        <a class="navigation__child" title="wizzi-utils ittf source code" href="wizzi-utils.html">utils</a>
                        <a class="navigation__child" title="wizzi-core ittf source code" href="wizzi-core.html">core</a>
                        <a class="navigation__child" title="wizzi-meta ittf source code" href="wizzi-meta.html">meta</a>
                        <a class="navigation__child" title="wizzi-docs ittf source code" href="wizzi-docs.html">docs</a>
                        <a class="navigation__child" title="v3-docs ittf source code" href="v3-docs.html">v3-docs</a>
                        <a class="navigation__child" title="wizzi-demo ittf source code" href="wizzi-demo.html">demo</a>
                    </div>
                </div>
            </header>
            <main id="main-content">
                <nav class="main-sidebar-left" style="max-height: 648px; position: fixed; top: 90px; width: 280px;">
                    <img src="../workinprogress.jpg">
                    <section id="main-toc" class="toc">
                        <h3>wizzi-mtree ittf source code:</h3>
                        <div class="treeview">
                            <ul>
                                <li><input type="checkbox" checked id="f2">
                                <span></span>
                                <label for="f2">v3-wizzi-mtree</label>
                                <ul>
                                    <li><input type="checkbox" checked id="f3">
                                    <span></span>
                                    <label for="f3">ittf</label>
                                    <ul>
                                        <li><input type="checkbox" id="f4">
                                        <span></span>
                                        <label for="f4">examples</label>
                                        <ul>
                                            <li><input type="checkbox" id="f5">
                                            <span></span>
                                            <label for="f5">jswizzi</label>
                                            <ul>
                                                <li><input type="checkbox" id="f6">
                                                <span></span>
                                                <label for="f6">ittf__copy</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f7">
                                                    <span></span>
                                                    <label for="f7">t</label>
                                                    <ul>
                                                        <li><input type="checkbox" id="f8">
                                                        <span></span>
                                                        <label for="f8">gwmc</label>
                                                        <ul>
                                                            <li><a href="#d1">footer.tests.ittf</a>
                                                            </li>
                                                            <li><a href="#d2">layout.tests.ittf</a>
                                                            </li>
                                                        </ul>
                                                        </li>
                                                        <li><a href="#d3">item.tests.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><a href="#d4">global_when_mixing_container.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d5">global.tests.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d6">global_when_mixing_container.js.ittf</a>
                                                </li>
                                                <li><a href="#d7">global.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f9">
                                            <span></span>
                                            <label for="f9">t</label>
                                            <ul>
                                                <li><a href="#d8">example.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d9">index.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f10">
                                        <span></span>
                                        <label for="f10">lib</label>
                                        <ul>
                                            <li><input type="checkbox" id="f11">
                                            <span></span>
                                            <label for="f11">basicloader</label>
                                            <ul>
                                                <li><a href="#d10">file.js.ittf</a>
                                                </li>
                                                <li><a href="#d11">index.js.ittf</a>
                                                </li>
                                                <li><a href="#d12">liner.js.ittf</a>
                                                </li>
                                                <li><a href="#d13">mTree.js.ittf</a>
                                                </li>
                                                <li><a href="#d14">nodifier.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f12">
                                            <span></span>
                                            <label for="f12">esprima</label>
                                            <ul>
                                                <li><input type="checkbox" id="f13">
                                                <span></span>
                                                <label for="f13">functions</label>
                                                <ul>
                                                    <li><a href="#d15">dateUtil.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d16">underscore.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d17">verify.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><input type="checkbox" id="f14">
                                                <span></span>
                                                <label for="f14">t</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f15">
                                                    <span></span>
                                                    <label for="f15">jsWizziContext</label>
                                                    <ul>
                                                        <li><a href="#d18">getset_value.ittf</a>
                                                        </li>
                                                        <li><a href="#d19">set_context.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><input type="checkbox" id="f16">
                                                    <span></span>
                                                    <label for="f16">jsWizziRunner</label>
                                                    <ul>
                                                        <li><a href="#d20">expressions.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d21">for.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d22">functions.js.ittf</a>
                                                        </li>
                                                        <li><a href="#d23">statements.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><a href="#d24">checked_run_set.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d25">checked_run.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d26">runner.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d27">contextData.js.ittf</a>
                                                </li>
                                                <li><a href="#d28">errors.js.ittf</a>
                                                </li>
                                                <li><a href="#d29">jsWizziContext.js.ittf</a>
                                                </li>
                                                <li><a href="#d30">jsWizziEvalHelper.js.ittf</a>
                                                </li>
                                                <li><a href="#d31">jsWizziRunner.js.ittf</a>
                                                </li>
                                                <li><a href="#d32">jsWizziScriptCoder.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f17">
                                            <span></span>
                                            <label for="f17">loader</label>
                                            <ul>
                                                <li><input type="checkbox" id="f18">
                                                <span></span>
                                                <label for="f18">buildup</label>
                                                <ul>
                                                    <li><a href="#d33">scripter.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><input type="checkbox" id="f19">
                                                <span></span>
                                                <label for="f19">t</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f20">
                                                    <span></span>
                                                    <label for="f20">ittfDocumentFinder</label>
                                                    <ul>
                                                        <li><a href="#d34">recurserTFolder.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><input type="checkbox" id="f21">
                                                    <span></span>
                                                    <label for="f21">mTree</label>
                                                    <ul>
                                                        <li><a href="#d35">getParamValues.js.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d36">appender.js.ittf</a>
                                                </li>
                                                <li><a href="#d37">evaluator.js.ittf</a>
                                                </li>
                                                <li><a href="#d38">includer.js.ittf</a>
                                                </li>
                                                <li><a href="#d39">index.js.ittf</a>
                                                </li>
                                                <li><a href="#d40">ittfDocumentFinder.js.ittf</a>
                                                </li>
                                                <li><a href="#d41">ittfInterpolate.js.ittf</a>
                                                </li>
                                                <li><a href="#d42">liner.js.ittf</a>
                                                </li>
                                                <li><a href="#d43">loadContext.js.ittf</a>
                                                </li>
                                                <li><a href="#d44">mixer.js.ittf</a>
                                                </li>
                                                <li><a href="#d45">mTree.js.ittf</a>
                                                </li>
                                                <li><a href="#d46">mtreeProvider.js.ittf</a>
                                                </li>
                                                <li><a href="#d47">nodifier.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f22">
                                            <span></span>
                                            <label for="f22">util</label>
                                            <ul>
                                                <li><a href="#d48">node.js.ittf</a>
                                                </li>
                                                <li><a href="#d49">types.js.ittf</a>
                                                </li>
                                                <li><a href="#d50">verify.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d51">errors.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f23">
                                        <span></span>
                                        <label for="f23">root</label>
                                        <ul>
                                            <li><a href="#d52">index.js.ittf</a>
                                            </li>
                                            <li><a href="#d53">package.json.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f24">
                                        <span></span>
                                        <label for="f24">t</label>
                                        <ul>
                                            <li><input type="checkbox" id="f25">
                                            <span></span>
                                            <label for="f25">mocks</label>
                                            <ul>
                                                <li><a href="#d54">errors.js.ittf</a>
                                                </li>
                                                <li><a href="#d55">fileSystemStore.js.ittf</a>
                                                </li>
                                                <li><a href="#d56">ittfDocumentStore.js.ittf</a>
                                                </li>
                                                <li><a href="#d57">uriparser.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d58">checked_call_return_set.js.ittf</a>
                                            </li>
                                            <li><a href="#d59">checked_call_return.js.ittf</a>
                                            </li>
                                            <li><a href="#d60">checked_call.js.ittf</a>
                                            </li>
                                            <li><a href="#d61">error.js.ittf</a>
                                            </li>
                                            <li><a href="#d62">f_cb_no_err.js.ittf</a>
                                            </li>
                                            <li><a href="#d63">f_cb_throw.js.ittf</a>
                                            </li>
                                            <li><a href="#d64">f_cb.js.ittf</a>
                                            </li>
                                            <li><a href="#d65">r_cb_error.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f26">
                                        <span></span>
                                        <label for="f26">tests</label>
                                        <ul>
                                            <li><input type="checkbox" id="f27">
                                            <span></span>
                                            <label for="f27">basicloader</label>
                                            <ul>
                                                <li><input type="checkbox" id="f28">
                                                <span></span>
                                                <label for="f28">data</label>
                                                <ul>
                                                    <li><a href="#d66">doc1.tests.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d67">index.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f29">
                                            <span></span>
                                            <label for="f29">esprima</label>
                                            <ul>
                                                <li><a href="#d68">contextData.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f30">
                                            <span></span>
                                            <label for="f30">loader</label>
                                            <ul>
                                                <li><input type="checkbox" id="f31">
                                                <span></span>
                                                <label for="f31">mocks</label>
                                                <ul>
                                                    <li><a href="#d69">errors.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d70">fileSystemStore.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d71">ittfDocumentStore.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d72">misc.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d73">mTreeLoader.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d74">uriparser.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><input type="checkbox" id="f32">
                                                <span></span>
                                                <label for="f32">repo</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f33">
                                                    <span></span>
                                                    <label for="f33">data</label>
                                                    <ul>
                                                        <li><input type="checkbox" id="f34">
                                                        <span></span>
                                                        <label for="f34">t</label>
                                                        <ul>
                                                            <li><a href="#d75">frag1.tests.ittf</a>
                                                            </li>
                                                            <li><a href="#d76">frag2.tests.ittf</a>
                                                            </li>
                                                            <li><a href="#d77">ittf_object_args_item.tests.ittf</a>
                                                            </li>
                                                            <li><a href="#d78">mixin_1.tests.ittf</a>
                                                            </li>
                                                            <li><a href="#d79">mixin_2_appender.tests.ittf</a>
                                                            </li>
                                                            <li><a href="#d80">mixin_2_evaluator.tests.ittf</a>
                                                            </li>
                                                            <li><a href="#d81">mixin_3_evaluator.tests.ittf</a>
                                                            </li>
                                                        </ul>
                                                        </li>
                                                        <li><a href="#d82">appender_1.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d83">doc1.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d84">evaluator_1.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d85">evaluator_2.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d86">evaluator_3.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d87">evaluator_4.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d88">evaluator_5.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d89">function_1.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d90">function_2.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d91">function_3.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d92">ittf_object_args.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d93">liner_1.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d94">mixer_1.tests.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d95">appender.js.ittf</a>
                                                </li>
                                                <li><a href="#d96">evaluator.js.ittf</a>
                                                </li>
                                                <li><a href="#d97">function.js.ittf</a>
                                                </li>
                                                <li><a href="#d98">index.js.ittf</a>
                                                </li>
                                                <li><a href="#d99">ittfInterpolate.js.ittf</a>
                                                </li>
                                                <li><a href="#d100">ittfModelProvider.js.ittf</a>
                                                </li>
                                                <li><a href="#d101">liner.js.ittf</a>
                                                </li>
                                                <li><a href="#d102">loadContext.js.ittf</a>
                                                </li>
                                                <li><a href="#d103">mixer.js.ittf</a>
                                                </li>
                                                <li><a href="#d104">nodifier.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f35">
                                            <span></span>
                                            <label for="f35">t</label>
                                            <ul>
                                                <li><a href="#d105">async.js.ittf</a>
                                                </li>
                                                <li><a href="#d106">expect_throw_error.js.ittf</a>
                                                </li>
                                                <li><a href="#d107">f_cb_done.js.ittf</a>
                                                </li>
                                                <li><a href="#d108">f_cb_no_err.js.ittf</a>
                                                </li>
                                                <li><a href="#d109">f_cb_test.js.ittf</a>
                                                </li>
                                                <li><a href="#d110">itasync.js.ittf</a>
                                                </li>
                                                <li><a href="#d111">tobe_array.js.ittf</a>
                                                </li>
                                                <li><a href="#d112">tobe_false.js.ittf</a>
                                                </li>
                                                <li><a href="#d113">tobe_number.js.ittf</a>
                                                </li>
                                                <li><a href="#d114">tobe_object_len.js.ittf</a>
                                                </li>
                                                <li><a href="#d115">tobe_object.js.ittf</a>
                                                </li>
                                                <li><a href="#d116">tobe_string_value.js.ittf</a>
                                                </li>
                                                <li><a href="#d117">tobe_string.js.ittf</a>
                                                </li>
                                                <li><a href="#d118">tobe_true.js.ittf</a>
                                                </li>
                                                <li><a href="#d119">tobe_undefined.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f36">
                                            <span></span>
                                            <label for="f36">util</label>
                                            <ul>
                                                <li><a href="#d120">fail.js.ittf</a>
                                                </li>
                                                <li><a href="#d121">file.js.ittf</a>
                                                </li>
                                                <li><a href="#d122">verify.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d123">errors.js.ittf</a>
                                            </li>
                                            <li><a href="#d124">option.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                    </ul>
                                    </li>
                                    <li><a href="#d125">generate.wfjob.ittf</a>
                                    </li>
                                </ul>
                                </li>
                            </ul>
                        </div>
                    </section>
                </nav>
                <div class="main-content">
                    <div style="margin-bottom: 20px;" id="d1">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/examples/jswizzi/ittf__copy/t/gwmc/footer.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">bottom</span></li><li class="L2"><span class="pnl">    </span><span class="tag">beta</span><span class="kwd"> ${</span><span class="expr">gname</span><span class="kwd">}</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d2">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/examples/jswizzi/ittf__copy/t/gwmc/layout.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">top</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name</span></li><li class="L3"><span class="pnl">    </span><span class="kwd">$global</span></li><li class="L4"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> gname = name;</span></li><li class="L5"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d1">footer(</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d3">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/examples/jswizzi/ittf__copy/t/item.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="tag">container</span></li><li class="L3"><span class="pnl">        </span><span class="kwd">$global</span></li><li class="L4"><span class="pnl">            </span><span class="tag">gcount++;</span></li><li class="L5"><span class="pnl">        </span><span class="tag">item</span><span class="kwd"> ${</span><span class="expr">gcount</span><span class="kwd">}</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d4">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/examples/jswizzi/ittf__copy/global_when_mixing_container.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="d2">gwmc/layout(</span><span class="arg"> alfa </span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d5">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/examples/jswizzi/ittf__copy/global.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">tests</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$global</span></li><li class="L3"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> gcount = 0;</span></li><li class="L4"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d3">item(</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d6">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/examples/jswizzi/global_when_mixing_container.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="d8">example(</span><span class="arg"> global_when_mixing_container </span><span class="mix">)</span></li><li class="L2"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> result</span></li><li class="L3"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> util.inspect</span></li><li class="L4"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> evaluatedModel</span></li><li class="L5"><span class="pnl">            </span><span class="tag">{</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> depth null</span></li><li class="L7"><span class="pnl">    </span><span class="tag">log</span><span class="pln"> 'global_when_mixing_container result', result</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d7">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/examples/jswizzi/global.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="d8">example(</span><span class="arg"> global </span><span class="mix">)</span></li><li class="L2"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> result</span></li><li class="L3"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> util.inspect</span></li><li class="L4"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> evaluatedModel</span></li><li class="L5"><span class="pnl">            </span><span class="tag">{</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> depth null</span></li><li class="L7"><span class="pnl">    </span><span class="tag">log</span><span class="pln"> '$global result', result</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d8">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/examples/t/example.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name</span></li><li class="L3"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L4"><span class="pnl">    </span><span class="tag">+</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L6"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L7"><span class="pnl">    </span><span class="tag">+</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> file = require('../../tests/util/file')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mocks = require('../../tests/loader/mocks/misc')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mTreeLoader = require('../../tests/loader/mocks/mTreeLoader')</span></li><li class="L1"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L2"><span class="pnl">        </span><span class="tag">function</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span></li><li class="L4"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> store</span></li><li class="L5"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> evaluatedModel</span></li><li class="L6"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 1</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> store = new mocks.IttfDocumentStore()</span></li><li class="L8"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 2</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> store.init</span></li><li class="L0"><span class="pnl">                </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> storeKind 'filesystem'</span></li><li class="L2"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d63">f_cb_throw(</span><span class="arg"> notUsed </span><span class="mix">)</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">log</span><span class="pln"> 3</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> ittfPath</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'ittf'</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> '</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">.tests.ittf'</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">log</span><span class="pln"> 4</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> mTreeLoader</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> store</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ittfPath</span></li><li class="L3"><span class="pnl">                        </span><span class="mix frag-to-link-a" data-frag-id="d63">f_cb_throw(</span><span class="arg"> result </span><span class="mix">)</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">log</span><span class="pln"> 5, result</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> evaluatedModel = result</span></li><li class="L6"><span class="pnl">                            </span><span class="kwd">$hook</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> file.write</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L9"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L0"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> 'outputs'</span></li><li class="L1"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> '</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">.tests.ittf'</span></li><li class="L2"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> evaluatedModel.toIttf()</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d9">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/examples/index.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> t = require('./jswizzi/global')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> t()</span></li><li class="L5"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> t = require('./jswizzi/global_when_mixing_container');</span></li><li class="L6"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> t()</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d10">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/basicloader/file.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> fs = require('fs')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> path = require('path')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> iconv = require('iconv-lite')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> md</span></li><li class="L7"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> module.exports =</span></li><li class="L8"><span class="pnl">            </span><span class="tag">{</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> pathSeparatorRe = /[\/\\]/g</span></li><li class="L0"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.defaultEncoding = 'utf8'</span></li><li class="L1"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.preserveBOM = false</span></li><li class="L2"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> win32 = process.platform === 'win32'</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.unixifyPath =</span></li><li class="L4"><span class="pnl">        </span><span class="tag">function</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> path_string</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> win32</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> path_string.replace(/\\/g, '/')</span></li><li class="L8"><span class="pnl">            </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> path_string</span></li><li class="L0"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> sync read</span></li><li class="L1"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.read</span></li><li class="L2"><span class="pnl">        </span><span class="tag">function</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> path_string</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> options</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !(options)</span></li><li class="L6"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> options =</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> contents = fs.readFileSync(String(path_string))</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> options.encoding !== null</span></li><li class="L0"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> contents = iconv.decode(contents, (options.encoding || md.defaultEncoding))</span></li><li class="L1"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> !md.preserveBOM && contents.charCodeAt(0) === 0xFEFF</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> contents = contents.substring(1)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> contents</span></li><li class="L4"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> sync readJSON</span></li><li class="L5"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.readJSON</span></li><li class="L6"><span class="pnl">        </span><span class="tag">function</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> path_string</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> options</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> src = md.read(path_string, options)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> result</span></li><li class="L1"><span class="pnl">            </span><span class="tag">try</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> result = JSON.parse(src)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> result</span></li><li class="L4"><span class="pnl">            </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L5"><span class="pnl">                </span><span class="tag">throw</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">new</span><span class="pln"> errors.FileError</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Unable to parse "' + path_string + '" file (' + ex.message + ').'</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ex</span></li><li class="L9"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> async read</span></li><li class="L0"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.readFile</span></li><li class="L1"><span class="pnl">        </span><span class="tag">function</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> path_string</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> fs.readFile</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> path_string</span></li><li class="L6"><span class="pnl">                </span><span class="tag">function</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> data</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> err</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> callback(err)</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> callback(null, data)</span></li><li class="L2"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.write</span></li><li class="L3"><span class="pnl">        </span><span class="tag">function</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> path_string</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> contents</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> options</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !options</span></li><li class="L8"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> options =</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> md.mkpath(path_string)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">try</span></li><li class="L2"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> !Buffer.isBuffer(contents)</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> contents = iconv.encode(contents, (options.encoding || md.defaultEncoding))</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> fs.writeFileSync(path_string, contents)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L6"><span class="pnl">            </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L7"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ex.message = 'Writing file ' + path_string + '.\n' + ex.message</span></li><li class="L8"><span class="pnl">                </span><span class="tag">throw</span><span class="pln"> ex</span></li><li class="L9"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.writeJSON</span></li><li class="L0"><span class="pnl">        </span><span class="tag">function</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> path_string</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> contentObject</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> md.write</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> path_string</span></li><li class="L5"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> JSON.stringify(contentObject, null, 2)</span></li><li class="L6"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.mkpath</span></li><li class="L7"><span class="pnl">        </span><span class="tag">function</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> path_string</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> dir = path.dirname(path_string)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> md.mkdir(dir)</span></li><li class="L1"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.mkdir</span></li><li class="L2"><span class="pnl">        </span><span class="tag">function</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> dirpath</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> mode</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> mode == null</span></li><li class="L6"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> mode = parseInt('0777', 8) & ~ (process.umask())</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> dirpath.split(pathSeparatorRe)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">._</span><span class="pln"> reduce</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">function</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> parts</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> part</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> parts += part + '/'</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> subpath = path.resolve(parts)</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> !md.exists(subpath)</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">try</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> fs.mkdirSync(subpath, mode)</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">throw</span></li><li class="L9"><span class="pnl">                                    </span><span class="tag">new</span><span class="pln"> errors.FileError</span></li><li class="L0"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> 'Unable to create directory "' + subpath + '" (Error code: ' + ex.code + ').'</span></li><li class="L1"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> ex</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> parts</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ''</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d11">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/basicloader/index.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">#</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> This basic loader is for testing plugins.</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> The loadMTree function loads an mTree from a</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> single IttfDocument without include, mix, append and evaluate.</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Does not require a requestContext.</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> The IttfDocument must be stored in the</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> filesystem (mongodb and localstorage store kinds</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> are not supported).</span></li><li class="L1"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L2"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> path = require('path')</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> file = require('./file')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> liner = require('./liner')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> nodifier = require('./nodifier')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> MTree = require('./mTree').MTree</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> md</span></li><li class="L8"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> module.exports =</span></li><li class="L9"><span class="pnl">            </span><span class="tag">{</span></li><li class="L0"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.loadMTree</span></li><li class="L1"><span class="pnl">        </span><span class="tag">function</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> primaryIttfDocumentUri</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> notUsed</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> typeof(callback) !== 'function'</span></li><li class="L6"><span class="pnl">                </span><span class="tag">throw</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">new</span><span class="pln"> Error("wizzi-mtree/lib/basicloader/loadMTree. A callback is required. Uri: " + primaryIttfDocumentUri)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> sourceText</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> file.read</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> primaryIttfDocumentUri</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> mTree = new MTree(primaryIttfDocumentUri)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> mTree.load</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> sourceText</span></li><li class="L4"><span class="pnl">                </span><span class="tag">{</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> sourceKey 's1'</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> nodes = mTree.nodes</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> mTree.nodes = []</span></li><li class="L8"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> item in nodes</span></li><li class="L9"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> final_node = _to_final_mtree(null, item)</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> mTree.nodes.push</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> final_node</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L6"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> _to_final_mtree</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> parent</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L9"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> final_node</span></li><li class="L0"><span class="pnl">            </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> parent parent</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> childs []</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> n node.name</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> v node.value</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> r node.row</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> c node.col</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> s node.modelKey</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> u node.sourceKey</span></li><li class="L9"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> item in node.childs</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> final_node_child = _to_final_mtree(final_node, item)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> final_node.childs.push</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> final_node_child</span></li><li class="L3"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> final_node</span></li><li class="L4"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> error</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L6"><span class="pnl">        </span><span class="tag">return</span></li><li class="L7"><span class="pnl">            </span><span class="tag">{</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> __is_error true</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> operation 'wizzi-mtree/lib/basicloader/index'</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> message message</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d12">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/basicloader/liner.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">#</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Reads an IttfDocument and extract an array of line descriptions</span></li><li class="L6"><span class="pnl">    </span><span class="tag">#</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Input</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> param textContent:String - The text content of the IttfDocument</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> param ittfDocumentData:Object {</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> sourceKey:String - The IttfDocument key generated by the loadContext</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L2"><span class="pnl">    </span><span class="tag">#</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Output</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> lines:Array of</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> line : {</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> indent: Number,</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> name: String,</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> value: String, // always trimmed</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> row: Number,</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> col: Number,</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> sourceKey: String,</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> tagSuffix: undefined || '(',</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> hasMacro: Boolean</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L5"><span class="pnl">    </span><span class="tag">#</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Ittf commands for comments</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $ and $ ... singleline comment</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $ and * ... * and $ multiline comment</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Comment states</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 0 = no comment seen</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 1 = seen char $ could be first char of comment</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 2 = seen chars $ and * we are inside multiline comments</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 3 = seen chars $ and * ... and *  could be first char of end of multiline comments</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 21 = seen chars $ and $ we are inside singleline comment</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Es6 macro states</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 0 = no macro seen</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 1 = seen char ` we are inside macro</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 2 = seen escape char inside a macro, the next ` char does not close the macro string</span></li><li class="L9"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L0"><span class="pnl">        </span><span class="tag">function</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> textContent</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfDocumentData</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span></li><li class="L4"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> sourceKey = ittfDocumentData.sourceKey</span></li><li class="L5"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> lines</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">[</span></li><li class="L7"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> leadingWhiteSpaces = 0</span></li><li class="L8"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> line = null</span></li><li class="L9"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> linepos = 1</span></li><li class="L0"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> lineHasMacro = false</span></li><li class="L1"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> colpos = 0</span></li><li class="L2"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> commentState = 0</span></li><li class="L3"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> macroState = 0</span></li><li class="L4"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> quote = null</span></li><li class="L5"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> TODO ensure textContent is red as utf-8 and avoid this</span></li><li class="L6"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> chunk = textContent.toString('utf-8')</span></li><li class="L7"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> ch</span></li><li class="L8"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> chUni</span></li><li class="L9"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> i</span></li><li class="L0"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> l = chunk.length</span></li><li class="L1"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> TODO replace ch with chUni</span></li><li class="L2"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> i = 0; i &lt; l; i++</span></li><li class="L3"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ch = chunk[i]</span></li><li class="L4"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> chUni = chunk.charCodeAt(i)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> colpos++</span></li><li class="L6"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> quote != null</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> quote == ch</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> quote = null</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> processMacro(ch)</span></li><li class="L0"><span class="pnl">                </span><span class="tag">else</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> commentState == 2</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> ch == '*'</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> could be start of end of comment</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> commentState = 3</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> skip comment char</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> ch == '\n'</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> linepos++</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> colpos = 0</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 21</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> ch == '\n'</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> end of line comment</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> delegate end of comment to processMacro</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> processMacro(ch)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 3</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> ch == '$'</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> ok, really is end of comment</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> commentState = 0</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> no, comments continue</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> commentState = 2</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> check if it is eol</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> ch == '\n'</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> linepos++</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> colpos = 0</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 1 && ch == '*'</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> ok, really is start of comment</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> commentState = 2</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 1 && ch == '$'</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> ok, is a line comment</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> commentState = 21</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 1 && ch != '*'</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> no, it was not a comment, reset</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> commentState = 0</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> processMacro('$')</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> processMacro(ch)</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 0 && ch == '"'</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> start of literal</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> quote = ch</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> processMacro(ch)</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 0 && ch == "'"</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> start of literal</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> quote = ch</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> processMacro(ch)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 0 && ch == '$'</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> could be start of comment</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> commentState = 1</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> processMacro(ch)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> line</span></li><li class="L1"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> typeof (line.value) !== 'undefined'</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> line.value = line.value.trim()</span></li><li class="L3"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> line.hasMacro = lineHasMacro</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> lines.push(line)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> lineHasMacro = false</span></li><li class="L6"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> lines</span></li><li class="L7"><span class="pnl">            </span><span class="tag">function</span><span class="pln"> processMacro</span></li><li class="L8"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> ch</span></li><li class="L9"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> macroState == 2</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> remove escape state</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> macroState = 1</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> log 'macroState', macroState, ch</span></li><li class="L3"><span class="pnl">                </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> chUni == 96</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> macroState &gt; 0</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> macroState = 0</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> log 'macroState', macroState, ch</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> macroState = 1</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> log 'macroState', macroState, ch</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> macroState == 1</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> ch == '$'</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> ch = '#'</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> lineHasMacro = true</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> log 'macroState', macroState, ch</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">elif</span><span class="pln"> ch == '\\'</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> could be an escape of a macro inside a macro</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> macroState = 2</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> log 'macroState', macroState, ch</span></li><li class="L1"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> processChar(ch)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">function</span><span class="pln"> processChar</span></li><li class="L3"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> ch</span></li><li class="L4"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> ch == '\n'</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> line</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> typeof (line.value) !== 'undefined'</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.value = line.value.trim()</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> line.hasMacro = lineHasMacro</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> lines.push(line)</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> line = null</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> lineHasMacro = false</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> Allow blank line. Do nothing</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> leadingWhiteSpaces = 0</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> colpos = 0</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> linepos++</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> commentState != 2</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> commentState = 0</span></li><li class="L9"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> ch == '\r'</span></li><li class="L0"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> [' ', '\t'].indexOf(ch) !== -1</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> ch == '\t'</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> colpos += 3</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> line</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> typeof (line.value) == 'undefined'</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.value = ''</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.value += ch</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> leadingWhiteSpaces += ch == ' ' ? 1 : 4</span></li><li class="L0"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> ['('].indexOf(ch) !== -1</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> line</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> typeof (line.value) == 'undefined'</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.tagSuffix = ch</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.value = ''</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.value += ch</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> line =</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">{</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> indent leadingWhiteSpaces / 4</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> name ch</span></li><li class="L2"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> row linepos</span></li><li class="L3"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> col colpos</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> sourceKey sourceKey</span></li><li class="L5"><span class="pnl">                </span><span class="tag">else</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> line</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> typeof(line.value) == 'undefined'</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.name += ch</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.value += ch</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> line =</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">{</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> indent leadingWhiteSpaces / 4</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> name ch</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> row linepos</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> col colpos</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> sourceKey sourceKey</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d13">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/basicloader/mTree.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> liner = require('./liner')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> nodifier = require('./nodifier')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">wz-class</span><span class="pln"> MTree</span></li><li class="L6"><span class="pnl">        </span><span class="tag">ctor</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> uri</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.uri = uri</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.nodes = null</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.nodeCount = 0</span></li><li class="L1"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> load</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfSourceTextContent</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfDocumentData</span></li><li class="L4"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> typeof(ittfSourceTextContent) !== 'string'</span></li><li class="L5"><span class="pnl">                </span><span class="tag">throw</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">new</span><span class="pln"> TypeError('ittfSourceTextContent must be a string')</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !ittfDocumentData || typeof(ittfDocumentData.sourceKey) !== 'string'</span></li><li class="L8"><span class="pnl">                </span><span class="tag">throw</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">new</span><span class="pln"> TypeError('ittfDocumentData.sourceKey must be a string')</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> lines</span><span class="mix">)</span></li><li class="L1"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> liner(ittfSourceTextContent, ittfDocumentData)</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> nodes</span><span class="mix">)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> nodifier(lines, this)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.nodes = nodes</span></li><li class="L5"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getNewNodeId</span></li><li class="L6"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ++this.nodeCount</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d14">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/basicloader/nodifier.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">#</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Nodify the lines of an IttfDocument and creates a</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> tree structure object based on line indentation.</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> . detects the $params command</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> . implements line continuation</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> . assigns an id to each node</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> !!! A line object is transformed in place into a node object</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> without recreation (no cloning) !!!</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Inputs</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> - the lines produced by the liner</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Outputs</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> nodes: Array of [</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> line -&gt; mTreeNode : {</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> + parent: Object, // parent mTreeNode</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> + model: Object, // the MTree to which the line belongs</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> + childs: Array, // the children mTreeNodes</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> id: Number,</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> indent: Number,</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> name: String,</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> value: String,</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> row: Number,</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> col: Number,</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> sourceKey: String,</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> tagSuffix: undefined || '('</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> hasMacro: Boolean</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> ]</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Ittf commands:</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $params  // the param values are stored in the MTree</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> \        // implements line continuation</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> //   the value is appendend to the value of the parent line</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> //   without separators</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> \b       // implements line continuation</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> //   the value is appendend to the value of the parent line</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> //   with a space separator:  prevLine,value += ' ' + currentLine.value</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> \n       // implements line continuation</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> //   the value is appendend to the value of the parent line</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> //   with a line break separator:  prevLine,value += '\n' + currentLine.value</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span></li><li class="L5"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L6"><span class="pnl">        </span><span class="tag">function</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> lines</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> mTree</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span></li><li class="L0"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> nodes</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">[</span></li><li class="L2"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> root = null</span></li><li class="L3"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> current = null</span></li><li class="L4"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> nameFirstChar = null</span></li><li class="L5"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> nameLength = 0</span></li><li class="L6"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> line</span></li><li class="L7"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> i</span></li><li class="L8"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> l = lines.length</span></li><li class="L9"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var i = 0; i &lt; l; i++</span></li><li class="L0"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> line = lines[i]</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> nameFirstChar = line.name[0]</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> nameLength = line.name.length</span></li><li class="L3"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> line.id = mTree.getNewNodeId()</span></li><li class="L4"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> line.model = mTree</span></li><li class="L5"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> line.indent == 0 && current == null</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> line.parent = null</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> nodes.push(line)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> current == null</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">return</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'Malformed tree, root node cannot have an indent.'</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> line</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L4"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> line.indent == current.indent</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> typeof(current.parent) === 'undefined' || current.parent === null</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> 'Malformed tree, only one root note allowed.'</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> line</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> line.parent = current.parent</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> current.parent.childs.push(line)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> line.indent &gt; current.indent</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> nameFirstChar == '$' && line.name === '$params'</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> current.indent &gt; 0</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> 'The $params node must be a child of the root node.'</span></li><li class="L9"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> line</span></li><li class="L0"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> current.model.$params = line.value</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">continue</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> nameFirstChar == '\\' && nameLength == 1</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> value continuation on new line</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> current.value += line.value</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">continue</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> nameFirstChar == '\\' && line.name === '\\b'</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> value continuation on new line with space</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> current.value += (' ' + line.value)</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">continue</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> nameFirstChar == '\\' && line.name === '\\n'</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> value continuation on new line with line break</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> current.value += ('\n' + line.value)</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">continue</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> line.parent = current</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> current.childs.push(line)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> line.indent &lt; current.indent</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> parent = current.parent</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">while</span><span class="pln"> parent != null && line.indent &lt; parent.indent</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> parent = parent.parent</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> line.parent = parent.parent</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> parent.parent</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> parent.parent.childs.push(line)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> 'Malformed tree, only one root note allowed.'</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> line</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> current = line</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> current.childs = []</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> nodes</span></li><li class="L4"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> error</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> line</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> mTree</span></li><li class="L8"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> message = message +</span></li><li class="L9"><span class="pnl">            </span><span class="tag">\b</span><span class="pln"> '\nNode ' +</span></li><li class="L0"><span class="pnl">            </span><span class="tag">\b</span><span class="pln"> line.name + ' ' + (line.value || '') +</span></li><li class="L1"><span class="pnl">            </span><span class="tag">\b</span><span class="pln"> ' row: ' + line.row + ' col: ' + line.col +</span></li><li class="L2"><span class="pnl">            </span><span class="tag">\b</span><span class="pln"> '.\n Filepath: ' + mTree.uri</span></li><li class="L3"><span class="pnl">        </span><span class="tag">return</span></li><li class="L4"><span class="pnl">            </span><span class="tag">{</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> __is_error true</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> message message</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> source 'wizzi-mtree/lib/loader/nodifier'</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d15">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/functions/dateUtil.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L4"><span class="pnl">        </span><span class="tag">{</span></li><li class="L5"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> now_GMYHMS</span></li><li class="L6"><span class="pnl">                </span><span class="tag">function</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> date = new Date()</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">+</span><span class="pln"> return date.getDate() + '/' +</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">+</span><span class="pln"> (date.getMonth() + 1) + '/' +</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">+</span><span class="pln"> date.getFullYear() + ':' +</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">+</span><span class="pln"> date.getHours() + ':' +</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">+</span><span class="pln"> date.getMinutes() + ':' +</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">+</span><span class="pln"> date.getSeconds();</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d16">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/functions/underscore.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> verify = require('../../util/verify')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> inflect = require('i')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> String.prototype.capitalize =</span></li><li class="L6"><span class="pnl">        </span><span class="tag">function</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.replace</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> /(?:^|\s)\S/g</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">function</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> a</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> a.toUpperCase()</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> String.prototype.pluralize =</span></li><li class="L4"><span class="pnl">        </span><span class="tag">function</span></li><li class="L5"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> inflect.pluralize(this)</span></li><li class="L6"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L7"><span class="pnl">        </span><span class="tag">{</span></li><li class="L8"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> pluralize</span></li><li class="L9"><span class="pnl">                </span><span class="tag">function</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> str</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> inflect.pluralize(str)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> capitalize</span></li><li class="L3"><span class="pnl">                </span><span class="tag">function</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> str</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> str.replace</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> /(?:^|\s)\S/g</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">function</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">param</span><span class="pln"> a</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">return</span><span class="pln"> a.toUpperCase()</span></li><li class="L1"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> escape verify.escapename</span></li><li class="L2"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isEmpty</span></li><li class="L3"><span class="pnl">                </span><span class="tag">function</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> typeof text === 'string' && text.trim().length === 0</span></li><li class="L6"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isNotEmpty</span></li><li class="L7"><span class="pnl">                </span><span class="tag">function</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> typeof text === 'string' && text.trim().length &gt; 0</span></li><li class="L0"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isObject</span></li><li class="L1"><span class="pnl">                </span><span class="tag">function</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> type = typeof obj</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> type === 'function' || type === 'object' && !!obj</span></li><li class="L5"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isArray</span></li><li class="L6"><span class="pnl">                </span><span class="tag">function</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> Array.isArray</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> Array.isArray(obj)</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> toString.call(obj) === '[object Array]'</span></li><li class="L2"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isString</span></li><li class="L3"><span class="pnl">                </span><span class="tag">function</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> toString.call(obj) === '[object String]'</span></li><li class="L6"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isNumber</span></li><li class="L7"><span class="pnl">                </span><span class="tag">function</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> toString.call(obj) === '[object Number]'</span></li><li class="L0"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isDate</span></li><li class="L1"><span class="pnl">                </span><span class="tag">function</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> toString.call(obj) === '[object Date]'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isFunction</span></li><li class="L5"><span class="pnl">                </span><span class="tag">function</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> toString.call(obj) === '[object Function]'</span></li><li class="L8"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isUndefined</span></li><li class="L9"><span class="pnl">                </span><span class="tag">function</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> obj === void 0</span></li><li class="L2"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> deinline</span></li><li class="L3"><span class="pnl">                </span><span class="tag">function</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> this.isNotEmpty(text) == false</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> ''</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">var</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">decl</span><span class="pln"> len = text.length</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">decl</span><span class="pln"> ch</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">decl</span><span class="pln"> i</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">decl</span><span class="pln"> ret = []</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">for</span><span class="pln"> i=0; i&lt;len; i++</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> ch = text[i]</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> ch === '
'</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> ret.push('\n')</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">elif</span><span class="pln"> ch === ''</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> ret.push('\r')</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">elif</span><span class="pln"> ch === '$'</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> ret.push('$')</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">elif</span><span class="pln"> ch === '\t'</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> ret.push('    ')</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> ret.push(ch)</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> ret.join('')</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d17">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/functions/verify.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L4"><span class="pnl">        </span><span class="tag">{</span></li><li class="L5"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isEmpty</span></li><li class="L6"><span class="pnl">                </span><span class="tag">function</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> typeof text === 'string' && text.trim().length === 0</span></li><li class="L9"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isNotEmpty</span></li><li class="L0"><span class="pnl">                </span><span class="tag">function</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> typeof text === 'string' && text.trim().length &gt; 0</span></li><li class="L3"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isObject</span></li><li class="L4"><span class="pnl">                </span><span class="tag">function</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> type = typeof obj</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> type === 'function' || type === 'object' && !!obj</span></li><li class="L8"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isArray</span></li><li class="L9"><span class="pnl">                </span><span class="tag">function</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> Array.isArray</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> Array.isArray(obj)</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> toString.call(obj) === '[object Array]'</span></li><li class="L5"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isString</span></li><li class="L6"><span class="pnl">                </span><span class="tag">function</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> toString.call(obj) === '[object String]'</span></li><li class="L9"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isNumber</span></li><li class="L0"><span class="pnl">                </span><span class="tag">function</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> toString.call(obj) === '[object Number]'</span></li><li class="L3"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isDate</span></li><li class="L4"><span class="pnl">                </span><span class="tag">function</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> toString.call(obj) === '[object Date]'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isFunction</span></li><li class="L8"><span class="pnl">                </span><span class="tag">function</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> toString.call(obj) === '[object Function]'</span></li><li class="L1"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> isUndefined</span></li><li class="L2"><span class="pnl">                </span><span class="tag">function</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> obj === void 0</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d18">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/t/jsWizziContext/getset_value.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> beginLoadingCallArguments</span></li><li class="L3"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.loadingCallArguments = true</span></li><li class="L4"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> endLoadingCallArguments</span></li><li class="L5"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.loadingCallArguments = false</span></li><li class="L6"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> declare</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L9"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.ittf_state === ittfStates.globalContext</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.declare(name, value)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> this.ittf_state === ittfStates.nodeContext</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.nodeContext.declare(name, value)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">else</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.modelEvalContext.declare(name, value)</span></li><li class="L5"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> declareCallParam</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.jsWizziContext.declareCallParam', name, value</span></li><li class="L9"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> this.callContext.declare(name, value)</span></li><li class="L0"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> undeclare</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L2"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.ittf_state === ittfStates.globalContext</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.undeclare(name)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> this.ittf_state === ittfStates.nodeContext</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.nodeContext.undeclare(name)</span></li><li class="L6"><span class="pnl">        </span><span class="tag">else</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.modelEvalContext.undeclare(name)</span></li><li class="L8"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> isDeclared</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L0"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> ret = false</span></li><li class="L1"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.loadingCallArguments</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.globalContext.isDeclared(name)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L4"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.nodeContext.isDeclared(name)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.callContext.isDeclared(name)</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.modelEvalContext && this.modelEvalContext.isDeclared(name)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L1"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> this.ittf_state === ittfStates.globalContext</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ret = this.modelEvalContext ? this.modelEvalContext.isDeclared(name) : null</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !ret</span></li><li class="L4"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret = this.globalContext.isDeclared(name)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> this.ittf_state === ittfStates.nodeContext</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ret = this.nodeContext.isDeclared(name)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !ret</span></li><li class="L8"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret = this.globalContext.isDeclared(name)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">else</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ret = this.modelEvalContext.isDeclared(name)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !ret</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret = this.globalContext.isDeclared(name)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> !ret</span></li><li class="L4"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> ret = this.callContext.isDeclared(name)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> ret</span></li><li class="L6"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> setValue</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L9"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.ittf_state === ittfStates.globalContext</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.setValue(name, value)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> this.ittf_state === ittfStates.nodeContext</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.nodeContext.setValue(name, value)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">else</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.modelEvalContext.setValue(name, value)</span></li><li class="L5"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> setValues</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> values</span></li><li class="L7"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> values = (values || {})</span></li><li class="L8"><span class="pnl">        </span><span class="tag">for</span><span class="pln"> var k in values</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.setValue</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> k</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> values[k]</span></li><li class="L2"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> put</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L5"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> assert</span></li><li class="L6"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> this.ittf_state != ittfStates.nodeContext</span></li><li class="L7"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> 'put in an invalid operation for NodeContext state'</span></li><li class="L8"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> ok = false</span></li><li class="L9"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.ittf_state === ittfStates.globalContext</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> ok = this.globalContext.put(name, value)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">else</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> ok = this.modelEvalContext.put(name, value)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !ok</span></li><li class="L4"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ok = this.globalContext.put(name, value)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> !ok</span></li><li class="L6"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'wizzi-mtree.jsWizziContext.modelEvalContext.declaresStack', this.modelEvalContext.declaresStack</span></li><li class="L7"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'wizzi-mtree.jsWizziContext.modelEvalContext.valuesStack', this.modelEvalContext.valuesStack</span></li><li class="L8"><span class="pnl">            </span><span class="tag">throw</span><span class="pln"> new Error('Not declared: ' + name);</span></li><li class="L9"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> getValue</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L1"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.loadingCallArguments</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.globalContext.isDeclared(name)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.globalContext.getValue(name)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.nodeContext.isDeclared(name)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.nodeContext.getValue(name)</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.callContext.isDeclared(name)</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.callContext.getValue(name)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.modelEvalContext && this.modelEvalContext.isDeclared(name)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.modelEvalContext.getValue(name)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> undefined</span></li><li class="L1"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> this.ittf_state === ittfStates.globalContext</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.modelEvalContext && this.modelEvalContext.isDeclared(name)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.modelEvalContext.getValue(name)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.globalContext.isDeclared(name)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.globalContext.getValue(name)</span></li><li class="L6"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> this.ittf_state === ittfStates.nodeContext</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.nodeContext.isDeclared(name)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.nodeContext.getValue(name)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.globalContext.isDeclared(name)</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.globalContext.getValue(name)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">else</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.modelEvalContext.isDeclared(name)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.modelEvalContext.getValue(name)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">elif</span><span class="pln"> this.globalContext.isDeclared(name)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.globalContext.getValue(name)</span></li><li class="L6"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.callContext.isDeclared(name)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this.callContext.getValue(name)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">else</span></li><li class="L9"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> return undefined</span></li><li class="L0"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'JsWizziContext.getValue context value not found for', name</span></li><li class="L1"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'JsWizziContext.getValue ittf_state ', this.ittf_state</span></li><li class="L2"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'JsWizziContext.getValue currentMTreeKey ', this.currentMTreeKey</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.dumpValues</span></li><li class="L4"><span class="pnl">            </span><span class="tag">throw</span><span class="pln"> new Error('In esprima context. Not declared: ' + name);</span></li><li class="L5"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> getValues</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> TODO modelEvalContext needs globalValues ???</span></li><li class="L7"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.ittf_state === ittfStates.globalContext</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this.globalContext.getValues()</span></li><li class="L9"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> this.ittf_state === ittfStates.nodeContext</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this.nodeContext.getValues()</span></li><li class="L1"><span class="pnl">        </span><span class="tag">else</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this.modelEvalContext.getValues()</span></li><li class="L3"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> setGlobalValues</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> values</span></li><li class="L5"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> this.globalContext.setValues(values)</span></li><li class="L6"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> getGlobalValues</span></li><li class="L7"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> this.globalContext.values</span></li><li class="L8"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> declareFunction</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> fn</span></li><li class="L1"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.ittf_state === ittfStates.globalContext</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.declareFunction(name, fn)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">else</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.modelEvalContext.declareFunction(name, fn)</span></li><li class="L5"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> getFunction</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L7"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.ittf_state === ittfStates.globalContext</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this.globalContext.getFunction(name)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">else</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ret = this.modelEvalContext.getFunction(name)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ret ? ret : this.globalContext.getFunction(name)</span></li><li class="L2"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> beginExpr</span></li><li class="L3"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.exprPending =</span></li><li class="L4"><span class="pnl">            </span><span class="tag">{</span></li><li class="L5"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> endExpr</span></li><li class="L6"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> assert</span></li><li class="L7"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> this.exprPending</span></li><li class="L8"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> 'endExpr called without previous call to beginExpr'</span></li><li class="L9"><span class="pnl">        </span><span class="tag">for</span><span class="pln"> var k in this.exprPending</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.put</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> k</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> this.exprPending[k]</span></li><li class="L3"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.exprPending = null</span></li><li class="L4"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> abortExpr</span></li><li class="L5"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.exprPending = null</span></li><li class="L6"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> dumpValues</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> TODO if this.verbose</span></li><li class="L8"><span class="pnl">        </span><span class="tag">log</span><span class="pln"> 'Dump context value for debug'</span></li><li class="L9"><span class="pnl">        </span><span class="tag">log</span><span class="pln"> 'JsWizziContext ittf_state ', this.ittf_state</span></li><li class="L0"><span class="pnl">        </span><span class="tag">log</span><span class="pln"> 'JsWizziContext currentMTreeKey ', this.currentMTreeKey</span></li><li class="L1"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.modelEvalContext</span></li><li class="L2"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'Local values'</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.modelEvalContext.dumpValues</span></li><li class="L4"><span class="pnl">        </span><span class="tag">log</span><span class="pln"> 'Global values'</span></li><li class="L5"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> this.globalContext.dumpValues</span></li><li class="L6"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> getDeclaredInfo</span></li><li class="L7"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> ret = []</span></li><li class="L8"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.ittf_state === ittfStates.globalContext</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ret.push</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'state=global'</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ret.push</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'global declares:' + this.globalContext.getDeclaredInfo()</span></li><li class="L3"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> this.ittf_state === ittfStates.nodeContext</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ret.push</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'state=node'</span></li><li class="L6"><span class="pnl">        </span><span class="tag">else</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ret.push</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'state=model:' + this.currentMTreeKey</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ret.push</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'model declares:' + this.modelEvalContext.getDeclaredInfo()</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ret.push</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'global declares:' + this.globalContext.getDeclaredInfo()</span></li><li class="L3"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> ret.join(', ')</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d19">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/t/jsWizziContext/set_context.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="tag">#</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> The JsWizziRunner is entering a block of statements</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> with instructions for the buildup</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> of the final (evaluated) MTree.</span></li><li class="L6"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> set_NodeContext</span></li><li class="L7"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.ittf_state === ittfStates.nodeContext</span></li><li class="L8"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> we already are in a nodeContext state</span></li><li class="L9"><span class="pnl">            </span><span class="tag">return</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> log '*** =&gt; set_NodeContext'</span></li><li class="L1"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.ittf_state = ittfStates.nodeContext</span></li><li class="L2"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.currentMTreeKey = null</span></li><li class="L3"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.modelEvalContext = null</span></li><li class="L4"><span class="pnl">    </span><span class="tag">#</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> The JsWizziRunner is entering a block of global statements</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> declared inside an IttfDocument.</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Example:</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 001     $global var message = 'hello';</span></li><li class="L9"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> set_GlobalContext</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> modelKey</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> get_value has scope: global and the current MTreeEvalContext</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> set_value puts value into global</span></li><li class="L3"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.currentMTreeKey !== modelKey</span></li><li class="L4"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> added 7/8/17</span></li><li class="L5"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> Must stay before the call to getMTreeEvalContext</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> to allow debug info about modelKey</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.currentMTreeKey = modelKey</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a">checked_call_return_set(</span><span class="arg"> this.modelEvalContext</span><span class="mix">)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.evalHelper.getMTreeEvalContext(modelKey, -1)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> assert(this.modelEvalContext, 'set_MTreeEvalContext modelEvalContext for key ' + modelKey + ' undefined')</span></li><li class="L1"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.ittf_state === ittfStates.globalContext</span></li><li class="L2"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> we already are in a globalContext state</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> log '*** =&gt; set_GlobalContext'</span></li><li class="L5"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.ittf_state = ittfStates.globalContext</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> via 7/8/17 set this.currentMTreeKey = null</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> via 7/8/17 set this.modelEvalContext = null</span></li><li class="L8"><span class="pnl">    </span><span class="tag">#</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> The JsWizziRunner is entering a block of local statements</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> declared inside an IttfDocument using the $ IttfCommand.</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Example:</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 001     $ var message = 'hello';</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> or the JsWizziEvalHelper has to execute an interpolation</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> on a node value which belongs to the modelKey.</span></li><li class="L5"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> set_MTreeEvalContext</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> modelKey</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> line</span></li><li class="L8"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.ittf_state = ittfStates.modelEvalContext</span></li><li class="L9"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> this.currentMTreeKey === modelKey</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Must stay before the call to getMTreeEvalContext</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> to allow debug info about modelKey</span></li><li class="L3"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.currentMTreeKey = modelKey</span></li><li class="L4"><span class="pnl">        </span><span class="mix frag-to-link-a">checked_call_return_set(</span><span class="arg"> this.modelEvalContext</span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.evalHelper.getMTreeEvalContext(modelKey, line)</span></li><li class="L6"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> assert(this.modelEvalContext, 'set_MTreeEvalContext modelEvalContext for key ' + modelKey + ' undefined')</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> log '*** =&gt; set_MTreeEvalContext', modelKey</span></li><li class="L8"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> this.modelEvalContext</span></li><li class="L9"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> get_currentMTreeKey</span></li><li class="L0"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> this.currentMTreeKey</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d20">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/t/jsWizziRunner/expressions.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> UnaryExpression</span><span class="mix">)</span></li><li class="L3"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> exp</span><span class="pln">,</span><span class="arg">  UnaryExpression</span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.argument</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L7"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.prefix</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> node.operator === '!'</span></li><li class="L9"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> !exp</span></li><li class="L0"><span class="pnl">            </span><span class="tag">elif</span><span class="pln"> node.operator === '-'</span></li><li class="L1"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> -exp</span></li><li class="L2"><span class="pnl">            </span><span class="tag">elif</span><span class="pln"> node.operator === '+'</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> exp</span></li><li class="L4"><span class="pnl">            </span><span class="tag">else</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Unmanaged unary operator ' + node.operator + ' (prefix: true)'</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node.operator</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'UnaryExpression'</span></li><li class="L2"><span class="pnl">        </span><span class="tag">else</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> node.operator === '!'</span></li><li class="L4"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> !exp</span></li><li class="L5"><span class="pnl">            </span><span class="tag">else</span></li><li class="L6"><span class="pnl">                </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Unmanaged unary operator ' + node.operator + ' (prefix: false)'</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node.operator</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'UnaryExpression'</span></li><li class="L3"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> BinaryExpression</span><span class="mix">)</span></li><li class="L4"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> l</span><span class="pln">,</span><span class="arg">  BinaryExpression l</span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.left</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> r</span><span class="pln">,</span><span class="arg">  BinaryExpressior</span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.right</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L2"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> log</span></li><li class="L3"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> 'BinaryExpression.l,r'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">[</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> l</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> r</span></li><li class="L7"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.operator === '+'</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> (l + r)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '-'</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> (l - r)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '*'</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> l * r</span></li><li class="L3"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '/'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> l / r</span></li><li class="L5"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '=='</span></li><li class="L6"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> l == r</span></li><li class="L7"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '==='</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> l === r</span></li><li class="L9"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '!='</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> l != r</span></li><li class="L1"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '!=='</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> l !== r</span></li><li class="L3"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '&gt;='</span></li><li class="L4"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> l &gt;= r</span></li><li class="L5"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '&gt;'</span></li><li class="L6"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> l &gt; r</span></li><li class="L7"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '&lt;='</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> l &lt;= r</span></li><li class="L9"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '&lt;'</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> l &lt; r</span></li><li class="L1"><span class="pnl">        </span><span class="tag">else</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'Unmanaged binary operator ' + node.operator</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.operator</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'BinaryExpression'</span></li><li class="L9"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> UpdateExpression</span><span class="mix">)</span></li><li class="L0"><span class="pnl">        </span><span class="tag">var</span></li><li class="L1"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> v</span></li><li class="L2"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> exp</span></li><li class="L3"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> exp</span><span class="pln">,</span><span class="arg">  UpdateExpression</span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.argument</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L7"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.operator === '++'</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = exp + 1</span></li><li class="L9"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '--'</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = exp - 1</span></li><li class="L1"><span class="pnl">        </span><span class="tag">else</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'Unmanaged update expression ' + node.operator</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.operator</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'UpdateExpression'</span></li><li class="L9"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> ctx.put</span></li><li class="L0"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> node.argument.name</span></li><li class="L1"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> v</span></li><li class="L2"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> node.prefix ? v : exp</span></li><li class="L3"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> LogicalExpression</span><span class="mix">)</span></li><li class="L4"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> l</span><span class="pln">,</span><span class="arg">  LogicalExpression l</span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.left</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.operator === '&&' && (l === false || l === null)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L0"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> r</span><span class="pln">,</span><span class="arg">  LogicalExpression r</span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.right</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L4"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> log</span></li><li class="L5"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> 'LogicalExpression.l,r'</span></li><li class="L6"><span class="pnl">            </span><span class="tag">[</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> l</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> r</span></li><li class="L9"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.operator === '&&'</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> l && r</span></li><li class="L1"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '||'</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> l || r</span></li><li class="L3"><span class="pnl">        </span><span class="tag">else</span></li><li class="L4"><span class="pnl">            </span><span class="tag">return</span></li><li class="L5"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'Unmanaged logical expression ' + node.operator</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.operator</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'LogicalExpression'</span></li><li class="L1"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> ConditionalExpression</span><span class="mix">)</span></li><li class="L2"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> test</span><span class="pln">,</span><span class="arg">  ConditionalExpression</span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner(node.test, ctx)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> test</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> value</span><span class="pln">,</span><span class="arg">  ConditionalExpression node.consequent</span><span class="mix">)</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.consequent</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L9"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> value</span></li><li class="L0"><span class="pnl">        </span><span class="tag">else</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> value</span><span class="pln">,</span><span class="arg">  ConditionalExpression node.alternate</span><span class="mix">)</span></li><li class="L2"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.alternate</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L5"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> value</span></li><li class="L6"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> CallExpression</span><span class="mix">)</span></li><li class="L7"><span class="pnl">        </span><span class="tag">var</span></li><li class="L8"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> value</span></li><li class="L9"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> args</span></li><li class="L0"><span class="pnl">                </span><span class="tag">[</span></li><li class="L1"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> property</span></li><li class="L2"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.callee.type === 'MemberExpression'</span></li><li class="L3"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> item in node.arguments</span></li><li class="L4"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d24">checked_run_set(</span><span class="arg"> value</span><span class="pln">,</span><span class="arg">  CallExpression argument</span><span class="mix">)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> runner(item, ctx)</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> args.push(value)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> obj</span><span class="pln">,</span><span class="arg">  CallExpression node.callee.object</span><span class="mix">)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.callee.object</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L1"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !obj</span></li><li class="L2"><span class="pnl">                </span><span class="tag">return</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'The value of callee must be an object. It is "' + getTypeDescription(obj) + '".'</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node.callee.object</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'CallExpression'</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> node.callee.computed</span></li><li class="L0"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d24">checked_run_set(</span><span class="arg"> property</span><span class="pln">,</span><span class="arg">  CallExpression node.callee.property</span><span class="mix">)</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node.callee.property</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L4"><span class="pnl">            </span><span class="tag">else</span></li><li class="L5"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> property = node.callee.property.name</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !obj[property]</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Missing object property.'</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node.callee.property</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'CallExpression'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> verify.isFunction(obj[property])</span></li><li class="L5"><span class="pnl">                </span><span class="tag">try</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> value = obj[property].apply(obj, args)</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> value && value.__is_error</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> currentModelInfo = ctx.get_currentMTreeInfo()</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">log</span><span class="pln"> 'error calling ' + property + ', on statement: ' + escodegen.generate(node)</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> value.message += ' (' + 'error calling ' + property + ', on statement: ' + escodegen.generate(node) +</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', currentModel_uri: ' + currentModelInfo.currentModel_uri +</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', currentModel_callerUri: ' + currentModelInfo.currentModel_callerUri +</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ')'</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> value</span></li><li class="L5"><span class="pnl">                </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'Exception calling function: ' + (ex ? ex.message : 'exception message unavailable')</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> node.callee.property</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'CallExpression'</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> ex</span></li><li class="L4"><span class="pnl">            </span><span class="tag">else</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'property: "' + property + '" is not a function'</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node.callee.property</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'CallExpression'</span></li><li class="L2"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.callee.type === 'Identifier'</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> f</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ctx.getFunction</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.callee.name</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> f == null</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ('Function undeclared ' + node.callee.name)</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node.callee</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'CallExpression'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.esprima.runner.expressions.CallExpression.jsWizziFunction', f.params</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> f.params.length !== node.arguments.length</span></li><li class="L6"><span class="pnl">                </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'A jsWizziFunction call must have the same number of arguments of the callee. Found: ' +</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> f.params.length + ' and ' + node.arguments.length</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'CallExpression'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.beginLoadingCallArguments();</span></li><li class="L5"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> item in node.arguments</span></li><li class="L6"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d24">checked_run_set(</span><span class="arg"> value</span><span class="pln">,</span><span class="arg">  CallExpression argument</span><span class="mix">)</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> runner(item, ctx)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.esprima.runner.expressions.CallExpression.value', value</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> args.push(value)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.endLoadingCallArguments();</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> runnerCall(f, ctx, args)</span></li><li class="L2"><span class="pnl">        </span><span class="tag">return</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'Not implemented'</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'CallExpression'</span></li><li class="L9"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> MemberExpression</span><span class="mix">)</span></li><li class="L0"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> obj</span><span class="pln">,</span><span class="arg">  MemberExpression</span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.object</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> !obj</span></li><li class="L5"><span class="pnl">            </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'The value must be an object. It is "' + getTypeDescription(obj) + '".'</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.object</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'MemberExpression'</span></li><li class="L2"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.computed</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> property</span><span class="pln">,</span><span class="arg">  MemberExpression node.property</span><span class="mix">)</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.property</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> obj[property]</span></li><li class="L8"><span class="pnl">        </span><span class="tag">else</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> property = node.property.name</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> obj[property]</span></li><li class="L1"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> MemberExpression_Set</span><span class="pln">,</span><span class="arg">  data</span><span class="mix">)</span></li><li class="L2"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> obj</span><span class="pln">,</span><span class="arg">  MemberExpression_Set</span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.object</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L6"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> !obj</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'The value must be an object. It is "' + getTypeDescription(obj) + '".'</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.object</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'MemberExpression_Set'</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.computed</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> property</span><span class="pln">,</span><span class="arg">  MemberExpression_Set node.property</span><span class="mix">)</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.property</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> obj[property] = data</span></li><li class="L0"><span class="pnl">        </span><span class="tag">else</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> property = node.property.name</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> obj[property] = data</span></li><li class="L3"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> AssignmentExpression</span><span class="mix">)</span></li><li class="L4"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> l</span><span class="pln">,</span><span class="arg">  AssignmentExpression l</span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.left</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> r</span><span class="pln">,</span><span class="arg">  AssignmentExpression r</span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.right</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L2"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> v</span></li><li class="L3"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.operator === '='</span></li><li class="L4"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = l = r</span></li><li class="L5"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '*='</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = l *= r</span></li><li class="L7"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '/='</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = l /= r</span></li><li class="L9"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '%='</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = l %= r</span></li><li class="L1"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '+='</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = l += r</span></li><li class="L3"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '-='</span></li><li class="L4"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = l -= r</span></li><li class="L5"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '&lt;&lt;='</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = l &lt;&lt;= r</span></li><li class="L7"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '&gt;&gt;='</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = l &gt;&gt;= r</span></li><li class="L9"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '&gt;&gt;&gt;='</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = l &gt;&gt;&gt;= r</span></li><li class="L1"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '&='</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = l &= r</span></li><li class="L3"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '^='</span></li><li class="L4"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = l ^= r</span></li><li class="L5"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.operator === '|='</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> v = l |= r</span></li><li class="L7"><span class="pnl">        </span><span class="tag">else</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'Unmanaged expression operator ' + node.operator</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.operator</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'AssignmentExpression'</span></li><li class="L5"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  AssignmentExpression node.left</span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runnerSet</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.left</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> v</span></li><li class="L0"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> v</span></li><li class="L1"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> ArrayExpression</span><span class="mix">)</span></li><li class="L2"><span class="pnl">        </span><span class="tag">var</span></li><li class="L3"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> ret</span></li><li class="L4"><span class="pnl">                </span><span class="tag">[</span></li><li class="L5"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> value</span></li><li class="L6"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> element in node.elements</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d24">checked_run_set(</span><span class="arg"> value</span><span class="pln">,</span><span class="arg">  ArrayExpression</span><span class="mix">)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(element, ctx)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ret.push(value)</span></li><li class="L0"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> ret</span></li><li class="L1"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> ObjectExpression</span><span class="mix">)</span></li><li class="L2"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.properties.length == 0</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span></li><li class="L4"><span class="pnl">                </span><span class="tag">{</span></li><li class="L5"><span class="pnl">        </span><span class="tag">var</span></li><li class="L6"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> ret</span></li><li class="L7"><span class="pnl">                </span><span class="tag">{</span></li><li class="L8"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> prop</span></li><li class="L9"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> property in node.properties</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d24">checked_run_set(</span><span class="arg"> prop</span><span class="pln">,</span><span class="arg">  ObjectExpression</span><span class="mix">)</span></li><li class="L1"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(property, ctx)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> ret[prop.key] = prop.value</span></li><li class="L3"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> ret</span></li><li class="L4"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> Property</span><span class="mix">)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> key = node.key.name</span></li><li class="L6"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> value</span><span class="pln">,</span><span class="arg">  Property</span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.value</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L0"><span class="pnl">        </span><span class="tag">return</span></li><li class="L1"><span class="pnl">            </span><span class="tag">{</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> key key</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> value value</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d21">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/t/jsWizziRunner/for.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> ForStatement</span><span class="mix">)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">var</span></li><li class="L4"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> test</span></li><li class="L5"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> state</span></li><li class="L6"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> savedCurrentModelKey</span></li><li class="L7"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> savedCurrentModelKey = ctx.get_currentMTreeKey()</span></li><li class="L8"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  ForStatement node.init</span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.init</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L2"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  ForStatement set_MTreeEvalContext</span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.set_MTreeEvalContext(savedCurrentModelKey)</span></li><li class="L4"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d24">checked_run_set(</span><span class="arg"> test</span><span class="pln">,</span><span class="arg">  ForStatement node.test</span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner(node.test, ctx)</span></li><li class="L6"><span class="pnl">        </span><span class="tag">while</span><span class="pln"> test</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d24">checked_run_set(</span><span class="arg"> state</span><span class="pln">,</span><span class="arg">  ForStatement node.body</span><span class="mix">)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(node.body, ctx)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> state.result || state.break</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> state</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  ForStatement set_MTreeEvalContext</span><span class="mix">)</span></li><li class="L2"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ctx.set_MTreeEvalContext(savedCurrentModelKey)</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  ForStatement node.update</span><span class="mix">)</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.update</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  ForStatement set_MTreeEvalContext</span><span class="mix">)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ctx.set_MTreeEvalContext(savedCurrentModelKey)</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d24">checked_run_set(</span><span class="arg"> test</span><span class="pln">,</span><span class="arg">  ForStatement node.test</span><span class="mix">)</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(node.test, ctx)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">return</span></li><li class="L2"><span class="pnl">            </span><span class="tag">{</span></li><li class="L3"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> ForInStatement</span><span class="mix">)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">var</span></li><li class="L5"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> test</span></li><li class="L6"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> state</span></li><li class="L7"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> savedCurrentModelKey</span></li><li class="L8"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> savedCurrentModelKey = ctx.get_currentMTreeKey()</span></li><li class="L9"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> obj</span><span class="pln">,</span><span class="arg">  ForInStatement node.right</span><span class="mix">)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.right</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L3"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> _.isObject(obj) == false</span></li><li class="L4"><span class="pnl">            </span><span class="tag">return</span></li><li class="L5"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'The value must be an object. It is "' + getTypeDescription(obj) + '".'</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.right</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'ForInStatement'</span></li><li class="L1"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  ForInStatement set_MTreeEvalContext</span><span class="mix">)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.set_MTreeEvalContext(savedCurrentModelKey)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> left = node.left.name</span></li><li class="L4"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> ctx.declare(left)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">for</span><span class="pln"> k in obj</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.put(left, k)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d24">checked_run_set(</span><span class="arg"> state</span><span class="pln">,</span><span class="arg">  ForInStatement node.body</span><span class="mix">)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(node.body, ctx)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> state.result || state.break</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> state</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  ForInStatement set_MTreeEvalContext</span><span class="mix">)</span></li><li class="L2"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ctx.set_MTreeEvalContext(savedCurrentModelKey)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> ctx.undeclare(left)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">return</span></li><li class="L5"><span class="pnl">            </span><span class="tag">{</span></li><li class="L6"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> BreakStatement</span><span class="mix">)</span></li><li class="L7"><span class="pnl">        </span><span class="tag">return</span></li><li class="L8"><span class="pnl">            </span><span class="tag">{</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> break true</span></li><li class="L0"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> ContinueStatement</span><span class="mix">)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">return</span></li><li class="L2"><span class="pnl">            </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> continue true</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d22">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/t/jsWizziRunner/functions.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> FunctionCall</span><span class="mix">)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">var</span></li><li class="L4"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> objbase</span></li><li class="L5"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> value</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.esprima.runner.functions.FunctionCall'</span></li><li class="L7"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.name.base</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d24">checked_run_set(</span><span class="arg"> objbase</span><span class="pln">,</span><span class="arg">  FunctionCall node.name.base</span><span class="mix">)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.name.base</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L2"><span class="pnl">        </span><span class="tag">else</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> objbase = ctx.values</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> _.isObject(objbase) == false</span></li><li class="L5"><span class="pnl">            </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'The value must be an object. It is "' + getTypeDescription(obj) + '".'</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.name.base</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'FunctionCall'</span></li><li class="L2"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> args</span></li><li class="L3"><span class="pnl">            </span><span class="tag">[</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> Object.prototype.toString.call(node.arguments) == '[object Array]'</span></li><li class="L5"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> item in node.arguments</span></li><li class="L6"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.esprima.runner.functions.FunctionCall.item', item</span></li><li class="L7"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d24">checked_run_set(</span><span class="arg"> value</span><span class="pln">,</span><span class="arg">  FunctionCall item</span><span class="mix">)</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> runner(item, ctx)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.esprima.runner.functions.FunctionCall.value', value</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> args.push(value)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> f = objbase[node.name.name]</span></li><li class="L2"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> !f</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'Missing function.'</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.name.base</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'FunctionCall'</span></li><li class="L0"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> verify.isFunction(f)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">try</span></li><li class="L2"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> v = objbase[node.name.name].apply(objbase, args)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> v</span></li><li class="L4"><span class="pnl">            </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> (ex ? ex.message : 'Error calling function')</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node.callee.property</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'CallExpression'</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ex</span></li><li class="L3"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> FunctionDeclaration</span><span class="mix">)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> ctx.declareFunction</span></li><li class="L5"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> node.id.name</span></li><li class="L6"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L7"><span class="pnl">        </span><span class="tag">return</span></li><li class="L8"><span class="pnl">            </span><span class="tag">{</span></li><li class="L9"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> FunctionDeclaration_Call</span><span class="pln">,</span><span class="arg">  data</span><span class="mix">)</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.esprima.runner.functions.FunctionDeclaration_Call'</span></li><li class="L1"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> save_model_key = ctx.get_currentMTreeKey()</span></li><li class="L2"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> ctx = ctx.push()</span></li><li class="L3"><span class="pnl">        </span><span class="tag">for</span><span class="pln"> var i = 0; i &lt; node.params.length; i++</span></li><li class="L4"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.esprima.runner.functions.FunctionDeclaration_Call.param', node.params[i].name</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> data.length &gt; i</span></li><li class="L6"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.esprima.runner.functions.FunctionDeclaration_Call.value', data[i]</span></li><li class="L7"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ctx.declareCallParam</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.params[i].name</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> data[i]</span></li><li class="L0"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> state</span><span class="pln">,</span><span class="arg">  FunctionCall node.body</span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.body</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L4"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> ctx.set_MTreeEvalContext(save_model_key, 0)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> ctx.pop()</span></li><li class="L6"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> state.value</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d23">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/t/jsWizziRunner/statements.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="mix frag-to-link-a">runner(</span><span class="arg"> EmptyStatement</span><span class="mix">)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">return</span></li><li class="L4"><span class="pnl">            </span><span class="tag">{</span></li><li class="L5"><span class="pnl">    </span><span class="mix frag-to-link-a">runner(</span><span class="arg"> ExpressionStatement</span><span class="mix">)</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 1/8/2017 _ ctx.beginExpr()</span></li><li class="L7"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> state</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.expression</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L1"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> state && state.__is_error</span></li><li class="L2"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> _ ctx.abortExpr()</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> state</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> _ ctx.endExpr()</span></li><li class="L5"><span class="pnl">        </span><span class="tag">return</span></li><li class="L6"><span class="pnl">            </span><span class="tag">{</span></li><li class="L7"><span class="pnl">    </span><span class="mix frag-to-link-a">runner(</span><span class="arg"> IfStatement</span><span class="mix">)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">var</span></li><li class="L9"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> ret</span></li><li class="L0"><span class="pnl">                </span><span class="tag">{</span></li><li class="L1"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> savedCurrentModelKey</span></li><li class="L2"><span class="pnl">        </span><span class="mix frag-to-link-a">checked_run(</span><span class="arg"> test</span><span class="pln">,</span><span class="arg">  IfStatement</span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner(node.test, ctx)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> test</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> savedCurrentModelKey = ctx.get_currentMTreeKey()</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a">checked_run_set(</span><span class="arg"> ret</span><span class="pln">,</span><span class="arg">  IfStatement node.consequent</span><span class="mix">)</span></li><li class="L7"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(node.consequent, ctx)</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  IfStatement set_MTreeEvalContext</span><span class="mix">)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ctx.set_MTreeEvalContext(savedCurrentModelKey)</span></li><li class="L0"><span class="pnl">        </span><span class="tag">else</span></li><li class="L1"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> node.alternate</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> savedCurrentModelKey = ctx.get_currentMTreeKey()</span></li><li class="L3"><span class="pnl">                </span><span class="mix frag-to-link-a">checked_run_set(</span><span class="arg"> ret</span><span class="pln">,</span><span class="arg">  IfStatement node.alternate</span><span class="mix">)</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> runner(node.alternate, ctx)</span></li><li class="L5"><span class="pnl">                </span><span class="mix frag-to-link-a">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  IfStatement set_MTreeEvalContext</span><span class="mix">)</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> ctx.set_MTreeEvalContext(savedCurrentModelKey)</span></li><li class="L7"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> ret</span></li><li class="L8"><span class="pnl">    </span><span class="mix frag-to-link-a">runner(</span><span class="arg"> BlockStatement</span><span class="mix">)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> state</span></li><li class="L0"><span class="pnl">        </span><span class="tag">for</span><span class="pln"> var i = 0; i &lt; node.body.length; i++</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> statement = node.body[i]</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a">checked_run_set(</span><span class="arg"> state</span><span class="pln">,</span><span class="arg">  BlockStatement</span><span class="mix">)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(statement, ctx)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> state.result || state.break || state.continue</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> state</span></li><li class="L6"><span class="pnl">        </span><span class="tag">return</span></li><li class="L7"><span class="pnl">            </span><span class="tag">{</span></li><li class="L8"><span class="pnl">    </span><span class="mix frag-to-link-a">runner(</span><span class="arg"> WhileStatement</span><span class="mix">)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">var</span></li><li class="L0"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> state</span></li><li class="L1"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> savedCurrentModelKey</span></li><li class="L2"><span class="pnl">        </span><span class="mix frag-to-link-a">checked_run(</span><span class="arg"> test</span><span class="pln">,</span><span class="arg">  WhileStatement node.test</span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner(node.test, ctx)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">while</span><span class="pln"> test</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> savedCurrentModelKey = ctx.get_currentMTreeKey()</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a">checked_run_set(</span><span class="arg"> state</span><span class="pln">,</span><span class="arg">  WhileStatement node.body</span><span class="mix">)</span></li><li class="L7"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(node.body, ctx)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> state.result || state.break</span></li><li class="L9"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> state</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  set_MTreeEvalContext</span><span class="mix">)</span></li><li class="L1"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ctx.set_MTreeEvalContext(savedCurrentModelKey)</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a">checked_run_set(</span><span class="arg"> test</span><span class="pln">,</span><span class="arg">  WhileStatement node.test</span><span class="mix">)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(node.test, ctx)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">return</span></li><li class="L5"><span class="pnl">            </span><span class="tag">{</span></li><li class="L6"><span class="pnl">    </span><span class="mix frag-to-link-a">runner(</span><span class="arg"> DoWhileStatement</span><span class="mix">)</span></li><li class="L7"><span class="pnl">        </span><span class="tag">var</span></li><li class="L8"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> test</span></li><li class="L9"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> state</span></li><li class="L0"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> savedCurrentModelKey</span></li><li class="L1"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> savedCurrentModelKey = ctx.get_currentMTreeKey()</span></li><li class="L2"><span class="pnl">        </span><span class="mix frag-to-link-a">checked_run_set(</span><span class="arg"> state</span><span class="pln">,</span><span class="arg">  DoWhileStatement node.body</span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner(node.body, ctx)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> state.result || state.break</span></li><li class="L5"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> state</span></li><li class="L6"><span class="pnl">        </span><span class="mix frag-to-link-a">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  DoWhileStatement set_MTreeEvalContext</span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.set_MTreeEvalContext(savedCurrentModelKey)</span></li><li class="L8"><span class="pnl">        </span><span class="mix frag-to-link-a">checked_run_set(</span><span class="arg"> test</span><span class="pln">,</span><span class="arg">  DoWhileStatement node.test</span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner(node.test, ctx)</span></li><li class="L0"><span class="pnl">        </span><span class="tag">while</span><span class="pln"> test</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a">checked_run_set(</span><span class="arg"> state</span><span class="pln">,</span><span class="arg">  DoWhileStatement node.body</span><span class="mix">)</span></li><li class="L2"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(node.body, ctx)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> state.result || state.break</span></li><li class="L4"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> state</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a">checked_run(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  DoWhileStatement set_MTreeEvalContext</span><span class="mix">)</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ctx.set_MTreeEvalContext(savedCurrentModelKey)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a">checked_run_set(</span><span class="arg"> test</span><span class="pln">,</span><span class="arg">  DoWhileStatement node.test</span><span class="mix">)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(node.test, ctx)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">return</span></li><li class="L0"><span class="pnl">            </span><span class="tag">{</span></li><li class="L1"><span class="pnl">    </span><span class="mix frag-to-link-a">runner(</span><span class="arg"> ReturnStatement</span><span class="mix">)</span></li><li class="L2"><span class="pnl">        </span><span class="mix frag-to-link-a">checked_run(</span><span class="arg"> value</span><span class="pln">,</span><span class="arg">  ReturnStatement</span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.argument</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L6"><span class="pnl">        </span><span class="tag">return</span></li><li class="L7"><span class="pnl">            </span><span class="tag">{</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> result true</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> value value</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d24">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/t/checked_run_set.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> varName, message|@@null</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span></li><li class="L4"><span class="pnl">        </span><span class="kwd">$hook</span></li><li class="L5"><span class="pnl">    </span><span class="tag">if</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span><span class="pln"> && </span><span class="kwd">${</span><span class="expr">varName</span><span class="kwd">}</span><span class="pln">.__is_error</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> log '__is_error </span><span class="kwd">${</span><span class="expr">message</span><span class="kwd">}</span><span class="pln">', </span><span class="kwd">${</span><span class="expr">varName</span><span class="kwd">}</span></li><li class="L7"><span class="pnl">        </span><span class="tag">return</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d25">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/t/checked_run.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> varName, message|@@null</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span></li><li class="L4"><span class="pnl">        </span><span class="kwd">$hook</span></li><li class="L5"><span class="pnl">    </span><span class="tag">if</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span><span class="pln"> && </span><span class="kwd">${</span><span class="expr">varName</span><span class="kwd">}</span><span class="pln">.__is_error</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> log '__is_error </span><span class="kwd">${</span><span class="expr">message</span><span class="kwd">}</span><span class="pln">', </span><span class="kwd">${</span><span class="expr">varName</span><span class="kwd">}</span></li><li class="L7"><span class="pnl">        </span><span class="tag">return</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d26">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/t/runner.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name, arg1|@@null</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> runner.</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span></li><li class="L4"><span class="pnl">        </span><span class="tag">function</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L7"><span class="pnl">            </span><span class="kwd">$if</span><span class="expr"> arg1 != null</span></li><li class="L8"><span class="pnl">                </span><span class="tag">param</span><span class="kwd"> ${</span><span class="expr">arg1</span><span class="kwd">}</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> log('</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">.node', node)</span></li><li class="L0"><span class="pnl">            </span><span class="kwd">$hook</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d27">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/contextData.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('./errors')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> f_verify = require('./functions/verify')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">class</span><span class="pln"> ContextData</span></li><li class="L7"><span class="pnl">        </span><span class="tag">ctor</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> kind</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> modelKey</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.kind = kind</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.modelKey = modelKey</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.clear</span></li><li class="L3"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> clear</span></li><li class="L4"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.$freezed = false</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.functions</span></li><li class="L6"><span class="pnl">                </span><span class="tag">{</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.values</span></li><li class="L8"><span class="pnl">                </span><span class="tag">{</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.declares</span></li><li class="L0"><span class="pnl">                </span><span class="tag">{</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.functionsStack</span></li><li class="L2"><span class="pnl">                </span><span class="tag">[</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.valuesStack</span></li><li class="L4"><span class="pnl">                </span><span class="tag">[</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.declaresStack</span></li><li class="L6"><span class="pnl">                </span><span class="tag">[</span></li><li class="L7"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> $freeze</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.$freezed = true</span></li><li class="L9"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> declare</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> init</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> name == '$' && this.$freezed</span></li><li class="L3"><span class="pnl">                </span><span class="tag">throw</span><span class="pln"> new errors.InvalidVariableNameError('The variable "$" cannot be declared on the global context after it has been freezed.')</span></li><li class="L4"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.declares[name] = true</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> typeof (init) !== 'undefined'</span></li><li class="L6"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> this.values[name] = init</span></li><li class="L7"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> TODO debug only</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> f_verify.isObject(init) == false</span></li><li class="L9"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'ContextData declare', name, init, 'kind', this.kind, this.modelKey</span></li><li class="L0"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> undeclare</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.declares[name] == true</span></li><li class="L3"><span class="pnl">                </span><span class="tag">delete</span><span class="pln"> this.declares[name]</span></li><li class="L4"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.values[name] == true</span></li><li class="L5"><span class="pnl">                </span><span class="tag">delete</span><span class="pln"> this.values[name]</span></li><li class="L6"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> isDeclared</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L8"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.contextData.isDeclared', name, this.declares[name]</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.declares[name] == true</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L1"><span class="pnl">            </span><span class="tag">elif</span><span class="pln"> this.declaresStack.length &gt; 0</span></li><li class="L2"><span class="pnl">                </span><span class="tag">backeach</span><span class="pln"> item in this.declaresStack</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> item[name] == true</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L6"><span class="pnl">            </span><span class="tag">else</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> setValue</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L1"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> name == '$' && this.$freezed</span></li><li class="L2"><span class="pnl">                </span><span class="tag">throw</span><span class="pln"> new errors.InvalidVariableNameError('The variable "$" cannot be set on the global context after it has been freezed.')</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.declare(name, value)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> TODO debug only</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> f_verify.isObject(value) == false</span></li><li class="L6"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'ContextData setValue', name, value, 'kind', this.kind, this.modelKey</span></li><li class="L7"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> setValues</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> values</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> values = (values || {})</span></li><li class="L0"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var k in values</span></li><li class="L1"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.declare</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> k</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> values[k]</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Set value only if name is declared</span></li><li class="L5"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> put</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.declares[name] === true</span></li><li class="L9"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> this.values[name] = value</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L1"><span class="pnl">            </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L3"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getValue</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.declares[name] == true</span></li><li class="L6"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.contextData.getValue found for', name, this.kind, this.modelKey</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.values[name]</span></li><li class="L8"><span class="pnl">            </span><span class="tag">elif</span><span class="pln"> this.declaresStack.length &gt; 0</span></li><li class="L9"><span class="pnl">                </span><span class="tag">backeach</span><span class="pln"> item in this.declaresStack</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> item[name] == true</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.contextData.getValue found for', name, this.kind, this.modelKey</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> this.valuesStack[i][name]</span></li><li class="L3"><span class="pnl">            </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.contextData.getValue not found for', name, this.kind, this.modelKey</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> undefined</span></li><li class="L6"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getValues</span></li><li class="L7"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> TODO what if the stack has items ???</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this.values</span></li><li class="L9"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getSettableValues</span></li><li class="L0"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> TODO what if the stack has items ???</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ret = {}</span></li><li class="L2"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var k in this.values</span></li><li class="L3"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> k != '$'</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> ret[k] = this.values[k]</span></li><li class="L5"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ret</span></li><li class="L6"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> declareFunction</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> fn</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.functions[name] = fn</span></li><li class="L0"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getFunction</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.functions[name]</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.functions[name]</span></li><li class="L4"><span class="pnl">            </span><span class="tag">elif</span><span class="pln"> this.functionsStack.length &gt; 0</span></li><li class="L5"><span class="pnl">                </span><span class="tag">backeach</span><span class="pln"> item in this.functionsStack</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> item[name]</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> item[name]</span></li><li class="L8"><span class="pnl">            </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> undefined</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> this.functions[name]</span></li><li class="L1"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> push</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.functionsStack.push(this.functions)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.valuesStack.push(this.values)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.declaresStack.push(this.declares)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.functions = {}</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.values = {}</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.declares = {}</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> pop</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.functionsStack.length &gt; 0</span></li><li class="L0"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> this.functions = this.functionsStack.pop()</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> this.values = this.valuesStack.pop()</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> this.declares = this.declaresStack.pop()</span></li><li class="L3"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> dumpValues</span></li><li class="L4"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'Dump context value for debug', this.kind</span></li><li class="L5"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var k in this.declares</span></li><li class="L6"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> f_verify.isObject(this.values[k]) == false</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">log</span><span class="pln"> k, this.values[k]</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getDeclareddumpValues</span></li><li class="L9"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'Dump context value for debug', this.kind</span></li><li class="L0"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var k in this.declares</span></li><li class="L1"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> f_verify.isObject(this.values[k]) == false</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">log</span><span class="pln"> k, this.values[k]</span></li><li class="L3"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getDeclaredInfo</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ret = []</span></li><li class="L5"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var k in this.declares</span></li><li class="L6"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> f_verify.isObject(this.values[k]) == false</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> ret.push(k + '=' + this.values[k])</span></li><li class="L8"><span class="pnl">                </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> ret.push(k + '= [object]')</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ret.join(', ')</span></li><li class="L1"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports = ContextData</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d28">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/errors.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> f_verify = require('./functions/verify')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">+</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> md = module.exports = {}</span></li><li class="L7"><span class="pnl">    </span><span class="tag">+</span></li><li class="L8"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d61">error(</span><span class="arg"> JsWizziRunner</span><span class="pln">,</span><span class="arg">  message</span><span class="pln">,</span><span class="arg">  node </span><span class="mix">)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.message = message + util.inspect(node.loc, {depth: null})</span></li><li class="L0"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d61">error(</span><span class="arg"> InvalidVariableName</span><span class="pln">,</span><span class="arg">  message </span><span class="mix">)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.message = message</span></li><li class="L2"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d61">error(</span><span class="arg"> JsWizziSynthax</span><span class="pln">,</span><span class="arg">  message</span><span class="pln">,</span><span class="arg">  node </span><span class="mix">)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">log</span><span class="pln"> 'JsWizziSynthax.message', message</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> f_verify.isObject(message) && message.lineNumber</span></li><li class="L5"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> In this case node = WizziJS source</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.message = "Synthax error. " + message.description +</span></li><li class="L7"><span class="pnl">                </span><span class="tag">\</span><span class="pln"> ' at line ' + message.lineNumber +</span></li><li class="L8"><span class="pnl">                </span><span class="tag">\</span><span class="pln"> ' column ' + message.column +</span></li><li class="L9"><span class="pnl">                </span><span class="tag">\</span><span class="pln"> '\n' +</span></li><li class="L0"><span class="pnl">                </span><span class="tag">\</span><span class="pln"> getEsprimaErrorLines(message, node) +</span></li><li class="L1"><span class="pnl">                </span><span class="tag">\</span><span class="pln"> '\n'</span></li><li class="L2"><span class="pnl">        </span><span class="tag">else</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.message = message</span></li><li class="L4"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> For</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> vars or functions undeclared</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> invalid values</span></li><li class="L7"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d61">error(</span><span class="arg"> JsWizziType</span><span class="pln">,</span><span class="arg">  message</span><span class="pln">,</span><span class="arg">  node </span><span class="mix">)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.message = message</span></li><li class="L9"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> getEsprimaErrorLines</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> esprimaException</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> source</span></li><li class="L2"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> statements = source.split('\n')</span></li><li class="L3"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> start = Math.max(0, (esprimaException.lineNumber - 4))</span></li><li class="L4"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> end</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> Math.min</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> statements.length</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> (esprimaException.lineNumber + 4)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> ret</span></li><li class="L9"><span class="pnl">            </span><span class="tag">[</span></li><li class="L0"><span class="pnl">        </span><span class="tag">for</span><span class="pln"> var i = start; i &lt; end; i++</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ret.push(formatLineNumber(i + 1) + ' ' + statements[i])</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> (i == esprimaException.lineNumber - 1)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> col = esprimaException.column</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ret.push(spaces(col + 4) + '^ ' + esprimaException.description)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> ret.join('\n')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> spaces</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> num</span></li><li class="L8"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> Array(num + 1).join(" ")</span></li><li class="L9"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> formatLineNumber</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> num</span></li><li class="L1"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> num &gt; 999</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> num</span></li><li class="L3"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> num &gt; 99</span></li><li class="L4"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ('0' + num)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> num &gt; 9</span></li><li class="L6"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ('00' + num)</span></li><li class="L7"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> ('000' + num)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d29">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/jsWizziContext.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> assert</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> f_dateutil = require('./functions/dateutil')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> f_verify = require('./functions/verify')</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> f_underscore = require('./functions/underscore')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('./errors')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> JsWizziEvalHelper = require('./jsWizziEvalHelper')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> ContextData = require('./contextData')</span></li><li class="L1"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> defaultValues</span></li><li class="L2"><span class="pnl">        </span><span class="tag">{</span></li><li class="L3"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> '__dollardollar'  '$$'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> '__dollaraster'   '$*'</span></li><li class="L5"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> '__asterdollar'   '*$'</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> knownCallables</span></li><li class="L7"><span class="pnl">        </span><span class="tag">{</span></li><li class="L8"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> 'console' console</span></li><li class="L9"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> '_' f_underscore</span></li><li class="L0"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> 'Object' Object</span></li><li class="L1"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> 'Math' Math</span></li><li class="L2"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> 'path' require('path')</span></li><li class="L3"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> 'dateUtil' f_dateutil</span></li><li class="L4"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> 'verify' f_verify</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> ittfStates</span></li><li class="L6"><span class="pnl">        </span><span class="tag">{</span></li><li class="L7"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> nodeContext 0</span></li><li class="L8"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> modelEvalContext 1</span></li><li class="L9"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> globalContext 2</span></li><li class="L0"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> callContext 3</span></li><li class="L1"><span class="pnl">    </span><span class="tag">class</span><span class="pln"> JsWizziContext</span></li><li class="L2"><span class="pnl">        </span><span class="tag">ctor</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> composedMTree</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> productionContext</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.composedMTree = composedMTree</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.productionContext = productionContext</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> composedMTree</span></li><li class="L8"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> The JsWizziContext is used for the</span></li><li class="L9"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> buildup of an MTree.</span></li><li class="L0"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> Create the JsWizziEvalHelper</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> this.primaryMTree = composedMTree</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> this.loadContext = composedMTree.loadContext</span></li><li class="L3"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> this.evalHelper = new JsWizziEvalHelper(this, composedMTree, productionContext)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">else</span></li><li class="L5"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> The JsWizziContext is used for interpolations.</span></li><li class="L6"><span class="pnl">            </span><span class="tag">+</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.nodeContext = new ContextData(ittfStates.nodeContext)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.globalContext = new ContextData(ittfStates.globalContext)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.callContext = new ContextData(ittfStates.callContext)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.loadingCallArguments = false</span></li><li class="L1"><span class="pnl">            </span><span class="tag">+</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.exprPending = null</span></li><li class="L3"><span class="pnl">            </span><span class="tag">+</span></li><li class="L4"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> The first getValue will be for the '$' variable</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.ittf_state = ittfStates.globalContext</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.currentMTreeKey = null</span></li><li class="L7"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> modelEvalContext is retrieved from JsWizziEvalHelper</span></li><li class="L8"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> each ittf source document has its modelEvalContext</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.modelEvalContext = null</span></li><li class="L0"><span class="pnl">            </span><span class="tag">+</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.declare('$', this.evalHelper)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.$freeze()</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.setValues(defaultValues)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.setValues(knownCallables)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">+</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.runningNodeId = null</span></li><li class="L7"><span class="pnl">            </span><span class="tag">+</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Called by JsWizziRunner.FunctionDeclarationCall</span></li><li class="L9"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> push</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.nodeContext.push()</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.callContext.push()</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.modelEvalContext.push()</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this</span></li><li class="L4"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> pop</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.nodeContext.pop()</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.callContext.pop()</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.modelEvalContext.pop()</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this</span></li><li class="L9"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> clear</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.clear</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.nodeContext.clear</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.modelEvalContext</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.modelEvalContext.clear</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.declare('$', this.evalHelper)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.$freeze()</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.setValues(defaultValues)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.globalContext.setValues(knownCallables)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> setRunningNodeId</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> id</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.runningNodeId = id</span></li><li class="L1"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> get_currentMTreeInfo</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.currentMTreeKey == null</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> currentModel_uri 'unavailable'</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> currentModel_callerUri 'unavailable'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">else</span></li><li class="L8"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> mTreeData = this.loadContext.getMTreeData(this.currentMTreeKey)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> callerUri = 'root model'</span></li><li class="L0"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> mTreeData.mTree.$mixerModelKey</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> callerMTreeData = this.loadContext.getMTreeData(mTreeData.mTree.$mixerModelKey)</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> callerUri = callerMTreeData ? callerMTreeData.ittfDocumentUri : 'root model';</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> currentModel_uri mTreeData.ittfDocumentUri</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> currentModel_callerUri callerUri</span></li><li class="L7"><span class="pnl">        </span><span class="kwd">$include</span><span class="mix frag-to-link-a"> jsWizziContext/getset_value</span></li><li class="L8"><span class="pnl">        </span><span class="kwd">$include</span><span class="mix frag-to-link-a"> jsWizziContext/set_context</span></li><li class="L9"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports = JsWizziContext</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d30">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/jsWizziEvalHelper.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> assert</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> verify = require('../util/verify')</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> ContextData = require('./ContextData')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> JsWizziContext = null</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> interpolate = require('../loader/ittfInterpolate')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> types = require('../util/types')</span></li><li class="L1"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> work</span></li><li class="L2"><span class="pnl">        </span><span class="tag">{</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> work.lineSep = "__LS__"</span></li><li class="L4"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> work.textSep = "__TS__"</span></li><li class="L5"><span class="pnl">    </span><span class="tag">#</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> properties</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> jsWizziContext:Object</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> primaryModel:Object</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> loadContext:Object</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> callApi:Function</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> loadWizziModel:Function</span></li><li class="L2"><span class="pnl">    </span><span class="tag">class</span><span class="pln"> JsWizziEvalHelper</span></li><li class="L3"><span class="pnl">        </span><span class="tag">ctor</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> jsWizziContext</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> primaryModel</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> productionContext</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.jsWizziContext = jsWizziContext</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.primaryModel = primaryModel</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.loadContext = primaryModel.loadContext</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.textSep = work.textSep</span></li><li class="L1"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> productionContext.runnerServer</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> this.callApi = productionContext.runnerServer.callApi</span></li><li class="L3"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> this.loadWizziModel = productionContext.runnerServer.loadWizziModel</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span></li><li class="L5"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> node tree buildup method</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> supershort method name</span></li><li class="L7"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> means set the JsWizziContext state to MTreeEvalContext</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> s</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> modelKey</span></li><li class="L0"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'JsWizziEvalHelper called $.s(' + modelKey +')'</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> notUsed</span><span class="mix">)</span></li><li class="L2"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.jsWizziContext.set_MTreeEvalContext(modelKey)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span></li><li class="L4"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> node tree buildup method</span></li><li class="L5"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> supershort method name</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> means set the JsWizziContext state to NodeContext</span></li><li class="L7"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> n</span></li><li class="L8"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'JsWizziEvalHelper called $.n()'</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.jsWizziContext.set_NodeContext()</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span></li><li class="L1"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> node tree buildup method</span></li><li class="L2"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> supershort method name</span></li><li class="L3"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> means set the JsWizziContext state to GlobalContext</span></li><li class="L4"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> g</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> modelKey</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'JsWizziEvalHelper called $.g("modelKey")'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.jsWizziContext.set_GlobalContext(modelKey)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span></li><li class="L9"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> node tree buildup method</span></li><li class="L0"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> supershort method name</span></li><li class="L1"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> means append a child node to a parent node</span></li><li class="L2"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> a</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> parent</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> line</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'JsWizziEvalHelper called $.a(' + node.n + ',' + node.v + ')'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> assert(parent, "wizzi-mtree.JsWizziEvalHelper error. Parent undefined in add. At line " + line)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node.parent = parent</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> typeof (parent.childs) === 'undefined'</span></li><li class="L0"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> parent.childs = []</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node.childs = []</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> parent.childs.push(node)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span></li><li class="L4"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> Interpolate a templated node value</span></li><li class="L5"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> ip</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> modelKey</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> templatedValue</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> type</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> line</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> hasMacro</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ret</span></li><li class="L2"><span class="pnl">            </span><span class="tag">try</span></li><li class="L3"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> save = this.jsWizziContext.get_currentMTreeKey()</span></li><li class="L4"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> notUsed</span><span class="mix">)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.jsWizziContext.set_MTreeEvalContext(modelKey, line)</span></li><li class="L6"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log ' *** JsWizziEvalHelper.ip templatedValue', templatedValue, 'modelKey', modelKey</span></li><li class="L7"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> ret</span><span class="pln">,</span><span class="arg">  JsWizziEvalHelper.ip </span><span class="mix">)</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> interpolate(templatedValue, this.jsWizziContext, {delimiter: '</span><span class="kwd">${</span><span class="expr"></span><span class="kwd">}</span><span class="pln">'})</span></li><li class="L9"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'interpolated result', ret</span></li><li class="L0"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> Stop 7/7/17 if hasMacro</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret = remacro(ret)</span></li><li class="L2"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> save === null</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.jsWizziContext.set_NodeContext(modelKey)</span></li><li class="L4"><span class="pnl">                </span><span class="tag">else</span></li><li class="L5"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> notUsed</span><span class="mix">)</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> this.jsWizziContext.set_MTreeEvalContext(save)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L8"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> mTreeData = this.loadContext.getMTreeData(modelKey)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> callerMTreeData = this.loadContext.getMTreeData(mTreeData.mTree.$mixerModelKey)</span></li><li class="L0"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> callerUri = callerMTreeData ? callerMTreeData.ittfDocumentUri : 'root model';</span></li><li class="L1"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'saved ip.currentMTreeKey', save, 'mTreeData.evalContext', mTreeData.evalContext</span></li><li class="L2"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> 'values.' + util.inspect(this.jsWizziContext.getValues(), {depth: 2}))</span></li><li class="L3"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> exMessage = ex ? ex.message : 'not available'</span></li><li class="L4"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> exStack = ex ? ex.stack : 'not available'</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Exception interpolating: ' + templatedValue +</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', line:' + line +</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', type:' + type +</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', modelKey:' + modelKey +</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', mTree uri: ' + mTreeData.ittfDocumentUri +</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', callerMTree uri: ' + callerUri +</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', ex message: ' + exMessage +</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', stack: ' + exStack</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'ip'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> retObject</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> types.objectify</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ret</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> type</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> row line</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> retObject && retObject.__is_error</span></li><li class="L4"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> mTreeData = this.loadContext.getMTreeData(modelKey)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> error</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Error interpolating: ' + templatedValue + ', line:' + line +</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', mTree uri: ' + mTreeData.ittfDocumentUri +</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', callerMTree uri: ' + callerUri</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'ip'</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> error.inner = retObject</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> error</span></li><li class="L4"><span class="pnl">            </span><span class="tag">else</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> retObject</span></li><li class="L6"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> api</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.callApi</span></li><li class="L8"><span class="pnl">                </span><span class="tag">return</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.callApi.apply</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> productionContext.runnerServer</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> arguments</span></li><li class="L2"><span class="pnl">            </span><span class="tag">else</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'A RunnerServer has not been started. You must create a wizzifile.js.'</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'api'</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> model</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.loadWizziModel</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.loadWizziModel.apply</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> productionContext.runnerServer</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> arguments</span></li><li class="L4"><span class="pnl">            </span><span class="tag">else</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'A wizzi.RunnerServer has not been started. You must create a wizzifile.js.'</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'model'</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span></li><li class="L1"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> called by set_MTreeEvalContext</span></li><li class="L2"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> called by JsWizziRunner</span></li><li class="L3"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getMTreeEvalContext</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> modelKey</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> line</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> retrieve the mTreeData for the given modelKey</span></li><li class="L7"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> from the loadContext</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> mTreeData = this.loadContext.getMTreeData(modelKey)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> evalContext</span></li><li class="L0"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> mTreeData.evalContext != null</span></li><li class="L1"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> An evalContext object has already been created for this mTreeData</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> evalContext = mTreeData.evalContext</span></li><li class="L3"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> notUsed</span><span class="mix">)</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this._refreshEvalContext</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> mTreeData</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> evalContext</span></li><li class="L7"><span class="pnl">            </span><span class="tag">else</span></li><li class="L8"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> evalContext = new ContextData(1, modelKey)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'JsWizziEvalHelper created evalContext for', modelKey, 'id', mTreeData.mTree.id, mTreeData.evalContext, mTreeData.ittfDocumentUri</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> evalContext.setValue</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> '__dirname'</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> path.dirname(mTreeData.ittfDocumentUri)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> evalContext.setValue</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> '__filename'</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> mTreeData.ittfDocumentUri</span></li><li class="L6"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> notUsed</span><span class="mix">)</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this._refreshEvalContext</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> mTreeData</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> evalContext</span></li><li class="L0"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> mTreeData.evalContext = evalContext</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> evalContext</span></li><li class="L2"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> _refreshEvalContext</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> mTreeData</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> evalContext</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> mTreeData.mTree.$params</span></li><li class="L6"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> args = mTreeData.mTree.$args</span></li><li class="L7"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> args && args.indexOf('</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> mixin call arguments must be interpolated</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> mTreeData.mTree.$mixerModelKey is the modelKey of the</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> calling node that mixed the mTreeData.mTree</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> we must retrieve the calling node model context</span></li><li class="L2"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> callingNode_ModelContext</span><span class="mix">)</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> this.getMTreeEvalContext</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> mTreeData.mTree.$mixerModelKey</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">try</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> JsWizziContext == null</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> JsWizziContext = require('./jsWizziContext')</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> interpolateArgsContext = new JsWizziContext()</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> interpolateArgsContext.setValues(this.jsWizziContext.globalContext.getSettableValues())</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> interpolateArgsContext.setValues(callingNode_ModelContext.getValues())</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> args = interpolate(args, interpolateArgsContext, {delimiter: '</span><span class="kwd">${</span><span class="expr"></span><span class="kwd">}</span><span class="pln">'})</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> log 'JsWizziEvalHelper interpolateArgs', mTreeData.mTree.$args, args</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> callerMTreeData = this.loadContext.getMTreeData(mTreeData.mTree.$mixerModelKey)</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> callerUri = callerMTreeData ? callerMTreeData.ittfDocumentUri : 'root model';</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> exMessage = ex ? ex.message : 'not available'</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> exStack = ex ? ex.stack : 'not available'</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">return</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> 'Exception interpolating args: ' + args +</span></li><li class="L1"><span class="pnl">                                    </span><span class="tag">\b</span><span class="pln"> ', mTree uri: ' + mTreeData.ittfDocumentUri +</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">\b</span><span class="pln"> ', callerMTree uri: ' + callerUri +</span></li><li class="L3"><span class="pnl">                                    </span><span class="tag">\b</span><span class="pln"> ', ex message: ' + exMessage +</span></li><li class="L4"><span class="pnl">                                    </span><span class="tag">\b</span><span class="pln"> ', stack: ' + exStack</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> '_refreshEvalContext'</span></li><li class="L7"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> paramValues</span><span class="mix">)</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> mTreeData.mTree.getParamValues</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> args</span></li><li class="L0"><span class="pnl">                </span><span class="tag">foreach</span><span class="pln"> item in paramValues</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> item.isByRef</span></li><li class="L2"><span class="pnl">                        </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> callingNode_ModelContext</span><span class="mix">)</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> this.getMTreeEvalContext</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mTreeData.mTree.$mixerModelKey</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> evalContext.setValue</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> item.name</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> callingNode_ModelContext.getValue(item.name)</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> mTreeData.byRefParams = (mTreeData.byRefParams || [])</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> mTreeData.byRefParams.push</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> item.name</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> evalContext.setValue</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> item.name</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> item.value</span></li><li class="L5"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> error</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> extra</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> method</span></li><li class="L9"><span class="pnl">            </span><span class="tag">return</span></li><li class="L0"><span class="pnl">                </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __is_error true</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> message message</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> source 'lib/esprima/jsWizziEvalHelper/' + method</span></li><li class="L4"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> remacro</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Alt+146 = Ã†</span></li><li class="L7"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> verify.replaceAll(value, "${", "</span></li><li class="L8"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports = JsWizziEvalHelper</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d31">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/jsWizziRunner.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> escodegen = require('escodegen')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> esprima = require('esprima')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> verify = require('../util/verify')</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('./errors')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> verbose = false</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> defaultOptions</span></li><li class="L0"><span class="pnl">        </span><span class="tag">{</span></li><li class="L1"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> verbose true</span></li><li class="L2"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> log</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> label</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> force</span></li><li class="L6"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> (verbose || force)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> escodegen.generate(node)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> console.log</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> label</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> util.inspect</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> depth 2</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> runner</span></li><li class="L5"><span class="pnl">        </span><span class="tag">function</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ast</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> action</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> data</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> type</span></li><li class="L1"><span class="pnl">                </span><span class="tag">iif</span><span class="pln"> action</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">then</span><span class="pln"> ast.type + '_' + action</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> ast.type</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> verbose</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> console.log(('ast.type: ' + type))</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> ast.trailingComments && ast.trailingComments.length == 1</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ctx.setRunningNodeId</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ast.trailingComments[0].value</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> trunner = runner[type]</span></li><li class="L1"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> trunner</span></li><li class="L2"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> trunner(ast, ctx, data)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                </span><span class="tag">return</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Missing runner for type: ' + type</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'runner'</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> runnerSet</span></li><li class="L0"><span class="pnl">        </span><span class="tag">function</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ast</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> data</span></li><li class="L4"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> runner(ast, ctx, 'Set', data)</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> runnerCall</span></li><li class="L6"><span class="pnl">        </span><span class="tag">function</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ast</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> data</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> runner(ast, ctx, 'Call', data)</span></li><li class="L1"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> Program</span><span class="mix">)</span></li><li class="L2"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> state</span></li><li class="L3"><span class="pnl">        </span><span class="tag">for</span><span class="pln"> var i = 0; i &lt; node.body.length; i++</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> statement = node.body[i]</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> state</span><span class="pln">,</span><span class="arg">  Program</span><span class="mix">)</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(statement, ctx)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> state.return</span></li><li class="L8"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> state.value</span></li><li class="L9"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> Identifier</span><span class="mix">)</span></li><li class="L0"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.name == 'undefined'</span></li><li class="L1"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'Identifier returning node.name = undefined'</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> undefined</span></li><li class="L3"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> ctx.isDeclared(node.name)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">return</span></li><li class="L5"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ctx.getValue</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.name</span></li><li class="L7"><span class="pnl">        </span><span class="tag">else</span></li><li class="L8"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.esprima.jsWizziRunner.Identifier not found', node.name, ctx</span></li><li class="L9"><span class="pnl">            </span><span class="tag">return</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'Identifier &lt; ' + node.name + ' &gt; not defined, on node &lt; ' + ctx.runningNodeId + ' &gt; ' +</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">\</span><span class="pln"> ctx.getDeclaredInfo()</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'Identifier'</span></li><li class="L7"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> Identifier_Set</span><span class="pln">,</span><span class="arg">  data</span><span class="mix">)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> ctx.put</span></li><li class="L9"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> node.name</span></li><li class="L0"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> data</span></li><li class="L1"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> Literal</span><span class="mix">)</span></li><li class="L2"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> node.value</span></li><li class="L3"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> VariableDeclaration</span><span class="mix">)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> declaration in node.declarations</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> state</span><span class="pln">,</span><span class="arg">  VariableDeclaration</span><span class="mix">)</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner(declaration, ctx)</span></li><li class="L7"><span class="pnl">        </span><span class="tag">return</span></li><li class="L8"><span class="pnl">            </span><span class="tag">{</span></li><li class="L9"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d26">runner(</span><span class="arg"> VariableDeclarator</span><span class="mix">)</span></li><li class="L0"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> !node.init</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.declare</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.id.name</span></li><li class="L3"><span class="pnl">        </span><span class="tag">else</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d25">checked_run(</span><span class="arg"> value</span><span class="pln">,</span><span class="arg">  VariableDeclaration</span><span class="mix">)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> runner</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.init</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.declare</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.id.name</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> value</span></li><li class="L1"><span class="pnl">    </span><span class="kwd">$include</span><span class="mix frag-to-link-a"> jsWizziRunner/statements</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$include</span><span class="mix frag-to-link-a" data-frag-id="d21"> jsWizziRunner/for</span></li><li class="L3"><span class="pnl">    </span><span class="kwd">$include</span><span class="mix frag-to-link-a" data-frag-id="d20"> jsWizziRunner/expressions</span></li><li class="L4"><span class="pnl">    </span><span class="kwd">$include</span><span class="mix frag-to-link-a" data-frag-id="d22"> jsWizziRunner/functions</span></li><li class="L5"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> error</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> parentnode</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> method</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> ex</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> throw new Error('boing')</span></li><li class="L3"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> nodeStm</span></li><li class="L4"><span class="pnl">        </span><span class="tag">try</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> nodeStm = node ? escodegen.generate(node) : ''</span></li><li class="L6"><span class="pnl">        </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> nodeStm = 'escodegen failed: ' + ex.message</span></li><li class="L8"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> nodeInsp = node ? util.inspect(node, {depth:2}) : ''</span></li><li class="L9"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> parentnodeStm</span></li><li class="L0"><span class="pnl">        </span><span class="tag">try</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> parentnodeStm = parentnode ? escodegen.generate(parentnode) : ''</span></li><li class="L2"><span class="pnl">        </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> parentnodeStm = 'escodegen failed: ' + ex.message</span></li><li class="L4"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> parentnodeInsp = node ? util.inspect(node, {depth:2}) : ''</span></li><li class="L5"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> currentModelInfo = ctx.get_currentMTreeInfo()</span></li><li class="L6"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> message</span></li><li class="L7"><span class="pnl">            </span><span class="tag">[</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'JsWizziRunner Error'</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'message: ' + message</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'node statement: ' + nodeStm</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'node inspected: ' + nodeInsp</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'parent node statement: ' + parentnodeStm</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'parent node inspected: ' + parentnodeInsp</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'currentModel_uri: ' + currentModelInfo.currentModel_uri</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'currentModel_callerUri: ' + currentModelInfo.currentModel_callerUri</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'method: ' + method</span></li><li class="L7"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> ex</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> message.push(ex.stack)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">return</span></li><li class="L0"><span class="pnl">            </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> __is_error true</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> message message.join('\n')</span></li><li class="L3"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> getTypeDescription</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L5"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> obj == null</span></li><li class="L6"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> 'null'</span></li><li class="L7"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> typeof(obj)</span></li><li class="L8"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports =</span></li><li class="L9"><span class="pnl">        </span><span class="tag">{</span></li><li class="L0"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> getParsed</span></li><li class="L1"><span class="pnl">                </span><span class="tag">function</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> source</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">try</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> parsed</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> esprima.parse</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> source</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">{</span></li><li class="L8"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> attachComment true</span></li><li class="L9"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> loc true</span></li><li class="L0"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> sourceType 'module'</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> parsed</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">throw</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">new</span><span class="pln"> errors.JsWizziSynthaxError(ex, source)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> run</span></li><li class="L6"><span class="pnl">                </span><span class="tag">function</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> source</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> options</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> options = (options || defaultOptions)</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> parsed = this.getParsed(source)</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> options.dumpfile</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> options.dumpfile</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> JSON.stringify(parsed, null, 2)</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> result = runner(parsed, ctx)</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> callback</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> result && result.__is_error</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> delete (result.__is_error)</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> callback(result)</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> callback(null, result)</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> result</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d32">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/esprima/jsWizziScriptCoder.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">class</span><span class="pln"> JsWizziScriptCoder</span></li><li class="L4"><span class="pnl">        </span><span class="tag">ctor</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.stm = []</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.indentValue = 0</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.length = 0</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.line = ''</span></li><li class="L9"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> for</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.line.length &gt; 0</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.w()</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.w('for (' + text + ') {' + ' //' + node.id)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.indent()</span></li><li class="L6"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> if</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.line.length &gt; 0</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.w()</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.w('if (' + text + ') {' + ' //' + node.id)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.indent()</span></li><li class="L3"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> elif</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.line.length &gt; 0</span></li><li class="L7"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.w()</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.w('else if (' + text + ') {' + ' //' + node.id)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.indent()</span></li><li class="L0"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> else</span></li><li class="L1"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.line.length &gt; 0</span></li><li class="L2"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.w()</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.w('else {')</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.indent()</span></li><li class="L5"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> while</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.line.length &gt; 0</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.w()</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.w('while (' + text + ') {' + ' //' + node.id)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.indent()</span></li><li class="L2"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> end</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.line.length &gt; 0</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.w()</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.deindent()</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.w('}')</span></li><li class="L7"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> w</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ind = spaces(this.indentValue * 4)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.stm.push(ind + this.line + (text || ''))</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.line = ''</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.length++</span></li><li class="L3"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> write</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.line += (text || '')</span></li><li class="L6"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> indent</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.indentValue++</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> deindent</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.indentValue = Math.max(0, (this.indentValue - 1))</span></li><li class="L0"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> toCode</span></li><li class="L1"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.line.length &gt; 0</span></li><li class="L2"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.w()</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this.stm.join('\n')</span></li><li class="L4"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getErrorLines</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> esprimaException</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> start = Math.max(0, (esprimaException.lineNumber - 4))</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> end</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> Math.min</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> this.stm.length</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> (esprimaException.lineNumber + 4)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ret</span></li><li class="L2"><span class="pnl">                </span><span class="tag">[</span></li><li class="L3"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var i = start; i &lt; end; i++</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ret.push(formatLineNumber(i + 1) + ' ' + this.stm[i])</span></li><li class="L5"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> (i == esprimaException.lineNumber - 1)</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> col = esprimaException.column</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> ret.push(spaces(col + 4) + '* ' + esprimaException.description)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ret</span></li><li class="L9"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> spaces</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> num</span></li><li class="L1"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> Array(num + 1).join(" ")</span></li><li class="L2"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> formatLineNumber</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> num</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> num &gt; 999</span></li><li class="L5"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> num</span></li><li class="L6"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> num &gt; 99</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ('0' + num)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> num &gt; 9</span></li><li class="L9"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ('00' + num)</span></li><li class="L0"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> ('000' + num)</span></li><li class="L1"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports = JsWizziScriptCoder</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d33">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/buildup/scripter.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">#</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> from a composed-MTree</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> write the js-script that will</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> buildup an evaluated-MTree</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> the script will be executed</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> by the JsWizziRunner using the "esprima" parser.</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> verify = require('../../util/verify')</span></li><li class="L1"><span class="pnl">    </span><span class="tag">wz-function</span><span class="pln"> codify</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> nparent</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> jsScriptCoder</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L6"><span class="pnl">        </span><span class="tag">var</span></li><li class="L7"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> nnode = ++ctx.counter</span></li><li class="L8"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> closeBlock = null</span></li><li class="L9"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.name == '$' || node.name == '$+'</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> setJsWizziContext</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.model.modelKey</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> jsScriptCoder</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> codeBlock(node, jsScriptCoder)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.name == '$global'</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> setJsWizziContext</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'global'</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> jsScriptCoder</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.model.modelKey</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> codeBlock(node, jsScriptCoder)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> setJsWizziContext</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.model.modelKey</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> jsScriptCoder</span></li><li class="L6"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.name == '$.'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> setJsWizziContext(ctx, null, jsScriptCoder)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> vparent = ('$' + nparent)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> value</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> codifyValue</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.model.modelKey</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.value</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'string'</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> jsScriptCoder.length + 1</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.hasMacro</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> vparent + ".v = " + vparent + ".v ? " + vparent + ".v : ''" + ' //' + node.id</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> vparent + '.v += ($.textSep + ' + value + ');' + ' //' + node.id</span></li><li class="L0"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.name == '$if'</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> setJsWizziContext</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.model.modelKey</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> jsScriptCoder</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.if</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.value</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> closeBlock = '}'</span></li><li class="L9"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.name == '$else'</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.else(node)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> ctx.modelKey = -1</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> closeBlock = '}'</span></li><li class="L3"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.name == '$elif'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.elif</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.value</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> ctx.modelKey = - (1)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> closeBlock = '}'</span></li><li class="L9"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.name == '$while'</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.while</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.value</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> ctx.modelKey = - (1)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> closeBlock = '}'</span></li><li class="L5"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.name == '$for'</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> setJsWizziContext</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.model.modelKey</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> jsScriptCoder</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> items = node.value.split(' ')</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> namevalue = items[0].split(',')</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> name = namevalue[0]</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> value = namevalue[1]</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'var ' + name + ', ' + value + ';' + ' //' + node.id</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.for</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> name + ' in ' + items[2] + ' //' + node.id</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> value + ' = ' + items[2] + '[' + name + '];' + ' //' + node.id</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> closeBlock = '}'</span></li><li class="L2"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.name == '$foreach'</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> setJsWizziContext</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.model.modelKey</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> jsScriptCoder</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> items = node.value.split(' ')</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.for</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'var i' + nnode + '=0, l' + nnode + ' = ' + items[2] + '.length; i' + nnode + '&lt;l' + nnode + '; i' + nnode + '++'</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'var ' + items[0] + ' = ' + items[2] + '[i' + nnode + '];' + ' //' + node.id</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'var _index = i' + nnode + ';' + ' //' + node.id</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'var _count = ' + items[2] + '.length;' + ' //' + node.id</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> closeBlock = '}'</span></li><li class="L8"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.name == '$backeach'</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> setJsWizziContext</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.model.modelKey</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> jsScriptCoder</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> items = node.value.split(' ')</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.for</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'var i' + nnode + '=' + items[2] + '.length-1; i' + nnode + '&gt;-1; i' + nnode + '--'</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'var ' + items[0] + ' = ' + items[2] + '[i' + nnode + '];' + ' //' + node.id</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'var _index = i' + nnode + ';' + ' //' + node.id</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'var _count = ' + items[2] + '.length;' + ' //' + node.id</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> closeBlock = '}'</span></li><li class="L4"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.name == '$virtual'</span></li><li class="L5"><span class="pnl">            </span><span class="tag">+</span><span class="pln"> ;</span></li><li class="L6"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.name == '$function'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> setJsWizziContext</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.model.modelKey</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> jsScriptCoder</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> params = '$parent'</span></li><li class="L2"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> item in node.childs</span></li><li class="L3"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> item.name === '$param'</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> params += ',' + item.value</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w('function ' + node.value + '(' + params + ') {')</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.indent</span></li><li class="L7"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> item in node.childs</span></li><li class="L8"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> item.name !== '$param'</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> codify(item, 'parent', jsScriptCoder, ctx)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.deindent</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w('}');</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span></li><li class="L3"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> node.name == '$_'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> ctx.modelKey = null</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> setJsWizziContext</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.model.modelKey</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> jsScriptCoder</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> vparent = '$' + nparent</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> args = vparent</span></li><li class="L1"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> item in node.childs</span></li><li class="L2"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> item.name === '$@'</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> args += ',' + item.value</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w(node.value + '(' + args + ');');</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> ctx.modelKey = null</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> setJsWizziContext</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node.model.modelKey</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> jsScriptCoder</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span></li><li class="L1"><span class="pnl">        </span><span class="tag">else</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> setJsWizziContext(ctx, null, jsScriptCoder)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'var $' + nnode + ' = { ' +</span></li><li class="L5"><span class="pnl">                    </span><span class="kwd">$$</span><span class="pln"> \b 'n: "' + escapename(node.name) + '", ' +</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">\b</span><span class="pln"> 'n: ' + codifyValue(node.model.modelKey, node.name, 'string', jsScriptCoder.length + 1, node.hasMacro) + ', ' +</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">\b</span><span class="pln"> (node.source ? 'source: ' + escape(node.source) + ', ' : '') +</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">\b</span><span class="pln"> 'v: ' + codifyValue(node.model.modelKey, node.value, 'string', jsScriptCoder.length + 1, node.hasMacro) + ', ' +</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">\b</span><span class="pln"> 'r: ' + node.row + ', ' +</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">\b</span><span class="pln"> 'c: ' + node.col + ', ' +</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">\b</span><span class="pln"> 's: "' + node.model.modelKey + '", ' +</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">\b</span><span class="pln"> 'u: "' + node.sourceKey + '", ' + ' };' + ' //' + node.id</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> vparent = ('$' + nparent)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> '$.a(' + vparent + ', $' + nnode + ', ' + (jsScriptCoder.length + 1) + ');'</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> nparent = nnode</span></li><li class="L7"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.name !== '$' && node.name !== '$global' && node.name !== '$+'</span></li><li class="L8"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> item in node.childs</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> codify(item, nparent, jsScriptCoder, ctx)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> closeBlock</span></li><li class="L1"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> jsScriptCoder.end()</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ctx.modelKey = -1</span></li><li class="L3"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> setJsWizziContext</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> modelKey</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> jsScriptCoder</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> modelKeyInGlobal</span></li><li class="L8"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> ctx.modelKey === modelKey</span></li><li class="L9"><span class="pnl">            </span><span class="tag">return</span></li><li class="L0"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> modelKey === null</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w('$.n();')</span></li><li class="L2"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> modelKey === 'global'</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w('$.g("' + modelKeyInGlobal + '");')</span></li><li class="L4"><span class="pnl">        </span><span class="tag">else</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w('$.s("' + modelKey + '");')</span></li><li class="L6"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> ctx.modelKey = modelKey</span></li><li class="L7"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> codifyValue</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> modelKey</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> type</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> line</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> hasMacro</span></li><li class="L3"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> typeof(value) === 'undefined' || value == null</span></li><li class="L4"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> '""'</span></li><li class="L5"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> type === 'string'</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> value.indexOf('</span></li><li class="L7"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> sHasMacro = hasMacro ? 'true' : 'false'</span></li><li class="L8"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> '$.ip("' + modelKey + '", ' + escape(value) + ', "' + type + '", ' + line + ', ' + sHasMacro + ')'</span></li><li class="L9"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> escape(hasMacro ? remacro(value) : value)</span></li><li class="L0"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> value</span></li><li class="L1"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> codeBlock</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> jsScriptCoder</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.name == '$' || node.name == '$global' || node.name == '$+'</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> node.value && node.value.trim().length &gt; 0</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.value</span></li><li class="L8"><span class="pnl">        </span><span class="tag">else</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> (node.name && (node.name.trim().length &gt; 0))</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> jsScriptCoder.w</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node.name + ' ' + (node.value || '') + ' //' + node.id</span></li><li class="L2"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> item in node.childs</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> codeBlock(item, jsScriptCoder)</span></li><li class="L4"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> escape</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L6"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> typeof (value) === 'undefined'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> "null"</span></li><li class="L8"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> typeof (value) === 'string'</span></li><li class="L9"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> "\"" + verify.replaceAll(verify.replaceAll(value, "\\", "\\\\"), '"', '\\"') + "\""</span></li><li class="L0"><span class="pnl">        </span><span class="tag">else</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> value</span></li><li class="L2"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> escapename</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> verify.isNotEmpty(value)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> verify.replaceAll</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> verify.replaceAll(value, "\\", "\\\\")</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> '"'</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> '\\"'</span></li><li class="L0"><span class="pnl">        </span><span class="tag">else</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> value</span></li><li class="L2"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> remacro</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Alt+146: Ã†</span></li><li class="L5"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> verify.replaceAll(value, "${", "</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d34">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/t/ittfDocumentFinder/recurserTFolder.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> recurserTFolder</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> basePath</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> relPath</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> log 'recurserTFolder enter', basePath, relPath</span></li><li class="L6"><span class="pnl">        </span><span class="tag">return</span></li><li class="L7"><span class="pnl">            </span><span class="tag">new</span><span class="pln"> Promise</span></li><li class="L8"><span class="pnl">                </span><span class="tag">function</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> resolve</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> ittfDocumentUri = path.join(basePath, 't', relPath)</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> that.tryExists</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ittfDocumentUri</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> that.schema</span></li><li class="L4"><span class="pnl">                        </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> result </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> result.found</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> return callback(null, result)</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> log 'recurserTFolder resolve found', result</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">return</span></li><li class="L9"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> resolve(result)</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">else</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> basePath = path.dirname(basePath)</span></li><li class="L2"><span class="pnl">                                </span><span class="tag">if</span><span class="pln"> basePath.length &gt; 3</span></li><li class="L3"><span class="pnl">                                    </span><span class="tag">#</span><span class="pln"> log 'recurserTFolder try parent', basePath</span></li><li class="L4"><span class="pnl">                                    </span><span class="tag">return</span></li><li class="L5"><span class="pnl">                                        </span><span class="tag">_</span><span class="pln"> recurserTFolder</span></li><li class="L6"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> basePath</span></li><li class="L7"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> relPath</span></li><li class="L8"><span class="pnl">                                            </span><span class="tag">._</span><span class="pln"> then</span></li><li class="L9"><span class="pnl">                                                </span><span class="tag">function</span></li><li class="L0"><span class="pnl">                                                    </span><span class="tag">param</span><span class="pln"> result</span></li><li class="L1"><span class="pnl">                                                    </span><span class="tag">#</span><span class="pln"> log 'recurserTFolder transmit resolve result', basePath, result</span></li><li class="L2"><span class="pnl">                                                    </span><span class="tag">_</span><span class="pln"> resolve(result)</span></li><li class="L3"><span class="pnl">                                    </span><span class="tag">#</span><span class="pln"> return that.resolvePathInTFolders(basePath, relPath, callback)</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">else</span></li><li class="L5"><span class="pnl">                                    </span><span class="tag">#</span><span class="pln"> log 'recurserTFolder resolve not found', basePath</span></li><li class="L6"><span class="pnl">                                    </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                                        </span><span class="tag">_</span><span class="pln"> resolve</span></li><li class="L8"><span class="pnl">                                            </span><span class="tag">{</span></li><li class="L9"><span class="pnl">                                                </span><span class="tag">@</span><span class="pln"> found false</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d35">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/t/mTree/getParamValues.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> getParamValues</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> args</span></li><li class="L4"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> params = this.$params</span></li><li class="L5"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> mTreeRootNode = this.nodes[0]</span></li><li class="L6"><span class="pnl">        </span><span class="tag">var</span></li><li class="L7"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> _paramArray</span></li><li class="L8"><span class="pnl">                </span><span class="tag">[</span></li><li class="L9"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> _argsArray</span></li><li class="L0"><span class="pnl">                </span><span class="tag">[</span></li><li class="L1"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> params !== null && typeof(params) === 'string' && params.length &gt; 0</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> _paramArray = params.trim().split(',')</span></li><li class="L3"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> args !== null && typeof(args) === 'string' && args.length &gt; 0</span></li><li class="L4"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> _argsArray = args.trim().split(',')</span></li><li class="L5"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> result</span></li><li class="L6"><span class="pnl">            </span><span class="tag">[</span></li><li class="L7"><span class="pnl">        </span><span class="tag">for</span><span class="pln"> var i = 0; i &lt; _paramArray.length; i++</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span></li><li class="L9"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> name</span></li><li class="L0"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> type = 'string'</span></li><li class="L1"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> defaultValue = null</span></li><li class="L2"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> value = null</span></li><li class="L3"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> hasparamvalue = false</span></li><li class="L4"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> hasdefaultvalue = false</span></li><li class="L5"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> a param may have the format</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> 1) name</span></li><li class="L7"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> 2) name|default</span></li><li class="L8"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> 3) name:type|default</span></li><li class="L9"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> valid types: string(default), integer, float, boolean, date</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> param_parts</span></li><li class="L1"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> _paramArray[i].trim()</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">._</span><span class="pln"> split(/[|]/)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> param_parts.length &gt; 2</span></li><li class="L4"><span class="pnl">                </span><span class="tag">return</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Error evaluating: $params ' + params +</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ' , Argument ' + i + ' is malformed. Expected name[:type[|default]]'</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> mTreeRootNode</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'getParamValues'</span></li><li class="L0"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> param_parts.length == 2</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> defaultValue = param_parts[1].trim()</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> hasdefaultvalue = true</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> param_parts</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> param_parts[0].trim()</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">._</span><span class="pln"> split(/[:]/)</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> param_parts.length &gt; 2</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Error evaluating: $params ' + params +</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', argument ' + i + ' is malformed. Expected name[:type[|default]]'</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> mTreeRootNode</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'getParamValues'</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> param_parts.length == 2</span></li><li class="L4"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> type = param_parts[1]</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> name = param_parts[0]</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> name.substr(0, 1) === '&'</span></li><li class="L7"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> name = name.substr(1)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> type = 'object'</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> _argsArray.length &gt; i</span></li><li class="L0"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> value = _argsArray[i].trim()</span></li><li class="L1"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> type === 'object'</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> value.substr(0, 1) !== '&'</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">return</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> 'Error evaluating: $params ' + params +</span></li><li class="L6"><span class="pnl">                                    </span><span class="tag">\b</span><span class="pln"> ', argument (' + i + ') must be an object reference. Found ' + value</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mTreeRootNode</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> 'getParamValues'</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> value = value.substr(1)</span></li><li class="L1"><span class="pnl">                </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> value = types.objectify(value, type, mTreeRootNode, true)</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> value && value.__is_error</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> error</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> 'Error evaluating: $params ' + params +</span></li><li class="L7"><span class="pnl">                                    </span><span class="tag">\b</span><span class="pln"> ', objectifying parameter: ' + i + '/' + name</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mTreeRootNode</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> 'getParamValues'</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> error.inner = value</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> error</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> hasparamvalue = true</span></li><li class="L3"><span class="pnl">            </span><span class="tag">elif</span><span class="pln"> hasdefaultvalue</span></li><li class="L4"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> value = types.objectify(defaultValue, type, mTreeRootNode, true)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> value && value.__is_error</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> error</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'Error evaluating: $params ' + params +</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">\b</span><span class="pln"> ', objectifying parameter: ' + i + '/' + name</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> mTreeRootNode</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'getParamValues'</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> error.inner = value</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> error</span></li><li class="L4"><span class="pnl">            </span><span class="tag">else</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Error evaluating: $params ' + params +</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> ', missing value for not optional argument ' + i + ' = ' + name</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> mTreeRootNode</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'getParamValues'</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> isTemplate</span></li><li class="L2"><span class="pnl">                </span><span class="tag">iif</span><span class="pln"> type === 'object'</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">then</span><span class="pln"> false</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> types.isTemplate(value)</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> result.push</span></li><li class="L7"><span class="pnl">                </span><span class="tag">{</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> name</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">iif</span><span class="pln"> name.substr(0, 1) === '&'</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">then</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> name.substr(1)</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">else</span><span class="pln"> name</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> value value</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> type type</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> isTemplate isTemplate</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> isByRef type === 'object'</span></li><li class="L7"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> result</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d36">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/appender.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('../errors')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> utilnode = require('../util/node')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L7"><span class="pnl">        </span><span class="tag">function</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> mixedMTree</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> appends</span></li><li class="L1"><span class="pnl">                </span><span class="tag">{</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> groups</span></li><li class="L3"><span class="pnl">                </span><span class="tag">[</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> overrides</span></li><li class="L5"><span class="pnl">                </span><span class="tag">[</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ctx</span></li><li class="L7"><span class="pnl">                </span><span class="tag">{</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> id 1</span></li><li class="L9"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> node in mixedMTree.nodes</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> assignId</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ctx</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> errors</span></li><li class="L4"><span class="pnl">                </span><span class="tag">[</span></li><li class="L5"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> node in mixedMTree.nodes</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> searchAppend(node, node, appends, groups, overrides, errors)</span></li><li class="L7"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> errors.length &gt; 0</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">return</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> errors[0]</span></li><li class="L1"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var key in appends</span></li><li class="L2"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> appobj = appends[key]</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> utilnode.replace</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> appobj.appto</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> appobj.items</span></li><li class="L6"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var key in overrides</span></li><li class="L7"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> overobj = overrides[key]</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> utilnode.replace</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> overobj.virt</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> overobj.items</span></li><li class="L1"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> item in groups</span></li><li class="L2"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> !item.parent</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">return</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> "The tag $group must have a parent and may be used in a fragment only. Hint: check for fragments not in a tfolder."</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> item</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> utilnode.replace</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> item</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> item.childs</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> toremove</span></li><li class="L2"><span class="pnl">                </span><span class="tag">[</span></li><li class="L3"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> node in mixedMTree.nodes</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> searchPendingNodes(node, toremove)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> item in toremove</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> utilnode.remove(item)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> callback(null, mixedMTree)</span></li><li class="L8"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> searchAppend</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> item</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> root</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> appends</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> groups</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> overrides</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> errors</span></li><li class="L5"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> item.name === '$group'</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> groups.push(item)</span></li><li class="L7"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> item.name === '$append'</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !item.value</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> errors.push</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> "The tag $append requires a value."</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> item</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> appto</span></li><li class="L5"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> utilnode.findHookExt</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> item</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> item.value.trim()</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> appto == null</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> errors.push</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Cannot find hook ' + (item.value || '') + ', root is ' + root.name</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> + ' ' + (root.value || '') + ', in ' + item.model.uri</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> + ', remember that $hook/$append does not work between siebling nodes.'</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> + 'After mixup the $hook node must be a parent node or a descendant of a parent node of $append'</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">\b</span><span class="pln"> + ', but not a siebling node.'</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> item</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> appobj = appends[item.id]</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> appobj</span></li><li class="L0"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> appobj.items = appobj.items.concat(item.childs)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> appobj =</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> appto appto</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> items item.childs</span></li><li class="L6"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> appends[item.id] = appobj</span></li><li class="L7"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> item.name === '$override'</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> ! (item.value)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> errors.push</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> "The tag $override requires a value."</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> item</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> virt</span></li><li class="L5"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> utilnode.findVirtual</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> item</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> item.value.trim()</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> virt == null</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> errors.push</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Cannot find virtual to override ' + (item.value || '') + ', root is ' + root.name + ' ' + root.value</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> item</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> overobj = overrides[item.value]</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> overobj</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> errors.push</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'The virtual node ' + item.value + ' has already been overridden. Root is ' + root.name + ' ' + root.value</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> item</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span></li><li class="L1"><span class="pnl">            </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> overobj =</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> virt virt</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> over item</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> items item.childs</span></li><li class="L7"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> overrides[item.value] = overobj</span></li><li class="L8"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> child in item.childs</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> searchAppend(child, root, appends, groups, overrides, errors)</span></li><li class="L0"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> searchPendingNodes</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> item</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> toremove</span></li><li class="L3"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> ['$hook', '$append', '$override'].indexOf(item.name) &gt;= 0</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> toremove.push(item)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> child in item.childs</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> searchPendingNodes(child, toremove)</span></li><li class="L7"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> assignId</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> item</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L0"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> item._id = ctx.id++</span></li><li class="L1"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> child in item.childs</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> assignId(child, ctx)</span></li><li class="L3"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> error</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L6"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node && node.name</span></li><li class="L7"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> '************************* node', node</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span></li><li class="L9"><span class="pnl">                </span><span class="tag">{</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __is_error true</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> message message</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> nodeInfo 'Node ' + node.name + ' ' + (node.value || '') + ' row: ' + node.row + ' col: ' + node.col</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> document node.model.uri</span></li><li class="L4"><span class="pnl">        </span><span class="tag">else</span></li><li class="L5"><span class="pnl">            </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                </span><span class="tag">{</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __is_error true</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> message message</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d37">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/evaluator.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> assert</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> jsWizziRunner = require('../esprima/jsWizziRunner')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> JsWizziContext = require('../esprima/jsWizziContext')</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> dateUtil = require('../esprima/functions/dateutil')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> JsWizziScriptCoder = require('../esprima/JsWizziScriptCoder')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> scripter = require('./buildup/scripter')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">#</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> param requestContext {</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> modelContext: Object</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> productionContext: Object {</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> runnerServer: Object</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L7"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports =</span></li><li class="L8"><span class="pnl">        </span><span class="tag">function</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> composedMTree</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> requestContext</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L2"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.loader.evaluator.requestContext', requestContext</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> productionContext = requestContext.productionContext</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ctx</span></li><li class="L5"><span class="pnl">                </span><span class="tag">{</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> modelKey null</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> counter 0</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> startTime dateUtil.now_GMYHMS()</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> scriptCoder</span></li><li class="L0"><span class="pnl">                </span><span class="tag">new</span><span class="pln"> JsWizziScriptCoder()</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> scriptCoder.w</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> '// ' + ctx.startTime + '  by ' + __filename</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> scriptCoder.w</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> '$.n(); // set the context state to NodeContext'</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> scriptCoder.w</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'var $0 = {}; // the root node of the MTree buildup'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> item in composedMTree.nodes</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> scripter.codify(item, 0, scriptCoder, ctx)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> productionContext.addMTreeBuildUpScript</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> composedMTree.uri</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> scriptCoder</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> jsWizziContext</span></li><li class="L3"><span class="pnl">                </span><span class="tag">new</span><span class="pln"> JsWizziContext(composedMTree, productionContext)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsWizziContext.setGlobalValues</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> requestContext.modelContext</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsWizziRunner.run</span></li><li class="L7"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> scriptCoder.toCode()</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> jsWizziContext</span></li><li class="L9"><span class="pnl">                </span><span class="tag">{</span></li><li class="L0"><span class="pnl">                </span><span class="tag">function</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> result</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> err</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">return</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> callback(err)</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> jsWizziContext.set_NodeContext()</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> $0 = jsWizziContext.getValue('$0')</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> assert</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> $0</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> "wizzi/evaluator. The jsWizziRunner did not return the $0 root object. Something went wery bad."</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> typeof($0) === 'undefined' || $0 == null || $0.childs === 'undefined'</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">{</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> message 'No nodes returned after IttfEvaluation.'</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> document composedMTree.uri</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> composedMTree.nodes = []</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">foreach</span><span class="pln"> item in $0.childs</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> item.parent = null</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> composedMTree.nodes.push(item)</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> composedMTree.data =</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> createdAt ctx.startTime</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> callback(null, composedMTree)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d38">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/includer.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> path = require('path')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> async = require('async')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('../errors')</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> verify = require('../util/verify')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> utilnode = require('../util/node')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">#</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Ittf commands</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $include</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $json</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> includer</span></li><li class="L4"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> module.exports =</span></li><li class="L5"><span class="pnl">            </span><span class="tag">function</span></li><li class="L6"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> wipNodifiedMTree</span></li><li class="L7"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> mTreeProvider</span></li><li class="L8"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L9"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> includes</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">[</span></li><li class="L1"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> jsons</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">[</span></li><li class="L3"><span class="pnl">                </span><span class="tag">foreach</span><span class="pln"> node in wipNodifiedMTree.nodes</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> searchIncludes</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> includes</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> jsons</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> async.mapSeries</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> includes</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">function</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> item</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> v = item.value.trim()</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> calleruri = item.model.uri</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> callerbasedir = path.dirname(calleruri)</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> mTreeProvider.get</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">{</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> from 'store'</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> basedir callerbasedir</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> relpath v</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> include true</span></li><li class="L2"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> includerModelKey item.model.modelKey</span></li><li class="L3"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> includedWipNodifiedMTree </span><span class="mix">)</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> mTreeProvider.enterFragmentCall</span></li><li class="L5"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> calleruri</span></li><li class="L6"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> includedWipNodifiedMTree.uri</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">if</span><span class="pln"> mTreeProvider.checkForRecursion()</span></li><li class="L8"><span class="pnl">                                    </span><span class="tag">var</span><span class="pln"> error</span></li><li class="L9"><span class="pnl">                                        </span><span class="tag">new</span><span class="pln"> errors.IttfLoadError</span></li><li class="L0"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> ('Recursive mixin or include: ' + v)</span></li><li class="L1"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> includedWipNodifiedMTree.uri</span></li><li class="L2"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L3"><span class="pnl">                                            </span><span class="tag">new</span><span class="pln"> Error()</span></li><li class="L4"><span class="pnl">                                    </span><span class="tag">return</span><span class="pln"> callback(error)</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> includer</span></li><li class="L6"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> includedWipNodifiedMTree</span></li><li class="L7"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> mTreeProvider</span></li><li class="L8"><span class="pnl">                                    </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> includeResult </span><span class="mix">)</span></li><li class="L9"><span class="pnl">                                        </span><span class="tag">_</span><span class="pln"> mTreeProvider.exitFragmentCall()</span></li><li class="L0"><span class="pnl">                                        </span><span class="tag">#</span><span class="pln"> _ mTreeProvider.callChain.pop()</span></li><li class="L1"><span class="pnl">                                        </span><span class="tag">_</span><span class="pln"> utilnode.replace</span></li><li class="L2"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> item</span></li><li class="L3"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> includeResult.nodes</span></li><li class="L4"><span class="pnl">                                        </span><span class="tag">return</span></li><li class="L5"><span class="pnl">                                            </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L6"><span class="pnl">                                                </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L7"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> results </span><span class="mix">)</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">foreach</span><span class="pln"> item in jsons</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">var</span><span class="pln"> json</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> JSON.parse</span></li><li class="L1"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> item.value</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> verify.isArray(json)</span></li><li class="L3"><span class="pnl">                                </span><span class="tag">var</span><span class="pln"> normalized</span></li><li class="L4"><span class="pnl">                                    </span><span class="tag">[</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">foreach</span><span class="pln"> jsonitem in json</span></li><li class="L6"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> normalized.push</span></li><li class="L7"><span class="pnl">                                        </span><span class="tag">_</span><span class="pln"> normalizeNode</span></li><li class="L8"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> jsonitem</span></li><li class="L9"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> item.parent</span></li><li class="L0"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> item.model</span></li><li class="L1"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> item.row</span></li><li class="L2"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> item.col</span></li><li class="L3"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> item.sourceKey</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> utilnode.replace(item, normalized)</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">else</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">var</span><span class="pln"> normalized</span></li><li class="L7"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> normalizeNode</span></li><li class="L8"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> json</span></li><li class="L9"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> item.parent</span></li><li class="L0"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> item.model</span></li><li class="L1"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> item.row</span></li><li class="L2"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> item.col</span></li><li class="L3"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> item.sourceKey</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> utilnode.replace</span></li><li class="L5"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> item</span></li><li class="L6"><span class="pnl">                                    </span><span class="tag">[</span></li><li class="L7"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> normalized</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> callback(null, wipNodifiedMTree)</span></li><li class="L9"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> searchIncludes</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> item</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> includes</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> jsons</span></li><li class="L3"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> item.name === '$include'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> includes.push(item)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> item.name === '$json'</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsons.push(item)</span></li><li class="L7"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> child in item.childs</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> searchIncludes</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> child</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> includes</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> jsons</span></li><li class="L2"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> normalizeNode</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> parent</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> model</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> r</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> c</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> u</span></li><li class="L9"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> node.parent = parent</span></li><li class="L0"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> node.model = model</span></li><li class="L1"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> node.row = r</span></li><li class="L2"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> node.col = c</span></li><li class="L3"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> node.souceKey = u</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.childs</span></li><li class="L5"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> item in node.childs</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> normalizeNode(item, node, model, r, c, u)</span></li><li class="L7"><span class="pnl">        </span><span class="tag">else</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node.childs = []</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d39">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/index.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> path = require('path')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('../errors')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> verify = require('../util/verify')</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> node = require('../util/node')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> MTreeProvider = require('./mTreeProvider')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> includer = require('./includer')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mixer = null</span></li><li class="L1"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> appender = require('./appender')</span></li><li class="L2"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> evaluator = require('./evaluator')</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> md</span></li><li class="L4"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> module.exports =</span></li><li class="L5"><span class="pnl">            </span><span class="tag">{</span></li><li class="L6"><span class="pnl">    </span><span class="tag">#</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> The Big JOB of an mTree loading</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> manages</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> normalization of context objects</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> instantiation of the modelProvider</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> liner</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> nodifier</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> includer</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> mixer</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> appender</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> evaluator</span></li><li class="L7"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.loadMTree</span></li><li class="L8"><span class="pnl">        </span><span class="tag">function</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> primaryIttfDocumentUri</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> requestContext</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> typeof(callback) !== 'function'</span></li><li class="L3"><span class="pnl">                </span><span class="tag">throw</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">new</span><span class="pln"> Error("wizzi-mtree/lib/loader/loadMTree. A callback is required. Uri: " + primaryIttfDocumentUri)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> originalrequestContext = requestContext</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> requestContext = normalizeRequestContext(requestContext)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> requestContext.__is_error</span></li><li class="L8"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> requestContext.ittfDocumentUri = primaryIttfDocumentUri</span></li><li class="L9"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> requestContext.instance = originalrequestContext</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> callback(requestContext)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> primaryIttfDocumentUri</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> requestContext</span></li><li class="L5"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> createdProvider </span><span class="mix">)</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> wipNodifiedMTree = createdProvider.getPrimaryMTree()</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> !wipNodifiedMTree.nodes || wipNodifiedMTree.nodes.length == 0</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> callback(null, wipNodifiedMTree)</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.loader.index.wipNodifiedMTree', wipNodifiedMTree.dump()</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> resolve $include commands</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> includer</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> wipNodifiedMTree</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> createdProvider</span></li><li class="L4"><span class="pnl">                        </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> wipIncludedMTree </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> mixer == null</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> mixer = require('./mixer')</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> mix primary MTree and fragments</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> mixer</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> wipIncludedMTree</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> createdProvider</span></li><li class="L1"><span class="pnl">                                </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> wipMixedMTree </span><span class="mix">)</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> requestContext.productionContext.addMixedMTree(primaryIttfDocumentUri, wipMixedMTree)</span></li><li class="L3"><span class="pnl">                                    </span><span class="tag">#</span><span class="pln"> resolve $group, $hook and $append commands</span></li><li class="L4"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> appender</span></li><li class="L5"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> wipMixedMTree</span></li><li class="L6"><span class="pnl">                                        </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> wipAppendedMTree</span><span class="mix">)</span></li><li class="L7"><span class="pnl">                                            </span><span class="tag">#</span><span class="pln"> evaluate</span></li><li class="L8"><span class="pnl">                                            </span><span class="tag">_</span><span class="pln"> evaluator</span></li><li class="L9"><span class="pnl">                                                </span><span class="tag">@</span><span class="pln"> wipAppendedMTree</span></li><li class="L0"><span class="pnl">                                                </span><span class="tag">@</span><span class="pln"> requestContext</span></li><li class="L1"><span class="pnl">                                                </span><span class="tag">function</span></li><li class="L2"><span class="pnl">                                                    </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L3"><span class="pnl">                                                    </span><span class="tag">param</span><span class="pln"> finalMTree</span></li><li class="L4"><span class="pnl">                                                    </span><span class="tag">if</span><span class="pln"> err</span></li><li class="L5"><span class="pnl">                                                        </span><span class="tag">set</span><span class="pln"> err.ittfDocumentUri = primaryIttfDocumentUri</span></li><li class="L6"><span class="pnl">                                                        </span><span class="tag">return</span><span class="pln"> callback(err)</span></li><li class="L7"><span class="pnl">                                                    </span><span class="tag">set</span><span class="pln"> finalMTree.loadContext = createdProvider.loadContext</span></li><li class="L8"><span class="pnl">                                                    </span><span class="tag">_</span><span class="pln"> requestContext.productionContext.addEvaluatedMTree(primaryIttfDocumentUri, finalMTree)</span></li><li class="L9"><span class="pnl">                                                    </span><span class="tag">_</span><span class="pln"> callback(null, finalMTree)</span></li><li class="L0"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> normalizeRequestContext</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> context</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.loader.index.normalizeRequestContext.context', context</span></li><li class="L3"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> verify.isObject(context) == false</span></li><li class="L4"><span class="pnl">            </span><span class="tag">return</span></li><li class="L5"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'A request context object is required'</span></li><li class="L7"><span class="pnl">        </span><span class="tag">else</span></li><li class="L8"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var k in context</span></li><li class="L9"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'normalizeRequestContext.k', k</span></li><li class="L0"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> verify.isObject(context.__productionManager) == false</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span></li><li class="L2"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'A request context must contain a __productionManager object'</span></li><li class="L4"><span class="pnl">        </span><span class="tag">else</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> context.productionContext = context.__productionManager.productionContext</span></li><li class="L6"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> verify.isObject(context.productionContext.aclstat) == false</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'A productionContext must contain an aclstat object'</span></li><li class="L0"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> verify.isObject(context.__ittfDocumentStore) == false</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span></li><li class="L2"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'A request context must contain an __ittfDocumentStore object'</span></li><li class="L4"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> verify.isObject(context.modelContext) == false</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> context.modelContext = {}</span></li><li class="L6"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> verify.isObject(context.artifactContext) == false</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> context.artifactContext = {}</span></li><li class="L8"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> context</span></li><li class="L9"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> error</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L1"><span class="pnl">        </span><span class="tag">return</span></li><li class="L2"><span class="pnl">            </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> __is_error true</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> operation 'wizzi-mtree/lib/loader/index'</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> message message</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d40">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/ittfDocumentFinder.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('../errors')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> isString</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L7"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> toString.call(obj) === '[object String]'</span></li><li class="L8"><span class="pnl">    </span><span class="tag">class</span><span class="pln"> IttfDocumentFinder</span></li><li class="L9"><span class="pnl">        </span><span class="tag">ctor</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> store</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> schema</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.store = store</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.schema = schema</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span></li><li class="L5"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> param options {</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> ittfDocumentUri:String</span></li><li class="L7"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> |</span></li><li class="L8"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> basedir:String</span></li><li class="L9"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> relpath:String</span></li><li class="L0"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L1"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> resolvePath</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> options</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span></li><li class="L5"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> ittfDocumentUri = options.ittfDocumentUri</span></li><li class="L6"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> relpath = options.relpath</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> isString(ittfDocumentUri) === false</span></li><li class="L8"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> (isString(relpath) === false) || (relpath[0] === '/')</span></li><li class="L9"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="unknown">var_cb_error(</span><span class="arg"> InvalidRequest </span><span class="mix">)</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'ittf.repo.IttfDocumentFinder.resolvePath. A "relpath" options with a relative path is required to load an ITTF document, or use the "ittfDocumentUri" option'</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'InvalidPath'</span></li><li class="L2"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> basedir = options.basedir</span></li><li class="L3"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> isString (basedir) === false</span></li><li class="L4"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="unknown">var_cb_error(</span><span class="arg"> InvalidRequest </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'ittf.repo.IttfDocumentFinder. A "basedir" option is required to load an ITTF document using a relative path'</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'InvalidPath'</span></li><li class="L7"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> isString (relpath) === false</span></li><li class="L8"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="unknown">var_cb_error(</span><span class="arg"> InvalidRequest </span><span class="mix">)</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'ittf.repo.IttfDocumentFinder. A "relpath" option is required to load an ITTF document using a relative path'</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'InvalidPath'</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ittfDocumentUri = path.join(basedir, relpath)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> that = this</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.tryExists</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ittfDocumentUri</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> this.schema</span></li><li class="L6"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> result </span><span class="mix">)</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> result.found</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">return</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> result.ittfDocumentUri</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> isString (relpath) === false</span></li><li class="L4"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="unknown">var_error(</span><span class="arg"> IttfNotFound </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> 'IttfDocument'</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> ittfDocumentUri</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">return</span><span class="pln"> callback(error)</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> that.resolvePathInTFolders</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> path.dirname(ittfDocumentUri)</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> relpath</span></li><li class="L1"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> tresult </span><span class="mix">)</span></li><li class="L2"><span class="pnl">                                </span><span class="tag">if</span><span class="pln"> tresult.found</span></li><li class="L3"><span class="pnl">                                    </span><span class="tag">return</span></li><li class="L4"><span class="pnl">                                        </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L5"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L6"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> tresult.ittfDocumentUri</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">else</span></li><li class="L8"><span class="pnl">                                    </span><span class="tag">#</span><span class="pln"> log 'IttfDocumentFinder.resolvePath options', options, that.schema</span></li><li class="L9"><span class="pnl">                                    </span><span class="mix frag-to-link-a" data-frag-id="unknown">var_error(</span><span class="arg"> IttfNotFound </span><span class="mix">)</span></li><li class="L0"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> 'IttfDocument'</span></li><li class="L1"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> ittfDocumentUri</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">return</span><span class="pln"> callback(error)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> resolvePathInTFolders</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> basePath</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> relPath</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> that = this</span></li><li class="L8"><span class="pnl">            </span><span class="kwd">$include</span><span class="mix frag-to-link-a" data-frag-id="d34"> ittfDocumentFinder/recurserTFolder</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> recurserTFolder</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> basePath</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> relPath</span></li><li class="L2"><span class="pnl">                </span><span class="tag">._</span><span class="pln"> then</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">function</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> result</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> callback(null, result)</span></li><li class="L7"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> tryExists</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> test</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> schema</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> that = this</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.store.documentExists</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> test</span></li><li class="L4"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> result </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> result</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">{</span></li><li class="L0"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> found true</span></li><li class="L1"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> ittfDocumentUri test</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> test.toLowerCase().substr(-5, 5) !== '.ittf'</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> schema</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> that.store.documentExists</span></li><li class="L6"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> test + '.' + schema + '.ittf'</span></li><li class="L7"><span class="pnl">                                    </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> result </span><span class="mix">)</span></li><li class="L8"><span class="pnl">                                        </span><span class="tag">if</span><span class="pln"> result</span></li><li class="L9"><span class="pnl">                                            </span><span class="tag">return</span></li><li class="L0"><span class="pnl">                                                </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L1"><span class="pnl">                                                    </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L2"><span class="pnl">                                                    </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                                                        </span><span class="tag">@</span><span class="pln"> found true</span></li><li class="L4"><span class="pnl">                                                        </span><span class="tag">@</span><span class="pln"> ittfDocumentUri test + '.' + schema + '.ittf'</span></li><li class="L5"><span class="pnl">                                        </span><span class="tag">else</span></li><li class="L6"><span class="pnl">                                            </span><span class="tag">_</span><span class="pln"> that.store.documentExists</span></li><li class="L7"><span class="pnl">                                                </span><span class="tag">@</span><span class="pln"> test + '.ittf'</span></li><li class="L8"><span class="pnl">                                                </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> result </span><span class="mix">)</span></li><li class="L9"><span class="pnl">                                                    </span><span class="tag">if</span><span class="pln"> result</span></li><li class="L0"><span class="pnl">                                                        </span><span class="tag">return</span></li><li class="L1"><span class="pnl">                                                            </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L2"><span class="pnl">                                                                </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L3"><span class="pnl">                                                                </span><span class="tag">{</span></li><li class="L4"><span class="pnl">                                                                    </span><span class="tag">@</span><span class="pln"> found true</span></li><li class="L5"><span class="pnl">                                                                    </span><span class="tag">@</span><span class="pln"> ittfDocumentUri test + '.ittf'</span></li><li class="L6"><span class="pnl">                                                    </span><span class="tag">else</span></li><li class="L7"><span class="pnl">                                                        </span><span class="tag">return</span></li><li class="L8"><span class="pnl">                                                            </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L9"><span class="pnl">                                                                </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L0"><span class="pnl">                                                                </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                                                                    </span><span class="tag">@</span><span class="pln"> found false</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">else</span></li><li class="L3"><span class="pnl">                                </span><span class="tag">return</span></li><li class="L4"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L5"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L6"><span class="pnl">                                        </span><span class="tag">{</span></li><li class="L7"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> found false</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">return</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L1"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> found false</span></li><li class="L4"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports = IttfDocumentFinder</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d41">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/ittfInterpolate.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> jsWizziRunner = require('../esprima/jsWizziRunner')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> state_text = 0</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> state_tag = 1</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> state_key = 2</span></li><li class="L7"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> interpolate</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> template</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> jsWizziContext</span></li><li class="L0"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> typeof template === 'undefined' || template === null</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ''</span></li><li class="L2"><span class="pnl">        </span><span class="tag">var</span></li><li class="L3"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> l = template.length</span></li><li class="L4"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> result = []</span></li><li class="L5"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> ch</span></li><li class="L6"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> key</span></li><li class="L7"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> inside_tags = 0</span></li><li class="L8"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> state = state_text</span></li><li class="L9"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> replacer = null</span></li><li class="L0"><span class="pnl">            </span><span class="tag">decl</span><span class="pln"> keyOrCode</span></li><li class="L1"><span class="pnl">        </span><span class="tag">for</span><span class="pln"> var i=0; i&lt;l; i++</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> ch = template[i]</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> state == state_text &&</span></li><li class="L4"><span class="pnl">                </span><span class="tag">\b</span><span class="pln"> ch == '\\' &&</span></li><li class="L5"><span class="pnl">                </span><span class="tag">\b</span><span class="pln"> i+3 &lt; l &&</span></li><li class="L6"><span class="pnl">                </span><span class="tag">\b</span><span class="pln"> template[i+1] == '$' &&</span></li><li class="L7"><span class="pnl">                </span><span class="tag">\b</span><span class="pln"> template[i+2] == '\\' &&</span></li><li class="L8"><span class="pnl">                </span><span class="tag">\b</span><span class="pln"> template[i+3] == '{'</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> result.push('</span></li><li class="L0"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> i = i +3</span></li><li class="L1"><span class="pnl">                </span><span class="tag">continue</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> ch == '$'</span></li><li class="L3"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> state == state_text</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> state = state_tag</span></li><li class="L5"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> state == state_key</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> key.push(ch)</span></li><li class="L7"><span class="pnl">                </span><span class="tag">else</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> state == state_tag</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> case double $$, is text</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> result.push('$$')</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> state = state_text</span></li><li class="L2"><span class="pnl">            </span><span class="tag">elif</span><span class="pln"> ch == '{'</span></li><li class="L3"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> state == state_text</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> result.push(ch)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> state == state_key</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> case '{' inside $ { }</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> inside_tags++</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> key.push(ch)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">else</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> state == state_tag</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> case </span></li><li class="L2"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> state = state_key</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> key = []</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> inside_tags = 0</span></li><li class="L5"><span class="pnl">            </span><span class="tag">elif</span><span class="pln"> ch == '}'</span></li><li class="L6"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> state == state_text</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> result.push(ch)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> state == state_key</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> inside_tags &gt; 0</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> case '{}' inside $ { }</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> inside_tags--</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> key.push(ch)</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> keyOrCode = key.join('').replace(/\s/g,'')</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> keyOrCode.length == 0</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> case empty </span><span class="kwd">${</span><span class="expr"></span><span class="kwd">}</span><span class="pln"> - is ok do not replace</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> result.push('</span><span class="kwd">${</span><span class="expr"></span><span class="kwd">}</span><span class="pln">')</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> replacer</span><span class="pln">,</span><span class="arg">  ittf.interpolate </span><span class="mix">)</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> evalKeyOrCode(keyOrCode, jsWizziContext)</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> result.push(replacer)</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> state = state_text</span></li><li class="L3"><span class="pnl">                </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> state == state_tag</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> case strange sequence '$}' but ok</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> result.push('$}')</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> state = state_text</span></li><li class="L8"><span class="pnl">            </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> state == state_text</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> result.push(ch)</span></li><li class="L1"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> state == state_key</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> key.push(ch)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> state == state_tag</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> case sequence '$*' is text</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> result.push('$' + ch)</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> state = state_text</span></li><li class="L8"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> state == state_key</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> result.push('</span></li><li class="L0"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> state == state_tag</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> result.push('$')</span></li><li class="L2"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> result.join('')</span></li><li class="L3"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> evalKeyOrCode</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> keyOrCode</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> jsWizziContext</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> log 'ittfInterpolate.evalKeyOrCode: ', keyOrCode</span></li><li class="L7"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> notUsed</span><span class="pln">,</span><span class="arg">  ittf.interpolate.evalKeyOrCode </span><span class="mix">)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> jsWizziRunner.run('var _____result = ' + keyOrCode, jsWizziContext)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> jsWizziContext.getValue('_____result')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports = interpolate</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d42">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/liner.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">#</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Reads an IttfDocument and extract an array of line descriptions</span></li><li class="L6"><span class="pnl">    </span><span class="tag">#</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Input</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> param textContent:String - The text content of the IttfDocument</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> param ittfDocumentData:Object {</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> sourceKey:String - The IttfDocument key generated by the loadContext</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L2"><span class="pnl">    </span><span class="tag">#</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Output</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> lines:Array of</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> line : {</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> indent: Number,</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> name: String,</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> value: String, // always trimmed</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> row: Number,</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> col: Number,</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> sourceKey: String,</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> tagSuffix: undefined || '(',</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> hasMacro: Boolean</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L5"><span class="pnl">    </span><span class="tag">#</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Ittf commands for comments</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $ and $ ... singleline comment</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $ and * ... * and $ multiline comment</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Comment states</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 0 = no comment seen</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 1 = seen char $ could be first char of comment</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 2 = seen chars $ and * we are inside multiline comments</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 3 = seen chars $ and * ... and *  could be first char of end of multiline comments</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 21 = seen chars $ and $ we are inside singleline comment</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Es6 macro states</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 0 = no macro seen</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 1 = seen char ` we are inside macro</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 2 = seen escape char inside a macro, the next ` char does not close the macro string</span></li><li class="L9"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L0"><span class="pnl">        </span><span class="tag">function</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> textContent</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfDocumentData</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span></li><li class="L4"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> sourceKey = ittfDocumentData.sourceKey</span></li><li class="L5"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> lines</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">[</span></li><li class="L7"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> leadingWhiteSpaces = 0</span></li><li class="L8"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> line = null</span></li><li class="L9"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> linepos = 1</span></li><li class="L0"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> lineHasMacro = false</span></li><li class="L1"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> colpos = 0</span></li><li class="L2"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> commentState = 0</span></li><li class="L3"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> macroState = 0</span></li><li class="L4"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> quote = null</span></li><li class="L5"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> TODO ensure textContent is red as utf-8 and avoid this</span></li><li class="L6"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> chunk = textContent.toString('utf-8')</span></li><li class="L7"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> ch</span></li><li class="L8"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> chUni</span></li><li class="L9"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> i</span></li><li class="L0"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> l = chunk.length</span></li><li class="L1"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> TODO replace ch with chUni</span></li><li class="L2"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> i = 0; i &lt; l; i++</span></li><li class="L3"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ch = chunk[i]</span></li><li class="L4"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> chUni = chunk.charCodeAt(i)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> colpos++</span></li><li class="L6"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> quote != null</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> quote == ch</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> quote = null</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> processMacro(ch)</span></li><li class="L0"><span class="pnl">                </span><span class="tag">else</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> commentState == 2</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> ch == '*'</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> could be start of end of comment</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> commentState = 3</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> skip comment char</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> ch == '\n'</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> linepos++</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> colpos = 0</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 21</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> ch == '\n'</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> end of line comment</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> delegate end of comment to processMacro</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> processMacro(ch)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 3</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> ch == '$'</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> ok, really is end of comment</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> commentState = 0</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> no, comments continue</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> commentState = 2</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> check if it is eol</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> ch == '\n'</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> linepos++</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> colpos = 0</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 1 && ch == '*'</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> ok, really is start of comment</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> commentState = 2</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 1 && ch == '$'</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> ok, is a line comment</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> commentState = 21</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 1 && ch != '*'</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> no, it was not a comment, reset</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> commentState = 0</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> processMacro('$')</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> processMacro(ch)</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 0 && ch == '"'</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> start of literal</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> quote = ch</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> processMacro(ch)</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 0 && ch == "'"</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> start of literal</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> quote = ch</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> processMacro(ch)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> commentState == 0 && ch == '$'</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> could be start of comment</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> commentState = 1</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> processMacro(ch)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> line</span></li><li class="L1"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> typeof (line.value) !== 'undefined'</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> line.value = line.value.trim()</span></li><li class="L3"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> line.hasMacro = lineHasMacro</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> lines.push(line)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> lineHasMacro = false</span></li><li class="L6"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> lines</span></li><li class="L7"><span class="pnl">            </span><span class="tag">function</span><span class="pln"> processMacro</span></li><li class="L8"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> ch</span></li><li class="L9"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> macroState == 2</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> remove escape state</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> macroState = 1</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> log 'macroState', macroState, ch</span></li><li class="L3"><span class="pnl">                </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> chUni == 96</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> macroState &gt; 0</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> macroState = 0</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> log 'macroState', macroState, ch</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> macroState = 1</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> log 'macroState', macroState, ch</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> macroState == 1</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> ch == '$'</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> Alt+146 = Ã†</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> ch = 'Ã†'</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> lineHasMacro = true</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> log 'macroState', macroState, ch</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">elif</span><span class="pln"> ch == '\\'</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> could be an escape of a macro inside a macro</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> macroState = 2</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> log 'macroState', macroState, ch</span></li><li class="L2"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> processChar(ch)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">function</span><span class="pln"> processChar</span></li><li class="L4"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> ch</span></li><li class="L5"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> ch == '\n'</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> line</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> typeof (line.value) !== 'undefined'</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.value = line.value.trim()</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> line.hasMacro = lineHasMacro</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> lines.push(line)</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> line = null</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> lineHasMacro = false</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> Allow blank line. Do nothing</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> leadingWhiteSpaces = 0</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> colpos = 0</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> linepos++</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> commentState != 2</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> commentState = 0</span></li><li class="L0"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> ch == '\r'</span></li><li class="L1"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> [' ', '\t'].indexOf(ch) !== -1</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> ch == '\t'</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> colpos += 3</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> line</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> typeof (line.value) == 'undefined'</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.value = ''</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.value += ch</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> leadingWhiteSpaces += ch == ' ' ? 1 : 4</span></li><li class="L1"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> ['('].indexOf(ch) !== -1</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> line</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> typeof (line.value) == 'undefined'</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.tagSuffix = ch</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.value = ''</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.value += ch</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> line =</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> indent leadingWhiteSpaces / 4</span></li><li class="L2"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> name ch</span></li><li class="L3"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> row linepos</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> col colpos</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> sourceKey sourceKey</span></li><li class="L6"><span class="pnl">                </span><span class="tag">else</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> line</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> typeof(line.value) == 'undefined'</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.name += ch</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> line.value += ch</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> line =</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">{</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> indent leadingWhiteSpaces / 4</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> name ch</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> row linepos</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> col colpos</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> sourceKey sourceKey</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d43">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/loadContext.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> MTreeProvider = null</span></li><li class="L5"><span class="pnl">    </span><span class="tag">#</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> One mTree loading &lt;--&gt; One mTreeProvider &lt;--&gt; One loadContext.</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> The loadContext keeps track of the IttfDocument fragments loaded</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> for building one mTree.</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Assigns source and model keys to work in progress (wip) mTrees.</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Checks the mix and include call chain to prevent recursion.</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> ittfDocumentDatas: Map</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> key: sourceKey</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> object:</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> ittfDocumentUri</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> content</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> sourceKey</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> mTreeDatas: Map</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> key: modelKey</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> object:</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> ittfDocumentUri</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> schema</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> mTree (cloned) { // mTree is created by the mTreeProvider</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $mixerModelKey:String    // key of the mixin caller mTreeData</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> // set by the lib/loader/mixer</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $args:String             // args of the mixin call</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> // set by the lib/loader/mixer</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $params:String           // params of the mixin callee</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> byRefParams:Array        // params that reference objects</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> getParamValues:Function  // calculates the values</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> evalContext</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> sourceKey</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> modelKey</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> callChain: Array of [</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> object {</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> callerUri</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> calleeUri</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span></li><li class="L4"><span class="pnl">    </span><span class="tag">wz-class</span><span class="pln"> LoadContext</span></li><li class="L5"><span class="pnl">        </span><span class="tag">ctor</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.__type = 'LoadContext'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.ittfDocumentDatas =</span></li><li class="L8"><span class="pnl">                </span><span class="tag">{</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.mTreeDatas =</span></li><li class="L0"><span class="pnl">                </span><span class="tag">{</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.sourceCount = 0</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.modelCount = 0</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.nodeCount = 0</span></li><li class="L4"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.callChain</span></li><li class="L5"><span class="pnl">                </span><span class="tag">[</span></li><li class="L6"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> addIttfDocument</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfDocumentUri</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> textContent</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> sourceKey = 'f' + ++this.sourceCount</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ittfDocumentData</span></li><li class="L1"><span class="pnl">                </span><span class="tag">{</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ittfDocumentUri ittfDocumentUri</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> sourceKey sourceKey</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> content textContent</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.ittfDocumentDatas[sourceKey] = ittfDocumentData</span></li><li class="L6"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ittfDocumentData</span></li><li class="L7"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> addMTree</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfDocumentUri</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> schema</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> mTreeCloned</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> options</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> sourceKey = this.getSourceKey(ittfDocumentUri)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> options.include</span></li><li class="L4"><span class="pnl">                </span><span class="tag">return</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> sourceKey sourceKey</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> modelKey options.includerModelKey</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> modelKey = 'f' + ++this.modelCount</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> mTreeData</span></li><li class="L0"><span class="pnl">                </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ittfDocumentUri ittfDocumentUri</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> schema schema</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> sourceKey sourceKey</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> modelKey modelKey</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> mTree mTreeCloned</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> evalContext null</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.mTreeDatas[modelKey] = mTreeData</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> mTreeData</span></li><li class="L9"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getMTreeData</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> modelKey</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this.mTreeDatas[modelKey]</span></li><li class="L2"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getIttfDocumentUri</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> sourceKey</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ittfDocumentData = this.ittfDocumentDatas[sourceKey]</span></li><li class="L5"><span class="pnl">            </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                </span><span class="tag">iif</span><span class="pln"> ittfDocumentData</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">then</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> ittfDocumentData.ittfDocumentUri</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">else</span><span class="pln"> 'Source ittfDocumentUri unknown'</span></li><li class="L0"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getSourceKey</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfDocumentUri</span></li><li class="L2"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var k in this.ittfDocumentDatas</span></li><li class="L3"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> this.ittfDocumentDatas[k].ittfDocumentUri === ittfDocumentUri</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> k</span></li><li class="L5"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> null</span></li><li class="L6"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getIttfDocuments</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ret</span></li><li class="L8"><span class="pnl">                </span><span class="tag">{</span></li><li class="L9"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var k in this.ittfDocumentDatas</span></li><li class="L0"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> ittfDocumentData = this.ittfDocumentDatas[k]</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret[this.getIttfDocumentUri(ittfDocumentData.sourceKey)]</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> sourceKey ittfDocumentData.sourceKey</span></li><li class="L4"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ret</span></li><li class="L5"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getNewNodeId</span></li><li class="L6"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ++this.nodeCount</span></li><li class="L7"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> enterFragmentCall</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callerUri</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> calleeUri</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.callChain.push</span></li><li class="L1"><span class="pnl">                </span><span class="tag">{</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> callerUri callerUri</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> calleeUri calleeUri</span></li><li class="L4"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> exitFragmentCall</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.callChain.pop()</span></li><li class="L6"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> checkForRecursion</span></li><li class="L7"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var i = 0; i &lt; this.callChain.length; i++</span></li><li class="L8"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> this.callChain[i].callerUri == this.callChain[i].calleeUri</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L0"><span class="pnl">                </span><span class="tag">for</span><span class="pln"> var j = 0; j &lt; this.callChain.length; j++</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> ((this.callChain[j].callerUri == this.callChain[i].calleeUri) && (this.callChain[j].calleeUri == this.callChain[i].callerUri))</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L4"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getLoadStateAsync</span></li><li class="L5"><span class="pnl">            </span><span class="tag">static</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfDocumentUri</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> requestContext</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !MTreeProvider</span></li><li class="L0"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> MTreeProvider = require('./mTreeProvider')</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ittfDocumentUri</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> requestContext</span></li><li class="L4"><span class="pnl">                </span><span class="tag">function</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> createdProvider</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> err</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> callback(err)</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> requestContext requestContext</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> provider createdProvider</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> getPrimaryMTree</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">function</span></li><li class="L6"><span class="pnl">                                    </span><span class="tag">return</span><span class="pln"> createdProvider.getPrimaryMTree()</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> callChain</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">[</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> checkForLoops</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">function</span></li><li class="L1"><span class="pnl">                                    </span><span class="tag">for</span><span class="pln"> var i = 0; i &lt; this.callChain.length; i++</span></li><li class="L2"><span class="pnl">                                        </span><span class="tag">if</span><span class="pln"> this.callChain[i].caller == this.callChain[i].callee</span></li><li class="L3"><span class="pnl">                                            </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L4"><span class="pnl">                                        </span><span class="tag">for</span><span class="pln"> var j = 0; j &lt; this.callChain.length; j++</span></li><li class="L5"><span class="pnl">                                            </span><span class="tag">if</span><span class="pln"> ((this.callChain[j].caller == this.callChain[i].callee) && (this.callChain[j].callee == this.callChain[i].caller))</span></li><li class="L6"><span class="pnl">                                                </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L7"><span class="pnl">                                    </span><span class="tag">return</span><span class="pln"> false</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d44">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/mixer.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> path = require('path')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> assert = require('assert')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> async = require('async')</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('../errors')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> includer = require('./includer')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> utilnode = require("../util/node")</span></li><li class="L0"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports =</span></li><li class="L1"><span class="pnl">        </span><span class="tag">function</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> wipMTree</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> mTreeProvider</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> assert.equal(mTreeProvider.__type, 'MTreeProvider', 'param mTreeProvider must be of type MTreeProvider')</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> wipMTree.mixed = false</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> mixNodeCollection</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> wipMTree.nodes</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L0"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> mixedNodes</span><span class="mix">)</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> wipMTree.nodes = mixedNodes</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> callback(null, wipMTree)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">function</span><span class="pln"> mixNodeCollection</span></li><li class="L4"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> callerNodes</span></li><li class="L5"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> resultingNodes_Parent</span></li><li class="L6"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L7"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> mixedNodesAccumulator</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">[</span></li><li class="L9"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> len = callerNodes.length</span></li><li class="L0"><span class="pnl">                </span><span class="tag">function</span><span class="pln"> repeater</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> index</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> index === len</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> callback(null, mixedNodesAccumulator)</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> mixNodeIfTheCase</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> callerNodes[index]</span></li><li class="L6"><span class="pnl">                        </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> mixedNodes</span><span class="mix">)</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> appendItemsToCollection(mixedNodes, mixedNodesAccumulator, resultingNodes_Parent)</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> process.nextTick</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">function</span></li><li class="L0"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> repeater(index + 1)</span></li><li class="L1"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> repeater(0)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">#</span></li><li class="L3"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> params</span></li><li class="L4"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> callerNode: Object - may contain a mixin call if name ends with '('; example: class()</span></li><li class="L5"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> If the callerNode is a mixin call</span></li><li class="L6"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> fetches the callee document and mixes it</span></li><li class="L7"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> else</span></li><li class="L8"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> go down and execute the mix operation on the childs nodes of the callerNode.</span></li><li class="L9"><span class="pnl">            </span><span class="tag">function</span><span class="pln"> mixNodeIfTheCase</span></li><li class="L0"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> callerNode</span></li><li class="L1"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L2"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> isMixinCall = false</span></li><li class="L3"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> callerNode.tagSuffix === '('</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> utilnode.isParentOfName(callerNode, ['$', '$global']) == false</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> isMixinCall = true</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> callerNode.name += callerNode.tagSuffix</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> callerNode.tagSuffix = null</span></li><li class="L9"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> isMixinCall</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> callerNode.name is the name of the mixin to include (IttfFragment)</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> callerNode.value is a comma separated list of arguments of the mixin call</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> callerNode.model.uri is the caller IttfDocument uri; its folder is the base path</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> for resolving the uri of the mixin</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> args = callerNode.value.trim()</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> args.substr(-1, 1) === ')'</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> callerNode.value = args.substring(0, args.length - 1)</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> calleruri = callerNode.model.uri</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> callerbasedir = path.dirname(calleruri)</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">##</span><span class="pln"> load the parsed mTreeModel of the mixin (we name it 'the callee')</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> mTreeProvider.get</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> from 'store'</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> basedir callerbasedir</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> relpath callerNode.name</span></li><li class="L5"><span class="pnl">                        </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> mixedWipNodifiedMTree </span><span class="mix">)</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> mTreeProvider.enterFragmentCall</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> calleruri</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mixedWipNodifiedMTree.uri</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> mTreeProvider.checkForRecursion()</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">var</span><span class="pln"> error</span></li><li class="L1"><span class="pnl">                                    </span><span class="tag">new</span><span class="pln"> errors.IttfLoadError</span></li><li class="L2"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> ('Recursive mixin or include: ' + callerNode.name)</span></li><li class="L3"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> mixedWipNodifiedMTree.uri</span></li><li class="L4"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> callerNode</span></li><li class="L5"><span class="pnl">                                        </span><span class="tag">new</span><span class="pln"> Error()</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">return</span><span class="pln"> callback(error)</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> before mixing the callee parsedMTree</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> resolve its eventual includes</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> includer</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mixedWipNodifiedMTree</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mTreeProvider</span></li><li class="L2"><span class="pnl">                                </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> calleeIncludedMTree </span><span class="mix">)</span></li><li class="L3"><span class="pnl">                                    </span><span class="tag">#</span><span class="pln"> now mix the callee root nodes</span></li><li class="L4"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> mixCalleeRootNodes</span></li><li class="L5"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> calleeIncludedMTree.nodes</span></li><li class="L6"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> callerNode</span></li><li class="L7"><span class="pnl">                                        </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> mixedNodes</span><span class="mix">)</span></li><li class="L8"><span class="pnl">                                            </span><span class="tag">_</span><span class="pln"> mTreeProvider.exitFragmentCall()</span></li><li class="L9"><span class="pnl">                                            </span><span class="tag">_</span><span class="pln"> callback(null, mixedNodes)</span></li><li class="L0"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> callerNode.name === '$.'</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> callerNode is a TEXT CONTAINER (CDATA)</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> callerNode.childs.length &gt; 0</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> callerNode.value = utilnode.textToLine(callerNode)</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> callerNode.childs = []</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">return</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">[</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> callerNode</span></li><li class="L0"><span class="pnl">                </span><span class="tag">else</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> callerNode IS NOT a mixin call</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> but its childs could contain mixin calls</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> so analyze and mix its childs before returning it</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> mixNodeCollection</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> callerNode.childs</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> callerNode</span></li><li class="L7"><span class="pnl">                        </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> mixedNodes</span><span class="mix">)</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> callerNode.childs = mixedNodes</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> return a node collection with callerNode as the only element</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">return</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L3"><span class="pnl">                                    </span><span class="tag">[</span></li><li class="L4"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> callerNode</span></li><li class="L5"><span class="pnl">            </span><span class="tag">function</span><span class="pln"> mixCalleeRootNodes</span></li><li class="L6"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> calleeRootNodes</span></li><li class="L7"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> callerNode</span></li><li class="L8"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L9"><span class="pnl">                </span><span class="tag">var</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">decl</span><span class="pln"> calleeRootNode</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">decl</span><span class="pln"> len = calleeRootNodes.length</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">decl</span><span class="pln"> mixedNodesAccumulation</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">[</span></li><li class="L4"><span class="pnl">                </span><span class="tag">#</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> The mixedWipNodifiedMTree may contain multiple root nodes.</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> The $group command is used as the root node of an IttfDocument</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> when multiple root nodes have to be declared.</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> So the repeater function execute the mixup of every child node of the mixedWipNodifiedMTree</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> and accumulates the resulting mixed nodes in the var "mixedNodesAccumulation"</span></li><li class="L0"><span class="pnl">                </span><span class="tag">function</span><span class="pln"> repeater</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> index</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> index === len</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> we are done, return the result</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> callback(null, mixedNodesAccumulation)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> calleeRootNode = calleeRootNodes[index]</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> TODO to set $args and $mixerModelKey on calleeRootNodes should be the same and more clear</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> THEY ARE NOT SET ON ROOT NODES BUT ON THE MODEL</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> sets the caller args for the evaluation step (see ./evaluator.js)</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> calleeRootNode.model.$args = callerNode.value</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> calleeRootNode.model.$mixerModelKey = callerNode.model.modelKey</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> wipMTree.mixed = true</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> search a default hook inside the calleeRootNode</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> hook = utilnode.findIttfCommand(calleeRootNode, 'default', 'hook')</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> The callerNode.childs, when mixed,</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> must be added to each calleeRootNode.</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> mixNodeCollection</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> callerNode.childs</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> calleeRootNode</span></li><li class="L9"><span class="pnl">                        </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> mixedNodes</span><span class="mix">)</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> hook</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> A default hook was found,</span></li><li class="L2"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> the caller node childs must replace the $hook node;</span></li><li class="L3"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> utilnode.replace will set the parent of the nodes of</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> mixedNodes to the parent of hook.</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> utilnode.replace(hook, mixedNodes)</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">else</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> A default hook was not found,</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> the caller node childs must be</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> appended to the last child of the calleeRootNode;</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> the calleeRootNode becomes the parent of the caller node childs.</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">foreach</span><span class="pln"> item in mixedNodes</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> calleeRootNode.childs.push</span></li><li class="L3"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> item</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">#</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> It seams we are done, but there is a notch.</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> calleeRootNode could contain itself a mixin call.</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> It must be analyzed and mixed if the case.</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> Set the callerNode.parent as its parent</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">#</span><span class="pln"> and add it to the resultMixedNodes collection.</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> mixNodeIfTheCase</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> calleeRootNode</span></li><li class="L2"><span class="pnl">                                </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> mixedNodes</span><span class="mix">)</span></li><li class="L3"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> appendItemsToCollection</span></li><li class="L4"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> mixedNodes</span></li><li class="L5"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> mixedNodesAccumulation</span></li><li class="L6"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> callerNode.parent</span></li><li class="L7"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> repeater(index + 1)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> repeater(0)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">function</span><span class="pln"> appendItemsToCollection</span></li><li class="L0"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> items</span></li><li class="L1"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> collection</span></li><li class="L2"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> parent</span></li><li class="L3"><span class="pnl">                </span><span class="tag">foreach</span><span class="pln"> item in items</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> parent</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> item.parent = parent</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> collection.push(item)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d45">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/mTree.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">#</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> An MTree is an objectified IttfDocument.</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> In the build-up of an MTree, the same Ittf document can be mixed</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> or included many times, so it is cloned when mixed or included.</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> MTree : {</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> uri: String // The location of the source IttfDocument.</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> schema: String // The IttfDocument schema.</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> loadContext: Object, // The loadContext object</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> lines: Array, // lined source text</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> nodes: Array, // nodified lines of source text</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> sourceKey: String, // key to the source info of the IttfDocument</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> modelKey: String // key to the cloned MTree</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> ... these are set by the mixer, on the cloned object</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> mixed: Boolean // true if has been mixed</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $mixerModelKey: String // the modelKey of the calling node</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $args: String // the value of the calling node</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $argArray: String // the $arg array of the calling node</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> ... these are set by the nodifier on the original mtree, then cloned</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $params: // the node value of the $params node, if declared</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Method</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> load</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> setKeys</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> clone</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> getParamValues</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> toIttf</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> toText</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> dump</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('../errors')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> types = require('../util/types')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> liner = require('./liner')</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> nodifier = require('./nodifier')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">wz-class</span><span class="pln"> MTree</span></li><li class="L9"><span class="pnl">        </span><span class="tag">ctor</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> uri</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> loadContext</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.uri = uri</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.loadContext = loadContext</span></li><li class="L4"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> load</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfSourceTextContent</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfDocumentData</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> typeof(ittfSourceTextContent) !== 'string'</span></li><li class="L8"><span class="pnl">                </span><span class="tag">throw</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">new</span><span class="pln"> TypeError('ittfSourceTextContent must be a string')</span></li><li class="L0"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !ittfDocumentData || typeof(ittfDocumentData.sourceKey) !== 'string'</span></li><li class="L1"><span class="pnl">                </span><span class="tag">throw</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">new</span><span class="pln"> TypeError('ittfDocumentData.sourceKey must be a string')</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> lines</span><span class="mix">)</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> liner(ittfSourceTextContent, ittfDocumentData)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d59">checked_call_return(</span><span class="arg"> nodes</span><span class="mix">)</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> nodifier(lines, this)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.nodes = nodes</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> setKeys</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> sourceKey</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> modelKey</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.sourceKey = sourceKey</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.modelKey = modelKey</span></li><li class="L3"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> clone</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> clonedModel</span></li><li class="L5"><span class="pnl">                </span><span class="tag">new</span><span class="pln"> MTree</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> this.uri</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> this.loadContext</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.$params</span></li><li class="L9"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> clonedModel.$params = this.$params</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> clonedModel.nodes = this._cloneNodes(this.nodes, null, clonedModel)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> clonedModel</span></li><li class="L2"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> _cloneNodes</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> nodes</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> parent</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> clonedModel</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> self = this</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span></li><li class="L8"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> clnode</span></li><li class="L9"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> clnodes</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">[</span></li><li class="L1"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> node in nodes</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> clnode =</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> id self.loadContext.getNewNodeId()</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> parsedId node.id</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> name node.name</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> value node.value</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> tagSuffix node.tagSuffix</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> row node.row</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> col node.col</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> sourceKey node.sourceKey</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> hasMacro node.hasMacro</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> parent parent</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> model clonedModel</span></li><li class="L5"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> clnode.childs = self._cloneNodes(node.childs, clnode, clonedModel)</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> clnodes.push(clnode)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> clnodes</span></li><li class="L8"><span class="pnl">        </span><span class="kwd">$include</span><span class="mix frag-to-link-a" data-frag-id="unknown"> mtree/getParamValues</span></li><li class="L9"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> dump</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> evaluated</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span></li><li class="L2"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> buffer</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">[</span></li><li class="L4"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> ctx</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> evaluated evaluated</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.nodes.forEach</span></li><li class="L8"><span class="pnl">                </span><span class="tag">function</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> _dumpNodeDeep(node, 1, buffer, ctx)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> buffer.join('\n')</span></li><li class="L2"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> toIttf</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> buffer</span></li><li class="L4"><span class="pnl">                </span><span class="tag">[</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.nodes.forEach</span></li><li class="L6"><span class="pnl">                </span><span class="tag">function</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> _toIttfNodeDeep(node, 0, buffer)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> buffer.join('\n')</span></li><li class="L0"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> toText</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> buffer</span></li><li class="L2"><span class="pnl">                </span><span class="tag">[</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.nodes.length == 1</span></li><li class="L4"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> root = this.nodes[0]</span></li><li class="L5"><span class="pnl">                </span><span class="tag">foreach</span><span class="pln"> child in root.childs</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> _toTextNodeDeep(child, 0, buffer)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> buffer.join('\n')</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> error</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> method</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> err</span></li><li class="L3"><span class="pnl">                </span><span class="tag">{</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __is_error true</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> message message</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> source "wizzi/lib/mtree/mtreeModel/" + method</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> err</span></li><li class="L8"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> _dumpNodeDeep</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> indent</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> buffer</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L3"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> ctx.evaluated</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> buffer.push</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> spaces(indent * 2) + node.n + ' ' + (node.v || '') + ' ids: ' + node.parsedId + ' ' + node.id</span></li><li class="L6"><span class="pnl">        </span><span class="tag">else</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> buffer.push</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> spaces(indent * 2) + node.name + ' ' + (node.value || '') + ' ids: ' + node.parsedId + ' ' + node.id</span></li><li class="L9"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node.model</span></li><li class="L0"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> node.model.$args || node.model.$params</span></li><li class="L1"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> !ctx[node.model.modelKey]</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> ctx[node.model.modelKey] = node.model</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> buffer.push</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> spaces(indent * 2) + '  $args: ' + node.model.$args + ' $params: ' + node.model.$params</span></li><li class="L5"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> indent++</span></li><li class="L6"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> node.childs.forEach</span></li><li class="L7"><span class="pnl">            </span><span class="tag">function</span></li><li class="L8"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> n</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> _dumpNodeDeep(n, indent, buffer, ctx)</span></li><li class="L0"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> _toIttfNodeDeep</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> indent</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> buffer</span></li><li class="L4"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> buffer.push</span></li><li class="L5"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> spaces(indent * 4) + node.n + ' ' + (node.v || '')</span></li><li class="L6"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> indent++</span></li><li class="L7"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> child in node.childs</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> _toIttfNodeDeep(child, indent, buffer)</span></li><li class="L9"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> _toTextNodeDeep</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> indent</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> buffer</span></li><li class="L3"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> buffer.push</span></li><li class="L4"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> spaces(indent * 4) + node.n + ' ' + node.v || ''</span></li><li class="L5"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> indent++</span></li><li class="L6"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> child in node.childs</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> _toTextNodeDeep(child, indent, buffer)</span></li><li class="L8"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> spaces</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> num</span></li><li class="L0"><span class="pnl">        </span><span class="tag">return</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> Array(num + 1)</span></li><li class="L2"><span class="pnl">                </span><span class="tag">._</span><span class="pln"> join(" ")</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d46">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/mtreeProvider.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> url</span></li><li class="L5"><span class="pnl">    </span><span class="tag">+</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('../errors')</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> LoadContext = require('./loadContext').LoadContext</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> MTree = require('./mTree').MTree</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> IttfDocumentFinder = require('./ittfDocumentFinder')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">#</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Each IttfLoading process requires one instance of the MTreeProvider</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> To date there is no global cache for MTrees, but only a cache for</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> fragments used during a single loading.</span></li><li class="L4"><span class="pnl">    </span><span class="tag">class</span><span class="pln"> MTreeProvider</span></li><li class="L5"><span class="pnl">        </span><span class="tag">ctor</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.__type = 'MTreeProvider'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.modelsCache = {}</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.store = null</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.storeKind = null</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.uri = null</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.schema = null</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.userId = null</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.documentFinder = null</span></li><li class="L4"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.primaryMTreeCloned = null</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.loadContext = null</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.productionContext = null</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.modelContext = null</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.sourcePreprocessor = null</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Each MTreeProvider has one primary MTree</span></li><li class="L0"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getPrimaryMTree</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this.primaryMTreeCloned</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> The starting point of an mTree loading</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Creates the mTree loadContext</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Load the primary mTree fragment form the primary IttfDocument</span></li><li class="L5"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> init</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> primaryIttfDocumentUri</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> requestContext</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.store = requestContext.__ittfDocumentStore</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> that = this</span></li><li class="L1"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> parse the primary IttfDocument Uri and collect</span></li><li class="L2"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> infos from the uri</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.store.parseUri</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> primaryIttfDocumentUri</span></li><li class="L5"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> parsedUri </span><span class="mix">)</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.mTreeProvider.parsedUri', parsedUri</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> that.storeKind = parsedUri.storeKind</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> that.uri = parsedUri.uri</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> that.userId = parsedUri.userId</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> that.projectId = parsedUri.projectId</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> that.schema = parsedUri.schema</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> load the document text content</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> that.store.getModelContent</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> that.uri</span></li><li class="L5"><span class="pnl">                        </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> documentTextContent </span><span class="mix">)</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> init helper objects</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> that.documentFinder = new IttfDocumentFinder(that.store, that.schema)</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> that.loadContext = new LoadContext()</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> that.productionContext = requestContext.productionContext</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> that.modelContext = requestContext.modelContext</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> that.sourcePreprocessor = requestContext.sourcePreprocessor</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.mTreeProvider.documentTextContent', documentTextContent</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> load the initial wip mTree from the source text content</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> that.loadMTreeFromSource</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> that.uri</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">{</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> documentTextContent</span></li><li class="L8"><span class="pnl">                                </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> primaryMTreeCloned </span><span class="mix">)</span></li><li class="L9"><span class="pnl">                                    </span><span class="tag">#</span><span class="pln"> save the cloned primary mTree on the mTreeProvider instance</span></li><li class="L0"><span class="pnl">                                    </span><span class="tag">set</span><span class="pln"> that.primaryMTreeCloned = primaryMTreeCloned</span></li><li class="L1"><span class="pnl">                                    </span><span class="tag">#</span><span class="pln"> callbacks returning the mTreeProvider instance</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> callback(null, that)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span></li><li class="L4"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> Clones, or load from source, an included or mixed IttfDocument fragment</span></li><li class="L5"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> params</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> options {</span></li><li class="L7"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> ittfDocumentUri: String</span></li><li class="L8"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> include: Boolean // If true the mTree of the IttfDocument will be included in the caller MTree</span></li><li class="L9"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> // and its scope will become that of the caller (its modelKey will be that of the includer).</span></li><li class="L0"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> // An $include command may not have any argument.</span></li><li class="L1"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> // An included IttfDocument may not have params</span></li><li class="L2"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> //   (may not have the $params command).</span></li><li class="L3"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> includerModelKey: String</span></li><li class="L4"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> basedir: String</span></li><li class="L5"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> relpath: String</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L7"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> called from</span></li><li class="L8"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> ./mtree.load</span></li><li class="L9"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> ./includer</span></li><li class="L0"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> ./mixer</span></li><li class="L1"><span class="pnl">            </span><span class="tag">#</span></li><li class="L2"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> get</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> options</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L5"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> loadContext = this.loadContext</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> productionContext = this.productionContext</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> that = this</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.documentFinder.resolvePath</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> options</span></li><li class="L0"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> uri </span><span class="mix">)</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.mTreeProvider.path resolved', uri</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> mTreeCloned = null</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> check cache</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> log 'searching in cache', that.modelsCache, uri</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> cachedMTree = that.modelsCache[uri]</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> cachedMTree</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> found in cache, clone it</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> mTreeCloned = cachedMTree.clone()</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> this is not superflous</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> the productionContext counts the cached used</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> productionContext.addIttfDocument</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> uri</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> cachedMTree.inputContent</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> adding the mTreeCloned to the loadContext</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> generates the sourceKey and modelKey</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">var</span><span class="pln"> ittfDocumentData</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> loadContext.addMTree</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> uri</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> that.schema</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mTreeCloned</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> options</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> mTreeCloned.sourceKey = ittfDocumentData.sourceKey</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> mTreeCloned.modelKey = ittfDocumentData.modelKey</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> mTreeCloned.$schema = that.schema</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> callback(null, mTreeCloned)</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> not found in cache, get the content from the store and cache it</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> that.store.getModelContent</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> uri</span></li><li class="L0"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> documentTextContent </span><span class="mix">)</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> that.loadMTreeFromSource</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> uri</span></li><li class="L3"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> options</span></li><li class="L4"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> documentTextContent</span></li><li class="L5"><span class="pnl">                                    </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> mTreeCloned </span><span class="mix">)</span></li><li class="L6"><span class="pnl">                                        </span><span class="tag">return</span><span class="pln"> callback(null, mTreeCloned)</span></li><li class="L7"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> loadMTreeFromSource</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> uri</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> options</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> documentTextContent</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.productionContext.addIttfDocument</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> uri</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> documentTextContent</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.loadContext.addIttfDocument</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> uri</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> documentTextContent</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.sourcePreprocessor</span></li><li class="L9"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> TODO save the preprocessed in productionContext and loadContext</span></li><li class="L0"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> or save the sourcePreprocessor function</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> documentTextContent = this.sourcePreprocessor(documentTextContent)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> create the ittfDocumentData object passing</span></li><li class="L3"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> null in the mTree parameter</span></li><li class="L4"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> it will be added later if the parameter</span></li><li class="L5"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> options.include is false. TODO ??? why this</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ittfDocumentData</span></li><li class="L7"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.loadContext.addMTree</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> uri</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> this.schema</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> options</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> newMTree = new MTree(uri, this.loadContext)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">try</span></li><li class="L4"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> parses the IttfDocument and loads the tree of the document nodes</span></li><li class="L5"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d60">checked_call(</span><span class="arg"> notUsed </span><span class="mix">)</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> newMTree.load(documentTextContent, ittfDocumentData)</span></li><li class="L7"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.mTreeProvider.parsed newMTree', newMTree</span></li><li class="L8"><span class="pnl">            </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L9"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">var_error(</span><span class="arg"> RepoIO </span><span class="mix">)</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ex.message</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> uri</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ex</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> callback(error)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> caches the newMTree</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.modelsCache[uri] = newMTree</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> clone it</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> mTreeCloned = newMTree.clone()</span></li><li class="L8"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> set keys</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> mTreeCloned.sourceKey = ittfDocumentData.sourceKey</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> mTreeCloned.modelKey = ittfDocumentData.modelKey</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> mTreeCloned.$schema = this.schema</span></li><li class="L2"><span class="pnl">            </span><span class="tag">+</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !(options.include)</span></li><li class="L4"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ittfDocumentData.mTree = mTreeCloned</span></li><li class="L5"><span class="pnl">            </span><span class="tag">+</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'cloned newMTree', mTreeCloned</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> callback(null, mTreeCloned)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> enterFragmentCall</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callerUri</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> calleeUri</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.loadContext.enterFragmentCall</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> callerUri</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> calleeUri</span></li><li class="L4"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> exitFragmentCall</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.loadContext.exitFragmentCall()</span></li><li class="L6"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> checkForRecursion</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> this.loadContext.checkForRecursion()</span></li><li class="L9"><span class="pnl">    </span><span class="tag">#</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Creates an MTreeProvider for loading</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> an IttfDocucument</span></li><li class="L2"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L3"><span class="pnl">        </span><span class="tag">function</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> primaryIttfDocumentUri</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> requestContext</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L7"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'wizzi-mtree.mTreeProvider.createFromUri', primaryIttfDocumentUri</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> provider = new MTreeProvider()</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> provider.init</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> primaryIttfDocumentUri</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> requestContext</span></li><li class="L2"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> notUsed </span><span class="mix">)</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> callback(null, provider)</span></li><li class="L4"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports = MTreeProvider</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d47">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/loader/nodifier.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">#</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Nodify the lines of an IttfDocument and creates a</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> tree structure object based on line indentation.</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> . detects the $params command</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> . implements line continuation</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> . assigns an id to each node</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> !!! A line object is transformed in place into a node object</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> without recreation (no cloning) !!!</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Inputs</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> - the lines produced by the liner</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Outputs</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> nodes: Array of [</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> line -&gt; mTreeNode : {</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> + parent: Object, // parent mTreeNode</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> + model: Object, // the MTree to which the line belongs</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> + childs: Array, // the children mTreeNodes</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> id: Number,</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> indent: Number,</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> name: String,</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> value: String,</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> row: Number,</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> col: Number,</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> sourceKey: String,</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> tagSuffix: undefined || '('</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> hasMacro: Boolean</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> ]</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Ittf commands:</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> $params  // the param values are stored in the MTree</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> \        // implements line continuation</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> //   the value is appendend to the value of the parent line</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> //   without separators</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> \b       // implements line continuation</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> //   the value is appendend to the value of the parent line</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> //   with a space separator:  prevLine,value += ' ' + currentLine.value</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> \n       // implements line continuation</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> //   the value is appendend to the value of the parent line</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> //   with a line break separator:  prevLine,value += '\n' + currentLine.value</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span></li><li class="L5"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L6"><span class="pnl">        </span><span class="tag">function</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> lines</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> mTree</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span></li><li class="L0"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> nodes</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">[</span></li><li class="L2"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> root = null</span></li><li class="L3"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> current = null</span></li><li class="L4"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> nameFirstChar = null</span></li><li class="L5"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> nameLength = 0</span></li><li class="L6"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> line</span></li><li class="L7"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> i</span></li><li class="L8"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> l = lines.length</span></li><li class="L9"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> var i = 0; i &lt; l; i++</span></li><li class="L0"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> line = lines[i]</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> nameFirstChar = line.name[0]</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> nameLength = line.name.length</span></li><li class="L3"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> line.id = mTree.loadContext.getNewNodeId()</span></li><li class="L4"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> line.model = mTree</span></li><li class="L5"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> line.indent == 0 && current == null</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> line.parent = null</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> nodes.push(line)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> current == null</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">return</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'Malformed tree, root node cannot have an indent.'</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> line</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L4"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> line.indent == current.indent</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> typeof(current.parent) === 'undefined' || current.parent === null</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> 'Malformed tree, only one root note allowed.'</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> line</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> line.parent = current.parent</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> current.parent.childs.push(line)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> line.indent &gt; current.indent</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> nameFirstChar == '$' && line.name === '$params'</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">if</span><span class="pln"> current.indent &gt; 0</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> 'The $params node must be a child of the root node.'</span></li><li class="L9"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> line</span></li><li class="L0"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> current.model.$params = line.value</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">continue</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> nameFirstChar == '\\' && nameLength == 1</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> value continuation on new line</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> current.value += line.value</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">continue</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> nameFirstChar == '\\' && line.name === '\\b'</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> value continuation on new line with space</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> current.value += (' ' + line.value)</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">continue</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">elif</span><span class="pln"> nameFirstChar == '\\' && line.name === '\\n'</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">#</span><span class="pln"> value continuation on new line with line break</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> current.value += ('\n' + line.value)</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">continue</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> line.parent = current</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> current.childs.push(line)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> line.indent &lt; current.indent</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> parent = current.parent</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">while</span><span class="pln"> parent != null && line.indent &lt; parent.indent</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> parent = parent.parent</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> line.parent = parent.parent</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> parent.parent</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> parent.parent.childs.push(line)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> 'Malformed tree, only one root note allowed.'</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> line</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> current = line</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> current.childs = []</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> nodes</span></li><li class="L4"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> error</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> line</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> mTree</span></li><li class="L8"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> message = message +</span></li><li class="L9"><span class="pnl">            </span><span class="tag">\b</span><span class="pln"> '\nNode ' +</span></li><li class="L0"><span class="pnl">            </span><span class="tag">\b</span><span class="pln"> line.name + ' ' + (line.value || '') +</span></li><li class="L1"><span class="pnl">            </span><span class="tag">\b</span><span class="pln"> ' row: ' + line.row + ' col: ' + line.col +</span></li><li class="L2"><span class="pnl">            </span><span class="tag">\b</span><span class="pln"> '.\n Filepath: ' + mTree.uri</span></li><li class="L3"><span class="pnl">        </span><span class="tag">return</span></li><li class="L4"><span class="pnl">            </span><span class="tag">{</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> __is_error true</span></li><li class="L6"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> message message</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> source 'wizzi-mtree/lib/loader/nodifier'</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d48">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/util/node.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> verify = require('../util/verify')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> md</span></li><li class="L6"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> module.exports =</span></li><li class="L7"><span class="pnl">            </span><span class="tag">{</span></li><li class="L8"><span class="pnl">    </span><span class="tag">#</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Node object {</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> name:String</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> value:String</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> parent:Object of type Node</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> childs:Array  of items of type Node</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L5"><span class="pnl">    </span><span class="tag">#</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> IttfCommands are nodes which name</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> starts with the char "$"</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> The search go down to descendants</span></li><li class="L9"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.findIttfCommand</span></li><li class="L0"><span class="pnl">        </span><span class="tag">function</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> item</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> cmdname</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> type</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> startItem</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> (startItem && item.id === startItem.id)</span></li><li class="L6"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> \b || (startItem && item.parent && item.parent.id === startItem.parent.id)</span></li><li class="L7"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> searching the hook for an append command</span></li><li class="L8"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> when descending from a parent we encounter startItem</span></li><li class="L9"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> or a sibling we skip it and its descendants</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> null</span></li><li class="L1"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> item.name === ('$' + type)</span></li><li class="L2"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> item.value && item.value.trim() === cmdname</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> item</span></li><li class="L4"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> !item.value && cmdname === 'default'</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> item</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span></li><li class="L7"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> found</span></li><li class="L8"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> i</span></li><li class="L9"><span class="pnl">                </span><span class="tag">decl</span><span class="pln"> l = item.childs.length</span></li><li class="L0"><span class="pnl">            </span><span class="tag">for</span><span class="pln"> i = 0; i &lt; l; i++</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> found = md.findIttfCommand(item.childs[i], cmdname, type, startItem)</span></li><li class="L2"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> found</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> found</span></li><li class="L4"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> null</span></li><li class="L5"><span class="pnl">    </span><span class="tag">#</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> find a $hook command</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> The search go up to ancestors</span></li><li class="L8"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.findHookExt</span></li><li class="L9"><span class="pnl">        </span><span class="tag">function</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> item</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> hookname</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> startItem</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> typeof startItem === 'undefined'</span></li><li class="L4"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> startItem = item</span></li><li class="L5"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> prn = item.parent</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !prn</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> null</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> hook = md.findIttfCommand(prn, hookname, 'hook', startItem)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> hook</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> hook</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> md.findHookExt(prn, hookname, startItem)</span></li><li class="L2"><span class="pnl">    </span><span class="tag">#</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> find a $virtual command</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> The search go up to ancestors</span></li><li class="L5"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.findVirtual =</span></li><li class="L6"><span class="pnl">        </span><span class="tag">function</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> item</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> virtname</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> prn = item.parent</span></li><li class="L0"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !prn</span></li><li class="L1"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> null</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> virt = md.findIttfCommand(prn, virtname, 'virtual')</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> virt</span></li><li class="L4"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> virt</span></li><li class="L5"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> md.findVirtual(prn, virtname)</span></li><li class="L6"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.replace</span></li><li class="L7"><span class="pnl">        </span><span class="tag">function</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> item</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> replacers</span></li><li class="L0"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> !item.parent</span></li><li class="L1"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> log 'util/node/replace/item', item</span></li><li class="L2"><span class="pnl">                </span><span class="tag">foreach</span><span class="pln"> repl in replacers</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> log 'util/node/replace/repl', repl</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> nodes = item.parent.childs</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> item.parent.childs = []</span></li><li class="L6"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> child in nodes</span></li><li class="L7"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> child === item</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">foreach</span><span class="pln"> replchild in replacers</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> replchild.parent = item.parent</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> item.parent.childs.push(replchild)</span></li><li class="L1"><span class="pnl">                </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> item.parent.childs.push(child)</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.remove</span></li><li class="L4"><span class="pnl">        </span><span class="tag">function</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> item</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> nodes = item.parent.childs</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> item.parent.childs = []</span></li><li class="L8"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> child in nodes</span></li><li class="L9"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> child !== item</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> item.parent.childs.push(child)</span></li><li class="L1"><span class="pnl">    </span><span class="tag">#</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> inline a node hierarchy in a single text line</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> separated by the "__LS__" sequence</span></li><li class="L4"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.textToLine</span></li><li class="L5"><span class="pnl">        </span><span class="tag">function</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> acc</span></li><li class="L8"><span class="pnl">                </span><span class="tag">[</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> node.childs</span></li><li class="L0"><span class="pnl">                </span><span class="tag">foreach</span><span class="pln"> item in node.childs</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> textline(item, acc, '')</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> acc.join</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> work.lineSep</span></li><li class="L5"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> textline</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> acc</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> indent</span></li><li class="L9"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> open = node.tagSuffix == '(' ? '(' : ' '</span></li><li class="L0"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> acc.push</span></li><li class="L1"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> indent + node.name + open + (node.value || '')</span></li><li class="L2"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> item in node.childs</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> textline(item, acc, (indent + '  '))</span></li><li class="L4"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.lineToText</span></li><li class="L5"><span class="pnl">        </span><span class="tag">function</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> typeof(text) === 'undefined' || text == null</span></li><li class="L8"><span class="pnl">                </span><span class="tag">return</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> text text</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> lines null</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> text</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> verify.replaceAll</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> text</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> work.textSep</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> '\n'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ss = text.split('\n')</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> ss.length == 1</span></li><li class="L9"><span class="pnl">                </span><span class="tag">return</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> text ss[0]</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> lines null</span></li><li class="L3"><span class="pnl">            </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> lines</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> verify.replaceAll</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ss[1]</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> work.lineSep</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> '\n'</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">._</span><span class="pln"> split('\n')</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> text ss[0]</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> lines lines</span></li><li class="L4"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.isParentOfName</span></li><li class="L5"><span class="pnl">        </span><span class="tag">function</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> parsernode</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> nameOrArray</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> test = parsernode.parent</span></li><li class="L9"><span class="pnl">            </span><span class="tag">while</span><span class="pln"> test</span></li><li class="L0"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> verify.isArray(nameOrArray)</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> match = false</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">foreach</span><span class="pln"> value in nameOrArray</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> match = match || test.name === value</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> match</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> match</span></li><li class="L6"><span class="pnl">                </span><span class="tag">else</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> test.name === nameOrArray</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> true</span></li><li class="L9"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> test = test.parent</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L1"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> spaces</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> num</span></li><li class="L3"><span class="pnl">        </span><span class="tag">return</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> Array((num + 1))</span></li><li class="L5"><span class="pnl">                </span><span class="tag">._</span><span class="pln"> join(" ")</span></li><li class="L6"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> _dumpNodeDeep</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> indent</span></li><li class="L9"><span class="pnl">        </span><span class="tag">log</span><span class="pln"> spaces(indent) + node.name + ' ' + (node.value || '') + ' ids: ' + node.parsedId + ' ' + node.id</span></li><li class="L0"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> (node.$args || node.$params)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> spaces(indent) + ' $args: ' + node.$args + ' $params: ' + node.$params</span></li><li class="L2"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> indent++</span></li><li class="L3"><span class="pnl">        </span><span class="tag">foreach</span><span class="pln"> child in node.childs</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> _dumpNodeDeep(child, indent)</span></li><li class="L5"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.dump</span></li><li class="L6"><span class="pnl">        </span><span class="tag">function</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> nodes</span></li><li class="L8"><span class="pnl">            </span><span class="tag">foreach</span><span class="pln"> node in nodes</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> _dumpNodeDeep(node, 1)</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> work</span></li><li class="L1"><span class="pnl">        </span><span class="tag">{</span></li><li class="L2"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> work.lineSep = "__LS__"</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> work.textSep = "__TS__"</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d49">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/util/types.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('../errors')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> verify = require('../util/verify')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">wz-function</span><span class="pln"> objectify</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> type</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> unquote</span></li><li class="L0"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> value === '@@null'</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> null</span></li><li class="L2"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> value === '@@undefined'</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> undefined</span></li><li class="L4"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> _isTemplate = isTemplate(value)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> _isTemplate</span></li><li class="L6"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> value</span></li><li class="L7"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> type == null || typeof(type) === 'undefined' || type == 'string'</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> verify.isString(value)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> unquote</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> verify.unquote(value)</span></li><li class="L1"><span class="pnl">                </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">return</span><span class="pln"> value</span></li><li class="L3"><span class="pnl">            </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> ''</span></li><li class="L5"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> type == 'integer'</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> isNaN(value) == false</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> parseInt(value, 10)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">else</span></li><li class="L9"><span class="pnl">                </span><span class="tag">return</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Cannot convert ' + value + ' to integer'</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'objectify'</span></li><li class="L4"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> type == 'float'</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> isNaN(value) == false</span></li><li class="L6"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> parseFloat(value)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">else</span></li><li class="L8"><span class="pnl">                </span><span class="tag">return</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Cannot convert ' + value + ' to float'</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'objectify'</span></li><li class="L3"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> type == 'boolean'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> isBool(value)</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> parseBool(value)</span></li><li class="L6"><span class="pnl">            </span><span class="tag">else</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Cannot convert ' + value + ' to boolean'</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'objectify'</span></li><li class="L2"><span class="pnl">        </span><span class="tag">elif</span><span class="pln"> type == 'date'</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> isDate(value)</span></li><li class="L4"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> parseDate(value)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">else</span></li><li class="L6"><span class="pnl">                </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Cannot convert ' + value + ' to date'</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'objectify'</span></li><li class="L1"><span class="pnl">        </span><span class="tag">return</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> error</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'Invalid type: "' + type + '", expected (string, integer, float, boolean, date)'</span></li><li class="L4"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> node</span></li><li class="L5"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> 'objectify'</span></li><li class="L6"><span class="pnl">    </span><span class="tag">wz-function</span><span class="pln"> isTemplate</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L8"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> isString(obj) === false</span></li><li class="L9"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L0"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> obj.substr(0, 2) === '</span><span class="kwd">${</span><span class="expr">' && obj.substr(-1, 1) === '</span><span class="kwd">}</span><span class="pln">'</span></li><li class="L1"><span class="pnl">    </span><span class="tag">wz-function</span><span class="pln"> isDefined</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L3"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> !(typeof(obj) === 'undefined')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">wz-function</span><span class="pln"> isObject</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L6"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> obj !== null && typeof(obj) === 'object'</span></li><li class="L7"><span class="pnl">    </span><span class="tag">wz-function</span><span class="pln"> isString</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L9"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> obj !== null && typeof(obj) === 'string'</span></li><li class="L0"><span class="pnl">    </span><span class="tag">wz-function</span><span class="pln"> isBool</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L2"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> isString(obj)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> obj === 'true' || obj === 'false'</span></li><li class="L4"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> typeof(obj) === "boolean"</span></li><li class="L5"><span class="pnl">    </span><span class="tag">wz-function</span><span class="pln"> isDate</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L7"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> parts = input.split('/')</span></li><li class="L8"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> parts.length == 3</span></li><li class="L9"><span class="pnl">    </span><span class="tag">wz-function</span><span class="pln"> parseBool</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L1"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> obj === 'true' ? true : false</span></li><li class="L2"><span class="pnl">    </span><span class="tag">wz-function</span><span class="pln"> parseDate</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> obj</span></li><li class="L4"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> parts = input.split('/')</span></li><li class="L5"><span class="pnl">        </span><span class="tag">return</span></li><li class="L6"><span class="pnl">            </span><span class="tag">new</span><span class="pln"> Date</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> parts[0]</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> parts[1] - 1</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> parts[2]</span></li><li class="L0"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> error</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> method</span></li><li class="L4"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> nodeError = new errors.NodeError(message, node)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">return</span></li><li class="L6"><span class="pnl">            </span><span class="tag">{</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> __is_error true</span></li><li class="L8"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> message nodeError.message</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> source "wizzi/util/types/" + method</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d50">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/util/verify.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> path = require('path')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> md</span></li><li class="L5"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> module.exports =</span></li><li class="L6"><span class="pnl">            </span><span class="tag">{</span></li><li class="L7"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.isFunction</span></li><li class="L8"><span class="pnl">        </span><span class="tag">function</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> functionToCheck</span></li><li class="L0"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> functionToCheck === null || typeof(functionToCheck) === 'undefined'</span></li><li class="L1"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> {}.toString.call(functionToCheck) === '[object Function]'</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.isArray</span></li><li class="L4"><span class="pnl">        </span><span class="tag">function</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> test</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> test === null || typeof(test) === 'undefined'</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> {}.toString.call(test) === '[object Array]'</span></li><li class="L9"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.isString</span></li><li class="L0"><span class="pnl">        </span><span class="tag">function</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> test</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> test !== null && typeof(test) === 'string'</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.isObject</span></li><li class="L4"><span class="pnl">        </span><span class="tag">function</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> test</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> test === null || typeof(test) === 'undefined'</span></li><li class="L7"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> {}.toString.call(test) === '[object Object]'</span></li><li class="L9"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.isEmpty</span></li><li class="L0"><span class="pnl">        </span><span class="tag">function</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> test</span></li><li class="L2"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> test == null || typeof(test) !== 'string' || test.length == 0</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.isNotEmpty</span></li><li class="L4"><span class="pnl">        </span><span class="tag">function</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> test</span></li><li class="L6"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> test != null && typeof(test) === 'string' && test.length &gt; 0</span></li><li class="L7"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.startsWith</span></li><li class="L8"><span class="pnl">        </span><span class="tag">function</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> str</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> prefix</span></li><li class="L1"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> md.isEmpty(str) || md.isEmpty(prefix)</span></li><li class="L2"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L3"><span class="pnl">            </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> str.indexOf(prefix) === 0</span></li><li class="L5"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.endsWith</span></li><li class="L6"><span class="pnl">        </span><span class="tag">function</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> str</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> suffix</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> md.isEmpty(str) || md.isEmpty(suffix)</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> false</span></li><li class="L1"><span class="pnl">            </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> str.indexOf(suffix, str.length - suffix.length) !== -1</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.replaceAll</span></li><li class="L4"><span class="pnl">        </span><span class="tag">function</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> find</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> replace</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> md.isEmpty(text)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> text</span></li><li class="L0"><span class="pnl">            </span><span class="tag">return</span></li><li class="L1"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> text.replace</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">new</span><span class="pln"> RegExp</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> escapeRegExp(find)</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'g'</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> replace</span></li><li class="L6"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> escapeRegExp</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L8"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> text.replace(/([.*+?^=!:</span><span class="kwd">${</span><span class="expr"></span><span class="kwd">}</span><span class="pln">()|\[\]\/\\])/g, "\\$1")</span></li><li class="L9"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.unquote</span></li><li class="L0"><span class="pnl">        </span><span class="tag">function</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> str</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> md.isString(str) === false</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> str</span></li><li class="L4"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> str.length &lt; 2</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> str</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> (str.substr(0, 1) === "'" && str.substr(-1, 1) === "'") ||</span></li><li class="L7"><span class="pnl">                </span><span class="tag">\b</span><span class="pln"> (str.substr(0, 1) === "\"" && str.substr(-1, 1) === "\"")</span></li><li class="L8"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> str.substr(1, str.length -2)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">else</span></li><li class="L0"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> str</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d51">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/lib/errors.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> md</span></li><li class="L5"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> module.exports =</span></li><li class="L6"><span class="pnl">            </span><span class="tag">{</span></li><li class="L7"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d61">error(</span><span class="arg"> Node</span><span class="pln">,</span><span class="arg">  message</span><span class="pln">,</span><span class="arg">  node </span><span class="mix">)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> msg</span></li><li class="L9"><span class="pnl">            </span><span class="tag">[</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> message</span></li><li class="L1"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> node.wzSourceLineInfo</span></li><li class="L3"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> info = node.wzSourceLineInfo</span></li><li class="L4"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> filePath = 'TODO'</span></li><li class="L5"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> node.wzSourceFilepath</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> filePath = node.wzSourceFilepath(info.sourceKey)</span></li><li class="L7"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> msg.push(' at row: ' + info.row)</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> msg.push(', col: ' + info.col)</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> msg.push(', source: ' + info.sourceKey)</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> msg.push(', in file: ' + filePath)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">elif</span><span class="pln"> node.row</span></li><li class="L2"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> msg.push(' at row: ' + node.row)</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> msg.push(', col: ' + node.col)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.message = msg.join('')</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> log 'NodeError', this.message</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> set this.node = node</span></li><li class="L7"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d61">error(</span><span class="arg"> IttfNotFound</span><span class="pln">,</span><span class="arg">  resourceType</span><span class="pln">,</span><span class="arg">  name</span><span class="pln">,</span><span class="arg">  sourceUri </span><span class="mix">)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.message = resourceType + ': ' + name +</span></li><li class="L9"><span class="pnl">            </span><span class="tag">\</span><span class="pln"> ' not found, processing document ' + md.getSrcPathInfo(sourceUri)</span></li><li class="L0"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d61">error(</span><span class="arg"> IttfLoad</span><span class="pln">,</span><span class="arg">  message</span><span class="pln">,</span><span class="arg">  srcPath</span><span class="pln">,</span><span class="arg">  node</span><span class="pln">,</span><span class="arg">  ex </span><span class="mix">)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> !(ex)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> ex = node</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = null</span></li><li class="L4"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.message = 'Error: ' + message + '\nLoading ittf document ' + md.getSrcPathInfo(srcPath)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> node</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.message += ('\n' + new NodeError('', node).message)</span></li><li class="L7"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d61">error(</span><span class="arg"> RepoIO</span><span class="pln">,</span><span class="arg">  message</span><span class="pln">,</span><span class="arg">  uri</span><span class="pln">,</span><span class="arg">  innerEx </span><span class="mix">)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.message = message + '\nuri: ' + uri</span></li><li class="L9"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.getSrcPathInfo</span></li><li class="L0"><span class="pnl">        </span><span class="tag">function</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> srcPath</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> typeof (srcPath) === 'string'</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> srcPath</span></li><li class="L4"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> (srcPath && (typeof (srcPath) === 'object'))</span></li><li class="L5"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> msg = md.getSrcPathInfoFromNode(srcPath)</span></li><li class="L6"><span class="pnl">                </span><span class="tag">return</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">iif</span><span class="pln"> msg</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">then</span><span class="pln"> msg</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">else</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> srcPath.toString()</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> 'unavailable'</span></li><li class="L2"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.getSrcPathInfoFromNode</span></li><li class="L3"><span class="pnl">        </span><span class="tag">function</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L5"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> msg</span></li><li class="L6"><span class="pnl">                </span><span class="tag">[</span></li><li class="L7"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> node</span></li><li class="L8"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> node.WmtSourceLineInfo</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> info = node.WmtSourceLineInfo</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> msg.push((' at row: ' + info.row))</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> msg.push((', col: ' + info.col))</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> msg.push((', source: ' + info.source))</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> msg.push((', in file: ' + 'TODO'))</span></li><li class="L4"><span class="pnl">                </span><span class="tag">elif</span><span class="pln"> node.wzSourceLineInfo</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> info = node.wzSourceLineInfo</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> filePath = 'TODO'</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> node.wzSourceFilepath</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> filePath = node.wzSourceFilepath(info.sourceKey)</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> msg.push((' at row: ' + info.row))</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> msg.push((', col: ' + info.col))</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> msg.push((', source: ' + info.sourceKey))</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> msg.push((', in file: ' + filePath))</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span></li><li class="L4"><span class="pnl">                </span><span class="tag">iif</span><span class="pln"> msg.length == 0</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">then</span><span class="pln"> null</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> msg.join('')</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d52">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/root/index.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> loader = require('./lib/loader')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">+</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> md = module.exports = {}</span></li><li class="L6"><span class="pnl">    </span><span class="tag">#</span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> param createStore:Function</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> param options:Object {</span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> useCache:Boolean</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L1"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.createLoadMTree</span></li><li class="L2"><span class="pnl">        </span><span class="tag">function</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> createStore</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> options</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> options = options || {}</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> useCache = options.useCache</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ittfDocumentStore</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span></li><li class="L9"><span class="pnl">                </span><span class="tag">function</span><span class="pln"> loadMTree</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> ittfDocumentUri</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> requestContext</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">if</span><span class="pln"> !useCache || !ittfDocumentStore</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> createStore</span></li><li class="L5"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d64">f_cb(</span><span class="arg"> store </span><span class="mix">)</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> ittfDocumentStore = store</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> requestContext.__ittfDocumentStore = store</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> loader.loadMTree</span></li><li class="L9"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> ittfDocumentUri</span></li><li class="L0"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> requestContext</span></li><li class="L1"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> callback</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> requestContext.__ittfDocumentStore = ittfDocumentStore</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> loader.loadMTree</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> ittfDocumentUri</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> requestContext</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> callback</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d53">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/root/package.json.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">{</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$</span></li><li class="L3"><span class="pnl">        </span><span class="expr">var</span><span class="expr"> pkgName = 'wizzi-mtree';</span></li><li class="L4"><span class="pnl">        </span><span class="expr">var</span><span class="expr"> app = {</span></li><li class="L5"><span class="pnl">            </span><span class="expr">name:</span><span class="expr"> pkgName,</span></li><li class="L6"><span class="pnl">            </span><span class="expr">version:</span><span class="expr"> '0.3.1',</span></li><li class="L7"><span class="pnl">            </span><span class="expr">description:</span><span class="expr"> 'Loader for wizzi indented text tree format (ittf) documents.',</span></li><li class="L8"><span class="pnl">            </span><span class="expr">private:</span><span class="expr"> false,</span></li><li class="L9"><span class="pnl">            </span><span class="expr">license:</span><span class="expr"> { type: 'MIT', url: 'https://github.com/wizzifactory/' + pkgName + '/blob/master/license.txt' },</span></li><li class="L0"><span class="pnl">            </span><span class="expr">repository:</span><span class="expr"> { url: 'https://github.com/wizzifactory/' + pkgName + '.git' },</span></li><li class="L1"><span class="pnl">            </span><span class="expr">author:</span><span class="expr"> { name: 'Stefano Bassoli', email: 'sbassoli.dev@gmail.com' },</span></li><li class="L2"><span class="pnl">        </span><span class="expr">};</span></li><li class="L3"><span class="pnl">    </span><span class="tag">name</span><span class="pln"> "</span><span class="kwd">${</span><span class="expr">app.name</span><span class="kwd">}</span><span class="pln">"</span></li><li class="L4"><span class="pnl">    </span><span class="tag">version</span><span class="pln"> "</span><span class="kwd">${</span><span class="expr">app.version</span><span class="kwd">}</span><span class="pln">"</span></li><li class="L5"><span class="pnl">    </span><span class="tag">description</span><span class="pln"> "</span><span class="kwd">${</span><span class="expr">app.description</span><span class="kwd">}</span><span class="pln">"</span></li><li class="L6"><span class="pnl">    </span><span class="tag">author</span></li><li class="L7"><span class="pnl">        </span><span class="tag">{</span></li><li class="L8"><span class="pnl">            </span><span class="tag">name</span><span class="pln"> "</span><span class="kwd">${</span><span class="expr">app.author.name</span><span class="kwd">}</span><span class="pln">"</span></li><li class="L9"><span class="pnl">            </span><span class="tag">email</span><span class="pln"> "</span><span class="kwd">${</span><span class="expr">app.author.email</span><span class="kwd">}</span><span class="pln">"</span></li><li class="L0"><span class="pnl">    </span><span class="tag">private</span><span class="kwd"> ${</span><span class="expr">app.private</span><span class="kwd">}</span></li><li class="L1"><span class="pnl">    </span><span class="tag">licenses</span></li><li class="L2"><span class="pnl">        </span><span class="tag">[</span></li><li class="L3"><span class="pnl">            </span><span class="tag">{</span></li><li class="L4"><span class="pnl">                </span><span class="tag">type</span><span class="pln"> "</span><span class="kwd">${</span><span class="expr">app.license.type</span><span class="kwd">}</span><span class="pln">"</span></li><li class="L5"><span class="pnl">                </span><span class="tag">url</span><span class="pln"> "</span><span class="kwd">${</span><span class="expr">app.license.url</span><span class="kwd">}</span><span class="pln">"</span></li><li class="L6"><span class="pnl">    </span><span class="tag">repository</span></li><li class="L7"><span class="pnl">        </span><span class="tag">{</span></li><li class="L8"><span class="pnl">            </span><span class="tag">type</span><span class="pln"> "git"</span></li><li class="L9"><span class="pnl">            </span><span class="tag">url</span><span class="pln"> "</span><span class="kwd">${</span><span class="expr">app.repository.url</span><span class="kwd">}</span><span class="pln">"</span></li><li class="L0"><span class="pnl">    </span><span class="tag">engines</span></li><li class="L1"><span class="pnl">        </span><span class="tag">{</span></li><li class="L2"><span class="pnl">            </span><span class="tag">node</span><span class="pln"> "&gt;=0.10.28"</span></li><li class="L3"><span class="pnl">            </span><span class="tag">npm</span><span class="pln"> "&gt;=1.4.28"</span></li><li class="L4"><span class="pnl">    </span><span class="tag">scripts</span></li><li class="L5"><span class="pnl">        </span><span class="tag">{</span></li><li class="L6"><span class="pnl">            </span><span class="tag">test</span><span class="pln"> "mocha tests/**/*.js --full-trace"</span></li><li class="L7"><span class="pnl">    </span><span class="tag">dependencies</span></li><li class="L8"><span class="pnl">        </span><span class="tag">{</span></li><li class="L9"><span class="pnl">            </span><span class="tag">async</span><span class="pln"> "^2.1.5"</span></li><li class="L0"><span class="pnl">            </span><span class="tag">chalk</span><span class="pln"> "^1.1.3"</span></li><li class="L1"><span class="pnl">            </span><span class="tag">escodegen</span><span class="pln"> "^1.8.1"</span></li><li class="L2"><span class="pnl">            </span><span class="tag">esprima</span><span class="pln"> "^3.1.3"</span></li><li class="L3"><span class="pnl">            </span><span class="tag">glob</span><span class="pln"> "^7.1.2"</span></li><li class="L4"><span class="pnl">            </span><span class="tag">i</span><span class="pln"> "^0.3.5"</span></li><li class="L5"><span class="pnl">            </span><span class="tag">iconv-lite</span><span class="pln"> "^0.4.15"</span></li><li class="L6"><span class="pnl">            </span><span class="tag">json-stringify-safe</span><span class="pln"> "^5.0.1"</span></li><li class="L7"><span class="pnl">            </span><span class="tag">lodash</span><span class="pln"> "^4.17.4"</span></li><li class="L8"><span class="pnl">            </span><span class="tag">promise</span><span class="pln"> "^7.1.1"</span></li><li class="L9"><span class="pnl">    </span><span class="tag">devDependencies</span></li><li class="L0"><span class="pnl">        </span><span class="tag">{</span></li><li class="L1"><span class="pnl">            </span><span class="tag">del</span><span class="pln"> "^2.2.2"</span></li><li class="L2"><span class="pnl">            </span><span class="tag">expect.js</span><span class="pln"> "^0.3.1"</span></li><li class="L3"><span class="pnl">            </span><span class="tag">mocha</span><span class="pln"> "^1.20.1"</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d54">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/t/mocks/errors.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> md = module.exports = {}</span></li><li class="L4"><span class="pnl">    </span><span class="tag">+</span></li><li class="L5"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d61">error(</span><span class="arg"> RepoIO</span><span class="pln">,</span><span class="arg">  message</span><span class="pln">,</span><span class="arg">  uri</span><span class="pln">,</span><span class="arg">  innerEx </span><span class="mix">)</span></li><li class="L6"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.message = message + '\nuri: ' + uri</span></li><li class="L7"><span class="pnl">    </span><span class="tag">+</span></li><li class="L8"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d61">error(</span><span class="arg"> InvalidRequest</span><span class="pln">,</span><span class="arg">  message</span><span class="pln">,</span><span class="arg">  code </span><span class="mix">)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">log</span><span class="pln"> 'message', message</span></li><li class="L0"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.message = message</span></li><li class="L1"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.code = code</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d55">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/t/mocks/fileSystemStore.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('./errors');</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> file = require('../../util/file')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">class</span><span class="pln"> FileSystemStore</span></li><li class="L6"><span class="pnl">        </span><span class="tag">ctor</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.storeKind = 'filesystem'</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> documentExists</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> filepath</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> documentExists</span></li><li class="L2"><span class="pnl">            </span><span class="tag">try</span></li><li class="L3"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> documentExists = file.isFile(filepath)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L5"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">var_error(</span><span class="arg"> RepoIO </span><span class="mix">)</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ex.message + '\nChecking documentExists'</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> filepath</span></li><li class="L8"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> callback(error)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> callback(null, documentExists)</span></li><li class="L0"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> folderExistsSync</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> folderpath</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> folderExists</span></li><li class="L3"><span class="pnl">            </span><span class="tag">try</span></li><li class="L4"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> folderExists = file.isDirectory(folderpath)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> return</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ex.message</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> folderpath</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'folderExistsSync'</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> folderExists</span></li><li class="L2"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getFoldersSync</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> parentFolderPath</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> options</span></li><li class="L5"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> folders</span></li><li class="L6"><span class="pnl">            </span><span class="tag">try</span></li><li class="L7"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> folders = file.getFolders(parentFolderPath, options)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L9"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> return</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> ex.message</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> parentFolderPath</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'getFolders'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> folders</span></li><li class="L5"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getModelContent</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> filepath</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> content</span></li><li class="L9"><span class="pnl">            </span><span class="tag">try</span></li><li class="L0"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> content = file.read(filepath)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">catch</span><span class="pln"> ex</span></li><li class="L2"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">var_error(</span><span class="arg"> RepoIO </span><span class="mix">)</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ex.message</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> filepath</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> callback(error)</span></li><li class="L6"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> callback(null, content)</span></li><li class="L7"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> path</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> method</span></li><li class="L1"><span class="pnl">            </span><span class="tag">return</span></li><li class="L2"><span class="pnl">                </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __is_error true</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> message message</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> path path</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> source '/wizzi-mtree/tests/loader/mocks/fileSystemStore/' + method</span></li><li class="L7"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports = FileSystemStore</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d56">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/t/mocks/ittfDocumentStore.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> uriparser = require('./uriparser')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> FileSystemStore = require('./fileSystemStore')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">class</span><span class="pln"> IttfDocumentStore</span></li><li class="L7"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> parseUri</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfDocumentUri</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> uriparser</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ittfDocumentUri</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> callback</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span></li><li class="L4"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> param ittfDocumentInfo {</span></li><li class="L5"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> storeKind:String oneOf("filesystem", "repo")</span></li><li class="L6"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> }</span></li><li class="L7"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> init</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfDocumentInfo</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> that = this</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.storeImpl = new FileSystemStore()</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.storeKind = this.storeImpl.storeKind</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> callback(null)</span></li><li class="L5"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> initSync</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ittfDocumentInfo</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.storeImpl = new FileSystemStore()</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> this.storeKind = this.storeImpl.storeKind</span></li><li class="L9"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> documentExists</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> documentUri</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.storeImpl.documentExists(documentUri, callback)</span></li><li class="L3"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> folderExistsSync</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> folderUri</span></li><li class="L5"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.storeKind !== 'filesystem'</span></li><li class="L6"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">throw_error(</span><span class="arg"> InvalidRequest </span><span class="mix">)</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'In lib/ittf/repo/IttfDocumentStore/folderExistsSync. Method "folderExistsSync" is for storeKind: ' +</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">\</span><span class="pln"> '"filesystem" only.'</span></li><li class="L9"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this.storeImpl.folderExists(folderUri)</span></li><li class="L0"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getFoldersSync</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> parentFolderUri</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> options</span></li><li class="L3"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> this.storeKind !== 'filesystem'</span></li><li class="L4"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">throw_error(</span><span class="arg"> InvalidRequest </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'In lib/ittf/repo/IttfDocumentStore/getFoldersSync. Method "getFoldersSync" is for storeKind: ' +</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">\</span><span class="pln"> '"filesystem" only.'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this.storeImpl.getFoldersSync(parentFolderUri, options)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> getModelContent</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> documentUri</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.storeImpl.getModelContent(documentUri, callback)</span></li><li class="L2"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> createFileSystemDocumentStore</span></li><li class="L3"><span class="pnl">            </span><span class="tag">static</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ret = new IttfDocumentStore()</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ret.initSync</span></li><li class="L6"><span class="pnl">                </span><span class="tag">{</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> storeKind "filesystem"</span></li><li class="L8"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> ret</span></li><li class="L9"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports = IttfDocumentStore</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d57">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/t/mocks/uriparser.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> url</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('./errors');</span></li><li class="L5"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L6"><span class="pnl">        </span><span class="tag">function</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> uri</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> uri = uri.toLowerCase()</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ret = {}</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> parsedUri = url.parse(uri)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> typeof(parsedUri.protocol) !== 'string'</span></li><li class="L3"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">var_cb_error(</span><span class="arg"> InvalidRequest </span><span class="mix">)</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> "ittf.uriparser. uri must have a protocol (must be an absolute url) : " + uri</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> "UriError"</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> protocol</span></li><li class="L7"><span class="pnl">                </span><span class="tag">iif</span><span class="pln"> parsedUri.protocol.substr(-1, 1) === ':'</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">then</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> parsedUri.protocol.substr(0, (parsedUri.protocol.length - 1))</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">else</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">set</span><span class="pln"> parsedUri.protocol</span></li><li class="L2"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'parseuri.parsedUri', parsedUri</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> name, parts = parsedUri.pathname ? parsedUri.pathname.split('/') : []</span></li><li class="L4"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> parsedUri.pathname && parsedUri.pathname.length &gt; 0 && parsedUri.pathname[0] == '/'</span></li><li class="L5"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> parts.shift()</span></li><li class="L6"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> protocol.length === 1</span></li><li class="L7"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> parts.length &lt; 3</span></li><li class="L8"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="unknown">var_cb_error(</span><span class="arg"> InvalidRequest </span><span class="mix">)</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Invalid uri for an IttfDocument. Too short: ' + uri</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'UriError'</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.storeKind = 'filesystem'</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.userId = parts[0]</span></li><li class="L3"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.projectId = parts[1]</span></li><li class="L4"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.uri = uri</span></li><li class="L5"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> parts.shift()</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> parts.shift()</span></li><li class="L7"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.path = parts.join('/')</span></li><li class="L8"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> name = parts[parts.length-1]</span></li><li class="L9"><span class="pnl">            </span><span class="tag">elif</span><span class="pln"> protocol === 'repo'</span></li><li class="L0"><span class="pnl">                </span><span class="tag">if</span><span class="pln"> parts.length &lt; 2</span></li><li class="L1"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="unknown">var_cb_error(</span><span class="arg"> InvalidRequest </span><span class="mix">)</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'Invalid uri for an IttfDocument. Too short: ' + uri</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'UriError'</span></li><li class="L4"><span class="pnl">                </span><span class="tag">log</span><span class="pln"> 'parsedUri.parts', parts</span></li><li class="L5"><span class="pnl">                </span><span class="tag">log</span><span class="pln"> 'parsedUri', parsedUri</span></li><li class="L6"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.storeKind = 'repo'</span></li><li class="L7"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.userId = parsedUri.host</span></li><li class="L8"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.projectId = parts[0]</span></li><li class="L9"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.uri = uri</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> parts.shift();</span></li><li class="L1"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.path = parts.join('/')</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> name = parts[parts.length-1]</span></li><li class="L3"><span class="pnl">            </span><span class="tag">else</span></li><li class="L4"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">var_cb_error(</span><span class="arg"> InvalidRequest </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'Invalid uri protocol for an IttfDocument. Must be a drive letter or "repo": uri=' + uri</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'UriError'</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> nameparts = name.split('.')</span></li><li class="L8"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> nameparts.length &gt; 2 && nameparts[nameparts.length -1] === 'ittf'</span></li><li class="L9"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.isIttfDocument = true</span></li><li class="L0"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.schema = nameparts[nameparts.length -2]</span></li><li class="L1"><span class="pnl">            </span><span class="tag">else</span></li><li class="L2"><span class="pnl">                </span><span class="tag">set</span><span class="pln"> ret.isIttfDocument = false</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> ret</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d58">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/t/checked_call_return_set.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> varName</span></li><li class="L3"><span class="pnl">    </span><span class="tag">set</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span></li><li class="L4"><span class="pnl">        </span><span class="kwd">$hook</span></li><li class="L5"><span class="pnl">    </span><span class="tag">if</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span><span class="pln"> && </span><span class="kwd">${</span><span class="expr">varName</span><span class="kwd">}</span><span class="pln">.__is_error</span></li><li class="L6"><span class="pnl">        </span><span class="tag">return</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d59">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/t/checked_call_return.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> varName</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span></li><li class="L4"><span class="pnl">        </span><span class="kwd">$hook</span></li><li class="L5"><span class="pnl">    </span><span class="tag">if</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span><span class="pln"> && </span><span class="kwd">${</span><span class="expr">varName</span><span class="kwd">}</span><span class="pln">.__is_error</span></li><li class="L6"><span class="pnl">        </span><span class="tag">return</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d60">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/t/checked_call.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> varName, message|@@null</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span></li><li class="L4"><span class="pnl">        </span><span class="kwd">$hook</span></li><li class="L5"><span class="pnl">    </span><span class="tag">if</span><span class="kwd"> ${</span><span class="expr">varName</span><span class="kwd">}</span><span class="pln"> && </span><span class="kwd">${</span><span class="expr">varName</span><span class="kwd">}</span><span class="pln">.__is_error</span></li><li class="L6"><span class="pnl">        </span><span class="tag">log</span><span class="pln"> '__is_error </span><span class="kwd">${</span><span class="expr">message</span><span class="kwd">}</span><span class="pln">', </span><span class="kwd">${</span><span class="expr">varName</span><span class="kwd">}</span></li><li class="L7"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> callback(</span><span class="kwd">${</span><span class="expr">varName</span><span class="kwd">}</span><span class="pln">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d61">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/t/error.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name, arg1|@@null, arg2|@@null, arg3|@@null, arg4|@@null</span></li><li class="L3"><span class="pnl">    </span><span class="tag">function</span><span class="kwd"> ${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">Error</span></li><li class="L4"><span class="pnl">        </span><span class="kwd">$if</span><span class="expr"> arg1 != null</span></li><li class="L5"><span class="pnl">            </span><span class="tag">param</span><span class="kwd"> ${</span><span class="expr">arg1</span><span class="kwd">}</span></li><li class="L6"><span class="pnl">        </span><span class="kwd">$if</span><span class="expr"> arg2 != null</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="kwd"> ${</span><span class="expr">arg2</span><span class="kwd">}</span></li><li class="L8"><span class="pnl">        </span><span class="kwd">$if</span><span class="expr"> arg3 != null</span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="kwd"> ${</span><span class="expr">arg3</span><span class="kwd">}</span></li><li class="L0"><span class="pnl">        </span><span class="kwd">$if</span><span class="expr"> arg4 != null</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="kwd"> ${</span><span class="expr">arg4</span><span class="kwd">}</span></li><li class="L2"><span class="pnl">        </span><span class="tag">set</span><span class="pln"> this.name = '</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">Error'</span></li><li class="L3"><span class="pnl">        </span><span class="kwd">$hook</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> 5/8/17 set this.stack = (new Error()).stack</span></li><li class="L5"><span class="pnl">    </span><span class="tag">set</span><span class="kwd"> ${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">Error.prototype.toString</span></li><li class="L6"><span class="pnl">        </span><span class="tag">function</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> this.message</span></li><li class="L8"><span class="pnl">    </span><span class="tag">set</span><span class="kwd"> ${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">Error.prototype = Object.create(Error.prototype)</span></li><li class="L9"><span class="pnl">    </span><span class="tag">set</span><span class="kwd"> ${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">Error.prototype.constructor = </span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">Error</span></li><li class="L0"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">Error = </span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">Error</span></li><li class="L1"><span class="pnl">    </span><span class="tag">+</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d62">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/t/f_cb_no_err.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> result</span></li><li class="L3"><span class="pnl">    </span><span class="tag">function</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="kwd"> ${</span><span class="expr">result</span><span class="kwd">}</span></li><li class="L6"><span class="pnl">        </span><span class="kwd">$hook</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d63">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/t/f_cb_throw.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> result</span></li><li class="L3"><span class="pnl">    </span><span class="tag">function</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="kwd"> ${</span><span class="expr">result</span><span class="kwd">}</span></li><li class="L6"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> err</span></li><li class="L7"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'err', err</span></li><li class="L8"><span class="pnl">            </span><span class="tag">throw</span><span class="pln"> new Error(err.message)</span></li><li class="L9"><span class="pnl">        </span><span class="kwd">$hook</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d64">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/t/f_cb.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> result</span></li><li class="L3"><span class="pnl">    </span><span class="tag">function</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="kwd"> ${</span><span class="expr">result</span><span class="kwd">}</span></li><li class="L6"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> err</span></li><li class="L7"><span class="pnl">            </span><span class="tag">return</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> err</span></li><li class="L0"><span class="pnl">        </span><span class="kwd">$hook</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d65">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/t/r_cb_error.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="tag">return</span></li><li class="L3"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> this.error</span></li><li class="L5"><span class="pnl">                </span><span class="kwd">$hook</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d66">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/basicloader/data/doc1.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">tests</span><span class="pln"> School</span></li><li class="L2"><span class="pnl">    </span><span class="tag">table</span><span class="pln"> Teacher</span></li><li class="L3"><span class="pnl">    </span><span class="tag">table</span><span class="pln"> Course</span></li><li class="L4"><span class="pnl">    </span><span class="tag">table</span><span class="pln"> student</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d67">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/basicloader/index.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">+</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L6"><span class="pnl">    </span><span class="tag">+</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> expect = require('expect.js')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> loader = require('../../lib/basicloader')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">+</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> ittfSource</span></li><li class="L1"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L2"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L3"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L4"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> 'doc1.tests.ittf'</span></li><li class="L5"><span class="pnl">    </span><span class="tag">+</span></li><li class="L6"><span class="pnl">    </span><span class="tag">describe</span><span class="pln"> the basicloader</span></li><li class="L7"><span class="pnl">        </span><span class="tag">+</span></li><li class="L8"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> should load an ittfdocument with no frills</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> loader.loadMTree</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> ittfSource</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L2"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d109">f_cb_test(</span><span class="arg"> mTree </span><span class="mix">)</span></li><li class="L3"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> mTree </span><span class="mix">)</span></li><li class="L4"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> mTree.nodes</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> mTree.nodes[0].n</span><span class="pln">,</span><span class="arg">  tests </span><span class="mix">)</span></li><li class="L6"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> mTree.nodes[0].v</span><span class="pln">,</span><span class="arg">  School </span><span class="mix">)</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> done()</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d68">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/esprima/contextData.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">+</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L6"><span class="pnl">    </span><span class="tag">+</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> expect = require('expect.js')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> contextData = require('../../lib/esprima/contextData')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> cd</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> values</span></li><li class="L1"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> alfa, beta, gamma, sigma</span></li><li class="L2"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> alfa_d, beta_d, gamma_d, sigma_d</span></li><li class="L3"><span class="pnl">    </span><span class="tag">describe</span><span class="pln"> manipulate a contextData</span></li><li class="L4"><span class="pnl">        </span><span class="tag">before</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> cd = new contextData('evalContext', 'f1')</span></li><li class="L6"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> should set and get values</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> cd.setValue('alfa', 10)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> cd.setValue('beta', 'annie')</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> alfa_d = cd.isDeclared('alfa')</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d118">tobe_true(</span><span class="arg"> alfa_d </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> alfa = cd.getValue('alfa')</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> alfa</span><span class="pln">,</span><span class="arg">  10 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> beta_d = cd.isDeclared('beta')</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d118">tobe_true(</span><span class="arg"> beta_d </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> beta = cd.getValue('beta')</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> beta</span><span class="pln">,</span><span class="arg">  annie </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> asterix_d = cd.isDeclared('asterix')</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d112">tobe_false(</span><span class="arg"> asterix_d </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> values = cd.getValues()</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d114">tobe_object_len(</span><span class="arg"> values</span><span class="pln">,</span><span class="arg">  2 </span><span class="mix">)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> should push a first time and set and get values</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> cd.push()</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> values = cd.getValues()</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d114">tobe_object_len(</span><span class="arg"> values</span><span class="pln">,</span><span class="arg">  0 </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> alfa = cd.getValue('alfa')</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> alfa</span><span class="pln">,</span><span class="arg">  10 </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> beta = cd.getValue('beta')</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> beta</span><span class="pln">,</span><span class="arg">  annie </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> cd.setValue('gamma', 30)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> values = cd.getValues()</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d114">tobe_object_len(</span><span class="arg"> values</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> gamma = cd.getValue('gamma')</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> gamma</span><span class="pln">,</span><span class="arg">  30 </span><span class="mix">)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> should push a second time and set and get values</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> cd.push()</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> values = cd.getValues()</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d114">tobe_object_len(</span><span class="arg"> values</span><span class="pln">,</span><span class="arg">  0 </span><span class="mix">)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> cd.setValue('sigma', 40)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> values = cd.getValues()</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d114">tobe_object_len(</span><span class="arg"> values</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> alfa = cd.getValue('alfa')</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> alfa</span><span class="pln">,</span><span class="arg">  10 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> beta = cd.getValue('beta')</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> beta</span><span class="pln">,</span><span class="arg">  annie </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> gamma = cd.getValue('gamma')</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> gamma</span><span class="pln">,</span><span class="arg">  30 </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> sigma = cd.getValue('sigma')</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> sigma</span><span class="pln">,</span><span class="arg">  40 </span><span class="mix">)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> should pop a first time and set and get values</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> cd.pop()</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> alfa = cd.getValue('alfa')</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> alfa</span><span class="pln">,</span><span class="arg">  10 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> beta = cd.getValue('beta')</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> beta</span><span class="pln">,</span><span class="arg">  annie </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> gamma = cd.getValue('gamma')</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> gamma</span><span class="pln">,</span><span class="arg">  30 </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> sigma_d = cd.isDeclared('sigma')</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d112">tobe_false(</span><span class="arg"> sigma_d </span><span class="mix">)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> should pop a second time and set and get values</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> cd.pop()</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> alfa = cd.getValue('alfa')</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> alfa</span><span class="pln">,</span><span class="arg">  10 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> beta = cd.getValue('beta')</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> beta</span><span class="pln">,</span><span class="arg">  annie </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> sigma_d = cd.isDeclared('sigma')</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d112">tobe_false(</span><span class="arg"> sigma_d </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> gamma_d = cd.isDeclared('gamma')</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d112">tobe_false(</span><span class="arg"> gamma_d </span><span class="mix">)</span></li><li class="L9"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> should pop a third time and set and get values</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> cd.pop()</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> alfa = cd.getValue('alfa')</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> alfa</span><span class="pln">,</span><span class="arg">  10 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> beta = cd.getValue('beta')</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> beta</span><span class="pln">,</span><span class="arg">  annie </span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d69">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/mocks/errors.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="d54">mocks/errors(</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d70">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/mocks/fileSystemStore.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="d55">mocks/fileSystemStore(</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d71">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/mocks/ittfDocumentStore.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="d56">mocks/ittfDocumentStore(</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d72">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/mocks/misc.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> file = require('../../util/file')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> IttfDocumentStore = require('./ittfDocumentStore')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L7"><span class="pnl">        </span><span class="tag">{</span></li><li class="L8"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> IttfDocumentStore IttfDocumentStore</span></li><li class="L9"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> ProductionManager</span></li><li class="L0"><span class="pnl">                </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> productionContext</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> aclstat</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">{</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> addIttfDocument</span></li><li class="L6"><span class="pnl">                                </span><span class="tag">function</span></li><li class="L7"><span class="pnl">                                    </span><span class="tag">param</span><span class="pln"> uri</span></li><li class="L8"><span class="pnl">                                    </span><span class="tag">param</span><span class="pln"> content</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> addMixedMTree</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">function</span></li><li class="L1"><span class="pnl">                                    </span><span class="tag">param</span><span class="pln"> uri</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">param</span><span class="pln"> content</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> addEvaluatedMTree</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">function</span></li><li class="L5"><span class="pnl">                                    </span><span class="tag">param</span><span class="pln"> uri</span></li><li class="L6"><span class="pnl">                                    </span><span class="tag">param</span><span class="pln"> content</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> addMTreeBuildUpScript</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">function</span></li><li class="L9"><span class="pnl">                                    </span><span class="tag">param</span><span class="pln"> uri</span></li><li class="L0"><span class="pnl">                                    </span><span class="tag">param</span><span class="pln"> jsScriptCoder</span></li><li class="L1"><span class="pnl">                                    </span><span class="tag">log</span><span class="pln"> 'addMTreeBuildUpScript'</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> file.write</span></li><li class="L3"><span class="pnl">                                        </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L4"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> path.dirname(uri)</span></li><li class="L5"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> '_debug_dumps'</span></li><li class="L6"><span class="pnl">                                            </span><span class="tag">@</span><span class="pln"> path.basename(uri)</span></li><li class="L7"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> jsScriptCoder.toCode()</span></li><li class="L8"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> ProductionContext</span></li><li class="L9"><span class="pnl">                </span><span class="tag">{</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> IttfDocumentStoreType IttfDocumentStore</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> dump true</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> addIttfDocument</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">function</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">param</span><span class="pln"> uri</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">param</span><span class="pln"> content</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> mTreeBuildUpScripts</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> addMTreeBuildUpScript</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">function</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">param</span><span class="pln"> uri</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">param</span><span class="pln"> jsScriptCoder</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">var</span><span class="pln"> uri = uri</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">var</span><span class="pln"> script = jsScriptCoder.toCode()</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> this.mTreeBuildUpScripts[uri]</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">{</span></li><li class="L6"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> uri uri</span></li><li class="L7"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> script script</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">log</span><span class="pln"> script, uri</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> this.dump</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">log</span><span class="pln"> 'dump'</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> file.write</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L3"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> path.dirname(uri)</span></li><li class="L4"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> '_debug'</span></li><li class="L5"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> path.basename(uri) + '.js.dump'</span></li><li class="L6"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> script</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> raiseIttfEvaluationScriptError</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">function</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">param</span><span class="pln"> uri</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">param</span><span class="pln"> exception</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">var</span><span class="pln"> uri = uri</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">var</span><span class="pln"> script = this.mTreeBuildUpScripts[uri]</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">if</span><span class="pln"> script && script.ittfEvalScript && exception && exception.lineNumber</span></li><li class="L4"><span class="pnl">                                </span><span class="tag">var</span><span class="pln"> lines = script.ittfEvalScript.getErrorLines(exception).join('\n')</span></li><li class="L5"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> exception.message = '\nError evaluating ittf in uri: ' + uri + '\n' + lines + '\n'</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">else</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">set</span><span class="pln"> exception.message = '\nError evaluating ittf in uri: ' + uri + '\n' + exception.message + '\n'</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> In case of --force proceed inside the try/catch flow</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">throw</span><span class="pln"> exception</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d73">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/mocks/mTreeLoader.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> url</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mocks = require('./misc')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> MTreeProvider = require('../../../lib/loader/mTreeProvider')</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mixer = require('../../../lib/loader/mixer')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> appender = require('../../../lib/loader/appender')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> evaluator = require('../../../lib/loader/evaluator')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L1"><span class="pnl">        </span><span class="tag">function</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> store</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> content_filepath</span></li><li class="L4"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L5"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> requestContext</span></li><li class="L6"><span class="pnl">                </span><span class="tag">{</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> modelContext</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> productionContext mocks.ProductionContext</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __ittfDocumentStore store</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> content_filepath</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> requestContext</span></li><li class="L4"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d109">f_cb_test(</span><span class="arg"> provider </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> mTree = provider.getPrimaryMTree()</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> mixer</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> provider</span></li><li class="L9"><span class="pnl">                        </span><span class="mix frag-to-link-a" data-frag-id="d109">f_cb_test(</span><span class="arg"> mixedModel </span><span class="mix">)</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> appender</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mixedModel</span></li><li class="L2"><span class="pnl">                                </span><span class="mix frag-to-link-a" data-frag-id="d109">f_cb_test(</span><span class="arg"> appendedModel </span><span class="mix">)</span></li><li class="L3"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> evaluator</span></li><li class="L4"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> appendedModel</span></li><li class="L5"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> requestContext</span></li><li class="L6"><span class="pnl">                                        </span><span class="mix frag-to-link-a" data-frag-id="d109">f_cb_test(</span><span class="arg"> result </span><span class="mix">)</span></li><li class="L7"><span class="pnl">                                            </span><span class="kwd">$*</span></li><li class="L8"><span class="pnl">                                            </span><span class="tag">_</span><span class="pln"> console.log</span></li><li class="L9"><span class="pnl">                                                </span><span class="tag">@</span><span class="pln"> 'err'</span></li><li class="L0"><span class="pnl">                                                </span><span class="tag">@</span><span class="pln"> err</span></li><li class="L1"><span class="pnl">                                                </span><span class="tag">@</span><span class="pln"> 'evaluator.result'</span></li><li class="L2"><span class="pnl">                                                </span><span class="tag">_</span><span class="pln"> util.inspect</span></li><li class="L3"><span class="pnl">                                                    </span><span class="tag">@</span><span class="pln"> result</span></li><li class="L4"><span class="pnl">                                                    </span><span class="tag">{</span></li><li class="L5"><span class="pnl">                                                        </span><span class="tag">@</span><span class="pln"> depth null</span></li><li class="L6"><span class="pnl">                                            </span><span class="tag">*$</span></li><li class="L7"><span class="pnl">                                            </span><span class="tag">_</span><span class="pln"> callback(null, result)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d74">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/mocks/uriparser.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="d57">mocks/uriparser(</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d75">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/t/frag1.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">property</span><span class="pln"> Nemo</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d76">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/t/frag2.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">property</span><span class="pln"> Nemo</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d77">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/t/ittf_object_args_item.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">gamma</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> &item</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> tau_</span><span class="kwd">${</span><span class="expr">item.name</span><span class="kwd">}</span><span class="pln"> = </span><span class="kwd">${</span><span class="expr">item.value</span><span class="kwd">}</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d78">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/t/mixin_1.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">tau</span><span class="pln"> 1</span></li><li class="L2"><span class="pnl">    </span><span class="tag">boss</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d79">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/t/mixin_2_appender.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">leaf</span><span class="pln"> 1</span></li><li class="L2"><span class="pnl">    </span><span class="tag">leaf</span><span class="pln"> 1.1</span></li><li class="L3"><span class="pnl">        </span><span class="kwd">$hook</span><span class="pln"> alpha</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d80">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/t/mixin_2_evaluator.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">root</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> team|milan</span></li><li class="L3"><span class="pnl">    </span><span class="tag">leaf</span><span class="kwd"> ${</span><span class="expr">team</span><span class="kwd">}</span><span class="pln"> 1</span></li><li class="L4"><span class="pnl">        </span><span class="kwd">$hook</span><span class="pln"> alpha</span></li><li class="L5"><span class="pnl">    </span><span class="tag">leaf</span><span class="kwd"> ${</span><span class="expr">team</span><span class="kwd">}</span><span class="pln"> 2</span></li><li class="L6"><span class="pnl">        </span><span class="kwd">$hook</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d81">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/t/mixin_3_evaluator.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="d80">mixin_2_evaluator(</span><span class="arg"> ${team} </span><span class="mix">)</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> team|milan</span></li><li class="L3"><span class="pnl">    </span><span class="tag">team</span><span class="kwd"> ${</span><span class="expr">team</span><span class="kwd">}</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d82">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/appender_1.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">root</span></li><li class="L2"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d79">mixin_2_appender(</span><span class="mix">)</span></li><li class="L3"><span class="pnl">        </span><span class="kwd">$appendto</span><span class="pln"> alpha</span></li><li class="L4"><span class="pnl">            </span><span class="tag">leaf</span><span class="pln"> 1.1.1</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d83">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/doc1.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">tests</span><span class="pln"> School</span></li><li class="L2"><span class="pnl">    </span><span class="tag">table</span><span class="pln"> Teacher</span></li><li class="L3"><span class="pnl">    </span><span class="tag">table</span><span class="pln"> Course</span></li><li class="L4"><span class="pnl">    </span><span class="tag">table</span><span class="pln"> student</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d84">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/evaluator_1.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">test</span></li><li class="L2"><span class="pnl">    </span><span class="tag">team</span><span class="kwd"> ${</span><span class="expr"> 'inter'.toUpperCase() </span><span class="kwd">}</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d85">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/evaluator_2.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="d81">mixin_3_evaluator(</span><span class="arg"> inter </span><span class="mix">)</span></li><li class="L2"><span class="pnl">    </span><span class="tag">leaf</span><span class="pln"> 2.1</span></li><li class="L3"><span class="pnl">    </span><span class="kwd">$append</span><span class="pln"> alpha</span></li><li class="L4"><span class="pnl">        </span><span class="tag">leaf</span><span class="pln"> 1.1</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d86">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/evaluator_3.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="d81">mixin_3_evaluator(</span><span class="arg"> inter </span><span class="mix">)</span></li><li class="L2"><span class="pnl">    </span><span class="tag">leaf</span><span class="pln"> 2.1</span></li><li class="L3"><span class="pnl">    </span><span class="kwd">$append</span><span class="pln"> alpha</span></li><li class="L4"><span class="pnl">        </span><span class="tag">leaf</span><span class="pln"> 1.1</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d87">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/evaluator_4.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="d81">mixin_3_evaluator(</span><span class="arg"> inter </span><span class="mix">)</span></li><li class="L2"><span class="pnl">    </span><span class="tag">leaf</span><span class="pln"> 2.1</span></li><li class="L3"><span class="pnl">    </span><span class="kwd">$append</span><span class="pln"> alpha</span></li><li class="L4"><span class="pnl">        </span><span class="tag">leaf</span><span class="pln"> 1.1</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d88">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/evaluator_5.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="d81">mixin_3_evaluator(</span><span class="arg"> inter </span><span class="mix">)</span></li><li class="L2"><span class="pnl">    </span><span class="tag">leaf</span><span class="pln"> 2.1</span></li><li class="L3"><span class="pnl">    </span><span class="kwd">$append</span><span class="pln"> alpha</span></li><li class="L4"><span class="pnl">        </span><span class="tag">leaf</span><span class="pln"> 1.1</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d89">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/function_1.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">alfa</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$function</span><span class="pln"> buildup_beta</span></li><li class="L3"><span class="pnl">        </span><span class="kwd">$param</span><span class="pln"> name</span></li><li class="L4"><span class="pnl">        </span><span class="tag">beta</span><span class="kwd"> ${</span><span class="expr">name</span><span class="kwd">}</span></li><li class="L5"><span class="pnl">    </span><span class="kwd">$</span><span class="pln"> var y = 'stefi';</span></li><li class="L6"><span class="pnl">    </span><span class="kwd">$_</span><span class="pln"> buildup_beta</span></li><li class="L7"><span class="pnl">        </span><span class="kwd">$@</span><span class="pln"> y</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d90">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/function_2.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">alfa</span></li><li class="L2"><span class="pnl">    </span><span class="tag">beta</span></li><li class="L3"><span class="pnl">    </span><span class="kwd">$function</span><span class="pln"> buildup_sigma</span></li><li class="L4"><span class="pnl">        </span><span class="kwd">$param</span><span class="pln"> name</span></li><li class="L5"><span class="pnl">        </span><span class="tag">sigma</span><span class="kwd"> ${</span><span class="expr">name</span><span class="kwd">}</span></li><li class="L6"><span class="pnl">    </span><span class="kwd">$</span><span class="pln"> var y = 'stefi';</span></li><li class="L7"><span class="pnl">    </span><span class="tag">gamma</span></li><li class="L8"><span class="pnl">        </span><span class="kwd">$_</span><span class="pln"> buildup_sigma</span></li><li class="L9"><span class="pnl">            </span><span class="kwd">$@</span><span class="pln"> y</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d91">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/function_3.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">plutone</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$</span></li><li class="L3"><span class="pnl">        </span><span class="expr">var</span><span class="expr"> item_data = {</span></li><li class="L4"><span class="pnl">            </span><span class="expr">name:</span><span class="expr"> 'alfa',</span></li><li class="L5"><span class="pnl">            </span><span class="expr">value:</span><span class="expr"> 'x',</span></li><li class="L6"><span class="pnl">            </span><span class="expr">childs:</span><span class="expr"> [{</span></li><li class="L7"><span class="pnl">                </span><span class="expr">name:</span><span class="expr"> 'beta',</span></li><li class="L8"><span class="pnl">                </span><span class="expr">value:</span><span class="expr"> 'y',</span></li><li class="L9"><span class="pnl">                </span><span class="expr">childs:</span><span class="expr"> [{</span></li><li class="L0"><span class="pnl">                    </span><span class="expr">name:</span><span class="expr"> 'sigma',</span></li><li class="L1"><span class="pnl">                    </span><span class="expr">value:</span><span class="expr"> 't',</span></li><li class="L2"><span class="pnl">                    </span><span class="expr">childs:</span><span class="expr"> []</span></li><li class="L3"><span class="pnl">                </span><span class="expr">}]</span></li><li class="L4"><span class="pnl">            </span><span class="expr">},{</span></li><li class="L5"><span class="pnl">                </span><span class="expr">name:</span><span class="expr"> 'gamma',</span></li><li class="L6"><span class="pnl">                </span><span class="expr">value:</span><span class="expr"> 'z',</span></li><li class="L7"><span class="pnl">                </span><span class="expr">childs:</span><span class="expr"> []</span></li><li class="L8"><span class="pnl">            </span><span class="expr">}]</span></li><li class="L9"><span class="pnl">        </span><span class="expr">};</span></li><li class="L0"><span class="pnl">    </span><span class="kwd">$function</span><span class="pln"> buildup_item</span></li><li class="L1"><span class="pnl">        </span><span class="kwd">$param</span><span class="pln"> item</span></li><li class="L2"><span class="pnl">        </span><span class="tag">giove</span><span class="kwd"> ${</span><span class="expr">item.name</span><span class="kwd">}</span><span class="pln"> </span><span class="kwd">${</span><span class="expr">item.value</span><span class="kwd">}</span></li><li class="L3"><span class="pnl">            </span><span class="kwd">$foreach</span><span class="pln"> c in item.childs</span></li><li class="L4"><span class="pnl">                </span><span class="kwd">$_</span><span class="pln"> buildup_item</span></li><li class="L5"><span class="pnl">                    </span><span class="kwd">$@</span><span class="pln"> c</span></li><li class="L6"><span class="pnl">    </span><span class="kwd">$_</span><span class="pln"> buildup_item</span></li><li class="L7"><span class="pnl">        </span><span class="kwd">$@</span><span class="pln"> item_data</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d92">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/ittf_object_args.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">alpha</span></li><li class="L2"><span class="pnl">    </span><span class="tag">beta</span></li><li class="L3"><span class="pnl">        </span><span class="kwd">$foreach</span><span class="pln"> item in items</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d77">ittf_object_args_item(</span><span class="arg"> &item </span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d93">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/liner_1.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">alpha</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$*</span><span class="pln"> bla bla *$beta 1</span></li><li class="L3"><span class="pnl">    </span><span class="tag">beta</span><span class="pln"> 2</span></li><li class="L4"><span class="pnl">        </span><span class="tag">gamma</span><span class="pln"> 2.1</span></li><li class="L5"><span class="pnl">    </span><span class="kwd">$*</span></li><li class="L6"><span class="pnl">    </span><span class="tag"><</span><span class="pln"> *</span></li><li class="L7"><span class="pnl">        </span><span class="tag">margin</span><span class="pln"> 0</span></li><li class="L8"><span class="pnl">        </span><span class="tag">padding</span><span class="pln"> 0</span></li><li class="L9"><span class="pnl">    </span><span class="tag">*$</span></li><li class="L0"><span class="pnl">    </span><span class="tag"><</span><span class="pln"> body</span></li><li class="L1"><span class="pnl">        </span><span class="tag">margin</span><span class="pln"> 0</span></li><li class="L2"><span class="pnl">        </span><span class="tag">padding</span><span class="pln"> 0</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d94">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/repo/data/mixer_1.tests.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">sigma</span></li><li class="L2"><span class="pnl">    </span><span class="mix frag-to-link-a" data-frag-id="d78">mixin_1(</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d95">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/appender.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">+</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L6"><span class="pnl">    </span><span class="tag">+</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> expect = require('expect.js')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mocks = require('./mocks/misc')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> MTreeProvider = require('../../lib/loader/mTreeProvider')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mixer = require('../../lib/loader/mixer')</span></li><li class="L1"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> appender = require('../../lib/loader/appender')</span></li><li class="L2"><span class="pnl">    </span><span class="tag">var</span></li><li class="L3"><span class="pnl">        </span><span class="tag">decl</span><span class="pln"> store</span></li><li class="L4"><span class="pnl">        </span><span class="tag">decl</span><span class="pln"> appendedModel</span></li><li class="L5"><span class="pnl">        </span><span class="tag">decl</span><span class="pln"> node</span></li><li class="L6"><span class="pnl">    </span><span class="tag">describe</span><span class="pln"> the appender resolves $group, $hook [name], $append [name] commands</span></li><li class="L7"><span class="pnl">        </span><span class="tag">before-async</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> store = new mocks.IttfDocumentStore()</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> store.init</span></li><li class="L0"><span class="pnl">                </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> storeKind 'filesystem'</span></li><li class="L2"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d108">f_cb_no_err(</span><span class="arg"> notUsed </span><span class="mix">)</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> done</span></li><li class="L4"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> should load an mTree</span></li><li class="L5"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> content_filepath</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'appender_1.tests.ittf'</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> content_filepath</span></li><li class="L3"><span class="pnl">                </span><span class="tag">{</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> modelContext</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> productionContext mocks.ProductionContext</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __ittfDocumentStore store</span></li><li class="L8"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">cb_no_err(</span><span class="arg"> provider </span><span class="mix">)</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> mTree = provider.getPrimaryMTree()</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> mixer</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> provider</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">function</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">param</span><span class="pln"> mixedModel</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> appender</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mixedModel</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">function</span></li><li class="L9"><span class="pnl">                                    </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L0"><span class="pnl">                                    </span><span class="tag">param</span><span class="pln"> result</span></li><li class="L1"><span class="pnl">                                    </span><span class="tag">set</span><span class="pln"> appendedModel = result</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L3"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> nodes[0]</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> appendedModel </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> appendedModel.nodes</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> appendedModel.nodes[0] </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = appendedModel.nodes[0]</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.row</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.col</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.name</span><span class="pln">,</span><span class="arg">  'root' </span><span class="mix">)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> nodes [0][0]</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> appendedModel.nodes[0].childs</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = appendedModel.nodes[0].childs[0]</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.row</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.col</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.name</span><span class="pln">,</span><span class="arg">  'leaf' </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.value</span><span class="pln">,</span><span class="arg">  '1' </span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d96">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/evaluator.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">+</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L6"><span class="pnl">    </span><span class="tag">+</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> expect = require('expect.js')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mocks = require('./mocks/misc')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> MTreeProvider = require('../../lib/loader/mTreeProvider')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mixer = require('../../lib/loader/mixer')</span></li><li class="L1"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> appender = require('../../lib/loader/appender')</span></li><li class="L2"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> evaluator = require('../../lib/loader/evaluator')</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span></li><li class="L4"><span class="pnl">        </span><span class="tag">decl</span><span class="pln"> store</span></li><li class="L5"><span class="pnl">        </span><span class="tag">decl</span><span class="pln"> evaluatedModel</span></li><li class="L6"><span class="pnl">        </span><span class="tag">decl</span><span class="pln"> node</span></li><li class="L7"><span class="pnl">    </span><span class="tag">describe</span><span class="pln"> the evaluator computes the tree structure of the ittf model and the expressions on node values</span></li><li class="L8"><span class="pnl">        </span><span class="tag">before-async</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> store = new mocks.IttfDocumentStore()</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> store.init</span></li><li class="L1"><span class="pnl">                </span><span class="tag">{</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> storeKind 'filesystem'</span></li><li class="L3"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d108">f_cb_no_err(</span><span class="arg"> notUsed </span><span class="mix">)</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> done</span></li><li class="L5"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> should load and evaluate</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> content_filepath</span></li><li class="L7"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'evaluator_1.tests.ittf'</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> requestContext</span></li><li class="L3"><span class="pnl">                </span><span class="tag">{</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> modelContext</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> productionContext mocks.ProductionContext</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __ittfDocumentStore store</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L9"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> content_filepath</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> requestContext</span></li><li class="L1"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">cb_no_err(</span><span class="arg"> provider </span><span class="mix">)</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> mTree = provider.getPrimaryMTree()</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> mixer</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> provider</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">function</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">param</span><span class="pln"> mixedModel</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> appender</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> mixedModel</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">function</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L3"><span class="pnl">                                    </span><span class="tag">param</span><span class="pln"> appendedModel</span></li><li class="L4"><span class="pnl">                                    </span><span class="tag">_</span><span class="pln"> evaluator</span></li><li class="L5"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> appendedModel</span></li><li class="L6"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> requestContext</span></li><li class="L7"><span class="pnl">                                        </span><span class="tag">function</span></li><li class="L8"><span class="pnl">                                            </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L9"><span class="pnl">                                            </span><span class="tag">param</span><span class="pln"> result</span></li><li class="L0"><span class="pnl">                                            </span><span class="tag">set</span><span class="pln"> evaluatedModel = result</span></li><li class="L1"><span class="pnl">                                            </span><span class="kwd">$*</span></li><li class="L2"><span class="pnl">                                            </span><span class="tag">_</span><span class="pln"> console.log</span></li><li class="L3"><span class="pnl">                                                </span><span class="tag">@</span><span class="pln"> 'err'</span></li><li class="L4"><span class="pnl">                                                </span><span class="tag">@</span><span class="pln"> err</span></li><li class="L5"><span class="pnl">                                                </span><span class="tag">@</span><span class="pln"> 'evaluator.evaluatedModel'</span></li><li class="L6"><span class="pnl">                                                </span><span class="tag">_</span><span class="pln"> util.inspect</span></li><li class="L7"><span class="pnl">                                                    </span><span class="tag">@</span><span class="pln"> evaluatedModel</span></li><li class="L8"><span class="pnl">                                                    </span><span class="tag">{</span></li><li class="L9"><span class="pnl">                                                        </span><span class="tag">@</span><span class="pln"> depth null</span></li><li class="L0"><span class="pnl">                                            </span><span class="tag">*$</span></li><li class="L1"><span class="pnl">                                            </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L2"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> nodes[0]</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> evaluatedModel </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> evaluatedModel.nodes</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> evaluatedModel.nodes[0] </span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = evaluatedModel.nodes[0]</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.r</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.c</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.n</span><span class="pln">,</span><span class="arg">  'test' </span><span class="mix">)</span></li><li class="L0"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> nodes [0][0]</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> evaluatedModel.nodes[0].childs</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = evaluatedModel.nodes[0].childs[0]</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.r</span><span class="pln">,</span><span class="arg">  2 </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.c</span><span class="pln">,</span><span class="arg">  5 </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.n</span><span class="pln">,</span><span class="arg">  'team' </span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.v</span><span class="pln">,</span><span class="arg">  'INTER' </span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d97">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/function.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">+</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L6"><span class="pnl">    </span><span class="tag">+</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> expect = require('expect.js')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mocks = require('./mocks/misc')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mTreeLoader = require('./mocks/mTreeLoader')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span></li><li class="L1"><span class="pnl">        </span><span class="tag">decl</span><span class="pln"> store</span></li><li class="L2"><span class="pnl">        </span><span class="tag">decl</span><span class="pln"> evaluatedModel</span></li><li class="L3"><span class="pnl">        </span><span class="tag">decl</span><span class="pln"> node</span></li><li class="L4"><span class="pnl">    </span><span class="tag">describe</span><span class="pln"> function calls</span></li><li class="L5"><span class="pnl">        </span><span class="tag">before-async</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> store = new mocks.IttfDocumentStore()</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> store.init</span></li><li class="L8"><span class="pnl">                </span><span class="tag">{</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> storeKind 'filesystem'</span></li><li class="L0"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d108">f_cb_no_err(</span><span class="arg"> notUsed </span><span class="mix">)</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> done</span></li><li class="L2"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> should load and evaluate an ittf with a function</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> content_filepath</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'function_1.tests.ittf'</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> mTreeLoader</span></li><li class="L0"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> store</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> content_filepath</span></li><li class="L2"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">cb_no_err(</span><span class="arg"> result </span><span class="mix">)</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> evaluatedModel = result</span></li><li class="L4"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> evaluatedModel </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> evaluatedModel.nodes</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L7"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> nodes[0]</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> evaluatedModel </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> evaluatedModel.nodes</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> evaluatedModel.nodes[0] </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = evaluatedModel.nodes[0]</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.r</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.c</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.n</span><span class="pln">,</span><span class="arg">  'alfa' </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L6"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> nodes [0][0]</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> evaluatedModel.nodes[0].childs</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = evaluatedModel.nodes[0].childs[0]</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.r</span><span class="pln">,</span><span class="arg">  4 </span><span class="mix">)</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.c</span><span class="pln">,</span><span class="arg">  9 </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.n</span><span class="pln">,</span><span class="arg">  'beta' </span><span class="mix">)</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.v</span><span class="pln">,</span><span class="arg">  'stefi' </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L4"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> should load and evaluate an ittf with a complex function</span></li><li class="L5"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> content_filepath</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'function_2.tests.ittf'</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> mTreeLoader</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> store</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> content_filepath</span></li><li class="L4"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">cb_no_err(</span><span class="arg"> result </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> evaluatedModel = result</span></li><li class="L6"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> evaluatedModel </span><span class="mix">)</span></li><li class="L7"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> evaluatedModel.nodes</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L9"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> complex function nodes[0]</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> evaluatedModel </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> evaluatedModel.nodes</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> evaluatedModel.nodes[0] </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = evaluatedModel.nodes[0]</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.r</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.c</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.n</span><span class="pln">,</span><span class="arg">  'alfa' </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L8"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> complex function nodes [0][0]</span></li><li class="L9"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'evaluatedModel.nodes[0].childs', evaluatedModel.nodes[0].childs</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> evaluatedModel.nodes[0].childs</span><span class="pln">,</span><span class="arg">  2 </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = evaluatedModel.nodes[0].childs[0]</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.r</span><span class="pln">,</span><span class="arg">  2 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.c</span><span class="pln">,</span><span class="arg">  5 </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.n</span><span class="pln">,</span><span class="arg">  'beta' </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = evaluatedModel.nodes[0].childs[1]</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.r</span><span class="pln">,</span><span class="arg">  7 </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.c</span><span class="pln">,</span><span class="arg">  5 </span><span class="mix">)</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.n</span><span class="pln">,</span><span class="arg">  'gamma' </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = evaluatedModel.nodes[0].childs[1].childs[0]</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.r</span><span class="pln">,</span><span class="arg">  5 </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.c</span><span class="pln">,</span><span class="arg">  9 </span><span class="mix">)</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.n</span><span class="pln">,</span><span class="arg">  'sigma' </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L4"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> should load and evaluate an ittf with a recursive function</span></li><li class="L5"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> content_filepath</span></li><li class="L6"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'function_3.tests.ittf'</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> mTreeLoader</span></li><li class="L2"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> store</span></li><li class="L3"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> content_filepath</span></li><li class="L4"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">cb_no_err(</span><span class="arg"> result </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">log</span><span class="pln"> '================', err, result</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> evaluatedModel = result</span></li><li class="L7"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> evaluatedModel </span><span class="mix">)</span></li><li class="L8"><span class="pnl">                    </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> evaluatedModel.nodes</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L0"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> recursive nodes[0]</span></li><li class="L1"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = evaluatedModel.nodes[0]</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> node </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> node.childs</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> node.childs[0] </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> n1 = node.childs[0]</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> n1.r</span><span class="pln">,</span><span class="arg">  22 </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> n1.c</span><span class="pln">,</span><span class="arg">  9 </span><span class="mix">)</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> n1.n</span><span class="pln">,</span><span class="arg">  'giove' </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> n1.v</span><span class="pln">,</span><span class="arg">  'alfa x' </span><span class="mix">)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L1"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> recursive nodes[0][0][0]</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = evaluatedModel.nodes[0].childs[0].childs[0]</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> node </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> node.childs</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> node.childs[0] </span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.r</span><span class="pln">,</span><span class="arg">  22 </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.c</span><span class="pln">,</span><span class="arg">  9 </span><span class="mix">)</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.n</span><span class="pln">,</span><span class="arg">  'giove' </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.v</span><span class="pln">,</span><span class="arg">  'beta y' </span><span class="mix">)</span></li><li class="L0"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> n1 = node.childs[0]</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> n1.r</span><span class="pln">,</span><span class="arg">  22 </span><span class="mix">)</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> n1.c</span><span class="pln">,</span><span class="arg">  9 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> n1.n</span><span class="pln">,</span><span class="arg">  'giove' </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> n1.v</span><span class="pln">,</span><span class="arg">  'sigma t' </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L6"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> recursive nodes[0][0][1]</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> node = evaluatedModel.nodes[0].childs[0].childs[1]</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> node </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> node.childs</span><span class="pln">,</span><span class="arg">  0 </span><span class="mix">)</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.r</span><span class="pln">,</span><span class="arg">  22 </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.c</span><span class="pln">,</span><span class="arg">  9 </span><span class="mix">)</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.n</span><span class="pln">,</span><span class="arg">  'giove' </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.v</span><span class="pln">,</span><span class="arg">  'gamma z' </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> done()</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d98">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/index.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">+</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L6"><span class="pnl">    </span><span class="tag">+</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> expect = require('expect.js')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mocks = require('./mocks/misc')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> file = require('../util/file')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> stringify = require('json-stringify-safe')</span></li><li class="L1"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> loader = require('../../lib/loader')</span></li><li class="L2"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> result</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> store</span></li><li class="L4"><span class="pnl">    </span><span class="tag">describe</span><span class="pln"> loader loads an MTree from an IttfDocument</span></li><li class="L5"><span class="pnl">        </span><span class="tag">before-async</span></li><li class="L6"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> store = new mocks.IttfDocumentStore()</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> store.init</span></li><li class="L8"><span class="pnl">                </span><span class="tag">{</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> storeKind 'filesystem'</span></li><li class="L0"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d108">f_cb_no_err(</span><span class="arg"> notUsed </span><span class="mix">)</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> done</span></li><li class="L2"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> should load an mTree</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> loader.loadMTree</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'ittf_object_args.tests.ittf'</span></li><li class="L9"><span class="pnl">                </span><span class="tag">{</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> modelContext</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> items</span></li><li class="L3"><span class="pnl">                                </span><span class="tag">[</span></li><li class="L4"><span class="pnl">                                    </span><span class="tag">{</span></li><li class="L5"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> name 'stefi'</span></li><li class="L6"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> value 60</span></li><li class="L7"><span class="pnl">                                    </span><span class="tag">{</span></li><li class="L8"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> name 'annie'</span></li><li class="L9"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> value 59</span></li><li class="L0"><span class="pnl">                                    </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> name 'afro'</span></li><li class="L2"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> value 98</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __productionManager mocks.ProductionManager</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __ittfDocumentStore store</span></li><li class="L5"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d108">f_cb_no_err(</span><span class="arg"> mTree </span><span class="mix">)</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">log</span><span class="pln"> 'err', err</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">set</span><span class="pln"> result = mTree</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> file.write</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'ittf_object_args.json'</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> stringify</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 2</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L9"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> should load</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d115">tobe_object(</span><span class="arg"> result </span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d99">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/ittfInterpolate.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> util = require('util')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> expect = require('expect.js')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> Context = require('../../lib/esprima/jsWizziContext')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> ip = require('../../lib/loader/ittfInterpolate')</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('../../lib/esprima/errors')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> ctx = new Context()</span></li><li class="L9"><span class="pnl">    </span><span class="tag">describe</span><span class="pln"> interpolate utility</span></li><li class="L0"><span class="pnl">        </span><span class="tag">before-each</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.clear()</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.set_GlobalContext()</span></li><li class="L3"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> interpolate a single var</span></li><li class="L4"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.setValue('name', 'stefi')</span></li><li class="L5"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> result = ip('My name is $' + '{name}.', ctx)</span></li><li class="L6"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'result', result</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> result</span><span class="pln">,</span><span class="arg">  My name is stefi. </span><span class="mix">)</span></li><li class="L8"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> interpolate a single var + an empty var</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.setValue('name', 'stefi')</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.setValue('hobby', '')</span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> result = ip('My name is $' + '{name} and hobby $' + '{hobby}.', ctx)</span></li><li class="L2"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'result', result</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> result</span><span class="pln">,</span><span class="arg">  My name is stefi and hobby . </span><span class="mix">)</span></li><li class="L4"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> escaped interpolation</span></li><li class="L5"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.setValue('name', 'stefi')</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.setValue('hobby', 'walking')</span></li><li class="L7"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> result = ip('My name is \\$' + '\\{name} and hobby $' + '{hobby}.', ctx)</span></li><li class="L8"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'result', result</span></li><li class="L9"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> expect(result).to.be.a('string')</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> expect(result).to.be('My name is $' + '{name} and hobby walking.')</span></li><li class="L1"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> strange template string</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.setValue('name', 'stefi')</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> result = ip('Hello *{ $a $ {} a$ ok.', ctx)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'result', result</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> result</span><span class="pln">,</span><span class="arg">  Hello *{ $a $ {} a$ ok. </span><span class="mix">)</span></li><li class="L6"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> not closed var delimiter</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.setValue('name', 'stefi')</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> result = ip('Hello </span></li><li class="L9"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'result', result</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> result</span><span class="pln">,</span><span class="arg">  Hello ${a </span><span class="mix">)</span></li><li class="L1"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> ending dollar</span></li><li class="L2"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.setValue('name', 'stefi')</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> result = ip('Hello $', ctx)</span></li><li class="L4"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'result', result</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> result</span><span class="pln">,</span><span class="arg">  Hello $ </span><span class="mix">)</span></li><li class="L6"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> double dollar</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.setValue('name', 'stefi')</span></li><li class="L8"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> result = ip('Hello $' + '$ ok', ctx)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'result', result</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> expect(result).to.be.a('string')</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> expect(result).to.be('Hello $' + '$ ok')</span></li><li class="L2"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> interpolated can manage methods on values</span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> ctx.setValue('name', 'stefi')</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> result = ip('Hello $' + '{ name.capitalize(); }.', ctx)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'result', result</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> result</span><span class="pln">,</span><span class="arg">  Hello Stefi.</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d100">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/ittfModelProvider.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">+</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> del</span></li><li class="L6"><span class="pnl">    </span><span class="tag">+</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> expect = require('expect.js')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> MTreeProvider = require('../../lib/loader/mTreeProvider')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> errors = require('../../lib/errors')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mocks = require('./mocks/misc')</span></li><li class="L1"><span class="pnl">    </span><span class="tag">+</span></li><li class="L2"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> store</span></li><li class="L3"><span class="pnl">    </span><span class="tag">+</span></li><li class="L4"><span class="pnl">    </span><span class="tag">describe</span><span class="pln"> using MTreeProvider to load MTrees</span></li><li class="L5"><span class="pnl">        </span><span class="tag">before-async</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> del.sync</span></li><li class="L7"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> [__dirname + '/dummy/**']</span></li><li class="L8"><span class="pnl">                </span><span class="tag">{</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> force true</span></li><li class="L0"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> store = new mocks.IttfDocumentStore()</span></li><li class="L1"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> store.init</span></li><li class="L2"><span class="pnl">                </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> storeKind 'filesystem'</span></li><li class="L4"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d108">f_cb_no_err(</span><span class="arg"> notUsed </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> done</span></li><li class="L6"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> it</span></li><li class="L7"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> "should get a protocol error"</span></li><li class="L8"><span class="pnl">            </span><span class="tag">function</span></li><li class="L9"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> done</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'alfa.txt'</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> productionContext mocks.ProductionContext</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> modelContext</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">{</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> __ittfDocumentStore store</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">function</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> content</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> expect(err.name).to.be('InvalidRequestError')</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> expect(err.code).to.be('UriError')</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L3"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> it</span></li><li class="L4"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> "should get a uri error"</span></li><li class="L5"><span class="pnl">            </span><span class="tag">function</span></li><li class="L6"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> done</span></li><li class="L7"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'http://alpha.txt'</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> productionContext mocks.ProductionContext</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> modelContext</span></li><li class="L2"><span class="pnl">                            </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> __ittfDocumentStore store</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">function</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> content</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> expect(err.name).to.be('InvalidRequestError')</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> expect(err.code).to.be('UriError')</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L0"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> it</span></li><li class="L1"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> "should get an invalid request error"</span></li><li class="L2"><span class="pnl">            </span><span class="tag">function</span></li><li class="L3"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> done</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'repo://alpha.txt'</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> productionContext mocks.ProductionContext</span></li><li class="L8"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> modelContext</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">{</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> __ittfDocumentStore store</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">function</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> content</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> expect(err.name).to.be('InvalidRequestError')</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L6"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> it</span></li><li class="L7"><span class="pnl">            </span><span class="tag">@</span><span class="pln"> "should get a RepoIOError (NotFound)"</span></li><li class="L8"><span class="pnl">            </span><span class="tag">function</span></li><li class="L9"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> done</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'dummy'</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> 'alpha.txt'</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> productionContext mocks.ProductionContext</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> modelContext</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">{</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> __ittfDocumentStore store</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">function</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">param</span><span class="pln"> content</span></li><li class="L3"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> expect(err.name).to.be('RepoIOError')</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L5"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> should load the raw MTree</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L7"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'doc1.tests.ittf'</span></li><li class="L2"><span class="pnl">                </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> productionContext mocks.ProductionContext</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> modelContext</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __ittfDocumentStore store</span></li><li class="L7"><span class="pnl">                </span><span class="tag">function</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> provider</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> log 'err, provider', err, provider</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(provider).to.be.an('object')</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> mTree = provider.getPrimaryMTree()</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(mTree).to.be.an('object')</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(mTree.$schema).to.be('tests')</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(mTree.sourceKey).to.be('f1')</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(mTree.modelKey).to.be('f1')</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(mTree.nodes).to.be.an('array')</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(mTree.nodes[0]).to.be.an('object')</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(mTree.nodes[0].name).to.be('tests')</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(mTree.nodes[0].value).to.be('School')</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(mTree.nodes[0].childs).to.be.an('array')</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(mTree.nodes[0].childs.length).to.be(3)</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> loadContext = provider.loadContext</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(loadContext).to.be.an('object')</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> done()</span></li><li class="L6"><span class="pnl">        </span><span class="tag">it-async</span><span class="pln"> should load the raw mTree</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L8"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'doc1.tests.ittf'</span></li><li class="L3"><span class="pnl">                </span><span class="tag">{</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> productionContext mocks.ProductionContext</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> modelContext</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __ittfDocumentStore store</span></li><li class="L8"><span class="pnl">                </span><span class="tag">function</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> provider</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">#</span><span class="pln"> log 'err, provider', err, provider</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> expect(provider).to.be.an('object')</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> provider.get</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> from 'store'</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> basedir</span></li><li class="L7"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L8"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L9"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L0"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> relpath 'frag1.tests.ittf'</span></li><li class="L2"><span class="pnl">                        </span><span class="mix frag-to-link-a" data-frag-id="unknown">cb_no_err(</span><span class="arg"> mTree </span><span class="mix">)</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">#</span><span class="pln"> log 'err, mTree', err, mTree</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> expect(mTree).to.be.an('object')</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> expect(mTree.$schema).to.be('tests')</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> expect(mTree.nodes).to.be.an('array')</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> expect(mTree.nodes[0]).to.be.an('object')</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> expect(mTree.nodes[0].name).to.be('property')</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> expect(mTree.nodes[0].value).to.be('Nemo')</span></li><li class="L0"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> done()</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d101">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/liner.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">+</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L6"><span class="pnl">    </span><span class="tag">+</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> expect = require('expect.js')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> liner = require('../../lib/loader/liner')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> file = require('../util/file')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">describe</span><span class="pln"> the liner loads the text content into lines</span></li><li class="L1"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> lines should have : an indent, row and col number, name and value</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> lines</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> liner</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> file.read</span></li><li class="L5"><span class="pnl">                        </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L8"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> 'liner_1.tests.ittf'</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> sourceKey 'f1'</span></li><li class="L2"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'liner lines', lines</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> lines</span><span class="pln">,</span><span class="arg">  7 </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> lines[0].indent</span><span class="pln">,</span><span class="arg">  0 </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> lines[0].row</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> lines[0].col</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> lines[0].sourceKey</span><span class="pln">,</span><span class="arg">  'f1' </span><span class="mix">)</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> lines[0].name</span><span class="pln">,</span><span class="arg">  'alpha' </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d119">tobe_undefined(</span><span class="arg"> lines[0].value </span><span class="mix">)</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> lines[1].indent</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> lines[1].row</span><span class="pln">,</span><span class="arg">  2 </span><span class="mix">)</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> lines[1].col</span><span class="pln">,</span><span class="arg">  18 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> lines[1].sourceKey</span><span class="pln">,</span><span class="arg">  'f1' </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> lines[1].name</span><span class="pln">,</span><span class="arg">  'beta' </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> lines[1].value</span><span class="pln">,</span><span class="arg">  '1' </span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> lines[2].indent</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> lines[2].row</span><span class="pln">,</span><span class="arg">  3 </span><span class="mix">)</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> lines[2].col</span><span class="pln">,</span><span class="arg">  5 </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> lines[2].sourceKey</span><span class="pln">,</span><span class="arg">  'f1' </span><span class="mix">)</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> lines[2].name</span><span class="pln">,</span><span class="arg">  'beta' </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> lines[2].value</span><span class="pln">,</span><span class="arg">  '2' </span><span class="mix">)</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> lines[4].indent</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> lines[4].row</span><span class="pln">,</span><span class="arg">  10 </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> lines[4].col</span><span class="pln">,</span><span class="arg">  5 </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> lines[4].sourceKey</span><span class="pln">,</span><span class="arg">  'f1' </span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> lines[4].name</span><span class="pln">,</span><span class="arg">  '&lt;' </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> lines[4].value</span><span class="pln">,</span><span class="arg">  'body' </span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d102">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/loadContext.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">+</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L6"><span class="pnl">    </span><span class="tag">+</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> expect = require('expect.js')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> LoadContext = require('../../lib/loader/loadContext').LoadContext</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> loadContext</span></li><li class="L0"><span class="pnl">    </span><span class="tag">describe</span><span class="pln"> the load context keep track of the mixed ittf documents</span></li><li class="L1"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> adding a source IttfDocument to the loadContext should return a key for retreaving the uri</span></li><li class="L2"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> loadContext = new LoadContext()</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> content_filepath</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'lexer_1.tests.ittf'</span></li><li class="L9"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> sourceData</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> loadContext.addIttfDocument</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> content_filepath</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L3"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> uri</span></li><li class="L4"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> loadContext.getIttfDocumentUri</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> sourceData.sourceKey</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> sourceData.sourceKey</span><span class="pln">,</span><span class="arg">  f1 </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> expect(uri).to.be(content_filepath)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d103">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/mixer.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">+</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L6"><span class="pnl">    </span><span class="tag">+</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mocks = require('./mocks/misc')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> expect = require('expect.js')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> MTreeProvider = require('../../lib/loader/mTreeProvider')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> mixer = require('../../lib/loader/mixer')</span></li><li class="L1"><span class="pnl">    </span><span class="tag">var</span></li><li class="L2"><span class="pnl">        </span><span class="tag">decl</span><span class="pln"> store</span></li><li class="L3"><span class="pnl">        </span><span class="tag">decl</span><span class="pln"> result_mixedModel</span></li><li class="L4"><span class="pnl">        </span><span class="tag">decl</span><span class="pln"> node</span></li><li class="L5"><span class="pnl">    </span><span class="tag">describe</span><span class="pln"> the mixer resolves mixin calls and includes/composes called mixins into one tree</span></li><li class="L6"><span class="pnl">        </span><span class="tag">before-async</span></li><li class="L7"><span class="pnl">            </span><span class="tag">set</span><span class="pln"> store = new mocks.IttfDocumentStore()</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> store.init</span></li><li class="L9"><span class="pnl">                </span><span class="tag">{</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> storeKind 'filesystem'</span></li><li class="L1"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="d108">f_cb_no_err(</span><span class="arg"> notUsed </span><span class="mix">)</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> done</span></li><li class="L3"><span class="pnl">        </span><span class="tag">it-async</span></li><li class="L4"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> content_filepath</span></li><li class="L5"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'mixer_1.tests.ittf'</span></li><li class="L0"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> MTreeProvider.createFromUri</span></li><li class="L1"><span class="pnl">                </span><span class="tag">@</span><span class="pln"> content_filepath</span></li><li class="L2"><span class="pnl">                </span><span class="tag">{</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> modelContext</span></li><li class="L4"><span class="pnl">                        </span><span class="tag">{</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> productionContext mocks.ProductionContext</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __ittfDocumentStore store</span></li><li class="L7"><span class="pnl">                </span><span class="mix frag-to-link-a" data-frag-id="unknown">cb_no_err(</span><span class="arg"> provider </span><span class="mix">)</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">var</span><span class="pln"> mTree = provider.getPrimaryMTree()</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> mixer</span></li><li class="L0"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> mTree</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> provider</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">function</span></li><li class="L3"><span class="pnl">                            </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L4"><span class="pnl">                            </span><span class="tag">param</span><span class="pln"> mixedModel</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> result_mixedModel = mixedModel</span></li><li class="L6"><span class="pnl">                            </span><span class="kwd">$*</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> console.log</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> 'err'</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> err</span></li><li class="L0"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> 'mixer.mixedModel'</span></li><li class="L1"><span class="pnl">                                </span><span class="tag">_</span><span class="pln"> util.inspect</span></li><li class="L2"><span class="pnl">                                    </span><span class="tag">@</span><span class="pln"> mixedModel.nodes</span></li><li class="L3"><span class="pnl">                                    </span><span class="tag">{</span></li><li class="L4"><span class="pnl">                                        </span><span class="tag">@</span><span class="pln"> depth null</span></li><li class="L5"><span class="pnl">                            </span><span class="tag">*$</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> node = result_mixedModel.nodes[0]</span></li><li class="L7"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.row</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L8"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.col</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L9"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.name</span><span class="pln">,</span><span class="arg">  sigma </span><span class="mix">)</span></li><li class="L0"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d119">tobe_undefined(</span><span class="arg"> node.value </span><span class="mix">)</span></li><li class="L1"><span class="pnl">                            </span><span class="tag">set</span><span class="pln"> node = result_mixedModel.nodes[0].childs[0]</span></li><li class="L2"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.row</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> node.col</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L4"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.name</span><span class="pln">,</span><span class="arg">  tau </span><span class="mix">)</span></li><li class="L5"><span class="pnl">                            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> node.value</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L6"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> done()</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d104">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/loader/nodifier.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">module</span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">+</span></li><li class="L4"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> path</span></li><li class="L5"><span class="pnl">    </span><span class="tag">import</span><span class="pln"> util</span></li><li class="L6"><span class="pnl">    </span><span class="tag">+</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> expect = require('expect.js')</span></li><li class="L8"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> liner = require('../../lib/loader/liner')</span></li><li class="L9"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> nodifier = require('../../lib/loader/nodifier')</span></li><li class="L0"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> MTree = require('../../lib/loader/mTree').MTree</span></li><li class="L1"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> LoadContext = require('../../lib/loader/loadContext').LoadContext</span></li><li class="L2"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> file = require('../util/file')</span></li><li class="L3"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> loadContext = new LoadContext()</span></li><li class="L4"><span class="pnl">    </span><span class="tag">describe</span><span class="pln"> parses source lines into nodes matching the tree structure of the ittf source.</span></li><li class="L5"><span class="pnl">        </span><span class="tag">it</span><span class="pln"> nodes should have : row and col number, name and value</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> uri</span></li><li class="L7"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'repo'</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'data'</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'liner_1.tests.ittf'</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> mTree</span></li><li class="L3"><span class="pnl">                </span><span class="tag">new</span><span class="pln"> MTree</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> uri</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> loadContext</span></li><li class="L6"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> lines</span></li><li class="L7"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> liner</span></li><li class="L8"><span class="pnl">                    </span><span class="tag">_</span><span class="pln"> file.read</span></li><li class="L9"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> uri</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">{</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> sourceKey 'f1'</span></li><li class="L2"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> nodes = nodifier(lines, mTree)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> log 'nodifier nodes', nodes</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> nodes</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> nodes[0].childs</span><span class="pln">,</span><span class="arg">  3 </span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d111">tobe_array(</span><span class="arg"> nodes[0].childs[1].childs</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> nodes[0].row</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> nodes[0].col</span><span class="pln">,</span><span class="arg">  1 </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].sourceKey</span><span class="pln">,</span><span class="arg">  'f1' </span><span class="mix">)</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].name</span><span class="pln">,</span><span class="arg">  'alpha' </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d119">tobe_undefined(</span><span class="arg"> nodes[0].value </span><span class="mix">)</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> nodes[0].childs[0].row</span><span class="pln">,</span><span class="arg">  2 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> nodes[0].childs[0].col</span><span class="pln">,</span><span class="arg">  18 </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].childs[0].sourceKey</span><span class="pln">,</span><span class="arg">  'f1' </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].childs[0].name</span><span class="pln">,</span><span class="arg">  'beta' </span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].childs[0].value</span><span class="pln">,</span><span class="arg">  '1' </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> nodes[0].childs[1].row</span><span class="pln">,</span><span class="arg">  3 </span><span class="mix">)</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> nodes[0].childs[1].col</span><span class="pln">,</span><span class="arg">  5 </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].childs[1].sourceKey</span><span class="pln">,</span><span class="arg">  'f1' </span><span class="mix">)</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].childs[1].name</span><span class="pln">,</span><span class="arg">  'beta' </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].childs[1].value</span><span class="pln">,</span><span class="arg">  '2' </span><span class="mix">)</span></li><li class="L2"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> nodes[0].childs[1].childs[0].row</span><span class="pln">,</span><span class="arg">  4 </span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> nodes[0].childs[1].childs[0].col</span><span class="pln">,</span><span class="arg">  9 </span><span class="mix">)</span></li><li class="L4"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].childs[1].childs[0].sourceKey</span><span class="pln">,</span><span class="arg">  'f1' </span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].childs[1].childs[0].name</span><span class="pln">,</span><span class="arg">  'gamma' </span><span class="mix">)</span></li><li class="L6"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].childs[1].childs[0].value</span><span class="pln">,</span><span class="arg">  '2.1' </span><span class="mix">)</span></li><li class="L7"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> nodes[0].childs[2].childs[0].row</span><span class="pln">,</span><span class="arg">  11 </span><span class="mix">)</span></li><li class="L8"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d113">tobe_number(</span><span class="arg"> nodes[0].childs[2].childs[0].col</span><span class="pln">,</span><span class="arg">  9 </span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].childs[2].childs[0].sourceKey</span><span class="pln">,</span><span class="arg">  'f1' </span><span class="mix">)</span></li><li class="L0"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].childs[2].childs[0].name</span><span class="pln">,</span><span class="arg">  'margin' </span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="mix frag-to-link-a" data-frag-id="d117">tobe_string(</span><span class="arg"> nodes[0].childs[2].childs[0].value</span><span class="pln">,</span><span class="arg">  '0' </span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d105">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/async.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> call, arg1|@@null, arg2|@@null, arg3|@@null, arg4|@@null, arg5|@@null, arg6|@@null</span></li><li class="L3"><span class="pnl">    </span><span class="tag">_</span><span class="kwd"> ${</span><span class="expr">call</span><span class="kwd">}</span></li><li class="L4"><span class="pnl">        </span><span class="kwd">$if</span><span class="expr"> arg1 != null</span></li><li class="L5"><span class="pnl">            </span><span class="tag">@</span><span class="kwd"> ${</span><span class="expr">arg1</span><span class="kwd">}</span></li><li class="L6"><span class="pnl">        </span><span class="kwd">$if</span><span class="expr"> arg2 != null</span></li><li class="L7"><span class="pnl">            </span><span class="tag">@</span><span class="kwd"> ${</span><span class="expr">arg2</span><span class="kwd">}</span></li><li class="L8"><span class="pnl">        </span><span class="kwd">$if</span><span class="expr"> arg3 != null</span></li><li class="L9"><span class="pnl">            </span><span class="tag">@</span><span class="kwd"> ${</span><span class="expr">arg3</span><span class="kwd">}</span></li><li class="L0"><span class="pnl">        </span><span class="kwd">$if</span><span class="expr"> arg4 != null</span></li><li class="L1"><span class="pnl">            </span><span class="tag">@</span><span class="kwd"> ${</span><span class="expr">arg4</span><span class="kwd">}</span></li><li class="L2"><span class="pnl">        </span><span class="kwd">$if</span><span class="expr"> arg5 != null</span></li><li class="L3"><span class="pnl">            </span><span class="tag">@</span><span class="kwd"> ${</span><span class="expr">arg5</span><span class="kwd">}</span></li><li class="L4"><span class="pnl">        </span><span class="kwd">$if</span><span class="expr"> arg6 != null</span></li><li class="L5"><span class="pnl">            </span><span class="tag">@</span><span class="kwd"> ${</span><span class="expr">arg6</span><span class="kwd">}</span></li><li class="L6"><span class="pnl">        </span><span class="tag">function</span></li><li class="L7"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L8"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> result</span></li><li class="L9"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> err</span></li><li class="L0"><span class="pnl">                </span><span class="tag">throw</span><span class="pln"> new Error()</span></li><li class="L1"><span class="pnl">            </span><span class="kwd">$hook</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d106">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/expect_throw_error.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> error</span></li><li class="L3"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect</span></li><li class="L4"><span class="pnl">        </span><span class="tag">function</span><span class="pln"> fn</span></li><li class="L5"><span class="pnl">            </span><span class="kwd">$hook</span></li><li class="L6"><span class="pnl">        </span><span class="tag">.</span><span class="pln"> to</span></li><li class="L7"><span class="pnl">        </span><span class="tag">._</span><span class="pln"> throwException</span></li><li class="L8"><span class="pnl">            </span><span class="tag">function</span></li><li class="L9"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> e</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> expect(e).to.be.a(errors.</span><span class="kwd">${</span><span class="expr">error</span><span class="kwd">}</span><span class="pln">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d107">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/f_cb_done.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> result</span></li><li class="L3"><span class="pnl">    </span><span class="tag">function</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="kwd"> ${</span><span class="expr">result</span><span class="kwd">}</span></li><li class="L6"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> err</span></li><li class="L7"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'err', err</span></li><li class="L8"><span class="pnl">            </span><span class="tag">throw</span><span class="pln"> new Error(err.message)</span></li><li class="L9"><span class="pnl">        </span><span class="kwd">$hook</span></li><li class="L0"><span class="pnl">        </span><span class="tag">_</span><span class="pln"> done</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d108">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/f_cb_no_err.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> result</span></li><li class="L3"><span class="pnl">    </span><span class="tag">function</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="kwd"> ${</span><span class="expr">result</span><span class="kwd">}</span></li><li class="L6"><span class="pnl">        </span><span class="kwd">$hook</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d109">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/f_cb_test.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> result</span></li><li class="L3"><span class="pnl">    </span><span class="tag">function</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="kwd"> ${</span><span class="expr">result</span><span class="kwd">}</span></li><li class="L6"><span class="pnl">        </span><span class="tag">if</span><span class="pln"> err</span></li><li class="L7"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'err', err</span></li><li class="L8"><span class="pnl">            </span><span class="tag">throw</span><span class="pln"> new Error(err.message)</span></li><li class="L9"><span class="pnl">        </span><span class="kwd">$hook</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d110">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/itasync.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> title, call, arg1|@@null, arg2|@@null, arg3|@@null, arg4|@@null, arg5|@@null, arg6|@@null</span></li><li class="L3"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> it</span></li><li class="L4"><span class="pnl">        </span><span class="tag">@</span><span class="pln"> "</span><span class="kwd">${</span><span class="expr">title</span><span class="kwd">}</span><span class="pln">"</span></li><li class="L5"><span class="pnl">        </span><span class="tag">function</span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> done</span></li><li class="L7"><span class="pnl">            </span><span class="tag">_</span><span class="kwd"> ${</span><span class="expr">call</span><span class="kwd">}</span></li><li class="L8"><span class="pnl">                </span><span class="kwd">$if</span><span class="expr"> arg1 != null</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="kwd"> ${</span><span class="expr">arg1</span><span class="kwd">}</span></li><li class="L0"><span class="pnl">                </span><span class="kwd">$if</span><span class="expr"> arg2 != null</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">@</span><span class="kwd"> ${</span><span class="expr">arg2</span><span class="kwd">}</span></li><li class="L2"><span class="pnl">                </span><span class="kwd">$if</span><span class="expr"> arg3 != null</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="kwd"> ${</span><span class="expr">arg3</span><span class="kwd">}</span></li><li class="L4"><span class="pnl">                </span><span class="kwd">$if</span><span class="expr"> arg4 != null</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="kwd"> ${</span><span class="expr">arg4</span><span class="kwd">}</span></li><li class="L6"><span class="pnl">                </span><span class="kwd">$if</span><span class="expr"> arg5 != null</span></li><li class="L7"><span class="pnl">                    </span><span class="tag">@</span><span class="kwd"> ${</span><span class="expr">arg5</span><span class="kwd">}</span></li><li class="L8"><span class="pnl">                </span><span class="kwd">$if</span><span class="expr"> arg6 != null</span></li><li class="L9"><span class="pnl">                    </span><span class="tag">@</span><span class="kwd"> ${</span><span class="expr">arg6</span><span class="kwd">}</span></li><li class="L0"><span class="pnl">                </span><span class="tag">function</span></li><li class="L1"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> err</span></li><li class="L2"><span class="pnl">                    </span><span class="tag">param</span><span class="pln"> result</span></li><li class="L3"><span class="pnl">                    </span><span class="kwd">$hook</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d111">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/tobe_array.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name, length</span></li><li class="L3"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).to.be.an('array')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">.length).to.be(</span><span class="kwd">${</span><span class="expr">length</span><span class="kwd">}</span><span class="pln">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d112">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/tobe_false.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name</span></li><li class="L3"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).to.be(false)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d113">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/tobe_number.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name, value</span></li><li class="L3"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).to.be.a('number')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).to.be(</span><span class="kwd">${</span><span class="expr">value</span><span class="kwd">}</span><span class="pln">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d114">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/tobe_object_len.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name, length</span></li><li class="L3"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).to.be.an('object')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(Object.keys(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).length).to.be(</span><span class="kwd">${</span><span class="expr">length</span><span class="kwd">}</span><span class="pln">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d115">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/tobe_object.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name</span></li><li class="L3"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).to.be.an('object')</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d116">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/tobe_string_value.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name, value</span></li><li class="L3"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).to.be.a('string')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).to.be(</span><span class="kwd">${</span><span class="expr">value</span><span class="kwd">}</span><span class="pln">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d117">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/tobe_string.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name, value</span></li><li class="L3"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).to.be.a('string')</span></li><li class="L4"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).to.be('</span><span class="kwd">${</span><span class="expr">value</span><span class="kwd">}</span><span class="pln">')</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d118">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/tobe_true.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name</span></li><li class="L3"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).to.be(true)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d119">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/t/tobe_undefined.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="kwd">$group</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name</span></li><li class="L3"><span class="pnl">    </span><span class="tag">_</span><span class="pln"> expect(</span><span class="kwd">${</span><span class="expr">name</span><span class="kwd">}</span><span class="pln">).to.be(undefined)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d120">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/util/fail.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="unknown">js/v3/tests/util/fail(</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d121">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/util/file.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="unknown">js/v3/tests/util/file(</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d122">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/util/verify.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="unknown">js/v3/tests/util/verify(</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d123">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/errors.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="unknown">js/v3/tests/errors(</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d124">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/ittf/tests/option.js.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="mix frag-to-link-a" data-frag-id="unknown">js/v3/tests/option(</span><span class="mix">)</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;" id="d125">&nbsp;
                        <div>
                            <h2 class="d-h2">/v3-wizzi-mtree/generate.wfjob.ittf</h2>
                            <pre class="prettyprint">
    <ol class="linenums">
        
<li class="L1"><span class="pnl"></span><span class="tag">wfjob</span><span class="pln"> wizzi-mtree</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$</span></li><li class="L3"><span class="pnl">        </span><span class="expr">var</span><span class="expr"> root_folder           = path.join(__dirname, 'root');</span></li><li class="L4"><span class="pnl">        </span><span class="expr">var</span><span class="expr"> ittf_lib_folder       = path.join(__dirname, 'ittf', 'lib');</span></li><li class="L5"><span class="pnl">        </span><span class="expr">var</span><span class="expr"> ittf_root_folder      = path.join(__dirname, 'ittf', 'root');</span></li><li class="L6"><span class="pnl">        </span><span class="expr">var</span><span class="expr"> ittf_examples_folder  = path.join(__dirname, 'ittf', 'examples');</span></li><li class="L7"><span class="pnl">        </span><span class="expr">var</span><span class="expr"> ittf_tests_folder     = path.join(__dirname, 'ittf', 'tests');</span></li><li class="L8"><span class="pnl">        </span><span class="expr">//</span><span class="expr"> var dest_folder        = "c:/my/wizzi/v3/packages/wizzi-mtree";</span></li><li class="L9"><span class="pnl">        </span><span class="expr">//</span><span class="expr"> var dest_folder        = "C:/My/wizzi/v3/apps/demo/node_modules/wizzi-mtree";</span></li><li class="L0"><span class="pnl">        </span><span class="expr">var</span><span class="expr"> dest_folder           = "C:/My/wizzi/v3/apps/docs/node_modules/wizzi-mtree";</span></li><li class="L1"><span class="pnl">        </span><span class="expr">//</span><span class="expr"> var dest_folder        = "C:/My/wizzi/v3/v3-next/node_modules/wizzi-mtree";</span></li><li class="L2"><span class="pnl">        </span><span class="expr">//</span><span class="expr"> var dest_folder        = "c:/my/wizzi/github/wizzi-mtree";</span></li><li class="L3"><span class="pnl">    </span><span class="tag">line</span><span class="pln"> root</span></li><li class="L4"><span class="pnl">        </span><span class="tag">cwd-folder</span><span class="kwd"> ${</span><span class="expr">root_folder</span><span class="kwd">}</span></li><li class="L5"><span class="pnl">        </span><span class="kwd">$include</span><span class="mix frag-to-link-a" data-frag-id="unknown"> wfjob/any_plain</span></li><li class="L6"><span class="pnl">        </span><span class="kwd">$include</span><span class="mix frag-to-link-a" data-frag-id="unknown"> wfjob/any_gitignore</span></li><li class="L7"><span class="pnl">    </span><span class="tag">line</span><span class="pln"> ittf-lib</span></li><li class="L8"><span class="pnl">        </span><span class="tag">cwd-folder</span><span class="kwd"> ${</span><span class="expr">ittf_lib_folder</span><span class="kwd">}</span></li><li class="L9"><span class="pnl">        </span><span class="tag">dest-folder</span><span class="kwd"> ${</span><span class="expr">dest_folder</span><span class="kwd">}</span><span class="pln">/lib</span></li><li class="L0"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="unknown">wfjob/any_js(</span><span class="mix">)</span></li><li class="L1"><span class="pnl">            </span><span class="tag">ignore</span><span class="kwd"> ${</span><span class="expr">ittf_lib_folder</span><span class="kwd">}</span><span class="pln">/**/*__copy/**/*.js.ittf</span></li><li class="L2"><span class="pnl">        </span><span class="tag">artifact</span><span class="pln"> any_ittf_inside___copy</span></li><li class="L3"><span class="pnl">            </span><span class="tag">src</span><span class="kwd"> ${</span><span class="expr">ittf_lib_folder</span><span class="kwd">}</span><span class="pln">/**/*__copy/**/*.ittf</span></li><li class="L4"><span class="pnl">            </span><span class="tag">extension</span><span class="pln"> ittf</span></li><li class="L5"><span class="pnl">    </span><span class="tag">line</span><span class="pln"> ittf-root</span></li><li class="L6"><span class="pnl">        </span><span class="tag">cwd-folder</span><span class="kwd"> ${</span><span class="expr">ittf_root_folder</span><span class="kwd">}</span></li><li class="L7"><span class="pnl">        </span><span class="tag">dest-folder</span><span class="kwd"> ${</span><span class="expr">dest_folder</span><span class="kwd">}</span></li><li class="L8"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="unknown">wfjob/any_js(</span><span class="mix">)</span></li><li class="L9"><span class="pnl">            </span><span class="tag">ignore</span><span class="kwd"> ${</span><span class="expr">ittf_root_folder</span><span class="kwd">}</span><span class="pln">/**/*__copy.*/**/*.js.ittf</span></li><li class="L0"><span class="pnl">        </span><span class="kwd">$include</span><span class="mix frag-to-link-a" data-frag-id="unknown"> wfjob/any_json</span></li><li class="L1"><span class="pnl">    </span><span class="tag">line</span><span class="pln"> ittf-examples</span></li><li class="L2"><span class="pnl">        </span><span class="tag">cwd-folder</span><span class="kwd"> ${</span><span class="expr">ittf_examples_folder</span><span class="kwd">}</span></li><li class="L3"><span class="pnl">        </span><span class="tag">dest-folder</span><span class="kwd"> ${</span><span class="expr">dest_folder</span><span class="kwd">}</span><span class="pln">/examples</span></li><li class="L4"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="unknown">wfjob/any_js(</span><span class="mix">)</span></li><li class="L5"><span class="pnl">            </span><span class="tag">ignore</span><span class="kwd"> ${</span><span class="expr">ittf_examples_folder</span><span class="kwd">}</span><span class="pln">/**/*__copy/**/*.js.ittf</span></li><li class="L6"><span class="pnl">        </span><span class="tag">artifact</span><span class="pln"> any_ittf_inside___copy</span></li><li class="L7"><span class="pnl">            </span><span class="tag">src</span><span class="kwd"> ${</span><span class="expr">ittf_examples_folder</span><span class="kwd">}</span><span class="pln">/**/*__copy/**/*.ittf</span></li><li class="L8"><span class="pnl">            </span><span class="tag">extension</span><span class="pln"> ittf</span></li><li class="L9"><span class="pnl">    </span><span class="tag">line</span><span class="pln"> ittf-tests</span></li><li class="L0"><span class="pnl">        </span><span class="tag">cwd-folder</span><span class="kwd"> ${</span><span class="expr">ittf_tests_folder</span><span class="kwd">}</span></li><li class="L1"><span class="pnl">        </span><span class="tag">dest-folder</span><span class="kwd"> ${</span><span class="expr">dest_folder</span><span class="kwd">}</span><span class="pln">/tests</span></li><li class="L2"><span class="pnl">        </span><span class="mix frag-to-link-a" data-frag-id="unknown">wfjob/any_js(</span><span class="mix">)</span></li><li class="L3"><span class="pnl">            </span><span class="tag">ignore</span><span class="kwd"> ${</span><span class="expr">ittf_tests_folder</span><span class="kwd">}</span><span class="pln">/**/*__copy/**/*.js.ittf</span></li><li class="L4"><span class="pnl">        </span><span class="tag">artifact</span><span class="pln"> any_ittf_inside___copy</span></li><li class="L5"><span class="pnl">            </span><span class="tag">src</span><span class="kwd"> ${</span><span class="expr">ittf_tests_folder</span><span class="kwd">}</span><span class="pln">/**/*__copy/**/*.ittf</span></li><li class="L6"><span class="pnl">            </span><span class="tag">extension</span><span class="pln"> ittf</span></li><li class="L7"><span class="pnl">        </span><span class="kwd">$include</span><span class="mix frag-to-link-a" data-frag-id="unknown"> wfjob/any_tests_ittf</span></li><li class="L8"><span class="pnl">    </span><span class="tag">production</span></li><li class="L9"><span class="pnl">        </span><span class="tag">dest-folder</span><span class="kwd"> ${</span><span class="expr">dest_folder</span><span class="kwd">}</span></li><li class="L0"><span class="pnl">        </span><span class="tag">line-ref</span><span class="pln"> root</span></li><li class="L1"><span class="pnl">        </span><span class="tag">line-ref</span><span class="pln"> ittf-lib</span></li><li class="L2"><span class="pnl">        </span><span class="tag">line-ref</span><span class="pln"> ittf-root</span></li><li class="L3"><span class="pnl">        </span><span class="tag">line-ref</span><span class="pln"> ittf-examples</span></li><li class="L4"><span class="pnl">        </span><span class="tag">line-ref</span><span class="pln"> ittf-tests</span></li></ol>
                            </pre>
                        </div>
                    </div>
                    <div id="frag-modal" class="modal">
                        <div id="frag-modal-content" class="modal-content">
                            <span class="modal-close">&times;</span>
                        </div>
                    </div>
                </div>
            </main>
        </div>
        <script src="jquery-3.2.1.js"></script>
        <script src="../wizzifactory.js"></script>
    </body>

</html>
