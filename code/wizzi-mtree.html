<!doctype html>
<html VERSION-5="5" VERSION-4="4" version="5">
<head>
    <title>The Wizzi Factory</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" />
    <link href="../sanitize.css" rel="stylesheet" />
    <link href="../wizzifactory.css" rel="stylesheet" />
    <link href="styles.css" rel="stylesheet" />
</head>
<body class="code-wizzi-mtree">
    <div class="site">
        <header class="navigation-sub">
            <div class="container navigation__inner">
                <a href="../index.html"><img width="100" height="44px" src="../logo.svg" />
                </a>
                <nav class="navigation__links">
                    <a title="code concepts" href="../concepts.html" class="navigation__link">Concepts</a>
                    <a title="code docs" href="../docs/intro.html" class="navigation__link">Docs</a>
                    <a title="code api" href="../api.html" class="navigation__link">Api</a>
                    <a title="code code" href="../code/intro.html" class="navigation__link navigation__link--active">Code</a>
                    <a title="code starters" href="../starters.html" class="navigation__link">Starters</a>
                    <a title="code project" href="../project.html" class="navigation__link">Project</a>
                </nav>
                <div class="navigation__search">
                    <span class="algolia-autocomplete" style="position: relative; display: inline-block; direction: ltr;">
                        <input type="text" class="navigation__search-input ds-input" placeholder="Search documentationâ€¦" autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0" dir="auto" style="position: relative; vertical-align: top;" />
                        <pre aria-hidden="true" style="position: absolute; visibility: hidden; white-space: pre; font-family: Arial; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; word-spacing: 0px; letter-spacing: normal; text-indent: 7px; text-rendering: auto; text-transform: none;"></pre>
                        <span class="ds-dropdown-menu" role="listbox" id="algolia-autocomplete-listbox-0" style="position: absolute; top: 100%; z-index: 100; display: none; left: 0px; right: auto;">
                            <div class="ds-dataset-1"></div>
                        </span>
                    </span>
                    <button class="navigation__search-icon icon-search"></button>
                    <button class="navigation__search-icon icon-cross"></button>
                </div>
                <a href="https://github.com/wizzifactory" target="_blank" class="navigation__icon" title="GitHub Repository"><i class="sidecar__icon icon-github"></i>
                </a>
                <a href="https://stackoverflow.com/questions/tagged/wizzifactory" target="_blank" class="navigation__icon" title="See Questions on Stack Overflow"><i class="sidecar__icon icon-stackoverflow"></i>
                </a>
                <a href="#" target="_blank" class="navigation__icon" title="Follow on twitter"><i class="sidecar__icon icon-twitter"></i>
                </a>
                <a href="#" target="_blank" class="navigation__icon" title="Follow on facebook"><i class="sidecar__icon icon-facebook"></i>
                </a>
            </div>
            <div class="navigation__bottom">
                <div class="container navigation__inner">
                    <a class="navigation__child" title="intro ittf source code" href="intro.html">intro</a>
                    <a class="navigation__child" title="wizzi ittf source code" href="wizzi.html">wizzi</a>
                    <a class="navigation__child navigation__child--active" title="wizzi-mtree ittf source code" href="wizzi-mtree.html">mtree</a>
                    <a class="navigation__child" title="wizzi-repo ittf source code" href="wizzi-repo.html">repo</a>
                    <a class="navigation__child" title="wizzi-utils ittf source code" href="wizzi-utils.html">utils</a>
                    <a class="navigation__child" title="wizzi-core ittf source code" href="wizzi-core.html">core</a>
                    <a class="navigation__child" title="wizzi-js ittf source code" href="wizzi-js.html">js</a>
                    <a class="navigation__child" title="wizzi-web ittf source code" href="wizzi-web.html">web</a>
                    <a class="navigation__child" title="wizzi-demo ittf source code" href="wizzi-demo.html">demo</a>
                </div>
            </div>
        </header>
        <main id="wrapper-sub">
            <nav class="main-sidebar-left main-sidebar-left-sub">
                <img src="../workinprogress.jpg" />
                <section id="main-toc" class="toc">
                    <h3>wizzi-mtree ittf source code:</h3>
                    <div class="treeview">
                        <ul>
                            <li><input type="checkbox" checked id="f2" />
                            <span></span>
                            <label for="f2">src</label>
                            <ul>
                                <li><input type="checkbox" checked id="f3" />
                                <span></span>
                                <label for="f3">ittf</label>
                                <ul>
                                    <li><input type="checkbox" id="f4" />
                                    <span></span>
                                    <label for="f4">examples</label>
                                    <ul>
                                        <li><input type="checkbox" id="f5" />
                                        <span></span>
                                        <label for="f5">ittf__copy</label>
                                        <ul>
                                            <li><a href="#d1">load_compile.html.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f6" />
                                        <span></span>
                                        <label for="f6">jswizzi</label>
                                        <ul>
                                            <li><input type="checkbox" id="f7" />
                                            <span></span>
                                            <label for="f7">ittf__copy</label>
                                            <ul>
                                                <li><input type="checkbox" id="f8" />
                                                <span></span>
                                                <label for="f8">t</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f9" />
                                                    <span></span>
                                                    <label for="f9">gwmc</label>
                                                    <ul>
                                                        <li><a href="#d2">footer.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d3">layout.tests.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><a href="#d4">item.tests.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d5">global_when_mixing_container.tests.ittf</a>
                                                </li>
                                                <li><a href="#d6">global.tests.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d7">global_when_mixing_container.js.ittf</a>
                                            </li>
                                            <li><a href="#d8">global.js.ittf</a>
                                            </li>
                                            <li><a href="#d9">quick.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f10" />
                                        <span></span>
                                        <label for="f10">loader</label>
                                        <ul>
                                            <li><input type="checkbox" id="f11" />
                                            <span></span>
                                            <label for="f11">step_1__copy</label>
                                            <ul>
                                                <li><a href="#d10">liner_1.sample.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f12" />
                                            <span></span>
                                            <label for="f12">step_2__copy</label>
                                            <ul>
                                                <li><input type="checkbox" id="f13" />
                                                <span></span>
                                                <label for="f13">t</label>
                                                <ul>
                                                    <li><a href="#d11">f_cb.sample.ittf</a>
                                                    </li>
                                                    <li><a href="#d12">r_cb.sample.ittf</a>
                                                    </li>
                                                    <li><a href="#d13">repeater_increment.sample.ittf</a>
                                                    </li>
                                                    <li><a href="#d14">repeater.sample.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d15">appender_1.sample.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f14" />
                                            <span></span>
                                            <label for="f14">step_5__copy</label>
                                            <ul>
                                                <li><a href="#d16">evaluate_1.sample.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d17">step_1_go.js.ittf</a>
                                            </li>
                                            <li><a href="#d18">step_2_go.js.ittf</a>
                                            </li>
                                            <li><a href="#d19">step_5_go.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f15" />
                                        <span></span>
                                        <label for="f15">t</label>
                                        <ul>
                                            <li><a href="#d20">example_prints.js.ittf</a>
                                            </li>
                                            <li><a href="#d21">example.js.ittf</a>
                                            </li>
                                            <li><a href="#d22">oldexample.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><a href="#d23">index.js.ittf</a>
                                        </li>
                                        <li><a href="#d24">loader.js.ittf</a>
                                        </li>
                                    </ul>
                                    </li>
                                    <li><input type="checkbox" id="f16" />
                                    <span></span>
                                    <label for="f16">lib</label>
                                    <ul>
                                        <li><input type="checkbox" id="f17" />
                                        <span></span>
                                        <label for="f17">basicloader</label>
                                        <ul>
                                            <li><a href="#d25">file.js.ittf</a>
                                            </li>
                                            <li><a href="#d26">index.js.ittf</a>
                                            </li>
                                            <li><a href="#d27">liner.js.ittf</a>
                                            </li>
                                            <li><a href="#d28">mTree.js.ittf</a>
                                            </li>
                                            <li><a href="#d29">nodifier.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f18" />
                                        <span></span>
                                        <label for="f18">jswizzi</label>
                                        <ul>
                                            <li><input type="checkbox" id="f19" />
                                            <span></span>
                                            <label for="f19">functions</label>
                                            <ul>
                                                <li><a href="#d30">dateUtil.js.ittf</a>
                                                </li>
                                                <li><a href="#d31">underscore.js.ittf</a>
                                                </li>
                                                <li><a href="#d32">verify.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f20" />
                                            <span></span>
                                            <label for="f20">t</label>
                                            <ul>
                                                <li><input type="checkbox" id="f21" />
                                                <span></span>
                                                <label for="f21">jsWizziContext</label>
                                                <ul>
                                                    <li><a href="#d33">getset_value.ittf</a>
                                                    </li>
                                                    <li><a href="#d34">set_context.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><input type="checkbox" id="f22" />
                                                <span></span>
                                                <label for="f22">jsWizziEvalHelper</label>
                                                <ul>
                                                    <li><a href="#d35">getMTreeBrickEvalContext.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><input type="checkbox" id="f23" />
                                                <span></span>
                                                <label for="f23">jsWizziRunner</label>
                                                <ul>
                                                    <li><a href="#d36">expressions.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d37">for.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d38">functions.js.ittf</a>
                                                    </li>
                                                    <li><a href="#d39">statements.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d40">checked_run_set.js.ittf</a>
                                                </li>
                                                <li><a href="#d41">checked_run.js.ittf</a>
                                                </li>
                                                <li><a href="#d42">runner.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d43">contextData.js.ittf</a>
                                            </li>
                                            <li><a href="#d44">errors.js.ittf</a>
                                            </li>
                                            <li><a href="#d45">jsWizziContext.js.ittf</a>
                                            </li>
                                            <li><a href="#d46">jsWizziEvalHelper.js.ittf</a>
                                            </li>
                                            <li><a href="#d47">jsWizziRunner.js.ittf</a>
                                            </li>
                                            <li><a href="#d48">jsWizziScriptCoder.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f24" />
                                        <span></span>
                                        <label for="f24">loader</label>
                                        <ul>
                                            <li><input type="checkbox" id="f25" />
                                            <span></span>
                                            <label for="f25">t</label>
                                            <ul>
                                                <li><input type="checkbox" id="f26" />
                                                <span></span>
                                                <label for="f26">ittfDocumentFinder</label>
                                                <ul>
                                                    <li><a href="#d49">recurserTFolder.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><input type="checkbox" id="f27" />
                                                <span></span>
                                                <label for="f27">md</label>
                                                <ul>
                                                    <li><a href="#d50">glo-item.md.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><input type="checkbox" id="f28" />
                                                <span></span>
                                                <label for="f28">mTreeBrick</label>
                                                <ul>
                                                    <li><a href="#d51">calcParamValues.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d52">appender.js.ittf</a>
                                            </li>
                                            <li><a href="#d53">debugInfoBuilder.js.ittf</a>
                                            </li>
                                            <li><a href="#d54">evaluator.js.ittf</a>
                                            </li>
                                            <li><a href="#d55">includer.js.ittf</a>
                                            </li>
                                            <li><a href="#d56">index.js.ittf</a>
                                            </li>
                                            <li><a href="#d57">ittfDocumentFinder.js.ittf</a>
                                            </li>
                                            <li><a href="#d58">ittfInterpolate.js.ittf</a>
                                            </li>
                                            <li><a href="#d59">liner_save.js.ittf</a>
                                            </li>
                                            <li><a href="#d60">liner.js.ittf</a>
                                            </li>
                                            <li><a href="#d61">loadHistory.js.ittf</a>
                                            </li>
                                            <li><a href="#d62">mixer.js.ittf</a>
                                            </li>
                                            <li><a href="#d63">mTreeBrick.js.ittf</a>
                                            </li>
                                            <li><a href="#d64">mTreeBrickProvider.js.ittf</a>
                                            </li>
                                            <li><a href="#d65">mTreeBuildUpScripter.js.ittf</a>
                                            </li>
                                            <li><a href="#d66">nodifier.js.ittf</a>
                                            </li>
                                            <li><a href="#d67">readme.md.ittf</a>
                                            </li>
                                            <li><a href="#d68">requireFromString.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f29" />
                                        <span></span>
                                        <label for="f29">util</label>
                                        <ul>
                                            <li><a href="#d69">node.js.ittf</a>
                                            </li>
                                            <li><a href="#d70">types.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><a href="#d71">errors.js.ittf</a>
                                        </li>
                                    </ul>
                                    </li>
                                    <li><input type="checkbox" id="f30" />
                                    <span></span>
                                    <label for="f30">meta</label>
                                    <ul>
                                        <li><a href="#d72">index.json.ittf</a>
                                        </li>
                                    </ul>
                                    </li>
                                    <li><input type="checkbox" id="f31" />
                                    <span></span>
                                    <label for="f31">root</label>
                                    <ul>
                                        <li><input type="checkbox" id="f32" />
                                        <span></span>
                                        <label for="f32">t</label>
                                        <ul>
                                            <li><a href="#d73">readme_content.md.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><a href="#d74">.gitignore.text.ittf</a>
                                        </li>
                                        <li><a href="#d75">index.js.ittf</a>
                                        </li>
                                        <li><a href="#d76">license.text.ittf</a>
                                        </li>
                                        <li><a href="#d77">package.json.ittf</a>
                                        </li>
                                        <li><a href="#d78">readme.md.ittf</a>
                                        </li>
                                    </ul>
                                    </li>
                                    <li><input type="checkbox" id="f33" />
                                    <span></span>
                                    <label for="f33">t</label>
                                    <ul>
                                        <li><input type="checkbox" id="f34" />
                                        <span></span>
                                        <label for="f34">mocks</label>
                                        <ul>
                                            <li><a href="#d79">errors.js.ittf</a>
                                            </li>
                                            <li><a href="#d80">fileSystemStore.js.ittf</a>
                                            </li>
                                            <li><a href="#d81">ittfDocumentStore.js.ittf</a>
                                            </li>
                                            <li><a href="#d82">uriparser.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><a href="#d83">checked_call_return_set.js.ittf</a>
                                        </li>
                                        <li><a href="#d84">checked_call_return.js.ittf</a>
                                        </li>
                                        <li><a href="#d85">checked_call.js.ittf</a>
                                        </li>
                                        <li><a href="#d86">error.js.ittf</a>
                                        </li>
                                        <li><a href="#d87">f_cb_no_err.js.ittf</a>
                                        </li>
                                        <li><a href="#d88">f_cb_throw.js.ittf</a>
                                        </li>
                                        <li><a href="#d89">f_cb.js.ittf</a>
                                        </li>
                                        <li><a href="#d90">local_error.js.ittf</a>
                                        </li>
                                        <li><a href="#d91">r_cb_err.js.ittf</a>
                                        </li>
                                        <li><a href="#d92">r_cb_error.js.ittf</a>
                                        </li>
                                        <li><a href="#d93">r_cb_wz_err.js.ittf</a>
                                        </li>
                                        <li><a href="#d94">r_wz_err.js.ittf</a>
                                        </li>
                                        <li><a href="#d95">var_cb_error.js.ittf</a>
                                        </li>
                                        <li><a href="#d96">var_error.js.ittf</a>
                                        </li>
                                    </ul>
                                    </li>
                                    <li><input type="checkbox" id="f35" />
                                    <span></span>
                                    <label for="f35">tests_stop</label>
                                    <ul>
                                        <li><input type="checkbox" id="f36" />
                                        <span></span>
                                        <label for="f36">basicloader</label>
                                        <ul>
                                            <li><input type="checkbox" id="f37" />
                                            <span></span>
                                            <label for="f37">data</label>
                                            <ul>
                                                <li><a href="#d97">doc1.tests.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d98">index.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                    </ul>
                                    </li>
                                    <li><input type="checkbox" id="f38" />
                                    <span></span>
                                    <label for="f38">tests</label>
                                    <ul>
                                        <li><input type="checkbox" id="f39" />
                                        <span></span>
                                        <label for="f39">jswizzi</label>
                                        <ul>
                                            <li><input type="checkbox" id="f40" />
                                            <span></span>
                                            <label for="f40">t</label>
                                            <ul>
                                                <li><a href="#d99">builtinFunctions.js.ittf</a>
                                                </li>
                                                <li><a href="#d100">conditionals.js.ittf</a>
                                                </li>
                                                <li><a href="#d101">declares.js.ittf</a>
                                                </li>
                                                <li><a href="#d102">iterations.js.ittf</a>
                                                </li>
                                                <li><a href="#d103">logicalExpressions.js.ittf</a>
                                                </li>
                                                <li><a href="#d104">mathExpressions.js.ittf</a>
                                                </li>
                                                <li><a href="#d105">memberAccesses.js.ittf</a>
                                                </li>
                                                <li><a href="#d106">stringExpressions.js.ittf</a>
                                                </li>
                                                <li><a href="#d107">unaryExpressions.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d108">contextData.js.ittf</a>
                                            </li>
                                            <li><a href="#d109">jsWizziRunner.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f41" />
                                        <span></span>
                                        <label for="f41">loader</label>
                                        <ul>
                                            <li><input type="checkbox" id="f42" />
                                            <span></span>
                                            <label for="f42">mocks</label>
                                            <ul>
                                                <li><a href="#d110">errors.js.ittf</a>
                                                </li>
                                                <li><a href="#d111">fileSystemStore.js.ittf</a>
                                                </li>
                                                <li><a href="#d112">ittfDocumentStore.js.ittf</a>
                                                </li>
                                                <li><a href="#d113">misc.js.ittf</a>
                                                </li>
                                                <li><a href="#d114">mTreeLoader.js.ittf</a>
                                                </li>
                                                <li><a href="#d115">uriParser.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f43" />
                                            <span></span>
                                            <label for="f43">repo</label>
                                            <ul>
                                                <li><input type="checkbox" id="f44" />
                                                <span></span>
                                                <label for="f44">data</label>
                                                <ul>
                                                    <li><input type="checkbox" id="f45" />
                                                    <span></span>
                                                    <label for="f45">t</label>
                                                    <ul>
                                                        <li><a href="#d116">frag1.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d117">frag2.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d118">ittf_object_args_item.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d119">lia.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d120">mixin_1.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d121">mixin_2_appender.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d122">mixin_2_evaluator.tests.ittf</a>
                                                        </li>
                                                        <li><a href="#d123">mixin_3_evaluator.tests.ittf</a>
                                                        </li>
                                                    </ul>
                                                    </li>
                                                    <li><a href="#d124">appender_1.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d125">doc1.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d126">evaluator_1.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d127">evaluator_2.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d128">evaluator_3.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d129">evaluator_4.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d130">evaluator_5.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d131">evaluator_6.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d132">function_1.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d133">function_2.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d134">function_3.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d135">ittf_object_args.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d136">liner_1.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d137">mixer_1.tests.ittf</a>
                                                    </li>
                                                    <li><a href="#d138">params_1.tests.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><input type="checkbox" id="f46" />
                                            <span></span>
                                            <label for="f46">t</label>
                                            <ul>
                                                <li><input type="checkbox" id="f47" />
                                                <span></span>
                                                <label for="f47">mtreeBrick</label>
                                                <ul>
                                                    <li><a href="#d139">calcParamValues.js.ittf</a>
                                                    </li>
                                                </ul>
                                                </li>
                                                <li><a href="#d140">initStore.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d141">appender.js.ittf</a>
                                            </li>
                                            <li><a href="#d142">evaluator.js.ittf</a>
                                            </li>
                                            <li><a href="#d143">function.js.ittf</a>
                                            </li>
                                            <li><a href="#d144">index.js.ittf</a>
                                            </li>
                                            <li><a href="#d145">ittfDocumentFinder.js.ittf</a>
                                            </li>
                                            <li><a href="#d146">ittfInterpolate.js.ittf</a>
                                            </li>
                                            <li><a href="#d147">liner.js.ittf</a>
                                            </li>
                                            <li><a href="#d148">loadContext.js.ittf</a>
                                            </li>
                                            <li><a href="#d149">mixer.js.ittf</a>
                                            </li>
                                            <li><a href="#d150">mTreeBrick.js.ittf</a>
                                            </li>
                                            <li><a href="#d151">mTreeBrickProvider.js.ittf</a>
                                            </li>
                                            <li><a href="#d152">nodifier.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f48" />
                                        <span></span>
                                        <label for="f48">t</label>
                                        <ul>
                                            <li><a href="#d153">async.js.ittf</a>
                                            </li>
                                            <li><a href="#d154">base_test.js.ittf</a>
                                            </li>
                                            <li><a href="#d155">expect_throw_error.js.ittf</a>
                                            </li>
                                            <li><a href="#d156">f_cb_done.js.ittf</a>
                                            </li>
                                            <li><a href="#d157">f_cb_no_err.js.ittf</a>
                                            </li>
                                            <li><a href="#d158">f_cb_test.js.ittf</a>
                                            </li>
                                            <li><a href="#d159">itasync.js.ittf</a>
                                            </li>
                                            <li><a href="#d160">tobe_array.js.ittf</a>
                                            </li>
                                            <li><a href="#d161">tobe_eql.js.ittf</a>
                                            </li>
                                            <li><a href="#d162">tobe_false.js.ittf</a>
                                            </li>
                                            <li><a href="#d163">tobe_number.js.ittf</a>
                                            </li>
                                            <li><a href="#d164">tobe_object_len.js.ittf</a>
                                            </li>
                                            <li><a href="#d165">tobe_object.js.ittf</a>
                                            </li>
                                            <li><a href="#d166">tobe_string_value.js.ittf</a>
                                            </li>
                                            <li><a href="#d167">tobe_string.js.ittf</a>
                                            </li>
                                            <li><a href="#d168">tobe_true.js.ittf</a>
                                            </li>
                                            <li><a href="#d169">tobe_undefined.js.ittf</a>
                                            </li>
                                            <li><a href="#d170">tobe.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                        <li><input type="checkbox" id="f49" />
                                        <span></span>
                                        <label for="f49">util</label>
                                        <ul>
                                            <li><input type="checkbox" id="f50" />
                                            <span></span>
                                            <label for="f50">t</label>
                                            <ul>
                                                <li><a href="#d171">nodeFinds.js.ittf</a>
                                                </li>
                                                <li><a href="#d172">nodeUpdates.js.ittf</a>
                                                </li>
                                            </ul>
                                            </li>
                                            <li><a href="#d173">node.js.ittf</a>
                                            </li>
                                            <li><a href="#d174">types.js.ittf</a>
                                            </li>
                                        </ul>
                                        </li>
                                    </ul>
                                    </li>
                                </ul>
                                </li>
                                <li><a href="#d175">generate.wfjob.ittf</a>
                                </li>
                            </ul>
                            </li>
                        </ul>
                    </div>
                </section>
            </nav>
            <div class="main-content">
                <div class="code-panel" id="d1">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/ittf__copy/load_compile.html.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">html</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">body</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">header</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$function</span><span class="pp-pln"> viewNode</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$param</span><span class="pp-pln"> node</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">tr</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">td</span><span class="pp-kwd"> ${</span><span class="pp-expr">node.id</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">td</span><span class="pp-pln"> item: </span><span class="pp-kwd">${</span><span class="pp-expr">node.title</span><span class="pp-kwd">}</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-kwd">$foreach</span><span class="pp-pln"> child in node.children</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-kwd">$_</span><span class="pp-pln"> viewNode</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-kwd">$@</span><span class="pp-pln"> child</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-kwd">$_</span><span class="pp-pln"> viewNode</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-kwd">$@</span><span class="pp-pln"> tree</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">footer</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d2">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/jswizzi/ittf__copy/t/gwmc/footer.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">bottom</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">beta</span><span class="pp-kwd"> ${</span><span class="pp-expr">gname</span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d3">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/jswizzi/ittf__copy/t/gwmc/layout.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">top</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$global</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> gname = name;</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">footer(</span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d4">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/jswizzi/ittf__copy/t/item.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">container</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-kwd">$global</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">gcount++;</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">item</span><span class="pp-kwd"> ${</span><span class="pp-expr">gcount</span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d5">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/jswizzi/ittf__copy/global_when_mixing_container.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">gwmc/layout(</span><span class="pp-arg"> alfa </span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d6">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/jswizzi/ittf__copy/global.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">tests</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$global</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> gcount = 0;</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">item(</span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d7">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/jswizzi/global_when_mixing_container.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d22">oldexample(</span><span class="pp-arg"> global_when_mixing_container </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> util.inspect</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> evaluatedModel</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> depth null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">log</span><span class="pp-pln"> 'global_when_mixing_container result', result</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d8">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/jswizzi/global.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d22">oldexample(</span><span class="pp-arg"> global </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> util.inspect</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> evaluatedModel</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> depth null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">log</span><span class="pp-pln"> '$global result', result</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d9">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/jswizzi/quick.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> JsWizziContext = require('../../lib/jswizzi/jsWizziContext')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> jsWizziRunner = require('../../lib/jswizzi/jsWizziRunner')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> result</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> runExpression</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'var x = typeof(nemo); return x;'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">log</span><span class="pp-pln"> 'result', result</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> runExpression</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> code</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> without ctor arguments means: isForInterpolation</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> jsWizziContext</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> JsWizziContext()</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> run the expression embedded in a var declaration 'result'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> hr</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsWizziRunner.run</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> code.indexOf('return ') &gt; -1</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span><span class="pp-pln"> 'var result = function dummy() { ' + code + ' }();'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span><span class="pp-pln"> 'var result = ' + code + ';'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsWizziContext</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> verbose false</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> hr && hr.__is_error</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error(hr)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> return the 'result' var from the context</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> jsWizziContext.getValue('result')</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d10">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/loader/step_1__copy/liner_1.sample.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">includer</span><span class="pp-pln"> first</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.hb.writeText(sp + '</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">e</span><span class="pp-pln"> string2</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">&</span><span class="pp-pln"> $$ ampersand_4</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">:</span><span class="pp-pln"> '</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">*</span><span class="pp-pln"> $$ asterisk_2</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">|</span><span class="pp-pln"> $$ bar_4</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d11">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/loader/step_2__copy/t/f_cb.sample.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result|notUsed</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> err</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d12">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/loader/step_2__copy/t/r_cb.sample.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d13">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/loader/step_2__copy/t/repeater_increment.sample.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> repeater_</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">(index_</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln"> + 1)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d14">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/loader/step_2__copy/t/repeater.sample.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, items, from|0</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> len_</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln"> = </span><span class="pp-kwd">${</span><span class="pp-expr">items</span><span class="pp-kwd">}</span><span class="pp-pln">.length</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> repeater_</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> index_</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> index_</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln"> === len_</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> next_</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> item_</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln"> = </span><span class="pp-kwd">${</span><span class="pp-expr">items</span><span class="pp-kwd">}</span><span class="pp-pln">[index_</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">]</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> repeater_</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">(</span><span class="pp-kwd">${</span><span class="pp-expr">from</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> next_</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span><span class="pp-pln"> next</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d15">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/loader/step_2__copy/appender_1.sample.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">append</span><span class="pp-pln"> 1</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> do = 1;</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-kwd">$if</span><span class="pp-expr"> do = 0</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">repeater(</span><span class="pp-arg"> 1</span><span class="pp-pln">,</span><span class="pp-arg">  items</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 1</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> a</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 2</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> b</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 3</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">repeater(</span><span class="pp-arg"> 2</span><span class="pp-pln">,</span><span class="pp-arg">  items</span><span class="pp-pln">,</span><span class="pp-arg">  index_1 + 1</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> 4</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> c</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> 5</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a">repeater_increment(</span><span class="pp-arg"> 2</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-kwd">$append</span><span class="pp-pln"> next</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> 6</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 7</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> d</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">repeater_increment(</span><span class="pp-arg"> 1</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-kwd">$append</span><span class="pp-pln"> next</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 8</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-kwd">$if</span><span class="pp-expr"> do = 1</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">repeater(</span><span class="pp-arg"> 1</span><span class="pp-pln">,</span><span class="pp-arg">  model.statements</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '607 jsArray'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> u.isMemberAccessOrCall(item_1)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.w('')</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.deindent()</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.write(']')</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> '605 jsArray'</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> cnt.genItem</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> item_1</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a">f_cb(</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> '603 jsArray'</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a">repeater(</span><span class="pp-arg"> 2</span><span class="pp-pln">,</span><span class="pp-arg">  model.statements</span><span class="pp-pln">,</span><span class="pp-arg">  index_1 + 1</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> u.isCallArgument(item_2)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.write('.')</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> cnt.genItem</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> item_2</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a">f_cb(</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                        </span><span class="pp-mix frag-to-link-a">repeater_increment(</span><span class="pp-arg"> 2</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                </span><span class="pp-kwd">$append</span><span class="pp-pln"> next</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a">r_cb(</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '606 jsArray'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !first</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.w(', ')</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> first = false</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> cnt.genItem</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> item_1</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">f_cb(</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> '604 jsArray'</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a">repeater_increment(</span><span class="pp-arg"> 1</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-kwd">$append</span><span class="pp-pln"> next</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> ;</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.w('')</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.deindent()</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.write(']')</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">r_cb(</span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d16">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/loader/step_5__copy/evaluate_1.sample.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">includer</span><span class="pp-pln"> first</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.hb.writeText(sp + '</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d17">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/loader/step_1_go.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d21">example(</span><span class="pp-arg"> loader_liner</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> EXAMPLE: liner</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> liner = require('../../lib/loader/liner')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> exec( 'liner_1' )</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> exec</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> source</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.read</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'step_1'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> name + '.sample.ittf'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> lines</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> liner</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> source</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey 'f1'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> name + ' source'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> source</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> printArray</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> name + ' lines'</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> lines</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d18">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/loader/step_2_go.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d21">example(</span><span class="pp-arg"> loader_appender</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> EXAMPLE: appender</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('../../tests/loader/mocks/misc')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrickProvider = require('../../lib/loader/mTreeBrickProvider')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mixer = require('../../lib/loader/mixer')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> appender = require('../../lib/loader/appender')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> evaluator = require('../../lib/loader/evaluator')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> store = new mocks.IttfDocumentStore()</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> evaluatedModel</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> node</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> store.init</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'filesystem'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">f_cb_throw(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> loadContext</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> exec( 'appender_1' )</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> exec</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> source</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'step_2'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> name + '.sample.ittf'</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> sourceContent</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> file.read</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> source</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> source</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">f_cb_throw(</span><span class="pp-arg"> provider </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> mTree = provider.getPrimaryMTreeBrick()</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> mixer</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> mTree</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> provider</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">f_cb_throw(</span><span class="pp-arg"> mixedModel </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> name + ' mixedModel'</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> mixedModel.dump()</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'dashes'</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> appender</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> mixedModel</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">f_cb_throw(</span><span class="pp-arg"> appendedModel </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> name + ' source'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> sourceContent</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'dashes'</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> name + ' toIttf'</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> appendedModel.toIttf()</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'dashes'</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d19">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/loader/step_5_go.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d21">example(</span><span class="pp-arg"> loader_evaluator</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> EXAMPLE: evaluator</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('../../tests/loader/mocks/misc')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrickProvider = require('../../lib/loader/mTreeBrickProvider')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mixer = require('../../lib/loader/mixer')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> appender = require('../../lib/loader/appender')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> evaluator = require('../../lib/loader/evaluator')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> store = new mocks.IttfDocumentStore()</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> evaluatedModel</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> node</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> store.init</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'filesystem'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">f_cb_throw(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> loadContext</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> exec( 'evaluate_1' )</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> exec</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> source</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'step_5'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> name + '.sample.ittf'</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> sourceContent</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> file.read</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> source</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> source</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">f_cb_throw(</span><span class="pp-arg"> provider </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> mTree = provider.getPrimaryMTreeBrick()</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> mixer</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> mTree</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> provider</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">f_cb_throw(</span><span class="pp-arg"> mixedModel </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> appender</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> mixedModel</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">f_cb_throw(</span><span class="pp-arg"> appendedModel </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> evaluator</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> appendedModel</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">f_cb_throw(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                                </span><span class="pp-tag">set</span><span class="pp-pln"> evaluatedModel = result</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> name + ' source'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceContent</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'dashes'</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> name + ' toIttf'</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> evaluatedModel.toIttf()</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'dashes'</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                                                </span><span class="pp-tag">_</span><span class="pp-pln"> printObject</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> name + ' evaluatedModel'</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> evaluatedModel</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'dashes'</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d20">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/t/example_prints.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, level|0, step|1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> heading1</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> ''</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '*'.repeat(120)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '** level </span><span class="pp-kwd">${</span><span class="pp-expr">level</span><span class="pp-kwd">}</span><span class="pp-pln"> - step </span><span class="pp-kwd">${</span><span class="pp-expr">step</span><span class="pp-kwd">}</span><span class="pp-pln"> - </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln"> - ' + text</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '*'.repeat(120)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> ''</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> heading2</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> ''</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', '-'.repeat(100)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '   ','-- </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln"> - ' + text</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', '-'.repeat(100)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> ''</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> printArray</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> arr</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> fields</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> format</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> format === 'dashes'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', '-'.repeat(100)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', '* array ' + name + ' : '</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in arr</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '    {', i</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> keys = fields || Object.keys(item)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> k in keys</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> printValue</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> k</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item[k]</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> printValue</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> k</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> v</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> format</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> p1</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> format === 'dashes' || format === 'meter'</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', '-'.repeat(100)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> format === 'json'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> stringify</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> v</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 4</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(v)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> lines</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> verify.splitLines</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> v</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> numbered true</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> lines.length === 1</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', k, ':', lines[0].text</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">for</span><span class="pp-pln"> var i=0; i&lt;lines.length; i++</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> i === 0</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', k, ':', lines[0].numFmt, lines[0].text</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', spaces(k.length+1), ' ', lines[i].numFmt, lines[i].text</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> verify.isObject(v)</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', k, ':', inspect(v)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', k, ':', v</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> format === 'meter'</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> meterLine(p1, '     ' + new Array(1 + k.length).join(' '))</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> printObject</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> k</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> v</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> format</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> p1</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> format === 'dashes' || format === 'meter'</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', '-'.repeat(100)</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '   ', k, '{'</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> __printObject(v, 2, 6)</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> format === 'meter'</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> meterLine(p1, '     ' + new Array(1 + k.length).join(' '))</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> __printObject</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> v</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> level</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> limit</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> level &lt; limit</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> indent = new Array(1 + level * 4).join(' ')</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> prop</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var k in v</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> prop = v[k]</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isObject(prop)</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> indent, k, '{'</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> __printObject(prop, level+1, limit)</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> verify.isFunction(prop)</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> indent, k, 'function'</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> verify.isArray(prop)</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> indent, k, '['</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> indent2 = new Array(1 + (level+1) * 4).join(' ')</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                    </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in prop</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isObject(item)</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> __printObject(item, level+1, limit)</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                        </span><span class="pp-tag">elif</span><span class="pp-pln"> verify.isFunction(item)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> indent2, 'function'</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> indent2, item</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> indent, k, prop</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> spaces</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> len</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> new Array(len).join(' ')</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> meterLine</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> len</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> indent</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> sb = []</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> numW = len &lt; 10 ? 1 : ( len &lt; 100 ? 2 : 3 )</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> x</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var i=0; i&lt;numW; i++</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var j=0; j&lt;len; j++</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> x = formatNum(j, numW)</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> sb.push(x.substr(i,1))</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> indent, sb.join('')</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> sb = []</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> formatNum</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> num</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> len</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> x = num.toString()</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> new Array(1 + len-x.length).join(' ') + x</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d21">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/t/example.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> async</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> stringify = require('json-stringify-safe')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> inspect = require('object-inspect')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> vfile = require('wizzi-utils').vfile</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = vfile()</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-kwd">$hook</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-kwd">$hook</span><span class="pp-pln"> functions</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> step_callback</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> heading1</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'EXAMPLE'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">.__name = '</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d20">example_prints(</span><span class="pp-arg"> ${name} </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-pln"> typeof require != 'undefined' && require.main === module</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d22">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/t/oldexample.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('../../tests/util/file')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('../../tests/loader/mocks/misc')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeLoader = require('../../tests/loader/mocks/mTreeLoader')</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> store</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> evaluatedModel</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 1</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> store = new mocks.IttfDocumentStore()</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 2</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> store.init</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'filesystem'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">f_cb_throw(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 3</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> ittfPath</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'ittf'</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">.tests.ittf'</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 4</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeLoader</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> store</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ittfPath</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">f_cb_throw(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> 5, result</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> evaluatedModel = result</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                            </span><span class="pp-kwd">$hook</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'outputs'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">.tests.ittf'</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> evaluatedModel.toIttf()</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d23">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/index.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> t = require('./jswizzi/global')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> t()</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> t = require('./jswizzi/global_when_mixing_container');</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> t()</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d24">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/examples/loader.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> vfile = require('wizzi-utils').vfile</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = vfile()</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('wizzi-utils').mocks</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> repo = mocks.repo</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> packageIndex = require('../index')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> loadMTree</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> packageIndex.createLoadMTree</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> repo.getCreateFilesystemStore</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> loadMTree</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'ittf'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'load_compile.html.ittf'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> __productionManager</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> mocks.getProductionManager</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> tree</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> id 1</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> title 'a'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                            </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> id 11</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> title 'aa'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                    </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> options</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> isCompile true</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d88">f_cb_throw(</span><span class="pp-arg"> mTree </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'outputs'</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'load_compile.html.ittf'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> mTree.toIttf</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d25">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/basicloader/file.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> fs = require('fs')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> path = require('path')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> iconv = require('iconv-lite')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> pathSeparatorRe = /[\/\\]/g</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.defaultEncoding = 'utf8'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.preserveBOM = false</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> win32 = process.platform === 'win32'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.unixifyPath =</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> win32</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> path_string.replace(/\\/g, '/')</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> path_string</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> sync read</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.read</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !(options)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> contents = fs.readFileSync(String(path_string))</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> options.encoding !== null</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> contents = iconv.decode(contents, (options.encoding || md.defaultEncoding))</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !md.preserveBOM && contents.charCodeAt(0) === 0xFEFF</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> contents = contents.substring(1)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> contents</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> sync readJSON</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.readJSON</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> src = md.read(path_string, options)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> result</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> result = JSON.parse(src)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> result</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> errors.FileError</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Unable to parse "' + path_string + '" file (' + ex.message + ').'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ex</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> async read</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.readFile</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> fs.readFile</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> data</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, data)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.write</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> contents</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !options</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> options =</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> md.mkpath(path_string)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !Buffer.isBuffer(contents)</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> contents = iconv.encode(contents, (options.encoding || md.defaultEncoding))</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> fs.writeFileSync(path_string, contents)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ex.message = 'Writing file ' + path_string + '.\n' + ex.message</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> ex</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.writeJSON</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> contentObject</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> md.write</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path_string</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> JSON.stringify(contentObject, null, 2)</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.mkpath</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> path_string</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> dir = path.dirname(path_string)</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> md.mkdir(dir)</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.mkdir</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> dirpath</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mode</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> mode == null</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> mode = parseInt('0777', 8) & ~ (process.umask())</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> dirpath.split(pathSeparatorRe)</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> reduce</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> parts</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> part</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> parts += part + '/'</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> subpath = path.resolve(parts)</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> !md.exists(subpath)</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                            </span><span class="pp-tag">try</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> fs.mkdirSync(subpath, mode)</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                                </span><span class="pp-tag">throw</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                                    </span><span class="pp-tag">new</span><span class="pp-pln"> errors.FileError</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Unable to create directory "' + subpath + '" (Error code: ' + ex.code + ').'</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> ex</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> parts</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ''</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d26">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/basicloader/index.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi.mtree.basicLoader</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> This basic loader is for testing plugins.</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The loadMTreeBrick function loads an mTree from a</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> single IttfDocument without include, mix, append and evaluate.</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Does not require a loadContext.</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The IttfDocument must be stored in the</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> filesystem (mongodb and localstorage store kinds</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> are not supported).</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> path = require('path')</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('./file')</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> liner = require('./liner')</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> nodifier = require('./nodifier')</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrick = require('./mTreeBrick').MTreeBrick</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.loadMTreeBrick</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> loadMTreeBrick</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> primaryIttfDocumentUri</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> notUsed</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(callback) !== 'function'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> Error("wizzi-mtree/lib/basicloader/loadMTreeBrick. A callback is required. Uri: " + primaryIttfDocumentUri)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> sourceText</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> file.read</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> primaryIttfDocumentUri</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> mTree = new MTreeBrick(primaryIttfDocumentUri)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mTree.load</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> sourceText</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey 's1'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nodes = mTree.nodes</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> mTree.nodes = []</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in nodes</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> final_node = _to_final_mtree(null, item)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> mTree.nodes.push</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> final_node</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTree</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _to_final_mtree</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> parent</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> final_node</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parent parent</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> children []</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> n node.name</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> v node.value</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> r node.row</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> c node.col</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> s node.brickKey</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> u node.sourceKey</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.children</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> final_node_child = _to_final_mtree(final_node, item)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> final_node.children.push</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> final_node_child</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> final_node</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d27">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/basicloader/liner.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Reads an IttfDocument and extract an array of line descriptions</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string textContent</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> #  The text content of the IttfDocument</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { ittfDocumentData</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string sourceKey</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> # The IttfDocument key generated by the loadHistory</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Output</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> lines:Array of</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> line : {</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> indent: Number,</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> name: String,</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> value: String, // always trimmed</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> row: Number,</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> col: Number,</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> sourceKey: String,</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> tagSuffix: undefined || '(',</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> hasMacro: Boolean</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> }</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Ittf commands for comments</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $ and $ ... singleline comment</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $ and * ... * and $ multiline comment</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Comment states</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 0 = no comment seen</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 1 = seen char $ could be first char of comment</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 2 = seen chars $ and * we are inside multiline comments</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 3 = seen chars $ and * ... and *  could be first char of end of multiline comments</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 21 = seen chars $ and $ we are inside singleline comment</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Es6 macro states</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 0 = no macro seen</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 1 = seen char ` we are inside macro</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 2 = seen escape char inside a macro, the next ` char does not close the macro string</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> textContent</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ittfDocumentData</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> sourceKey = ittfDocumentData.sourceKey</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> lines</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> leadingWhiteSpaces = 0</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> line = null</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> linepos = 1</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> lineHasMacro = false</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> colpos = 0</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> commentState = 0</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> macroState = 0</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> quote = null</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> TODO ensure textContent is red as utf-8 and avoid this</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> chunk = textContent.toString('utf-8')</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> ch</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> chUni</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> i</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> l = chunk.length</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> TODO replace ch with chUni</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> i = 0; i &lt; l; i++</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ch = chunk[i]</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> chUni = chunk.charCodeAt(i)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> colpos++</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> quote != null</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> quote == ch</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> quote = null</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(ch)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> commentState == 2</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '*'</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> could be start of end of comment</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = 3</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> skip comment char</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '\n'</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> linepos++</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> colpos = 0</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == 21</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '\n'</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> end of line comment</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> delegate end of comment to processMacro</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(ch)</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == 3</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '$'</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> ok, really is end of comment</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = 0</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> no, comments continue</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = 2</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> check if it is eol</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '\n'</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> linepos++</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> colpos = 0</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == 1 && ch == '*'</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> ok, really is start of comment</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = 2</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == 1 && ch == '$'</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> ok, is a line comment</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = 21</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == 1 && ch != '*'</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> no, it was not a comment, reset</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = 0</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro('$')</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(ch)</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == 0 && ch == '"'</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> start of literal</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> quote = ch</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(ch)</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == 0 && ch == "'"</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> start of literal</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> quote = ch</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(ch)</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == 0 && ch == '$'</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> could be start of comment</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = 1</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(ch)</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (line.value) !== 'undefined'</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> line.value = line.value.trim()</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> line.hasMacro = lineHasMacro</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> lines.push(line)</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> lineHasMacro = false</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> lines</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> processMacro</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> ch</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> macroState == 2</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> remove escape state</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = 1</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, ch</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> chUni == 96</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> macroState &gt; 0</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = 0</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, ch</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = 1</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, ch</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> macroState == 1</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '$'</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> ch = '#'</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> lineHasMacro = true</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, ch</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                            </span><span class="pp-tag">elif</span><span class="pp-pln"> ch == '\\'</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> could be an escape of a macro inside a macro</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = 2</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, ch</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(ch)</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> processChar</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> ch</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '\n'</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (line.value) !== 'undefined'</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value = line.value.trim()</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line.hasMacro = lineHasMacro</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> lines.push(line)</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line = null</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> lineHasMacro = false</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> Allow blank line. Do nothing</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> leadingWhiteSpaces = 0</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> colpos = 0</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> linepos++</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> commentState != 2</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = 0</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> ch == '\r'</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> [' ', '\t'].indexOf(ch) !== -1</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '\t'</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> colpos += 3</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (line.value) == 'undefined'</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value = ''</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value += ch</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> leadingWhiteSpaces += ch == ' ' ? 1 : 4</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> ['('].indexOf(ch) !== -1</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (line.value) == 'undefined'</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.tagSuffix = ch</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value = ''</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value += ch</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line =</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> indent leadingWhiteSpaces / 4</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name ch</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> row linepos</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> col colpos</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey sourceKey</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(line.value) == 'undefined'</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.name += ch</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value += ch</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line =</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> indent leadingWhiteSpaces / 4</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name ch</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> row linepos</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> col colpos</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey sourceKey</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d28">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/basicloader/mTree.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> liner = require('./liner')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> nodifier = require('./nodifier')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">wz-class</span><span class="pp-pln"> MTree</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.uri = uri</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.nodes = null</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.nodeCount = 0</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> load</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ittfSourceTextContent</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ittfDocumentData</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(ittfSourceTextContent) !== 'string'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> TypeError('ittfSourceTextContent must be a string')</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !ittfDocumentData || typeof(ittfDocumentData.sourceKey) !== 'string'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">new</span><span class="pp-pln"> TypeError('ittfDocumentData.sourceKey must be a string')</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> lines</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> liner(ittfSourceTextContent, ittfDocumentData)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> nodes</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> nodifier(lines, this)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.nodes = nodes</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getNewNodeId</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ++this.nodeCount</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d29">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/basicloader/nodifier.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Nodify the lines of an IttfDocument and creates a</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> tree structure object based on line indentation.</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . detects the $params command</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . implements line continuation</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . assigns an id to each node</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> !!! A line object is transformed in place into a node object</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> without recreation (no cloning) !!!</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Inputs</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> - the lines produced by the liner</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Outputs</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> nodes: Array of [</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> line -&gt; mTreeNode : {</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> + parent: Object, // parent mTreeNode</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> + model: Object, // the MTreeBrick to which the line belongs</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> + children: Array, // the children mTreeNodes</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> id: Number,</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> indent: Number,</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> name: String,</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> value: String,</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> row: Number,</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> col: Number,</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> sourceKey: String,</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> tagSuffix: undefined || '('</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> hasMacro: Boolean</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> }</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> ]</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Ittf commands:</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $params  // the param values are stored in the MTreeBrick</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> \        // implements line continuation</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> //   the value is appendend to the value of the parent line</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> //   without separators</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> \b       // implements line continuation</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> //   the value is appendend to the value of the parent line</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> //   with a space separator:  prevLine,value += ' ' + currentLine.value</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> \n       // implements line continuation</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> //   the value is appendend to the value of the parent line</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> //   with a line break separator:  prevLine,value += '\n' + currentLine.value</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> lines</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mTree</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> nodes</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> root = null</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> current = null</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> nameFirstChar = null</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> nameLength = 0</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> line</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> i</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> l = lines.length</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; l; i++</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> line = lines[i]</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> nameFirstChar = line.name[0]</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> nameLength = line.name.length</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> line.id = mTree.getNewNodeId()</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> line.model = mTree</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> line.indent == 0 && current == null</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> line.parent = null</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> nodes.push(line)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> current == null</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Malformed tree, root node cannot have an indent.'</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> line</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> mTree</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> line.indent == current.indent</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(current.parent) === 'undefined' || current.parent === null</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Malformed tree, only one root note allowed.'</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> line</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mTree</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> line.parent = current.parent</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> current.parent.children.push(line)</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> line.indent &gt; current.indent</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> nameFirstChar == '$' && line.name === '$params'</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> current.indent &gt; 0</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'The $params node must be a child of the root node.'</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> line</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTree</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> current.model.$params = line.value</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> nameFirstChar == '\\' && nameLength == 1</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> value continuation on new line</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> current.value += line.value</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> nameFirstChar == '\\' && line.name === '\\b'</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> value continuation on new line with space</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> current.value += (' ' + line.value)</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> nameFirstChar == '\\' && line.name === '\\n'</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> value continuation on new line with line break</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> current.value += ('\n' + line.value)</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line.parent = current</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> current.children.push(line)</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> line.indent &lt; current.indent</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> parent = current.parent</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                    </span><span class="pp-tag">while</span><span class="pp-pln"> parent != null && line.indent &lt; parent.indent</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> parent = parent.parent</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> line.parent = parent.parent</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parent.parent</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> parent.parent.children.push(line)</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Malformed tree, only one root note allowed.'</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> line</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mTree</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> current = line</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> current.children = []</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> nodes</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> error</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> message</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> line</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> mTree</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> message = message + '\nNode ' + line.name + ' ' + (line.value || '') + ' row: ' + line.row + ' col: ' + line.col + '.\n Filepath: ' + mTree.uri</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> message message</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> source 'wizzi-mtree/lib/loader/nodifier'</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d30">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/functions/dateUtil.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> now_GMYHMS</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> date = new Date()</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-tag">+</span><span class="pp-pln"> return date.getDate() + '/' +</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                        </span><span class="pp-tag">+</span><span class="pp-pln"> (date.getMonth() + 1) + '/' +</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                        </span><span class="pp-tag">+</span><span class="pp-pln"> date.getFullYear() + ':' +</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">+</span><span class="pp-pln"> date.getHours() + ':' +</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">+</span><span class="pp-pln"> date.getMinutes() + ':' +</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">+</span><span class="pp-pln"> date.getSeconds();</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d31">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/functions/underscore.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> inflect = require('i')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> String.prototype.capitalize =</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.replace</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> /(?:^|\s)\S/g</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> a</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> a.toUpperCase()</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> String.prototype.pluralize =</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> inflect.pluralize(this)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> pluralize</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> inflect.pluralize(str)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> capitalize</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> str.replace</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> /(?:^|\s)\S/g</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                            </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                </span><span class="pp-tag">param</span><span class="pp-pln"> a</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span><span class="pp-pln"> a.toUpperCase()</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> dashToCamelCase</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> str</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> verify.dashToCamelCase(str)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> escape verify.escapename</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isEmpty</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> typeof text === 'string' && text.trim().length === 0</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isNotEmpty</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> typeof text === 'string' && text.trim().length &gt; 0</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isObject</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> type = typeof obj</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> type === 'function' || type === 'object' && !!obj</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isArray</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> Array.isArray</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> Array.isArray(obj)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> toString.call(obj) === '[object Array]'</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isString</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> toString.call(obj) === '[object String]'</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isNumber</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> toString.call(obj) === '[object Number]'</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isDate</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> toString.call(obj) === '[object Date]'</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isFunction</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> toString.call(obj) === '[object Function]'</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isUndefined</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> obj === void 0</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> deinline</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> this.isNotEmpty(text) == false</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> ''</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                        </span><span class="pp-tag">decl</span><span class="pp-pln"> len = text.length</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                        </span><span class="pp-tag">decl</span><span class="pp-pln"> ch</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                        </span><span class="pp-tag">decl</span><span class="pp-pln"> i</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                        </span><span class="pp-tag">decl</span><span class="pp-pln"> ret = []</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                    </span><span class="pp-tag">for</span><span class="pp-pln"> i=0; i&lt;len; i++</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> ch = text[i]</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> ch === '
'</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push('\n')</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                        </span><span class="pp-tag">elif</span><span class="pp-pln"> ch === ''</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push('\r')</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                        </span><span class="pp-tag">elif</span><span class="pp-pln"> ch === '$'</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push('$')</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                        </span><span class="pp-tag">elif</span><span class="pp-pln"> ch === '\t'</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push('    ')</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push(ch)</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> ret.join('')</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> log</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> args</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> Array.prototype.slice.call</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> arguments</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> args.splice</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> "=== jsWizzi:log =&gt; "</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> console.log.apply</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> args</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> inspect</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> util.inspect(obj, { depth: null})</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> replace</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> from</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> to</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> verify.replaceAll(text, from, to)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d32">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/functions/verify.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isEmpty</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> typeof text === 'string' && text.trim().length === 0</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isNotEmpty</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> typeof text === 'string' && text.trim().length &gt; 0</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isObject</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> type = typeof obj</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> type === 'function' || type === 'object' && !!obj</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isArray</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> Array.isArray</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> Array.isArray(obj)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> toString.call(obj) === '[object Array]'</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isString</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> toString.call(obj) === '[object String]'</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isNumber</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> toString.call(obj) === '[object Number]'</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isDate</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> toString.call(obj) === '[object Date]'</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isFunction</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> toString.call(obj) === '[object Function]'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> isUndefined</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> obj === void 0</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d33">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/t/jsWizziContext/getset_value.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> beginLoadingCallArguments</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.loadingCallArguments = true</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> endLoadingCallArguments</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.loadingCallArguments = false</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> declare</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.ittf_state === ittfStates.globalContext</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.declare(name, value)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> this.ittf_state === ittfStates.nodeContext</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.nodeContext.declare(name, value)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.brickEvalContext.declare(name, value)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> declareCallParam</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.jsWizziContext.declareCallParam', name, value</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.callContext.declare(name, value)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> undeclare</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.ittf_state === ittfStates.globalContext</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.undeclare(name)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> this.ittf_state === ittfStates.nodeContext</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.nodeContext.undeclare(name)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.brickEvalContext.undeclare(name)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> isDeclared</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> ret = false</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.loadingCallArguments</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.globalContext.isDeclared(name)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.callContext.isDeclared(name)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.isForInterpolation == false</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> this.nodeContext.isDeclared(name)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> this.brickEvalContext && this.brickEvalContext.isDeclared(name)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> this.ittf_state === ittfStates.globalContext</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = this.brickEvalContext ? this.brickEvalContext.isDeclared(name) : null</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !ret</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret = this.globalContext.isDeclared(name)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> this.ittf_state === ittfStates.nodeContext</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = this.nodeContext.isDeclared(name)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !ret</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret = this.globalContext.isDeclared(name)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = this.brickEvalContext.isDeclared(name)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !ret</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret = this.globalContext.isDeclared(name)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> !ret</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ret = this.callContext.isDeclared(name)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> setValue</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.ittf_state === ittfStates.globalContext</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.setValue(name, value)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> this.ittf_state === ittfStates.nodeContext</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.nodeContext.setValue(name, value)</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.brickEvalContext.setValue(name, value)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> setValues</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> values</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> values = (values || {})</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var k in values</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.setValue</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> k</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> values[k]</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> put</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> assert</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> this.ittf_state != ittfStates.nodeContext</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'put in an invalid operation for NodeContext state'</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> ok = false</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.ittf_state === ittfStates.globalContext</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ok = this.globalContext.put(name, value)</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ok = this.brickEvalContext.put(name, value)</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !ok</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ok = this.globalContext.put(name, value)</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> !ok</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-mtree.jsWizziContext.brickEvalContext.declaresStack', this.brickEvalContext.declaresStack</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-mtree.jsWizziContext.brickEvalContext.valuesStack', this.brickEvalContext.valuesStack</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error('Not declared: ' + name);</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getValue</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.loadingCallArguments</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.globalContext.isDeclared(name)</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.globalContext.getValue(name)</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.callContext.isDeclared(name)</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.callContext.getValue(name)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.isForInterpolation == false</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> this.nodeContext.isDeclared(name)</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> this.nodeContext.getValue(name)</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> this.brickEvalContext && this.brickEvalContext.isDeclared(name)</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> this.brickEvalContext.getValue(name)</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> undefined</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> this.ittf_state === ittfStates.globalContext</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.brickEvalContext && this.brickEvalContext.isDeclared(name)</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.brickEvalContext.getValue(name)</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.globalContext.isDeclared(name)</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.globalContext.getValue(name)</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> this.ittf_state === ittfStates.nodeContext</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.nodeContext.isDeclared(name)</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.nodeContext.getValue(name)</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.globalContext.isDeclared(name)</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.globalContext.getValue(name)</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.brickEvalContext.isDeclared(name)</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.brickEvalContext.getValue(name)</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> this.globalContext.isDeclared(name)</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.globalContext.getValue(name)</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.callContext.isDeclared(name)</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.callContext.getValue(name)</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> return undefined</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'JsWizziContext.getValue context value not found for', name</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'JsWizziContext.getValue ittf_state ', this.ittf_state</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'JsWizziContext.getValue currentMTreeBrickKey ', this.currentMTreeBrickKey</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.dumpValues</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error('In jswizzi context. Not declared: ' + name);</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getValues</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> TODO brickEvalContext needs globalValues ???</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.ittf_state === ittfStates.globalContext</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.globalContext.getValues()</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> this.ittf_state === ittfStates.nodeContext</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.nodeContext.getValues()</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.brickEvalContext.getValues()</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> setGlobalValues</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> values</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.setValues(values)</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getGlobalValues</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.getValues()</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> declareFunction</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> fn</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.ittf_state === ittfStates.globalContext</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.declareFunction(name, fn)</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.brickEvalContext.declareFunction(name, fn)</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getFunction</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.ittf_state === ittfStates.globalContext</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.globalContext.getFunction(name)</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = this.brickEvalContext.getFunction(name)</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret ? ret : this.globalContext.getFunction(name)</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> beginExpr</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.exprPending =</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> endExpr</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> assert</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> this.exprPending</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'endExpr called without previous call to beginExpr'</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var k in this.exprPending</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.put</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> k</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> this.exprPending[k]</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.exprPending = null</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> abortExpr</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.exprPending = null</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> dumpValues</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> TODO if this.verbose</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'Dump context value for debug'</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'JsWizziContext ittf_state ', this.ittf_state</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'JsWizziContext currentMTreeBrickKey ', this.currentMTreeBrickKey</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.brickEvalContext</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'Local values'</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.brickEvalContext.dumpValues</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'Global values'</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.dumpValues</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getDeclaredInfo</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> ret = []</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.ittf_state === ittfStates.globalContext</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'state=global'</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'global declares:' + this.globalContext.getDeclaredInfo()</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> this.ittf_state === ittfStates.nodeContext</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'state=node'</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'state=brick:' + this.currentMTreeBrickKey</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'model declares:' + this.brickEvalContext.getDeclaredInfo()</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'global declares:' + this.globalContext.getDeclaredInfo()</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> ret.join(', ')</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d34">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/t/jsWizziContext/set_context.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The JsWizziRunner is entering a block of statements</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> with instructions for the buildup</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> of the final MTree.</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> set_NodeContext</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.isForInterpolation</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.ittf_state === ittfStates.nodeContext</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> we already are in a nodeContext state</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log '*** =&gt; set_NodeContext'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.ittf_state = ittfStates.nodeContext</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.currentMTreeBrickKey = null</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.brickEvalContext = null</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The JsWizziRunner is entering a block of global statements</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> declared inside an ittf document.</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Example:</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 001     $global var message = 'hello';</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> set_GlobalContext</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> brickKey</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> get_value has scope: global and the current MTreeBrickEvalContext</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> set_value puts value into global</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.isForInterpolation == false && this.currentMTreeBrickKey !== brickKey</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> added 7/8/17</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> Must stay before the call to getMTreeBrickEvalContext</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> to allow debug info about brickKey</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.currentMTreeBrickKey = brickKey</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">checked_call_return_set(</span><span class="pp-arg"> this.brickEvalContext</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.evalHelper.getMTreeBrickEvalContext(brickKey, -1)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> assert(this.brickEvalContext, 'set_MTreeBrickEvalContext brickEvalContext for key ' + brickKey + ' undefined')</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.ittf_state === ittfStates.globalContext</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> we already are in a globalContext state</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log '*** =&gt; set_GlobalContext'</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.ittf_state = ittfStates.globalContext</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> via 7/8/17 set this.currentMTreeBrickKey = null</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> via 7/8/17 set this.brickEvalContext = null</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The JsWizziRunner is entering a block of statements or</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> a node expression that are in the scope of an mTreeBrick.</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> They could be statements declared in a mixed ittf</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> document using the $ IttfCommand:</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 001     $ var message = 'hello';</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> or it could be a node expression that the JsWizziEvalHelper</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> has to interpolate:</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 001     function </span><span class="pp-kwd">${</span><span class="pp-expr">'$'</span><span class="pp-kwd">}</span><span class="pp-pln">{functionName}</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> set_MTreeBrickEvalContext</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> brickKey</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> line</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.isForInterpolation</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.ittf_state = ittfStates.brickEvalContext</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> this.currentMTreeBrickKey === brickKey</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Must stay before the call to getMTreeBrickEvalContext</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> to allow debug info about brickKey</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.currentMTreeBrickKey = brickKey</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">checked_call_return_set(</span><span class="pp-arg"> this.brickEvalContext</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.evalHelper.getMTreeBrickEvalContext(brickKey, line)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> assert(this.brickEvalContext, 'set_MTreeBrickEvalContext brickEvalContext for key ' + brickKey + ' undefined')</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log '*** =&gt; set_MTreeBrickEvalContext', brickKey</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> this.brickEvalContext</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> get_currentMTreeBrickKey</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> this.currentMTreeBrickKey</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d35">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/t/jsWizziEvalHelper/getMTreeBrickEvalContext.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Helper method</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> called by jswizzi.jsWizziContext.set_MTreeBrickEvalContext</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> for retrieving the evaluation context of</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> an mTreeBrick by its brickKey.</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> getMTreeBrickEvalContext</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> brickKey</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> line</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> mTreeBrick eval contexts are stored in the mTreeBrickDatas</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> map of the wizzi-mtree.loader.loadHistory</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBrickData = this.loadHistory.getMTreeBrickData(brickKey)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBrick_EvalContext</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> mTreeBrickData.evalContext != null</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> An eval context object has already been created for this mTreeBrickData</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> mTreeBrick_EvalContext = mTreeBrickData.evalContext</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> notUsed</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this._updateEvalContext</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickData</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrick_EvalContext</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> mTreeBrick_EvalContext = new ContextData(1, brickKey)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'JsWizziEvalHelper created mTreeBrick_EvalContext for', brickKey, 'id', mTreeBrickData.mTreeBrick.id, mTreeBrickData.evalContext, mTreeBrickData.ittfDocumentUri</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBrick_EvalContext.setValue</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '__dirname'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> path.dirname(mTreeBrickData.ittfDocumentUri)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBrick_EvalContext.setValue</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '__filename'</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickData.ittfDocumentUri</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> notUsed</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this._updateEvalContext</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickData</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrick_EvalContext</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> mTreeBrickData.evalContext = mTreeBrick_EvalContext</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> mTreeBrick_EvalContext</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> A refresh could be need for these reasons</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> _updateEvalContext</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> mTreeBrickData</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> mTreeBrick_EvalContext</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> If the mTreeBrick do not receives parameters</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> a refresh of the eval context is not required</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isEmpty(mTreeBrickData.mTreeBrick.$params)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> args = mTreeBrickData.mTreeBrick.$args</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> args && args.indexOf('</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> Mixin call arguments may contain IttfMacros,</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> in that case they must be interpolated.</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> mTreeBrickData.mTreeBrick.$mixerBrickKey is the brickKey of the</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> mixer mTreeBrick. We need its eval context for interpolation.</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> mixer_mTreeBrick_EvalContext</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.getMTreeBrickEvalContext</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickData.mTreeBrick.$mixerBrickKey</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> Then we create a temporary JsWizziContext and load it with the</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> context values of both the global context and the mixer mTreeBrick</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> eval context.</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> JsWizziContext == null</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> JsWizziContext = require('./jsWizziContext')</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> interpolateArgsContext = new JsWizziContext()</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> interpolateArgsContext.setValues(this.jsWizziContext.globalContext.getSettableValues())</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> interpolateArgsContext.setValues(mixer_mTreeBrick_EvalContext.getValues())</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> TODO the values of the mixer can be modified by the mixed during interpolation</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> if so, what does it means? Needs investigation.</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> then we interpolate the arguments passed to the mixed mTree brick</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> args = interpolate(args, interpolateArgsContext)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'JsWizziEvalHelper interpolateArgs', mTreeBrickData.mTreeBrick.$args, args</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mixerMTreeBrickData = this.loadHistory.getMTreeBrickData(mTreeBrickData.mTreeBrick.$mixerBrickKey)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mixerUri = mixerMTreeBrickData ? mixerMTreeBrickData.ittfDocumentUri : 'root model';</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> exMessage = ex ? ex.message : 'not available'</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> exStack = ex ? ex.stack : 'not available'</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InterpolationError'</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> '_updateEvalContext'</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Exception interpolating mixer args: ' + args + ', mTreeBrick uri: ' + mTreeBrickData.ittfDocumentUri + ', mixerMTreeBrick uri: ' + mixerUri + ', ex message: ' + exMessage + ', stack: ' + exStack</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ex</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> With the interpolated values of the arguments we may now calculate the</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> parameters received  by the mixed mTreeBrick, applying type conversions and default values</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> calculatedParamValues</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBrickData.mTreeBrick.calcParamValues</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> args</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> We have to load the calculated parameters on the eval context</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> of the mixed mTreeBrick brick</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in calculatedParamValues</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> item.isByRef</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> The argument is passed by reference, so the parameter</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> value must be retrieved from the eval context of the mixer mTreeBrick</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> and then added to the mixed one.</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> mixer_mTreeBrick_EvalContext</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.getMTreeBrickEvalContext</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickData.mTreeBrick.$mixerBrickKey</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBrick_EvalContext.setValue</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item.name</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mixer_mTreeBrick_EvalContext.getValue(item.name)</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> VIA set mTreeBrickData.byRefParams = (mTreeBrickData.byRefParams || [])</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> VIA _ mTreeBrickData.byRefParams.push</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> VIA     @ item.name</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> The argument is passed by value, so the calculated</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> parameter can be added to the eval context of the mixed mTreeBrick</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBrick_EvalContext.setValue</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item.name</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item.value</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d36">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/t/jsWizziRunner/expressions.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> UnaryExpression</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> exp</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.operator === 'typeof'</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> exp</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.argument</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> exp && exp.__is_error</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree-jsWizziRunner.__is_error CallExpression argument', exp</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> exp.name === 'JsWizziError-ReferenceError'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> exp = undefined</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> exp</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> exp</span><span class="pp-pln">,</span><span class="pp-arg">  UnaryExpression</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.argument</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.prefix</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> node.operator === '!'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> !exp</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '-'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> -exp</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '+'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> exp</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '~'</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> ~exp</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === 'typeof'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> typeof exp</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Unmanaged unary operator ' + node.operator + ' (prefix: true)'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node.operator</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'UnaryExpression'</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> node.operator === '!'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> !exp</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Unmanaged unary operator ' + node.operator + ' (prefix: false)'</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node.operator</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'UnaryExpression'</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> BinaryExpression</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> l</span><span class="pp-pln">,</span><span class="pp-arg">  BinaryExpression l</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.left</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> r</span><span class="pp-pln">,</span><span class="pp-arg">  BinaryExpressior</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.right</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> log</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'BinaryExpression.l,r'</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> l</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> r</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.operator === '+'</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> (l + r)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '-'</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> (l - r)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '*'</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l * r</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '/'</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l / r</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '%'</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l % r</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '=='</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l == r</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '==='</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l === r</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '!='</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l != r</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '!=='</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l !== r</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '&gt;='</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l &gt;= r</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '&gt;'</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l &gt; r</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '&lt;='</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l &lt;= r</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '&lt;'</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l &lt; r</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '&lt;&lt;'</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l &lt;&lt; r</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '&gt;&gt;'</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l &gt;&gt; r</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '&gt;&gt;&gt;'</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l &gt;&gt;&gt; r</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '|'</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l | r</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '&'</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l & r</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '^'</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l ^ r</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === 'in'</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l in r</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === 'instanceof'</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l instanceof r</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Unmanaged binary operator ' + node.operator</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.operator</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'BinaryExpression'</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> UpdateExpression</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> v</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> exp</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> exp</span><span class="pp-pln">,</span><span class="pp-arg">  UpdateExpression</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.argument</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.operator === '++'</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = exp + 1</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '--'</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = exp - 1</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Unmanaged update expression ' + node.operator</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.operator</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'UpdateExpression'</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.put</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> node.argument.name</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> v</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> node.prefix ? v : exp</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> LogicalExpression</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> l</span><span class="pp-pln">,</span><span class="pp-arg">  LogicalExpression l</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.left</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.operator === '&&' && (l === false || l === null)</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> r</span><span class="pp-pln">,</span><span class="pp-arg">  LogicalExpression r</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.right</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> log</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'LogicalExpression.l,r'</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> l</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> r</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.operator === '&&'</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l && r</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '||'</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> l || r</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Unmanaged logical expression ' + node.operator</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.operator</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'LogicalExpression'</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> ConditionalExpression</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> test</span><span class="pp-pln">,</span><span class="pp-arg">  ConditionalExpression</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.test, ctx)</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> test</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> value</span><span class="pp-pln">,</span><span class="pp-arg">  ConditionalExpression node.consequent</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.consequent</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> value</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> value</span><span class="pp-pln">,</span><span class="pp-arg">  ConditionalExpression node.alternate</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.alternate</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> value</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> CallExpression</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> value</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> args</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> property</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'CallExpression.node.callee', node.callee</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.callee.type === 'MemberExpression'</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.arguments</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> value</span><span class="pp-pln">,</span><span class="pp-arg">  CallExpression argument</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> runner(item, ctx)</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> args.push(value)</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> obj</span><span class="pp-pln">,</span><span class="pp-arg">  CallExpression node.callee.object</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.callee.object</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !obj</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'The value of callee must be an object. It is "' + getTypeDescription(obj) + '" : ' + obj + '.'</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node.callee.object</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'CallExpression'</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> node.callee.computed</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> property</span><span class="pp-pln">,</span><span class="pp-arg">  CallExpression node.callee.property</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node.callee.property</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> property = node.callee.property.name</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !obj[property]</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Missing object property.'</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node.callee.property</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'CallExpression'</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isFunction(obj[property])</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">                </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> value = obj[property].apply(obj, args)</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> value && value.__is_error</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> currentModelInfo = ctx.get_currentMTreeBrickInfo()</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-mtree.jswizzi.jsWizziRunner.CallExpression. Error calling ' + property + ', on statement: ' + escodegen.generate(node)</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> value.message += ' (' + 'error calling ' + property + ', on statement: ' + escodegen.generate(node) + ', currentModel_uri: ' + currentModelInfo.currentModel_uri + ', currentModel_mixerUri: ' + currentModelInfo.currentModel_mixerUri + ')'</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> value</span></div><div class="L8"><span class="pp-ln"> 228 </span><span class="pp-pln">                </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L9"><span class="pp-ln"> 229 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 230 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L1"><span class="pp-ln"> 231 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L2"><span class="pp-ln"> 232 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Exception calling function: ' + (ex ? ex.message : 'exception message unavailable')</span></div><div class="L3"><span class="pp-ln"> 233 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> node.callee.property</span></div><div class="L4"><span class="pp-ln"> 234 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L5"><span class="pp-ln"> 235 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'CallExpression'</span></div><div class="L6"><span class="pp-ln"> 236 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ex</span></div><div class="L7"><span class="pp-ln"> 237 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 238 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 239 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L0"><span class="pp-ln"> 240 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L1"><span class="pp-ln"> 241 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'property: "' + property + '" is not a function'</span></div><div class="L2"><span class="pp-ln"> 242 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node.callee.property</span></div><div class="L3"><span class="pp-ln"> 243 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L4"><span class="pp-ln"> 244 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'CallExpression'</span></div><div class="L5"><span class="pp-ln"> 245 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.callee.type === 'Identifier'</span></div><div class="L6"><span class="pp-ln"> 246 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> f</span></div><div class="L7"><span class="pp-ln"> 247 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.getFunction</span></div><div class="L8"><span class="pp-ln"> 248 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.callee.name</span></div><div class="L9"><span class="pp-ln"> 249 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'CallExpression.node.callee.name', node.callee.name, f</span></div><div class="L0"><span class="pp-ln"> 250 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> f == null</span></div><div class="L1"><span class="pp-ln"> 251 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> f = ctx.getValue(node.callee.name)</span></div><div class="L2"><span class="pp-ln"> 252 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> f != null && verify.isFunction(f)</span></div><div class="L3"><span class="pp-ln"> 253 </span><span class="pp-pln">                    </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.arguments</span></div><div class="L4"><span class="pp-ln"> 254 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> value</span><span class="pp-pln">,</span><span class="pp-arg">  CallExpression argument</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 255 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> value = runner(item, ctx)</span></div><div class="L6"><span class="pp-ln"> 256 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> args.push(value)</span></div><div class="L7"><span class="pp-ln"> 257 </span><span class="pp-pln">                    </span><span class="pp-tag">try</span></div><div class="L8"><span class="pp-ln"> 258 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> f.apply(null, args)</span></div><div class="L9"><span class="pp-ln"> 259 </span><span class="pp-pln">                    </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L0"><span class="pp-ln"> 260 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln"> 261 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L2"><span class="pp-ln"> 262 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln"> 263 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Exception calling function: ' + (ex ? ex.message : 'exception message unavailable')</span></div><div class="L4"><span class="pp-ln"> 264 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> node.callee.name</span></div><div class="L5"><span class="pp-ln"> 265 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L6"><span class="pp-ln"> 266 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'CallExpression'</span></div><div class="L7"><span class="pp-ln"> 267 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> ex</span></div><div class="L8"><span class="pp-ln"> 268 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 269 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 270 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L1"><span class="pp-ln"> 271 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L2"><span class="pp-ln"> 272 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ('Function undeclared ' + node.callee.name)</span></div><div class="L3"><span class="pp-ln"> 273 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> node.callee</span></div><div class="L4"><span class="pp-ln"> 274 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L5"><span class="pp-ln"> 275 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'CallExpression'</span></div><div class="L6"><span class="pp-ln"> 276 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.jswizzi.runner.expressions.CallExpression.jsWizziFunction', f.params</span></div><div class="L7"><span class="pp-ln"> 277 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> f.params.length !== node.arguments.length</span></div><div class="L8"><span class="pp-ln"> 278 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 279 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L0"><span class="pp-ln"> 280 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L1"><span class="pp-ln"> 281 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'A jsWizziFunction call must have the same number of arguments of the callee. Found: ' + f.params.length + ' and ' + node.arguments.length</span></div><div class="L2"><span class="pp-ln"> 282 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L3"><span class="pp-ln"> 283 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L4"><span class="pp-ln"> 284 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'CallExpression'</span></div><div class="L5"><span class="pp-ln"> 285 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> _ ctx.elapsedTime('wizzi-mtree.jsWizziRunner.Call function ' + node.callee.name + ' start')</span></div><div class="L6"><span class="pp-ln"> 286 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.beginLoadingCallArguments();</span></div><div class="L7"><span class="pp-ln"> 287 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.arguments</span></div><div class="L8"><span class="pp-ln"> 288 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> value</span><span class="pp-pln">,</span><span class="pp-arg">  CallExpression argument</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 289 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> value = runner(item, ctx)</span></div><div class="L0"><span class="pp-ln"> 290 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.jswizzi.runner.expressions.CallExpression.value', value</span></div><div class="L1"><span class="pp-ln"> 291 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> args.push(value)</span></div><div class="L2"><span class="pp-ln"> 292 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.endLoadingCallArguments();</span></div><div class="L3"><span class="pp-ln"> 293 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> result = runnerCall(f, ctx, args)</span></div><div class="L4"><span class="pp-ln"> 294 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> _ ctx.elapsedTime('wizzi-mtree.jsWizziRunner.Call function ' + node.callee.name + ' end')</span></div><div class="L5"><span class="pp-ln"> 295 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> result</span></div><div class="L6"><span class="pp-ln"> 296 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.callee.type === 'FunctionExpression'</span></div><div class="L7"><span class="pp-ln"> 297 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'FunctionExpression', node.callee, true</span></div><div class="L8"><span class="pp-ln"> 298 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> f = node.callee</span></div><div class="L9"><span class="pp-ln"> 299 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> f.params.length !== node.arguments.length</span></div><div class="L0"><span class="pp-ln"> 300 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln"> 301 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L2"><span class="pp-ln"> 302 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln"> 303 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'A jsWizziFunction call must have the same number of arguments of the callee. Found: ' + f.params.length + ' and ' + node.arguments.length</span></div><div class="L4"><span class="pp-ln"> 304 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L5"><span class="pp-ln"> 305 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L6"><span class="pp-ln"> 306 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'CallExpression'</span></div><div class="L7"><span class="pp-ln"> 307 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.beginLoadingCallArguments();</span></div><div class="L8"><span class="pp-ln"> 308 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.arguments</span></div><div class="L9"><span class="pp-ln"> 309 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> value</span><span class="pp-pln">,</span><span class="pp-arg">  CallExpression argument</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 310 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> runner(item, ctx)</span></div><div class="L1"><span class="pp-ln"> 311 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> args.push(value)</span></div><div class="L2"><span class="pp-ln"> 312 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.endLoadingCallArguments();</span></div><div class="L3"><span class="pp-ln"> 313 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> f.type = 'FunctionDeclaration'</span></div><div class="L4"><span class="pp-ln"> 314 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> runnerCall(f, ctx, args)</span></div><div class="L5"><span class="pp-ln"> 315 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln"> 316 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L7"><span class="pp-ln"> 317 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L8"><span class="pp-ln"> 318 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Not implemented. CallExpression.node.callee.type: "' + node.callee.type + '"'</span></div><div class="L9"><span class="pp-ln"> 319 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L0"><span class="pp-ln"> 320 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L1"><span class="pp-ln"> 321 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'CallExpression'</span></div><div class="L2"><span class="pp-ln"> 322 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> MemberExpression</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 323 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> obj</span><span class="pp-pln">,</span><span class="pp-arg">  MemberExpression</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 324 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L5"><span class="pp-ln"> 325 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.object</span></div><div class="L6"><span class="pp-ln"> 326 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L7"><span class="pp-ln"> 327 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> !obj</span></div><div class="L8"><span class="pp-ln"> 328 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 329 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L0"><span class="pp-ln"> 330 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L1"><span class="pp-ln"> 331 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'The value must be an object. It is "' + getTypeDescription(obj) + '".'</span></div><div class="L2"><span class="pp-ln"> 332 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.object</span></div><div class="L3"><span class="pp-ln"> 333 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L4"><span class="pp-ln"> 334 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'MemberExpression'</span></div><div class="L5"><span class="pp-ln"> 335 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.computed</span></div><div class="L6"><span class="pp-ln"> 336 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> property</span><span class="pp-pln">,</span><span class="pp-arg">  MemberExpression node.property</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 337 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L8"><span class="pp-ln"> 338 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.property</span></div><div class="L9"><span class="pp-ln"> 339 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L0"><span class="pp-ln"> 340 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> obj[property]</span></div><div class="L1"><span class="pp-ln"> 341 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 342 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> property = node.property.name</span></div><div class="L3"><span class="pp-ln"> 343 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> obj[property]</span></div><div class="L4"><span class="pp-ln"> 344 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> MemberExpression_Set</span><span class="pp-pln">,</span><span class="pp-arg">  data</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 345 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> obj</span><span class="pp-pln">,</span><span class="pp-arg">  MemberExpression_Set</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 346 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L7"><span class="pp-ln"> 347 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.object</span></div><div class="L8"><span class="pp-ln"> 348 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L9"><span class="pp-ln"> 349 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> !obj</span></div><div class="L0"><span class="pp-ln"> 350 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln"> 351 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L2"><span class="pp-ln"> 352 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln"> 353 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'The value must be an object. It is "' + getTypeDescription(obj) + '".'</span></div><div class="L4"><span class="pp-ln"> 354 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.object</span></div><div class="L5"><span class="pp-ln"> 355 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L6"><span class="pp-ln"> 356 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'MemberExpression_Set'</span></div><div class="L7"><span class="pp-ln"> 357 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.computed</span></div><div class="L8"><span class="pp-ln"> 358 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> property</span><span class="pp-pln">,</span><span class="pp-arg">  MemberExpression_Set node.property</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 359 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L0"><span class="pp-ln"> 360 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.property</span></div><div class="L1"><span class="pp-ln"> 361 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L2"><span class="pp-ln"> 362 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> obj[property] = data</span></div><div class="L3"><span class="pp-ln"> 363 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln"> 364 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> property = node.property.name</span></div><div class="L5"><span class="pp-ln"> 365 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> obj[property] = data</span></div><div class="L6"><span class="pp-ln"> 366 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> AssignmentExpression</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 367 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> l</span><span class="pp-pln">,</span><span class="pp-arg">  AssignmentExpression l</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 368 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L9"><span class="pp-ln"> 369 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.left</span></div><div class="L0"><span class="pp-ln"> 370 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L1"><span class="pp-ln"> 371 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> r</span><span class="pp-pln">,</span><span class="pp-arg">  AssignmentExpression r</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 372 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L3"><span class="pp-ln"> 373 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.right</span></div><div class="L4"><span class="pp-ln"> 374 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L5"><span class="pp-ln"> 375 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> v</span></div><div class="L6"><span class="pp-ln"> 376 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.operator === '='</span></div><div class="L7"><span class="pp-ln"> 377 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = l = r</span></div><div class="L8"><span class="pp-ln"> 378 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '*='</span></div><div class="L9"><span class="pp-ln"> 379 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = l *= r</span></div><div class="L0"><span class="pp-ln"> 380 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '/='</span></div><div class="L1"><span class="pp-ln"> 381 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = l /= r</span></div><div class="L2"><span class="pp-ln"> 382 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '%='</span></div><div class="L3"><span class="pp-ln"> 383 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = l %= r</span></div><div class="L4"><span class="pp-ln"> 384 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '+='</span></div><div class="L5"><span class="pp-ln"> 385 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = l += r</span></div><div class="L6"><span class="pp-ln"> 386 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '-='</span></div><div class="L7"><span class="pp-ln"> 387 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = l -= r</span></div><div class="L8"><span class="pp-ln"> 388 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '&lt;&lt;='</span></div><div class="L9"><span class="pp-ln"> 389 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = l &lt;&lt;= r</span></div><div class="L0"><span class="pp-ln"> 390 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '&gt;&gt;='</span></div><div class="L1"><span class="pp-ln"> 391 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = l &gt;&gt;= r</span></div><div class="L2"><span class="pp-ln"> 392 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '&gt;&gt;&gt;='</span></div><div class="L3"><span class="pp-ln"> 393 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = l &gt;&gt;&gt;= r</span></div><div class="L4"><span class="pp-ln"> 394 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '&='</span></div><div class="L5"><span class="pp-ln"> 395 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = l &= r</span></div><div class="L6"><span class="pp-ln"> 396 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '^='</span></div><div class="L7"><span class="pp-ln"> 397 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = l ^= r</span></div><div class="L8"><span class="pp-ln"> 398 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> node.operator === '|='</span></div><div class="L9"><span class="pp-ln"> 399 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> v = l |= r</span></div><div class="L0"><span class="pp-ln"> 400 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 401 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 402 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L3"><span class="pp-ln"> 403 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L4"><span class="pp-ln"> 404 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Unmanaged expression operator ' + node.operator</span></div><div class="L5"><span class="pp-ln"> 405 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.operator</span></div><div class="L6"><span class="pp-ln"> 406 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L7"><span class="pp-ln"> 407 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'AssignmentExpression'</span></div><div class="L8"><span class="pp-ln"> 408 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  AssignmentExpression node.left</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 409 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runnerSet</span></div><div class="L0"><span class="pp-ln"> 410 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.left</span></div><div class="L1"><span class="pp-ln"> 411 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L2"><span class="pp-ln"> 412 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> v</span></div><div class="L3"><span class="pp-ln"> 413 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> v</span></div><div class="L4"><span class="pp-ln"> 414 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> ArrayExpression</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 415 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L6"><span class="pp-ln"> 416 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> ret</span></div><div class="L7"><span class="pp-ln"> 417 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L8"><span class="pp-ln"> 418 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> value</span></div><div class="L9"><span class="pp-ln"> 419 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> element in node.elements</span></div><div class="L0"><span class="pp-ln"> 420 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> value</span><span class="pp-pln">,</span><span class="pp-arg">  ArrayExpression</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 421 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(element, ctx)</span></div><div class="L2"><span class="pp-ln"> 422 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push(value)</span></div><div class="L3"><span class="pp-ln"> 423 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div><div class="L4"><span class="pp-ln"> 424 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> ObjectExpression</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 425 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.properties.length == 0</span></div><div class="L6"><span class="pp-ln"> 426 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln"> 427 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln"> 428 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L9"><span class="pp-ln"> 429 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> ret</span></div><div class="L0"><span class="pp-ln"> 430 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln"> 431 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> prop</span></div><div class="L2"><span class="pp-ln"> 432 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> property in node.properties</span></div><div class="L3"><span class="pp-ln"> 433 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> prop</span><span class="pp-pln">,</span><span class="pp-arg">  ObjectExpression</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 434 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(property, ctx)</span></div><div class="L5"><span class="pp-ln"> 435 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ret[prop.key] = prop.value</span></div><div class="L6"><span class="pp-ln"> 436 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div><div class="L7"><span class="pp-ln"> 437 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> Property</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 438 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> key = node.key.name</span></div><div class="L9"><span class="pp-ln"> 439 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> value</span><span class="pp-pln">,</span><span class="pp-arg">  Property</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 440 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L1"><span class="pp-ln"> 441 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.value</span></div><div class="L2"><span class="pp-ln"> 442 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln"> 443 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 444 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln"> 445 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> key key</span></div><div class="L6"><span class="pp-ln"> 446 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> value value</span></div><div class="L7"><span class="pp-ln"> 447 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> NewExpression</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 448 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'NewExpression.node', node</span></div><div class="L9"><span class="pp-ln"> 449 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.callee.type === 'Identifier'</span></div><div class="L0"><span class="pp-ln"> 450 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> l = node.arguments.length</span></div><div class="L1"><span class="pp-ln"> 451 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> args = []</span></div><div class="L2"><span class="pp-ln"> 452 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.arguments</span></div><div class="L3"><span class="pp-ln"> 453 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> value</span><span class="pp-pln">,</span><span class="pp-arg">  NewExpression argument</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 454 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> runner(item, ctx)</span></div><div class="L5"><span class="pp-ln"> 455 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> args.push(value)</span></div><div class="L6"><span class="pp-ln"> 456 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'NewExpression.args', args</span></div><div class="L7"><span class="pp-ln"> 457 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> node.callee.name === 'String' && l === 0</span></div><div class="L8"><span class="pp-ln"> 458 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new String()</span></div><div class="L9"><span class="pp-ln"> 459 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'String' && l === 1</span></div><div class="L0"><span class="pp-ln"> 460 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new String(args[0])</span></div><div class="L1"><span class="pp-ln"> 461 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Number' && l === 0</span></div><div class="L2"><span class="pp-ln"> 462 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Number()</span></div><div class="L3"><span class="pp-ln"> 463 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Number' && l === 1</span></div><div class="L4"><span class="pp-ln"> 464 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Number(args[0])</span></div><div class="L5"><span class="pp-ln"> 465 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Date' && l === 0</span></div><div class="L6"><span class="pp-ln"> 466 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Date()</span></div><div class="L7"><span class="pp-ln"> 467 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Date' && l === 1</span></div><div class="L8"><span class="pp-ln"> 468 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Date(args[0])</span></div><div class="L9"><span class="pp-ln"> 469 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Date' && l === 2</span></div><div class="L0"><span class="pp-ln"> 470 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Date(args[0],args[1])</span></div><div class="L1"><span class="pp-ln"> 471 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Date' && l === 3</span></div><div class="L2"><span class="pp-ln"> 472 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Date(args[0],args[1], args[2])</span></div><div class="L3"><span class="pp-ln"> 473 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Date' && l === 4</span></div><div class="L4"><span class="pp-ln"> 474 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Date(args[0],args[1], args[2], args[3])</span></div><div class="L5"><span class="pp-ln"> 475 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Date' && l === 5</span></div><div class="L6"><span class="pp-ln"> 476 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Date(args[0],args[1], args[2], args[3], args[4])</span></div><div class="L7"><span class="pp-ln"> 477 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Date' && l === 6</span></div><div class="L8"><span class="pp-ln"> 478 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Date(args[0],args[1], args[2], args[3], args[4], args[5])</span></div><div class="L9"><span class="pp-ln"> 479 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'RegExp' && l === 1</span></div><div class="L0"><span class="pp-ln"> 480 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new RegExp(args[0])</span></div><div class="L1"><span class="pp-ln"> 481 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Array' && l === 0</span></div><div class="L2"><span class="pp-ln"> 482 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Array()</span></div><div class="L3"><span class="pp-ln"> 483 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Array' && l === 1</span></div><div class="L4"><span class="pp-ln"> 484 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Array(args[0])</span></div><div class="L5"><span class="pp-ln"> 485 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Object' && l === 0</span></div><div class="L6"><span class="pp-ln"> 486 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Object()</span></div><div class="L7"><span class="pp-ln"> 487 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Object' && l === 1</span></div><div class="L8"><span class="pp-ln"> 488 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Object(args[0])</span></div><div class="L9"><span class="pp-ln"> 489 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Map' && l === 0</span></div><div class="L0"><span class="pp-ln"> 490 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Map()</span></div><div class="L1"><span class="pp-ln"> 491 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Map' && l === 1</span></div><div class="L2"><span class="pp-ln"> 492 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Map(args[0])</span></div><div class="L3"><span class="pp-ln"> 493 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Set' && l === 0</span></div><div class="L4"><span class="pp-ln"> 494 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Set()</span></div><div class="L5"><span class="pp-ln"> 495 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'Set' && l === 1</span></div><div class="L6"><span class="pp-ln"> 496 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new Set(args[0])</span></div><div class="L7"><span class="pp-ln"> 497 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'RegExp' && l === 1</span></div><div class="L8"><span class="pp-ln"> 498 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new RegExp(args[0])</span></div><div class="L9"><span class="pp-ln"> 499 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.callee.name === 'RegExp' && l === 2</span></div><div class="L0"><span class="pp-ln"> 500 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> new RegExp(args[0], args[1])</span></div><div class="L1"><span class="pp-ln"> 501 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 502 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln"> 503 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L4"><span class="pp-ln"> 504 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L5"><span class="pp-ln"> 505 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ('Builtin object (or number of arguments) not managed ' + node.callee.name + ', num arguments ' + l)</span></div><div class="L6"><span class="pp-ln"> 506 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node.callee</span></div><div class="L7"><span class="pp-ln"> 507 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L8"><span class="pp-ln"> 508 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'NewExpression'</span></div><div class="L9"><span class="pp-ln"> 509 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 510 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L1"><span class="pp-ln"> 511 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L2"><span class="pp-ln"> 512 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Not implemented. NewExpression.node.callee.type: "' + node.callee.type + '"'</span></div><div class="L3"><span class="pp-ln"> 513 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L4"><span class="pp-ln"> 514 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L5"><span class="pp-ln"> 515 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'NewExpression'</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d37">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/t/jsWizziRunner/for.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> ForStatement</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> test</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> state</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> savedCurrentBrickKey</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> iterCheck = 0</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> savedCurrentBrickKey = ctx.get_currentMTreeBrickKey()</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  ForStatement node.init</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.init</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  ForStatement set_MTreeBrickEvalContext</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.set_MTreeBrickEvalContext(savedCurrentBrickKey)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> test</span><span class="pp-pln">,</span><span class="pp-arg">  ForStatement node.test</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.test, ctx)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">while</span><span class="pp-pln"> test</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> iterCheck &gt; MAX_ITERATIONS</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> state</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> iterCheck++</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> state</span><span class="pp-pln">,</span><span class="pp-arg">  ForStatement node.body</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.body, ctx)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> state.result</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> state</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> state.break</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">break</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  ForStatement set_MTreeBrickEvalContext</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.set_MTreeBrickEvalContext(savedCurrentBrickKey)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  ForStatement node.update</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.update</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  ForStatement set_MTreeBrickEvalContext</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.set_MTreeBrickEvalContext(savedCurrentBrickKey)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> test</span><span class="pp-pln">,</span><span class="pp-arg">  ForStatement node.test</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.test, ctx)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> ForInStatement</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> test</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> state</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> savedCurrentBrickKey</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> savedCurrentBrickKey = ctx.get_currentMTreeBrickKey()</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> obj</span><span class="pp-pln">,</span><span class="pp-arg">  ForInStatement node.right</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.right</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> _.isObject(obj) == false</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'The value must be an object. It is "' + getTypeDescription(obj) + '".'</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.right</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'ForInStatement'</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  ForInStatement set_MTreeBrickEvalContext</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.set_MTreeBrickEvalContext(savedCurrentBrickKey)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> left = node.left.name</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.declare(left)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> k in obj</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.put(left, k)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> state</span><span class="pp-pln">,</span><span class="pp-arg">  ForInStatement node.body</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.body, ctx)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> state.result</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> state</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> state.break</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">break</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  ForInStatement set_MTreeBrickEvalContext</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.set_MTreeBrickEvalContext(savedCurrentBrickKey)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.undeclare(left)</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> BreakStatement</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> break true</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> ContinueStatement</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> continue true</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d38">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/t/jsWizziRunner/functions.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> FunctionCall</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> objbase</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> value</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.jswizzi.runner.functions.FunctionCall'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.name.base</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> objbase</span><span class="pp-pln">,</span><span class="pp-arg">  FunctionCall node.name.base</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.name.base</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> objbase = ctx.values</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> _.isObject(objbase) == false</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'The value must be an object. It is "' + getTypeDescription(obj) + '".'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.name.base</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'FunctionCall'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> args</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> Object.prototype.toString.call(node.arguments) == '[object Array]'</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.arguments</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.jswizzi.runner.functions.FunctionCall.item', item</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d40">checked_run_set(</span><span class="pp-arg"> value</span><span class="pp-pln">,</span><span class="pp-arg">  FunctionCall item</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> runner(item, ctx)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.jswizzi.runner.functions.FunctionCall.value', value</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> args.push(value)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> f = objbase[node.name.name]</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> !f</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Missing function.'</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.name.base</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'FunctionCall'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isFunction(f)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> v = objbase[node.name.name].apply(objbase, args)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> v</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> (ex ? ex.message : 'Error calling function')</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node.callee.property</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'CallExpression'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ex</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> FunctionDeclaration</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.declareFunction</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> node.id.name</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> FunctionDeclaration_Call</span><span class="pp-pln">,</span><span class="pp-arg">  data</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.jswizzi.runner.functions.FunctionDeclaration_Call'</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> save_brick_key = ctx.get_currentMTreeBrickKey()</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> ctx = ctx.push()</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; node.params.length; i++</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.jswizzi.runner.functions.FunctionDeclaration_Call.param', node.params[i].name</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> data.length &gt; i</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.jswizzi.runner.functions.FunctionDeclaration_Call.value', data[i]</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.declareCallParam</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.params[i].name</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> data[i]</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> state</span><span class="pp-pln">,</span><span class="pp-arg">  FunctionCall node.body</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.body</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.set_MTreeBrickEvalContext(save_brick_key, 0)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.pop()</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> state.value</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d39">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/t/jsWizziRunner/statements.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">runner(</span><span class="pp-arg"> EmptyStatement</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">runner(</span><span class="pp-arg"> ExpressionStatement</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 1/8/2017 _ ctx.beginExpr()</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> state</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.expression</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> state && state.__is_error</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> _ ctx.abortExpr()</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> state</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> _ ctx.endExpr()</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">runner(</span><span class="pp-arg"> IfStatement</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> ret</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> savedCurrentBrickKey</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">checked_run(</span><span class="pp-arg"> test</span><span class="pp-pln">,</span><span class="pp-arg">  IfStatement</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.test, ctx)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> test</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> savedCurrentBrickKey = ctx.get_currentMTreeBrickKey()</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">checked_run_set(</span><span class="pp-arg"> ret</span><span class="pp-pln">,</span><span class="pp-arg">  IfStatement node.consequent</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.consequent, ctx)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  IfStatement set_MTreeBrickEvalContext</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.set_MTreeBrickEvalContext(savedCurrentBrickKey)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> node.alternate</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> savedCurrentBrickKey = ctx.get_currentMTreeBrickKey()</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">checked_run_set(</span><span class="pp-arg"> ret</span><span class="pp-pln">,</span><span class="pp-arg">  IfStatement node.alternate</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.alternate, ctx)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  IfStatement set_MTreeBrickEvalContext</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.set_MTreeBrickEvalContext(savedCurrentBrickKey)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">runner(</span><span class="pp-arg"> BlockStatement</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> state</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; node.body.length; i++</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> statement = node.body[i]</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">checked_run_set(</span><span class="pp-arg"> state</span><span class="pp-pln">,</span><span class="pp-arg">  BlockStatement</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(statement, ctx)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> state.result || state.break || state.continue</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> state</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">runner(</span><span class="pp-arg"> WhileStatement</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> state</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> savedCurrentBrickKey</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> iterCheck = 0</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">checked_run(</span><span class="pp-arg"> test</span><span class="pp-pln">,</span><span class="pp-arg">  WhileStatement node.test</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.test, ctx)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">while</span><span class="pp-pln"> test</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> iterCheck &gt; MAX_ITERATIONS</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> state</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> iterCheck++</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> savedCurrentBrickKey = ctx.get_currentMTreeBrickKey()</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">checked_run_set(</span><span class="pp-arg"> state</span><span class="pp-pln">,</span><span class="pp-arg">  WhileStatement node.body</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.body, ctx)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> state.result</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> state</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> state.break</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">break</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  set_MTreeBrickEvalContext</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.set_MTreeBrickEvalContext(savedCurrentBrickKey)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">checked_run_set(</span><span class="pp-arg"> test</span><span class="pp-pln">,</span><span class="pp-arg">  WhileStatement node.test</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.test, ctx)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">runner(</span><span class="pp-arg"> DoWhileStatement</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> test</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> state</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> savedCurrentBrickKey</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> iterCheck = 0</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> savedCurrentBrickKey = ctx.get_currentMTreeBrickKey()</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">checked_run_set(</span><span class="pp-arg"> state</span><span class="pp-pln">,</span><span class="pp-arg">  DoWhileStatement node.body</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.body, ctx)</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  DoWhileStatement set_MTreeBrickEvalContext</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.set_MTreeBrickEvalContext(savedCurrentBrickKey)</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a">checked_run_set(</span><span class="pp-arg"> test</span><span class="pp-pln">,</span><span class="pp-arg">  DoWhileStatement node.test</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.test, ctx)</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">        </span><span class="pp-tag">while</span><span class="pp-pln"> test</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> iterCheck++</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> iterCheck &gt; MAX_ITERATIONS</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> state</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">checked_run_set(</span><span class="pp-arg"> state</span><span class="pp-pln">,</span><span class="pp-arg">  DoWhileStatement node.body</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.body, ctx)</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> state.result</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> state</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> state.break</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-tag">break</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">checked_run(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  DoWhileStatement set_MTreeBrickEvalContext</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.set_MTreeBrickEvalContext(savedCurrentBrickKey)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">checked_run_set(</span><span class="pp-arg"> test</span><span class="pp-pln">,</span><span class="pp-arg">  DoWhileStatement node.test</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(node.test, ctx)</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a">runner(</span><span class="pp-arg"> ReturnStatement</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.argument</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">checked_run(</span><span class="pp-arg"> value</span><span class="pp-pln">,</span><span class="pp-arg">  ReturnStatement</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.argument</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result true</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> value value</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> result true</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d40">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/t/checked_run_set.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> varName, message|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln"> && </span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">.__is_error</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log '__is_error </span><span class="pp-kwd">${</span><span class="pp-expr">message</span><span class="pp-kwd">}</span><span class="pp-pln">', </span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d41">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/t/checked_run.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> varName, message|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln"> && </span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">.__is_error</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log '__is_error </span><span class="pp-kwd">${</span><span class="pp-expr">message</span><span class="pp-kwd">}</span><span class="pp-pln">', </span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d42">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/t/runner.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, arg1|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> runner.</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg1 != null</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg1</span><span class="pp-kwd">}</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> log('</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">.node', node)</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d43">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/contextData.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.jswizzi.ContextData</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('./errors')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> f_verify = require('./functions/verify')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> ContextData</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> kind</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> brickKey</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.kind = kind</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.brickKey = brickKey</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.clear</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> clear</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.$freezed = false</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.functions</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.values</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.declares</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.functionsStack</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.valuesStack</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.declaresStack</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.builtInFunctions</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.builtInObjects</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> $freeze</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.$freezed = true</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> declare</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> init</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> name == '$' && this.$freezed</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> new errors.InvalidVariableNameError('The variable "$" cannot be declared on the global context after it has been freezed.')</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.declares[name] = true</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (init) !== 'undefined'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.values[name] = init</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> TODO debug only</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> f_verify.isObject(init) == false</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'ContextData declare', name, init, 'kind', this.kind, this.brickKey</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> undeclare</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.declares[name] == true</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">delete</span><span class="pp-pln"> this.declares[name]</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.values[name] == true</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">delete</span><span class="pp-pln"> this.values[name]</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> isDeclared</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.contextData.isDeclared', name, this.declares[name]</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.declares[name] == true</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> this.declaresStack.length &gt; 0</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">backeach</span><span class="pp-pln"> item in this.declaresStack</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> item[name] == true</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> setValue</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> name == '$' && this.$freezed</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> new errors.InvalidVariableNameError('The variable "$" cannot be set on the global context after it has been freezed.')</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.declare(name, value)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> TODO debug only</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> f_verify.isObject(value) == false</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'ContextData setValue', name, value, 'kind', this.kind, this.brickKey</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> setValues</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> values</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> values = (values || {})</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var k in values</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.declare</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> k</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> values[k]</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Set value only if name is declared</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> put</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.declares[name] === true</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.values[name] = value</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getValue</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.declares[name] == true</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.contextData.getValue found for', name, this.kind, this.brickKey</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.values[name]</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> this.declaresStack.length &gt; 0</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                </span><span class="pp-tag">backeach</span><span class="pp-pln"> item in this.declaresStack</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> item[name] == true</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.contextData.getValue found for', name, this.kind, this.brickKey</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> this.valuesStack[i][name]</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.contextData.getValue not found for', name, this.kind, this.brickKey</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> undefined</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getValues</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> TODO what if the stack has items ???</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.values</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getSettableValues</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> TODO what if the stack has items ???</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = {}</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var k in this.values</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> k != '$'</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> ret[k] = this.values[k]</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> declareFunction</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> fn</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.functions[name] = fn</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getFunction</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.functions[name]</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.functions[name]</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> this.functionsStack.length &gt; 0</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                </span><span class="pp-tag">backeach</span><span class="pp-pln"> item in this.functionsStack</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> item[name]</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> item[name]</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> undefined</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> this.functions[name]</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> setBuiltInFunction</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.builtInFunctions[name] = value</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getBuiltInFunction</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.builtInFunctions[name]</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> push</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.functionsStack.push(this.functions)</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.valuesStack.push(this.values)</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.declaresStack.push(this.declares)</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.functions = {}</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.values = {}</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.declares = {}</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> pop</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.functionsStack.length &gt; 0</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.functions = this.functionsStack.pop()</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.values = this.valuesStack.pop()</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.declares = this.declaresStack.pop()</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> dumpValues</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'Dump context value for debug', this.kind</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var k in this.declares</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> f_verify.isObject(this.values[k]) == false</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> k, this.values[k]</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getDeclareddumpValues</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'Dump context value for debug', this.kind</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var k in this.declares</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> f_verify.isObject(this.values[k]) == false</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> k, this.values[k]</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getDeclaredInfo</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = []</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var k in this.declares</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> f_verify.isObject(this.values[k]) == false</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push(k + '=' + this.values[k])</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push(k + '= [object]')</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret.join(', ')</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = ContextData</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d44">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/errors.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> f_verify = require('./functions/verify')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = module.exports = {}</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d86">error(</span><span class="pp-arg"> JsWizziRunner</span><span class="pp-pln">,</span><span class="pp-arg">  message</span><span class="pp-pln">,</span><span class="pp-arg">  node </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message + util.inspect(node.loc, {depth: null})</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d86">error(</span><span class="pp-arg"> InvalidVariableName</span><span class="pp-pln">,</span><span class="pp-arg">  message </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d86">error(</span><span class="pp-arg"> JsWizziSynthax</span><span class="pp-pln">,</span><span class="pp-arg">  message</span><span class="pp-pln">,</span><span class="pp-arg">  node </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'JsWizziSynthax.message', message</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> f_verify.isObject(message) && message.lineNumber</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> In this case node = WizziJS source</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = "Synthax error. " + message.description +' at line ' + message.lineNumber +' column ' + message.column +'\n' +getEsprimaErrorLines(message, node) +'\n'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> For</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> vars or functions undeclared</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> invalid values</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d86">error(</span><span class="pp-arg"> JsWizziType</span><span class="pp-pln">,</span><span class="pp-arg">  message</span><span class="pp-pln">,</span><span class="pp-arg">  node </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> getEsprimaErrorLines</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> esprimaException</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> source</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> statements = source.split('\n')</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> start = Math.max(0, (esprimaException.lineNumber - 4))</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> end</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> Math.min</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> statements.length</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> (esprimaException.lineNumber + 4)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> ret</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var i = start; i &lt; end; i++</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push(formatLineNumber(i + 1) + ' ' + statements[i])</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> (i == esprimaException.lineNumber - 1)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> col = esprimaException.column</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push(spaces(col + 4) + '^ ' + esprimaException.description)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> ret.join('\n')</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> spaces</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> num</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> Array(num + 1).join(" ")</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> formatLineNumber</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> num</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> num &gt; 999</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> num</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> num &gt; 99</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ('0' + num)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> num &gt; 9</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ('00' + num)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> ('000' + num)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d45">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/jsWizziContext.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.jswizzi.jsWizziContext</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> assert</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> f_dateutil = require('./functions/dateutil')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> f_verify = require('./functions/verify')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> f_underscore = require('./functions/underscore')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('./errors')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> JsWizziEvalHelper = require('./jsWizziEvalHelper')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> ContextData = require('./contextData')</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> defaultValues</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '__dollar'        '$'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '__dollardollar'  '$$'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '__dollaraster'   '$*'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '__asterdollar'   '*$'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> knownCallables</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'console' console</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '_' f_underscore</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Object' Object</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Array' Array</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'String' String</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Date' Date</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Number' Number</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Map' Map</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Math' Math</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'RegExp' RegExp</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'JSON' JSON</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'path' require('path')</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'util' util</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'dateUtil' f_dateutil</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'verify' f_verify</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Infinity' Infinity</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'NaN' NaN</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> builtinFunctions</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Array' Array</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'String' String</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Date' Date</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Number' Number</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'RegExp' RegExp</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'isFinite' isFinite</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'isNaN' isNaN</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'parseFloat' parseFloat</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'parseInt' parseInt</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'decodeURI' decodeURI</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'decodeURIComponent' decodeURIComponent</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'encodeURI' encodeURI</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'encodeURIComponent' encodeURIComponent</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> ittfStates</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> nodeContext 0</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> brickEvalContext 1</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> globalContext 2</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> callContext 3</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> JsWizziContext</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> composedMTree</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> productionContext</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.isForInterpolation = false</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> composedMTree</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> The JsWizziContext is used for the</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> buildup of an MTree.</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> Create the JsWizziEvalHelper</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.composedMTree = composedMTree</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.loadHistory = composedMTree.loadHistory</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.productionContext = productionContext</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.evalHelper = new JsWizziEvalHelper(this, composedMTree, productionContext)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> The JsWizziContext is used for interpolations.</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.isForInterpolation = true</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.globalContext = new ContextData(ittfStates.globalContext)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.callContext = new ContextData(ittfStates.callContext)</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.isForInterpolation == false</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.nodeContext = new ContextData(ittfStates.nodeContext)</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.loadingCallArguments = false</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.exprPending = null</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> The first getValue will be for the '$' variable</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.ittf_state = ittfStates.globalContext</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.currentMTreeBrickKey = null</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> brickEvalContext is retrieved from JsWizziEvalHelper</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> each ittf source document has its brickEvalContext</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.brickEvalContext = null</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.isForInterpolation == false</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.declare('$', this.evalHelper)</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> freeze to avoid override of $ variable.</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.$freeze()</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> set global defaults and allowed functions</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.setValues(defaultValues)</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.setValues(knownCallables)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.setValues(builtinFunctions)</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.runningNodeId = null</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof window === 'undefined'</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.startTimer = process.hrtime()</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.startTimer = window.performance.now()</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Called by JsWizziRunner.FunctionDeclarationCall</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> push</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.callContext.push()</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.isForInterpolation == false</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.nodeContext.push()</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.brickEvalContext.push()</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> pop</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.callContext.pop()</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.isForInterpolation == false</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.nodeContext.pop()</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.brickEvalContext.pop()</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> clear</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.clear</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.isForInterpolation == false</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.nodeContext.clear</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> this.brickEvalContext</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.brickEvalContext.clear</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.declare('$', this.evalHelper)</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.$freeze()</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.setValues(defaultValues)</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.globalContext.setValues(knownCallables)</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> setRunningNodeId</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> id</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.runningNodeId = id</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> get_currentMTreeBrickInfo</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.currentMTreeBrickKey == null</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> currentModel_uri 'unavailable'</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> currentModel_mixerUri 'unavailable'</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBrickData = this.loadHistory.getMTreeBrickData(this.currentMTreeBrickKey)</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mixerUri = 'root model'</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> mTreeBrickData.mTreeBrick.$mixerBrickKey</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> mixerMTreeBrickData = this.loadHistory.getMTreeBrickData(mTreeBrickData.mTreeBrick.$mixerBrickKey)</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> mixerUri = mixerMTreeBrickData ? mixerMTreeBrickData.ittfDocumentUri : 'root model';</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> currentModel_uri mTreeBrickData.ittfDocumentUri</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> currentModel_mixerUri mixerUri</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getIsCompileGlobals</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '_' true</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'path' true</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'util' true</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'dateUtil' true</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'verify' true</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> k in Object.keys(this.getGlobalValues())</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !(defaultValues[k] || knownCallables[k] || builtinFunctions[k]) && k !== '$' && k !== 'NaN'</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> ret[k] = true</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> elapsedTime</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> note</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> precision = 3</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> divide by a million to get nano to milli</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof window === 'undefined'</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> elapsed = process.hrtime(this.startTimer)[1] / 1000000;</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> process.hrtime(this.startTimer)[0] + " s, " + elapsed.toFixed(precision) + " ms - " + note</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.startTimer = process.hrtime()</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> elapsed = window.performance.now(this.startTimer)[1] / 1000000;</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> window.performance.now(this.startTimer)[0] + " s, " + elapsed.toFixed(precision) + " ms - " + note</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.startTimer = window.performance.now()</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> jsWizziContext/getset_value</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> jsWizziContext/set_context</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = JsWizziContext</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d46">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/jsWizziEvalHelper.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.jsWizziEvalHelper</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> assert</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> ContextData = require('./contextData')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> interpolate = require('../loader/ittfInterpolate')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> types = require('../util/types')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> JsWizziContext = null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> work</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> work.lineSep = "__LS__"</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> work.textSep = "__TS__"</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> This helper instance is declared in the global context</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> of the JsWizziContext and is in the global scope of the</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> JsWizziRunner when it runs the mTreeBrickBuildupScript.</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The mTreeBuildupScript may call the methods of</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> this instance for</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . Setting the evalContext: global, mTreeBuildup or mTreeBrick.</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . Adding nodes to the mTree that is been building.</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . Executing interpolation of expressions.</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . Calling api functions (declared in the wizzifile.js) on the runner server</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . Retrieving wizzi models (loaded in wizzifile.js) from the runner server</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The evalContext(s) of mTreeBrick(s) are stored in the</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> the mTreeBrickDatas map of the wizzi.loader.loadHistory.</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> There are retrieved by the getMTreeBrickEvalContext method</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> every time the active mTreeBrick context changes.</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> JsWizziEvalHelper</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> jsWizziContext</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> primaryModel</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">{</span><span class="pp-pln"> loadHistory</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> productionContext</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.jsWizziContext = jsWizziContext</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.primaryModel = primaryModel</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.loadHistory = primaryModel.loadHistory</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.productionContext = productionContext</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.textSep = work.textSep</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> productionContext.runnerServer</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.callApi = productionContext.runnerServer.callApi</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> this.getModel = productionContext.runnerServer.getModel</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> mTree buildup method</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> supershort method name</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> Set the JsWizziContext state to MTreeBrickEvalContext</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> s</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> brickKey</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'JsWizziEvalHelper called $.s(' + brickKey +')'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> notUsed</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.jsWizziContext.set_MTreeBrickEvalContext(brickKey)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> mTree buildup method</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> supershort method name</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> Set the JsWizziContext state to NodeContext</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> n</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'JsWizziEvalHelper called $.n()'</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.jsWizziContext.set_NodeContext()</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> mTree buildup method</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> supershort method name</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> Set the JsWizziContext state to GlobalContext</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> g</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> brickKey</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'JsWizziEvalHelper called $.g("brickKey")'</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.jsWizziContext.set_GlobalContext(brickKey)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> mTree buildup method</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> supershort method name</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> Append a child node to a parent node</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> a</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> parent</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> line</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'JsWizziEvalHelper called $.a(' + node.n + ',' + node.v + ')'</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> assert(parent, "wizzi-mtree.JsWizziEvalHelper error. Parent undefined in add. At line " + line)</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> node.parent = parent</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (parent.children) === 'undefined'</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> parent.children = []</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> node.children = []</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> parent.children.push(node)</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> Interpolate a templated node value</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> ip</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> brickKey</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> templatedValue</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> type</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> line</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> hasMacro</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> save = this.jsWizziContext.get_currentMTreeBrickKey()</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> notUsed</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.jsWizziContext.set_MTreeBrickEvalContext(brickKey, line)</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log ' *** JsWizziEvalHelper.ip templatedValue', templatedValue, 'brickKey', brickKey</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> ret</span><span class="pp-pln">,</span><span class="pp-arg">  JsWizziEvalHelper.ip </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> interpolate(templatedValue, this.jsWizziContext, {delimiter: '</span><span class="pp-kwd">${</span><span class="pp-expr"></span><span class="pp-kwd">}</span><span class="pp-pln">'})</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'interpolated result', ret</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> Stop 7/7/17 if hasMacro</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret = remacro(ret)</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> save === null</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.jsWizziContext.set_NodeContext(brickKey)</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> notUsed</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> this.jsWizziContext.set_MTreeBrickEvalContext(save)</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBrickData = this.loadHistory.getMTreeBrickData(brickKey)</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mixerMTreeBrickData = this.loadHistory.getMTreeBrickData(mTreeBrickData.mTreeBrick.$mixerBrickKey)</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mixerUri = mixerMTreeBrickData ? mixerMTreeBrickData.ittfDocumentUri : 'root model';</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'saved ip.currentMTreeBrickKey', save, 'mTreeBrickData.evalContext', mTreeBrickData.evalContext</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> 'values.' + util.inspect(this.jsWizziContext.getValues(), {depth: 2}))</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> exMessage = ex ? ex.message : 'not available'</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> exStack = ex ? ex.stack : 'not available'</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InterpolationError'</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'ip'</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Exception interpolating: ' + templatedValue + ', line:' + line + ', type:' + type + ', brickKey:' + brickKey + ', mTreeBrick uri: ' + mTreeBrickData.ittfDocumentUri + ', mixerMTreeBrick uri: ' + mixerUri + ', ex message: ' + exMessage + ', stack: ' + exStack</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ex</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> retObject</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> types.objectify</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ret</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> type</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> row line</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> retObject && retObject.__is_error</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBrickData = this.loadHistory.getMTreeBrickData(brickKey)</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InterpolationError'</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'ip'</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Error interpolating: ' + templatedValue + ', line:' + line + ', mTreeBrick uri: ' + mTreeBrickData.ittfDocumentUri + ', mixerMTreeBrick uri: ' + mixerUri</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> retObject</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> retObject</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> api</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.callApi</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.callApi.apply</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> this.productionContext.runnerServer</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> arguments</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidOperation'</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'api'</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'A RunnerServer has not been started. You must create a wizzifile.js.'</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> model</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.getModel</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> this.getModel.apply</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> this.productionContext.runnerServer</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> arguments</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidOperation'</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'model'</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'A wizzi.RunnerServer has not been started. You must create a wizzifile.js.'</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d35"> jsWizziEvalHelper/getMTreeBrickEvalContext</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> remacro</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Alt+146 = Ã†</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> verify.replaceAll(value, "${", "</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = JsWizziEvalHelper</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d47">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/jsWizziRunner.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.jsWizzi.jsWizziRunner</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> escodegen = require('escodegen')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> esprima = require('esprima')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('./errors')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verbose = false</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> logGetSet = false</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> parsedCache = {}</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MAX_ITERATIONS = 5000</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> defaultOptions</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> verbose true</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> dummy</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> hello</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> for emitting error function</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> log</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> label</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> force</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> (verbose || force)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> escodegen.generate(node)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> console.log</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> label</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> util.inspect</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> depth 2</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> logGet</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> name[0] === '$'</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> var fmt =  util.inspect(value, { depth: null})</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.jsWizziRunner == get == ' + name + ' : ' + fmt + ' -----'</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> logSet</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> name[0] === '$'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> var fmt =  util.inspect(value, { depth: null})</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.jsWizziRunner -- set -- ' + name + ' : ' + fmt + ' ====='</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> runner</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ast</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> action</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> data</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> type</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> action</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span><span class="pp-pln"> ast.type + '_' + action</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> ast.type</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> verbose</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> console.log('ast.type: ' + type)</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ast.trailingComments && ast.trailingComments.length == 1</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.setRunningNodeId</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ast.trailingComments[0].value</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> trunner = runner[type]</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> trunner</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> trunner(ast, ctx, data)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Missing runner for type: ' + type</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'runner'</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> runnerSet</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ast</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> data</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> runner(ast, ctx, 'Set', data)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> runnerCall</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ast</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> data</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> runner(ast, ctx, 'Call', data)</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> Program</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> state</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; node.body.length; i++</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> statement = node.body[i]</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> state</span><span class="pp-pln">,</span><span class="pp-arg">  Program</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(statement, ctx)</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> state.return</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> state.value</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> Identifier</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.name == 'undefined'</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'Identifier returning node.name = undefined'</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> undefined</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ctx.isDeclared(node.name)</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> logGetSet</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> logGet</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.name</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.getValue</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node.name</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.getValue</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.name</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.esprima.jsWizziRunner.Identifier not found', node.name, ctx</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'ReferenceError|Identifier &lt; ' + node.name + ' &gt; not defined, on node &lt; ' + ctx.runningNodeId + ' &gt; ' +ctx.getDeclaredInfo()</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Identifier'</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> Identifier_Set</span><span class="pp-pln">,</span><span class="pp-arg">  data</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.put</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> node.name</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> data</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> Literal</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> node.value</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> VariableDeclaration</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> declaration in node.declarations</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> state</span><span class="pp-pln">,</span><span class="pp-arg">  VariableDeclaration</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner(declaration, ctx)</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d42">runner(</span><span class="pp-arg"> VariableDeclarator</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> !node.init</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.declare</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.id.name</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d41">checked_run(</span><span class="pp-arg"> value</span><span class="pp-pln">,</span><span class="pp-arg">  VariableDeclaration</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> runner</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.init</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> if node.id.name === '_____result'</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'jsWizziRunner.VariableDeclarator', node.id.name, value</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.declare</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.id.name</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> value</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a"> jsWizziRunner/statements</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d37"> jsWizziRunner/for</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d36"> jsWizziRunner/expressions</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d38"> jsWizziRunner/functions</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> local_error</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> message</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> parentnode</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> method</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> ex</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> throw new Error('boing')</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> message = message || ''</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> errorCode = 'JsWizziError', ss = message.split('|')</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ss.length == 2</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> errorCode = 'JsWizziError-' + ss[0]</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> message = ss[1]</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> nodeStm</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">        </span><span class="pp-tag">try</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> nodeStm = node ? escodegen.generate(node) : ''</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">        </span><span class="pp-tag">catch</span><span class="pp-pln"> escodegenErr</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> nodeStm = 'escodegen failed: ' + escodegenErr.message</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> nodeInsp = node ? util.inspect(node, {depth:2}) : ''</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> parentnodeStm</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">        </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> parentnodeStm = parentnode ? escodegen.generate(parentnode) : ''</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">        </span><span class="pp-tag">catch</span><span class="pp-pln"> escodegenErr</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> parentnodeStm = 'escodegen failed: ' + escodegenErr.message</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> parentnodeInsp = node ? util.inspect(node, {depth:2}) : ''</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> currentModelInfo = ctx.get_currentMTreeBrickInfo()</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> message</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'JsWizziRunner Error'</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'message: ' + message</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'node statement: ' + nodeStm</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'node inspected: ' + nodeInsp</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'parent node statement: ' + parentnodeStm</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'parent node inspected: ' + parentnodeInsp</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'currentModel_uri: ' + currentModelInfo.currentModel_uri</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'currentModel_mixerUri: ' + currentModelInfo.currentModel_mixerUri</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> errorCode</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> method</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> message.join('\n')</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ex</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> getTypeDescription</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> obj == null</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> 'null'</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> typeof(obj)</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> getParsed</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> source</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                    </span><span class="pp-tag">try</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> parsed</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> esprima.parse</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> source</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> attachComment true</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> loc true</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceType 'module'</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> parsed</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                    </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">                        </span><span class="pp-tag">throw</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                            </span><span class="pp-tag">new</span><span class="pp-pln"> errors.JsWizziSynthaxError(ex, source)</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> run</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">                </span><span class="pp-tag">function</span><span class="pp-pln"> run</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> source</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> ctx : instance-of wizzi-mtree.jswizzi.jsWizziContext</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(source) === false</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> err</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidArgument'</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'run'</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'source'</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> message 'The source parameter must be a string. Received: ' + source</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isObject(ctx) === false</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L8"><span class="pp-ln"> 228 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidArgument'</span></div><div class="L9"><span class="pp-ln"> 229 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'run'</span></div><div class="L0"><span class="pp-ln"> 230 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln"> 231 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'ctx'</span></div><div class="L2"><span class="pp-ln"> 232 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> message 'The ctx parameter must be an object. Received: ' + ctx</span></div><div class="L3"><span class="pp-ln"> 233 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln"> 234 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 235 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div><div class="L6"><span class="pp-ln"> 236 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 237 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln"> 238 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> options = (options || defaultOptions)</span></div><div class="L9"><span class="pp-ln"> 239 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> parsed</span></div><div class="L0"><span class="pp-ln"> 240 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> FIXME caching provokes errors, now disbled</span></div><div class="L1"><span class="pp-ln"> 241 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> should be:  if source.length &lt; 100</span></div><div class="L2"><span class="pp-ln"> 242 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> source.length &lt; 0</span></div><div class="L3"><span class="pp-ln"> 243 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> parsed = parsedCache[source]</span></div><div class="L4"><span class="pp-ln"> 244 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> !parsed</span></div><div class="L5"><span class="pp-ln"> 245 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> parsed = this.getParsed(source)</span></div><div class="L6"><span class="pp-ln"> 246 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> parsedCache[source] = parsed</span></div><div class="L7"><span class="pp-ln"> 247 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 248 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'using cache', source</span></div><div class="L9"><span class="pp-ln"> 249 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 250 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> parsed = this.getParsed(source)</span></div><div class="L1"><span class="pp-ln"> 251 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> options.dumpfile</span></div><div class="L2"><span class="pp-ln"> 252 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> options.dumpfile</span></div><div class="L3"><span class="pp-ln"> 253 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> JSON.stringify(parsed, null, 2)</span></div><div class="L4"><span class="pp-ln"> 254 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> result = runner(parsed, ctx)</span></div><div class="L5"><span class="pp-ln"> 255 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> result && result.__is_error</span></div><div class="L6"><span class="pp-ln"> 256 </span><span class="pp-pln">                        </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-mtree.jswizzi.jsWizziRunner. Result has errors: ', result</span></div><div class="L7"><span class="pp-ln"> 257 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln"> 258 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> result && result.__is_error</span></div><div class="L9"><span class="pp-ln"> 259 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> delete (result.__is_error)</span></div><div class="L0"><span class="pp-ln"> 260 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(result)</span></div><div class="L1"><span class="pp-ln"> 261 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 262 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L3"><span class="pp-ln"> 263 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln"> 264 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> result</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d48">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/jswizzi/jsWizziScriptCoder.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.jswizzi.jsWizziScriptCoder</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Helper class for building JsWizzi scripts</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> JsWizziScriptCoder</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.stm = []</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.indentValue = 0</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.length = 0</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.line = ''</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> for</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.line.length &gt; 0</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.w()</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.w('for (' + text + ') {' + ' //' + node.id)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.indent()</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> if</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.line.length &gt; 0</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.w()</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.w('if (' + text + ') {' + ' //' + node.id)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.indent()</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> elif</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.line.length &gt; 0</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.w()</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.w('else if (' + text + ') {' + ' //' + node.id)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.indent()</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> else</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.line.length &gt; 0</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.w()</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.w('else {')</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.indent()</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> while</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.line.length &gt; 0</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.w()</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.w('while (' + text + ') {' + ' //' + node.id)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.indent()</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> end</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.line.length &gt; 0</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.w()</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.deindent()</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.w('}')</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> w</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ind = spaces(this.indentValue * 4)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.stm.push(ind + this.line + (text || ''))</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.line = ''</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.length++</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> write</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.line += (text || '')</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> indent</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.indentValue++</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> deindent</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.indentValue = Math.max(0, (this.indentValue - 1))</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> toCode</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.line.length &gt; 0</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.w()</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.stm.join('\n')</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getErrorLines</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> esprimaException</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> start = Math.max(0, (esprimaException.lineNumber - 4))</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> end</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> Math.min</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> this.stm.length</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> (esprimaException.lineNumber + 4)</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var i = start; i &lt; end; i++</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push(formatLineNumber(i + 1) + ' ' + this.stm[i])</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> (i == esprimaException.lineNumber - 1)</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> col = esprimaException.column</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ret.push(spaces(col + 4) + '* ' + esprimaException.description)</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> spaces</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> num</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> Array(num + 1).join(" ")</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> formatLineNumber</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> num</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> num &gt; 999</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> num</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> num &gt; 99</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ('0' + num)</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> num &gt; 9</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ('00' + num)</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> ('000' + num)</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = JsWizziScriptCoder</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d49">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/t/ittfDocumentFinder/recurserTFolder.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> recurserTFolder</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> basePath</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">string</span><span class="pp-pln"> relPath</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'recurserTFolder enter', basePath, relPath</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Promise</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> resolve</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> ittfDocumentUri = path.join(basePath, 't', relPath)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.tryExists</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> that.schema</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> result.found</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> return callback(null, result)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'recurserTFolder resolve found', result</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> resolve(result)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> basePath = path.dirname(basePath)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> basePath.length &gt; 3</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'recurserTFolder try parent', basePath</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> recurserTFolder</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> basePath</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> relPath</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                            </span><span class="pp-tag">._</span><span class="pp-pln"> then</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                                </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                                    </span><span class="pp-tag">param</span><span class="pp-pln"> result</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'recurserTFolder transmit resolve result', basePath, result</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                                                    </span><span class="pp-tag">_</span><span class="pp-pln"> resolve(result)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                                    </span><span class="pp-tag">#</span><span class="pp-pln"> return that.resolvePathInTFolders(basePath, relPath, callback)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                                </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'recurserTFolder resolve not found', basePath</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> resolve</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                                            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> found false</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d50">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/t/md/glo-item.md.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">tr</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">td</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">td</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d51">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/t/mTreeBrick/calcParamValues.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Rules</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Node command format</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> &gt; $params param1 [,param2 [,param-n]]</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> param   : [&]name[:type][|default]</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> &       : the paramater is an object passed by reference</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> name    : the name of the parameter to use in IttfMacro expressions</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> type    : the parameter type</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> one-of : string(default), integer, float, boolean, date, object (implicit</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> when '&' declared), macro (implicit, detected from IttfMacro delimiters</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> contained in the default value)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> default : typed-value | @@null | @@undefined</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> // warning! `title|null` becomes title = "null" (the quoted string null)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> // if you want title to be null then : `title|@@null`</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string  : quotes are optional, example: `title|"my way"` and `title|my way` are the same</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> boolean : true | false</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> date    : yyyy/mm/dd</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> macro   : an IttfMacro can be passed as a parameter to a mixin, when the parameter</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> is referenced we have a double macro substitution</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> TODO verify, explain how this works, macro or macros can be partial</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> insides of the default value?</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-tag">m</span><span class="pp-pln"> calcParamValues</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> args</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string args</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> optional</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBrickRoot = this.nodes[0]</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> params = this.$params</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> _paramArray</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> _argsArray</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(params)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> _paramArray = params.trim().split(',')</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(args)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> _argsArray = args.trim().split(',')</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; _paramArray.length; i++</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> type = 'string'</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> defaultValue = null</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> value = null</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> hasparamvalue = false</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> hasdefaultvalue = false</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> a param may have the format</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> 1) name</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> 2) name|default</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> 3) name:type|default</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> valid types: string(default), integer, float, boolean, date</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> param_parts</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> _paramArray[i].trim()</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> split(/[|]/)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> param_parts.length &gt; 2</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'MixinParamError'</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'calcParamValues'</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Error evaluating: $params ' + params + ' , Argument ' + i + ' is malformed. Expected name[:type[|default]]'</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickRoot</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> param_parts.length == 2</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> defaultValue = param_parts[1].trim()</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> hasdefaultvalue = true</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> param_parts</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> param_parts[0].trim()</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> split(/[:]/)</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> param_parts.length &gt; 2</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'MixinParamError'</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'calcParamValues'</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Error evaluating: $params ' + params + ', argument ' + i + ' is malformed. Expected name[:type[|default]]'</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickRoot</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> param_parts.length == 2</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> type = param_parts[1]</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> name = param_parts[0]</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> name.substr(0, 1) === '&'</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> name = name.substr(1)</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> type = 'object'</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> _argsArray.length &gt; i</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> value = _argsArray[i].trim()</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> type === 'object'</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> value.substr(0, 1) !== '&'</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'MixinParamError'</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'calcParamValues'</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Error evaluating: $params ' + params + ', argument (' + i + ') must be an object reference. Found ' + value</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickRoot</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> value = value.substr(1)</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> value = verify.convert(value, type, true)</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> value && value.__is_error</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'MixinParamError'</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'calcParamValues'</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Error evaluating: $params ' + params + ', objectifying parameter: ' + i + '/' + name</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickRoot</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> value</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> hasparamvalue = true</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> hasdefaultvalue</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> value = verify.convert(defaultValue, type, true)</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> value && value.__is_error</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'MixinParamError'</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'calcParamValues'</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Error evaluating: $params ' + params + ', converting parameter: ' + i + '/' + name + ' to type ' + type</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickRoot</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> value</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'MixinParamError'</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'calcParamValues'</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Error evaluating: $params ' + params + ', missing value for not optional argument ' + i + ' = ' + name</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickRoot</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> isIttfMacro</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> type === 'object'</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span><span class="pp-pln"> false</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> verify.isIttfMacro(value)</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> result.push</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> name</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                        </span><span class="pp-tag">iif</span><span class="pp-pln"> name.substr(0, 1) === '&'</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                            </span><span class="pp-tag">then</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> name.substr(1)</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span><span class="pp-pln"> name</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> value value</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> type type</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> isIttfMacro isIttfMacro</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> isByRef type === 'object'</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> result</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d52">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/appender.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.appender</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../errors')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> utilnode = require('../util/node')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Ittf commands</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $group</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $append</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $override</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> mixedMTreePiece</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> appends</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> groups</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> overrides</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ctx</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> id 1</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> node in mixedMTreePiece.nodes</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> assignId</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> errors</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> node in mixedMTreePiece.nodes</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> searchAppend(node, node, appends, groups, overrides, errors, mixedMTreePiece)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> errors.length &gt; 0</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> errors[0]</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var key in appends</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.loader.appender.appends.key', key, appends[key]</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> appobj = appends[key]</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> utilnode.replace</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> appobj.appto</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> appobj.items</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var key in overrides</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> overobj = overrides[key]</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> utilnode.replace</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> overobj.virt</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> overobj.items</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in groups</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !item.parent</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidIttfError'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'default'</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> "The tag $group must have a parent and cannot be the root of a primary ittf document. Hint: check for ittf fragments not in a tfolder."</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> utilnode.replace</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item.children</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> toremove</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> node in mixedMTreePiece.nodes</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> searchPendingNodes(node, toremove)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in toremove</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> utilnode.remove(item)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, mixedMTreePiece)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> searchAppend</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> root</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> appends</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> groups</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> overrides</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> errors</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> mixedMTreePiece</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> item.name === '$group'</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> groups.push(item)</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> item.name === '$append'</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !item.value</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> errors.push</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidIttfError'</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'searchAppend'</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> "The tag $append requires a node-value."</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> appto</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> utilnode.findHookExt</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> item.value.trim()</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 1</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> appto == null</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> appto</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> utilnode.findHookExt</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> item.value.trim()</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 0</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> appto == null</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'mixedMTreePiece.dump\n', mixedMTreePiece.toText()</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> errors.push</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidIttfError'</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'searchAppend'</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Cannot find hook ' + (item.value || '') + ', root is ' + root.name + ' ' + (root.value || '') + ', in ' + item.model.uri + ', brickKey ' + item.model.brickKey + ', remember that $hook/$append does not work between sibling nodes.' + 'After mixup the $hook node must be a parent node or a descendant of a parent node of $append' + ', but not a sibling node.'</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> appobj = appends[item.id]</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> appobj</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> appobj.items = appobj.items.concat(item.children)</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> appobj =</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> appto appto</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> items item.children</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> appends[item.id] = appobj</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> item.name === '$override'</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !(item.value)</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> errors.push</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidIttfError'</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'searchAppend'</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> "The tag $override requires a value."</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> virt</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> utilnode.findVirtual</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> item.value.trim()</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> virt == null</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> errors.push</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidIttfError'</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'searchAppend'</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Cannot find virtual to override ' + (item.value || '') + ', root is ' + root.name + ' ' + root.value</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> overobj = overrides[item.value]</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> overobj</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> errors.push</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidIttfError'</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'searchAppend'</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'The virtual node ' + item.value + ' has already been overridden. Root is ' + root.name + ' ' + root.value</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> overobj =</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> virt virt</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> over item</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> items item.children</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> overrides[item.value] = overobj</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> child in item.children</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> searchAppend(child, root, appends, groups, overrides, errors, mixedMTreePiece)</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> searchPendingNodes</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> toremove</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ['$hook', '$append', '$override'].indexOf(item.name) &gt;= 0</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> toremove.push(item)</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> child in item.children</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> searchPendingNodes(child, toremove)</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> assignId</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> item._id = ctx.id++</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> child in item.children</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> assignId(child, ctx)</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d90"> local_error</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d53">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/debugInfoBuilder.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.debugInfoBuilder</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> JsWizziContext = require('../jswizzi/jsWizziContext')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> dateUtil = require('../jswizzi/functions/dateutil')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> JsWizziScriptCoder = require('../jswizzi/JsWizziScriptCoder')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBuildUpScripter = require('./mTreeBuildUpScripter')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> requireFromString = null</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Returns for debug purposes:</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . the mTreeBuildUpScript</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> composedMTreePiece</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> loadContext</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> productionContext = loadContext.productionContext</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.options = loadContext.options || {}</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> jsWizziContext</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> JsWizziContext(composedMTreePiece, productionContext)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsWizziContext.setGlobalValues</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext.mTreeBuildUpContext</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> brickKey null</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> counter 0</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> startTime dateUtil.now_GMYHMS()</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> isCompile loadContext.options.isCompile</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> isCompile = loadContext.options.isCompile</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> scriptCoder</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> JsWizziScriptCoder()</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '// ' + ctx.startTime + '  by ' + __filename</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isCompile</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'module.exports = function($, $ctx) {'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.indent</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">foreach</span><span class="pp-pln"> k in Object.keys(jsWizziContext.getIsCompileGlobals())</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'var ' + k + ' = $ctx.' + k + ';'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '$.n(); // set the context state to NodeContext'</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'var $0 = {}; // the root node of the MTree buildup'</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in composedMTreePiece.nodes</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBuildUpScripter.codify(item, 0, scriptCoder, ctx)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isCompile</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'return $0;'</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.deindent</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '}'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpScript scriptCoder.toCode()</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d54">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/evaluator.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.evaluator</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> jsWizziRunner = require('../jswizzi/jsWizziRunner')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> JsWizziContext = require('../jswizzi/jsWizziContext')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> dateUtil = require('../jswizzi/functions/dateutil')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> JsWizziScriptCoder = require('../jswizzi/JsWizziScriptCoder')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBuildUpScripter = require('./mTreeBuildUpScripter')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> requireFromString = null</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The final step of an mTree loading.</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Executes the expressions evaluation and the</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> template commands of the composed mTree piece and build the final mTree:</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . creates the mTreeBuildUpScript from the composedMTreePiece,</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . creates the jsWizziContext and loads the loadContext.mTreeBuildUpContext</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> in the global context,</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . runs the script with the jsWizziRunner,</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . returns the builded mTree.</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { composedMTreePiece</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { loadContext</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { mTreeBuildUpContext</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { productionContext</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { runnerServer</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> composedMTreePiece</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> loadContext</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> productionContext = loadContext.productionContext</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.options = loadContext.options || {}</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> jsWizziContext</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> JsWizziContext(composedMTreePiece, productionContext)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsWizziContext.setGlobalValues</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext.mTreeBuildUpContext</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ctx</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> brickKey null</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> counter 0</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> startTime dateUtil.now_GMYHMS()</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> isCompile loadContext.options.isCompile</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> isCompile = loadContext.options.isCompile</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'isCompile', isCompile</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> scriptCoder</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> JsWizziScriptCoder()</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '// ' + ctx.startTime + '  by ' + __filename</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isCompile</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'module.exports = function($, $ctx) {'</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.indent</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">foreach</span><span class="pp-pln"> k in Object.keys(jsWizziContext.getIsCompileGlobals())</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'var ' + k + ' = $ctx.' + k + ';'</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '$.n(); // set the context state to NodeContext'</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'var $0 = {}; // the root node of the MTree buildup'</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in composedMTreePiece.nodes</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBuildUpScripter.codify(item, 0, scriptCoder, ctx)</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isCompile</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'return $0;'</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.deindent</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.w</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '}'</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> productionContext.addMTreeBuildUpScript</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> composedMTreePiece.uri</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> scriptCoder</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isCompile</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'scriptCoder.toCode()', scriptCoder.toCode()</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> requireFromString === null</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> requireFromString = require('./requireFromString')</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> md</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> requireFromString</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.toCode</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> $0</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> md</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> jsWizziContext.getValue('$')</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> jsWizziContext.getGlobalValues</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> finalize</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> composedMTreePiece</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> $0</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> jsWizziRunner.run</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> scriptCoder.toCode()</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> jsWizziContext</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> jsWizziContext.set_NodeContext()</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> $0 = jsWizziContext.getValue('$0')</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof($0) === 'undefined' || $0 == null || $0.children === 'undefined'</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> message 'No nodes returned after IttfEvaluation.'</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> document composedMTreePiece.uri</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> finalize</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> composedMTreePiece</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> $0</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> finalize</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> composedMTreePiece</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> $0</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> composedMTreePiece.nodes = []</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in $0.children</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> item.parent = null</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> composedMTreePiece.nodes.push(item)</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> composedMTreePiece.data =</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> createdAt ctx.startTime</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, composedMTreePiece)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d55">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/includer.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.includer</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> path = require('path')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> async = require('async')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../errors')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> utilnode = require('../util/node')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Ittf commands</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $include</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $json</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> includer</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">{</span><span class="pp-pln"> primaryMTreeBrick</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">{</span><span class="pp-pln"> mTreeBrickProvider</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">callback</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> includes</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> jsons</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">foreach</span><span class="pp-pln"> node in primaryMTreeBrick.nodes</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> searchIncludes</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> includes</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> jsons</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> async.mapSeries</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> includes</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> v = item.value.trim()</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> mixeruri = item.model.uri</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> mixerbasedir = path.dirname(mixeruri)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBrickProvider.get</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> from 'store'</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> basedir mixerbasedir</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> relpath v</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> include true</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> includerBrickKey item.model.brickKey</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> includedWipNodifiedMTree </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBrickProvider.enterFragmentCall</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> mixeruri</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> includedWipNodifiedMTree.uri</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> mTreeBrickProvider.checkForRecursion()</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidIttfError'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'default'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Recursive mixin or include: ' + v</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> includer</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> includedWipNodifiedMTree</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickProvider</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> includeResult </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBrickProvider.exitFragmentCall()</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                                        </span><span class="pp-tag">#</span><span class="pp-pln"> _ mTreeBrickProvider.callChain.pop()</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> utilnode.replace</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> includeResult.nodes</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                                        </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> results </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                        </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in jsons</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> json</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> JSON.parse</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> item.value</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isArray(json)</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                                </span><span class="pp-tag">var</span><span class="pp-pln"> normalized</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                                    </span><span class="pp-tag">[</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                                </span><span class="pp-tag">foreach</span><span class="pp-pln"> jsonitem in json</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> normalized.push</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> normalizeNode</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> jsonitem</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> item.parent</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> item.model</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> item.row</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> item.col</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> item.sourceKey</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> utilnode.replace(item, normalized)</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                                </span><span class="pp-tag">var</span><span class="pp-pln"> normalized</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> normalizeNode</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> json</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> item.parent</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> item.model</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> item.row</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> item.col</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> item.sourceKey</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> utilnode.replace</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                                    </span><span class="pp-tag">[</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> normalized</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, primaryMTreeBrick)</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> searchIncludes</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> includes</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> jsons</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> item.name === '$include'</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> includes.push(item)</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> item.name === '$json'</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsons.push(item)</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> child in item.children</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> searchIncludes</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> child</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> includes</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsons</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> normalizeNode</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> parent</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> model</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> r</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> c</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> u</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node.parent = parent</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node.model = model</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node.row = r</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node.col = c</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node.souceKey = u</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.children</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.children</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> normalizeNode(item, node, model, r, c, u)</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> node.children = []</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d90"> local_error</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d56">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/index.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> path = require('path')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../errors')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> node = require('../util/node')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrickProvider = require('./mTreeBrickProvider')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> includer = require('./includer')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mixer = null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> appender = require('./appender')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> evaluator = require('./evaluator')</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> debugInfoBuilder = require('./debugInfoBuilder')</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The Big JOB of an mTree loading</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> manages</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> normalization of loadContext objects</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> instantiation of the modelProvider</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> liner</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> nodifier</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> includer</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> mixer</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> appender</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> evaluator</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Are checked in /lib/index.js. See there for doc.</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> There should be no direct access to this method except for testing.</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.loadMTree</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> loadMTree</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> primaryIttfDocumentUri</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> loadContext</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> originalloadContext = loadContext</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext = normalizeRequestContext(loadContext)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> loadContext.__is_error</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.ittfDocumentUri = primaryIttfDocumentUri</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.instance = originalloadContext</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(loadContext)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'primaryIttfDocumentUri', primaryIttfDocumentUri</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> primaryIttfDocumentUri</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d87">f_cb_no_err(</span><span class="pp-arg"> createdProvider </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> err.primaryIttfDocumentUri = primaryIttfDocumentUri</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> err.MTreeLoaderIndexStack = (new Error()).stack</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d91">r_cb_err(</span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> primaryMTreeBrick = createdProvider.getPrimaryMTreeBrick()</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> !primaryMTreeBrick.nodes || primaryMTreeBrick.nodes.length == 0</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, primaryMTreeBrick)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.loader.index.primaryMTreeBrick', primaryMTreeBrick.dump()</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> resolve $include commands</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> includer</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> primaryMTreeBrick</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> createdProvider</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> includedMTreePiece </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> mixer == null</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> mixer = require('./mixer')</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> mix primary mTreeBrick and mixins</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> mixer</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> includedMTreePiece</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> createdProvider</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> mixedMTreePiece </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> loadContext.productionContext.addMixedMTree(primaryIttfDocumentUri, mixedMTreePiece)</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                                    </span><span class="pp-tag">#</span><span class="pp-pln"> resolve $group, $hook and $append commands</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> appender</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixedMTreePiece</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> appendedMTreePiece</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                                            </span><span class="pp-tag">#</span><span class="pp-pln"> evaluate</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> evaluator</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> appendedMTreePiece</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                                                </span><span class="pp-tag">function</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                                                    </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                                                    </span><span class="pp-tag">param</span><span class="pp-pln"> finalMTree</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                                                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                                                        </span><span class="pp-tag">set</span><span class="pp-pln"> err.ittfDocumentUri = primaryIttfDocumentUri</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                                                        </span><span class="pp-tag">return</span><span class="pp-pln"> callback(err)</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                                                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mTree.loader.index.createdProvider.loadHistory', createdProvider.loadHistory</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                                                    </span><span class="pp-tag">set</span><span class="pp-pln"> finalMTree.loadHistory = createdProvider.loadHistory</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                                                    </span><span class="pp-tag">_</span><span class="pp-pln"> loadContext.productionContext.addEvaluatedMTree(primaryIttfDocumentUri, finalMTree)</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                                                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, finalMTree)</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Load the raw primaryIttfDocumentUri only.</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> This is mainly for debug or documentation purposes.</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.loadMTreeRaw</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> loadMTreeRaw</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> primaryIttfDocumentUri</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> loadContext</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-tag">{</span><span class="pp-pln"> __productionManager</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span><span class="pp-pln"> productionContext</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span><span class="pp-pln"> aclstat</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                </span><span class="pp-tag">{</span><span class="pp-pln"> __ittfDocumentStore</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> originalloadContext = loadContext</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext = normalizeRequestContext(loadContext)</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> loadContext.__is_error</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.ittfDocumentUri = primaryIttfDocumentUri</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.instance = originalloadContext</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(loadContext)</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> primaryIttfDocumentUri</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> createdProvider </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> primaryMTreeBrick = createdProvider.getPrimaryMTreeBrick()</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, primaryMTreeBrick)</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Load mTree debug info.</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> This is mainly for debug or documentation purposes.</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.loadMTreeDebugInfo</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> loadMTree</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> primaryIttfDocumentUri</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> loadContext</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> originalloadContext = loadContext</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext = normalizeRequestContext(loadContext)</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> loadContext.__is_error</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.ittfDocumentUri = primaryIttfDocumentUri</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.instance = originalloadContext</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(loadContext)</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> primaryIttfDocumentUri</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d87">f_cb_no_err(</span><span class="pp-arg"> createdProvider </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> err.primaryIttfDocumentUri = primaryIttfDocumentUri</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> err.MTreeLoaderIndexStack = (new Error()).stack</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d91">r_cb_err(</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> primaryMTreeBrick = createdProvider.getPrimaryMTreeBrick()</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> !primaryMTreeBrick.nodes || primaryMTreeBrick.nodes.length == 0</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, primaryMTreeBrick)</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.loader.index.primaryMTreeBrick', primaryMTreeBrick.dump()</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> resolve $include commands</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> includer</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> primaryMTreeBrick</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> createdProvider</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> includedMTreePiece </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> mixer == null</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> mixer = require('./mixer')</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> mix primary mTreeBrick and mixins</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> mixer</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> includedMTreePiece</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> createdProvider</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> mixedMTreePiece </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> loadContext.productionContext.addMixedMTree(primaryIttfDocumentUri, mixedMTreePiece)</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                                    </span><span class="pp-tag">#</span><span class="pp-pln"> resolve $group, $hook and $append commands</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> appender</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixedMTreePiece</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> appendedMTreePiece</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                                            </span><span class="pp-tag">#</span><span class="pp-pln"> build debug info</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> debugInfoBuilder</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> appendedMTreePiece</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> normalizeRequestContext</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> loadContext</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.loader.index.normalizeRequestContext.loadContext', loadContext</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> for var k in loadContext</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'normalizeRequestContext.k', k</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.productionContext = loadContext.__productionManager.productionContext</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isObject(loadContext.mTreeBuildUpContext) == false</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.mTreeBuildUpContext = {}</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> TODO this seems out of place, remove</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> if verify.isObject(loadContext.artifactContext) == false</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> set loadContext.artifactContext = {}</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isObject(loadContext.options) == false</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.options = {}</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> loadContext</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d57">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/ittfDocumentFinder.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.ittfDocumentFinder</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> TODO IttfBrickFinder would be a best name.</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Implements the path resolution strategy</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> of the wizzi factory:</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . first try the absolute path</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . if not found search in 't' folders.</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The wizzi-repo.ittfDocumentStore instance used</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> for locating documents is ctor iniected.</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> IttfDocumentFinder</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> store</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> schema</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.store = store</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.schema = schema</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> param options {</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> ittfDocumentUri:String</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> |</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> basedir:String</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> relpath:String</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> }</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> resolvePath</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> ittfDocumentUri = options.ittfDocumentUri</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> relpath = options.relpath</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(ittfDocumentUri) === false</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> basedir = options.basedir</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty (basedir) === false || verify.isAbsolutePath(basedir) === false</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d93">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  resolvePath </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'An "options.ittfDocumentUri" parameter or an "options.basedir" parameter with an absolute path is required to load an ITTF document. Received: ' + 'ittfDocumentUri: ' + options.ittfDocumentUri + ', basedir: ' + options.basedir + ', relpath: ' + options.relpath</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> (verify.isNotEmpty(relpath) === false) || (relpath[0] === '/')</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d93">r_cb_wz_err(</span><span class="pp-arg"> InvalidArgument</span><span class="pp-pln">,</span><span class="pp-arg">  resolvePath </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'An "options.ittfDocumentUri" parameter or an "options.relpath" parameter with a relative path is required to load an ITTF document. Received: ' + 'ittfDocumentUri: ' + options.ittfDocumentUri + ', basedir: ' + options.basedir + ', relpath: ' + options.relpath</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ittfDocumentUri = path.join(basedir, relpath)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.tryExists</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> this.schema</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> result.found</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> result.ittfDocumentUri</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(relpath) === false</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d93">r_cb_wz_err(</span><span class="pp-arg"> IttfNotFound</span><span class="pp-pln">,</span><span class="pp-arg">  resolvePath </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> parameter 'ittfDocumentUri'</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> message 'Cannot resolve ittf document uri: ' + ittfDocumentUri</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> that.resolvePathInTFolders</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> path.dirname(ittfDocumentUri)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> relpath</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> tresult </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> tresult.found</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> tresult.ittfDocumentUri</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                                </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'IttfDocumentFinder.resolvePath options', options, that.schema</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d93">r_cb_wz_err(</span><span class="pp-arg"> IttfNotFound</span><span class="pp-pln">,</span><span class="pp-arg">  resolvePath </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Cannot find ittf document: ' + ittfDocumentUri</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> resolvePathInTFolders</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> basePath</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> relPath</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d49"> ittfDocumentFinder/recurserTFolder</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> recurserTFolder</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> basePath</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> relPath</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> then</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> result</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> tryExists</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> test</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> schema</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.store.documentExists</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> test</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> found true</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri test</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> test.toLowerCase().substr(-5, 5) !== '.ittf'</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> schema</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> that.store.documentExists</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> test + '.' + schema + '.ittf'</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                                        </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                                            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                                                    </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                                                        </span><span class="pp-tag">@</span><span class="pp-pln"> found true</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                                                        </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri test + '.' + schema + '.ittf'</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                                        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> that.store.documentExists</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> test + '.ittf'</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                                                    </span><span class="pp-tag">if</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                                                        </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                                                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                                                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                                                                </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> found true</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri test + '.ittf'</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                                                    </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                                                        </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                                                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                                                                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                                                                </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> found false</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                                        </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> found false</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> found false</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = IttfDocumentFinder</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d58">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/ittfInterpolate.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.interpolate</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> jsWizziRunner = require('../jswizzi/jsWizziRunner')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> rules:</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Macro expressions are enclosed by </span><span class="pp-kwd">${</span><span class="pp-expr">'$'</span><span class="pp-kwd">}</span><span class="pp-pln">{ and } delimiters.</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> example: </span><span class="pp-kwd">${</span><span class="pp-expr">'$'</span><span class="pp-kwd">}</span><span class="pp-pln">{name}.</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> A macro expression can be escaped and used as a literal,</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> example: \</span><span class="pp-kwd">${</span><span class="pp-expr">'$'</span><span class="pp-kwd">}</span><span class="pp-pln">\{name}.</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> A macro expression may contain paired graphs { },</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> example: </span><span class="pp-kwd">${</span><span class="pp-expr">'$'</span><span class="pp-kwd">}</span><span class="pp-pln">{ for { var i=0; i&lt;10; i++} ; return i; }.</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> An empty macro </span><span class="pp-kwd">${</span><span class="pp-expr"></span><span class="pp-kwd">}</span><span class="pp-pln"> is treated as a literal, it is not replaced.</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> An unclosed delimiter </span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> state_text = 0</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> state_tag = 1</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> state_key = 2</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> interpolate</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> template</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> jsWizziContext</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof template === 'undefined' || template === null</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ''</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof options === 'undefined' || options === null</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> options = {}</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> isCompile = options.isCompile</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> l = template.length</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> result = []</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> ch</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> key</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> inside_tags = 0</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> state = state_text</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> replacer = null</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> keyOrCode</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> isCompile</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> result.push("'")</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">for</span><span class="pp-pln"> var i=0; i&lt;l; i++</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ch = template[i]</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '\\'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.loader.ittfInterpolate', template[i+1], template[i+2], template[i+3]</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> state == state_text && ch == '\\' && i+3 &lt; l && template[i+1] == '$' && template[i+2] == '\\' && template[i+3] == '{'</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> result.push('</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> i = i +3</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">continue</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '$'</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> state == state_text</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> state = state_tag</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> state == state_key</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> key.push(ch)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> state == state_tag</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> case double $$, is text</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> result.push('$$')</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> state = state_text</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> ch == '{'</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> state == state_text</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> isCompile && ch === "'"</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> result.push('\\')</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> result.push(ch)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> state == state_key</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> case '{' inside $ { }</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> inside_tags++</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> key.push(ch)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> state == state_tag</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> case </span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> state = state_key</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> key = []</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> inside_tags = 0</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> ch == '}'</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> state == state_text</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> isCompile && ch === "'"</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> result.push('\\')</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> result.push(ch)</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> state == state_key</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> inside_tags &gt; 0</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> case '{}' inside $ { }</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> inside_tags--</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> key.push(ch)</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> keyOrCode = key.join('')</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> keyOrCode.replace(/\s/g,'').length == 0</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> case empty </span><span class="pp-kwd">${</span><span class="pp-expr"></span><span class="pp-kwd">}</span><span class="pp-pln"> - is ok do not replace</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> result.push('</span><span class="pp-kwd">${</span><span class="pp-expr"></span><span class="pp-kwd">}</span><span class="pp-pln">')</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> isCompile</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> result.push("' + " + keyOrCode + " + '")</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> replacer</span><span class="pp-pln">,</span><span class="pp-arg">  ittf.interpolate </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> evalKeyOrCode(keyOrCode, jsWizziContext)</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> result.push(replacer)</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> state = state_text</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> state == state_tag</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> case strange sequence '$}' but ok</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> result.push('$}')</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> state = state_text</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> state == state_text</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> isCompile && ch === "'"</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> result.push('\\')</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> result.push(ch)</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> state == state_key</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> key.push(ch)</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> state == state_tag</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> case sequence '$*' is text</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> result.push('$')</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> isCompile && ch === "'"</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> result.push('\\')</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> result.push(ch)</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> state = state_text</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> check for unclosed macros</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> state == state_key</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> 16/11/17 _ result.push('</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> result.push('</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> state == state_tag</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> result.push('$')</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> isCompile</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> result.push("'")</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> result.join('')</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> evalKeyOrCode</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> keyOrCode</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> jsWizziContext</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.loader.ittfInterpolate.evalKeyOrCode: ', keyOrCode</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> stm</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">            </span><span class="pp-tag">iif</span><span class="pp-pln"> keyOrCode.indexOf('return ') &gt; -1</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                </span><span class="pp-tag">then</span><span class="pp-pln"> 'var _____result = function dummy() { ' + keyOrCode + ' }();'</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                </span><span class="pp-tag">else</span><span class="pp-pln"> 'var _____result = ' + keyOrCode + ';'</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> notUsed</span><span class="pp-pln">,</span><span class="pp-arg">  ittf.interpolate.evalKeyOrCode </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsWizziRunner.run(stm, jsWizziContext)</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> jsWizziContext.getValue('_____result')</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = interpolate</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d59">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/liner_save.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.liner</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Reads an IttfDocument and extract an array of line descriptions</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string textContent</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> # The text content of the IttfDocument</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { ittfDocumentData</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string sourceKey</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> # The IttfDocument key generated by the loadHistory</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Output</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> lines:Array of</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> line : {</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> indent: Number,</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> name: String,</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> value: String, // always trimmed</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> row: Number,</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> col: Number,</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> sourceKey: String,</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> tagSuffix: undefined || '(',</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> hasMacro: Boolean</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> }</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Ittf commands for comments</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $ and $ ... singleline comment</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $ and * ... * and $ multiline comment</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Comment states</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 0 = no comment seen</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 1 = seen char $ could be first char of comment</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 2 = seen chars $ and * we are inside multiline comments</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 3 = seen chars $ and * ... and *  could be first char of end of multiline comments</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 21 = seen chars $ and $ we are inside singleline comment</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Es6 macro states</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 0 = no macro seen</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 1 = seen char ` we are inside template</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 2 = seen escape char inside a template, the next ` char does not close the macro string</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 10 = seen char $ inside a template could be start of macro</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> COMMENT</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> NONE 0</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> NONE_SEEN_DOLLAR 1</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> MULTI_LINE 2</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> MULTI_LINE_SEEN_ASTER 3</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> SINGLE_LINE 21</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MACRO</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> NONE 0</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> INSIDE_TEMPLATE 1</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> INSIDE_TEMPLATE_SEEN_ESCAPE 2</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> INSIDE_TEMPLATE_SEEN_DOLLAR 10</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> CP</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> DOLLAR 36</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> ASTER 42</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> SLASH 92</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> SINGLE_QUOTE 39</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> DOUBLE_QUOTE 34</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> TAB 9</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> LF 10</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> CR 13</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> SPACE 32</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> textContent</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ittfDocumentData</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> sourceKey = ittfDocumentData.sourceKey</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> lines</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> leadingWhiteSpaces = 0</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> line = null</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> linepos = 1</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> lineHasMacro = false</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> colpos = 0</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> commentState = COMMENT.NONE</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> macroState = MACRO.NONE</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> quote = null</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> TODO ensure textContent is red as utf-8 and avoid this</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> chunk = textContent.toString('utf-8')</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> ch</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> chUni</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> i</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> l = chunk.length</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> TODO replace ch with chUni</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> i = 0; i &lt; l; i++</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ch = chunk[i]</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> chUni = chunk.charCodeAt(i)</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> cp = (chunk.charAt(index) + chunk.charAt(index + 1)).codePointAt(0)</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> cp &gt; 0xffff</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-mtree.loader.liner.cp &gt; 0xffff'</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> index += 1</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> colpos++</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '\\'</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log '+++++ wizzi-mtree.liner', chunk[i+1], chunk[i+2], chunk[i+3]</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> quote != null</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> quote == ch</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> quote = null</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(ch)</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> commentState == COMMENT.MULTI_LINE $$ 2</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '*'</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> could be start of end of comment</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.MULTI_LINE_SEEN_ASTER $$ 3</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> skip comment char</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '\n'</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> linepos++</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> colpos = 0</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == COMMENT.SINGLE_LINE $$ 21</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '\n'</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> end of line comment</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> delegate end of comment to processMacro</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(ch)</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == COMMENT.MULTI_LINE_SEEN_ASTER $$ 3</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '$'</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> ok, really is end of comment</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.NONE $$ 0</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> no, multi line comments continue</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.MULTI_LINE $$ 2</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> check if it is eol</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '\n'</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> linepos++</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> colpos = 0</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == COMMENT.NONE_SEEN_DOLLAR && ch == '*'</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> ok, really is start of multi line comment</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.MULTI_LINE $$ 2</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == COMMENT.NONE_SEEN_DOLLAR && ch == '$'</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> ok, is a single line comment</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.SINGLE_LINE $$ 21</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == COMMENT.NONE_SEEN_DOLLAR && ch != '*'</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> no, it was not a comment, reset</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.NONE $$ 0</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro('$')</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(ch)</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == COMMENT.NONE && ( ch == '"' || ch == "'" )</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> start of literal</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> quote = ch</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(ch)</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == COMMENT.NONE && ch == '$'</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> could be start of comment</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.NONE_SEEN_DOLLAR $$ 1</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> ch == '\\' && i+3 &lt; l && chunk[i+1] == '$' && chunk[i+2] == '\\' && chunk[i+3] == '{'</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processChar('$')</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processChar('{')</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> i = i +3</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(ch)</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (line.value) !== 'undefined'</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> line.value = line.value.trim()</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> line.hasMacro = lineHasMacro</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'last push line', line</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> lines.push(line)</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> lineHasMacro = false</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> lines</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> processMacro</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> ch</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> macroState == MACRO.INSIDE_TEMPLATE_SEEN_ESCAPE $$ 2</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> remove escape state</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.INSIDE_TEMPLATE $$ 1</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(ch)</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, ch</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> macroState == MACRO.INSIDE_TEMPLATE_SEEN_DOLLAR $$ 10</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '{'</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> ok - really it was a start of macro</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> Alt+146 = Ã†</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processChar('Ã†')</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processChar('{')</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> lineHasMacro = true</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> no - it was not a start of macro</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processChar('$')</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(ch)</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.INSIDE_TEMPLATE $$ 1</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, ch</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> chUni == 96</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> macroState &gt; MACRO.NONE $$ 0</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.NONE $$ 0</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(ch)</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, ch</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.INSIDE_TEMPLATE $$ 1</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(ch)</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, ch</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> macroState == MACRO.INSIDE_TEMPLATE $$ 1</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '$'</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> could be start of macro</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.INSIDE_TEMPLATE_SEEN_DOLLAR $$ 10</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, ch</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">                            </span><span class="pp-tag">elif</span><span class="pp-pln"> ch == '\\'</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> could be an escape of a template start inside a template</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.INSIDE_TEMPLATE_SEEN_ESCAPE $$ 2</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(ch)</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, ch</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'process char macroState', macroState, ch</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(ch)</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(ch)</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> processChar</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> ch</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '\n'</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (line.value) !== 'undefined'</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value = line.value.trim()</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line.hasMacro = lineHasMacro</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> lines.push(line)</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line = null</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> lineHasMacro = false</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> Allow blank line. Do nothing</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> leadingWhiteSpaces = 0</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> colpos = 0</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> linepos++</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.NONE</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> commentState != COMMENT.MULTI_LINE $$ 2</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.NONE $$ 0</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> ch == '\r'</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> [' ', '\t'].indexOf(ch) !== -1</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> ch == '\t'</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> colpos += 3</span></div><div class="L8"><span class="pp-ln"> 228 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L9"><span class="pp-ln"> 229 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (line.value) == 'undefined'</span></div><div class="L0"><span class="pp-ln"> 230 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value = ''</span></div><div class="L1"><span class="pp-ln"> 231 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 232 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value += ch</span></div><div class="L3"><span class="pp-ln"> 233 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln"> 234 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> leadingWhiteSpaces += ch == ' ' ? 1 : 4</span></div><div class="L5"><span class="pp-ln"> 235 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> ['('].indexOf(ch) !== -1</span></div><div class="L6"><span class="pp-ln"> 236 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L7"><span class="pp-ln"> 237 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (line.value) == 'undefined'</span></div><div class="L8"><span class="pp-ln"> 238 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.tagSuffix = ch</span></div><div class="L9"><span class="pp-ln"> 239 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value = ''</span></div><div class="L0"><span class="pp-ln"> 240 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 241 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value += ch</span></div><div class="L2"><span class="pp-ln"> 242 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 243 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line =</span></div><div class="L4"><span class="pp-ln"> 244 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln"> 245 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> indent leadingWhiteSpaces / 4</span></div><div class="L6"><span class="pp-ln"> 246 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name ch</span></div><div class="L7"><span class="pp-ln"> 247 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> row linepos</span></div><div class="L8"><span class="pp-ln"> 248 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> col colpos</span></div><div class="L9"><span class="pp-ln"> 249 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey sourceKey</span></div><div class="L0"><span class="pp-ln"> 250 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 251 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L2"><span class="pp-ln"> 252 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(line.value) == 'undefined'</span></div><div class="L3"><span class="pp-ln"> 253 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.name += ch</span></div><div class="L4"><span class="pp-ln"> 254 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 255 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value += ch</span></div><div class="L6"><span class="pp-ln"> 256 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 257 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line =</span></div><div class="L8"><span class="pp-ln"> 258 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln"> 259 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> indent leadingWhiteSpaces / 4</span></div><div class="L0"><span class="pp-ln"> 260 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name ch</span></div><div class="L1"><span class="pp-ln"> 261 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> row linepos</span></div><div class="L2"><span class="pp-ln"> 262 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> col colpos</span></div><div class="L3"><span class="pp-ln"> 263 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey sourceKey</span></div><div class="L4"><span class="pp-ln"> 264 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L5"><span class="pp-ln"> 265 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'line.name, value', line.name, line.value</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d60">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/liner.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.liner</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Reads an IttfDocument and extract an array of line descriptions</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string textContent</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> # The text content of the IttfDocument</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { ittfDocumentData</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string sourceKey</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> # The IttfDocument key generated by the loadHistory</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Output</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> lines:Array of</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> line : {</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> indent: Number,</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> name: String,</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> value: String, // always trimmed</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> row: Number,</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> col: Number,</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> sourceKey: String,</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> tagSuffix: undefined || '(',</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> hasMacro: Boolean</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> }</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Ittf commands for comments</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $ and $ ... singleline comment</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $ and * ... * and $ multiline comment</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Comment states</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 0 = no comment seen</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 1 = seen char $ could be first char of comment</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 2 = seen chars $ and * we are inside multiline comments</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 3 = seen chars $ and * ... and *  could be first char of end of multiline comments</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 21 = seen chars $ and $ we are inside singleline comment</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Es6 macro states</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 0 = no macro seen</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 1 = seen char ` we are inside template</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 2 = seen escape char inside a template, the next ` char does not close the macro string</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 10 = seen char $ inside a template could be start of macro</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> COMMENT</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> NONE 0</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> NONE_SEEN_DOLLAR 1</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> MULTI_LINE 2</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> MULTI_LINE_SEEN_ASTER 3</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> SINGLE_LINE 21</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> https://hacks.mozilla.org/2015/05/es6-in-depth-template-strings-2/</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MACRO</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> NONE 0</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> INSIDE_TEMPLATE 1</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> INSIDE_TEMPLATE_SEEN_ESCAPE 2</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> INSIDE_TEMPLATE_SEEN_DOLLAR 10</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> CP</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> TAB 9</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> LF 10</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> CR 13</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> SPACE 32</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> DOLLAR 36</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> ASTER 42</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> SLASH 92</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> OPEN_PAREN 40</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> OPEN_GRAPH 123</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> CLOSE_GRAPH 125</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> SINGLE_QUOTE 39</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> DOUBLE_QUOTE 34</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> BACKTICK 96</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> MACRO_REPLACE 198</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> textContent</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ittfDocumentData</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> sourceKey = ittfDocumentData.sourceKey</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> lines</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> leadingWhiteSpaces = 0</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> line = null</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> linepos = 1</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> lineHasMacro = false</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> colpos = 0</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> commentState = COMMENT.NONE</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> macroState = MACRO.NONE</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> quote = null</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> TODO ensure textContent is red as utf-8 and avoid this</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> chunk = textContent.toString('utf-8')</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> ch</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> cp</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> chUni</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> i</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> l = chunk.length</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> TODO replace ch with chUni</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> i = 0; i &lt; l; i++</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ch = chunk[i]</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> chUni = chunk.charCodeAt(i)</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> i &lt; l - 1</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> cp = (chunk.charAt(i) + chunk.charAt(i + 1)).codePointAt(0)</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> i &lt; l</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> cp = chunk.charAt(i).codePointAt(0)</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                    </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error('wizzi-mtree.loader.liner index of chunk out of range: ' + chunk)</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> cp &gt; 0xffff</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-mtree.loader.liner.cp &gt; 0xffff'</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> i += 1</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> colpos++</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.SLASH</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log '+++++ wizzi-mtree.liner', chunk[i+1], chunk[i+2], chunk[i+3]</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                </span><span class="pp-kwd">$$</span><span class="pp-pln"> log 'liner', ch, cp, commentState, quote</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> quote != null</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> quote == cp</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> quote = null</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(cp)</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> commentState == COMMENT.MULTI_LINE</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.ASTER</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> could be start of end of comment</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.MULTI_LINE_SEEN_ASTER</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> skip comment char</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.LF</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> linepos++</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> colpos = 0</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == COMMENT.SINGLE_LINE</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.LF</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> end of line comment</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> delegate end of comment to processMacro</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(cp)</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == COMMENT.MULTI_LINE_SEEN_ASTER</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.DOLLAR</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> ok, really is end of comment</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.NONE</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> no, multi line comments continue</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.MULTI_LINE</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> check if it is eol</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.LF</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> linepos++</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> colpos = 0</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == COMMENT.NONE_SEEN_DOLLAR</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.ASTER</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> ok, is start of multi line comment</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.MULTI_LINE</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                        </span><span class="pp-tag">elif</span><span class="pp-pln"> cp == CP.DOLLAR</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> ok, is a single line comment</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.SINGLE_LINE</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> no, it was not a comment, reset</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.NONE</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(CP.DOLLAR)</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(cp)</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == COMMENT.NONE && ( cp == CP.SINGLE_QUOTE || cp == CP.DOUBLE_QUOTE )</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> start of literal</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> a literal suspend comments strip</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> comment delimiters inside quotes are normal characters.</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> quote = cp</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(cp)</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> commentState == COMMENT.NONE && cp == CP.DOLLAR</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> could be start of comment</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.NONE_SEEN_DOLLAR</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> cp == CP.SLASH && i+3 &lt; l && chunk[i+1] == '$' && chunk[i+2] == '\\' && chunk[i+3] == '{'</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(CP.DOLLAR)</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(CP.OPEN_GRAPH)</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> i = i +3</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processMacro(cp)</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (line.value) !== 'undefined'</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> line.value = line.value.trim()</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> line.hasMacro = lineHasMacro</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'last push line', line</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> lines.push(line)</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> lineHasMacro = false</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> lines</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> processMacro</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> cp</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> macroState == MACRO.INSIDE_TEMPLATE_SEEN_ESCAPE</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> remove escape state</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.INSIDE_TEMPLATE</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(cp)</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, String.fromCodePoint(cp)</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> macroState == MACRO.INSIDE_TEMPLATE_SEEN_DOLLAR</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.OPEN_GRAPH</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> ok - really it was a start of macro</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> Alt+146 = Ã†</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(CP.MACRO_REPLACE)</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(CP.OPEN_GRAPH)</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> lineHasMacro = true</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> no - it was not a start of macro</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(CP.DOLLAR)</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(cp)</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.INSIDE_TEMPLATE</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, String.fromCodePoint(cp)</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.BACKTICK</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> macroState &gt; MACRO.NONE</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.NONE</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(cp)</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, String.fromCodePoint(cp)</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.INSIDE_TEMPLATE</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(cp)</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, String.fromCodePoint(cp)</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> macroState == MACRO.INSIDE_TEMPLATE</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.DOLLAR</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> could be start of macro</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.INSIDE_TEMPLATE_SEEN_DOLLAR</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, String.fromCodePoint(cp)</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">                            </span><span class="pp-tag">elif</span><span class="pp-pln"> cp == CP.SLASH</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> could be an escape of a template start inside a template</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.INSIDE_TEMPLATE_SEEN_ESCAPE</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(cp)</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'macroState', macroState, String.fromCodePoint(cp)</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'process char macroState', macroState, String.fromCodePoint(cp)</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(cp)</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> processChar(cp)</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> processChar</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> cp</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.LF</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (line.value) !== 'undefined'</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value = line.value.trim()</span></div><div class="L8"><span class="pp-ln"> 228 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line.hasMacro = lineHasMacro</span></div><div class="L9"><span class="pp-ln"> 229 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> lines.push(line)</span></div><div class="L0"><span class="pp-ln"> 230 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line = null</span></div><div class="L1"><span class="pp-ln"> 231 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> lineHasMacro = false</span></div><div class="L2"><span class="pp-ln"> 232 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 233 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> Allow blank line. Do nothing</span></div><div class="L4"><span class="pp-ln"> 234 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> leadingWhiteSpaces = 0</span></div><div class="L5"><span class="pp-ln"> 235 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> colpos = 0</span></div><div class="L6"><span class="pp-ln"> 236 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> linepos++</span></div><div class="L7"><span class="pp-ln"> 237 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> macroState = MACRO.NONE</span></div><div class="L8"><span class="pp-ln"> 238 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> quote = null</span></div><div class="L9"><span class="pp-ln"> 239 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> commentState != COMMENT.MULTI_LINE</span></div><div class="L0"><span class="pp-ln"> 240 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> commentState = COMMENT.NONE</span></div><div class="L1"><span class="pp-ln"> 241 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> cp == CP.CR</span></div><div class="L2"><span class="pp-ln"> 242 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> [CP.SPACE, CP.TAB].indexOf(cp) !== -1</span></div><div class="L3"><span class="pp-ln"> 243 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.TAB</span></div><div class="L4"><span class="pp-ln"> 244 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> colpos += 3</span></div><div class="L5"><span class="pp-ln"> 245 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L6"><span class="pp-ln"> 246 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (line.value) == 'undefined'</span></div><div class="L7"><span class="pp-ln"> 247 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value = ''</span></div><div class="L8"><span class="pp-ln"> 248 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 249 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value += String.fromCodePoint(cp)</span></div><div class="L0"><span class="pp-ln"> 250 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 251 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> leadingWhiteSpaces += (cp == CP.SPACE ? 1 : 4)</span></div><div class="L2"><span class="pp-ln"> 252 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 253 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L4"><span class="pp-ln"> 254 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(line.value) == 'undefined'</span></div><div class="L5"><span class="pp-ln"> 255 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> cp == CP.OPEN_PAREN</span></div><div class="L6"><span class="pp-ln"> 256 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> line.tagSuffix = String.fromCodePoint(cp)</span></div><div class="L7"><span class="pp-ln"> 257 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> line.value = ''</span></div><div class="L8"><span class="pp-ln"> 258 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 259 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> line.name += String.fromCodePoint(cp)</span></div><div class="L0"><span class="pp-ln"> 260 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 261 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> line.value += String.fromCodePoint(cp)</span></div><div class="L2"><span class="pp-ln"> 262 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln"> 263 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line =</span></div><div class="L4"><span class="pp-ln"> 264 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln"> 265 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> indent leadingWhiteSpaces / 4</span></div><div class="L6"><span class="pp-ln"> 266 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name String.fromCodePoint(cp)</span></div><div class="L7"><span class="pp-ln"> 267 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> row linepos</span></div><div class="L8"><span class="pp-ln"> 268 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> col colpos</span></div><div class="L9"><span class="pp-ln"> 269 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey sourceKey</span></div><div class="L0"><span class="pp-ln"> 270 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L1"><span class="pp-ln"> 271 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'line.name, value', line.name, line.value</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d61">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/loadHistory.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.loadHistory</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrickProvider = null</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> One mTree loading uses 1 mTreeBrickProvider and 1 loadHistory.</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The loadHistory keeps tracks of the ittf documents loaded</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> for building one mTree. Once loaded, ittf documents become mTreeBricks,</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> that may be reused many times for the same mTree and always are cloned.</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Every cloned mTreeBrick has its own evalContext and</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> the load context assigns source keys to ittf documents, loaded once, and</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> mTreeBrick keys to every cloned mTreeBricks.</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> It also checks the mix and include call chain to prevent recursion.</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> ittfDocumentDatas: Map</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> key: sourceKey</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> item object:</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string ittfDocumentUri</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string content</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string sourceKey</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> mTreeBrickDatas: Map</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> key: brickKey</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> item object:</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string ittfDocumentUri</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string schema</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { mTreeBrick (cloned)      // mTreeBrick is created by the mTreeBrickProvider</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $mixerBrickKey:String    // key of the mixer mTreeBrickData</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> // set by the lib/loader/mixer</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $args:String             // args of the mixin call</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> // set by the lib/loader/mixer</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $params:String           // params received by the mixed mTreeBrick</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> byRefParams:Array        // params passed by reference</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> calcParamValues:Function  // calculates the values</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { evalContext</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string sourceKey</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string brickKey</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> [ callChain</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> {</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string mixerUri</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string mixedUri</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">    </span><span class="pp-tag">wz-class</span><span class="pp-pln"> LoadHistory</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.__type = 'LoadHistory'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.ittfDocumentDatas =</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.mTreeBrickDatas =</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.sourceCount = 0</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.modelCount = 0</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.nodeCount = 0</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.callChain</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> addIttfDocument</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> textContent</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> sourceKey = 'f' + ++this.sourceCount</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ittfDocumentData</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri ittfDocumentUri</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey sourceKey</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> content textContent</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.ittfDocumentDatas[sourceKey] = ittfDocumentData</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ittfDocumentData</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> addMTreeBrick</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> schema</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mTreeBrickCloned</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> sourceKey = this.getSourceKey(ittfDocumentUri)</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> options.include</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey sourceKey</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> brickKey options.includerBrickKey</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> brickKey = 'f' + ++this.modelCount</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBrickData</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri ittfDocumentUri</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> schema schema</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey sourceKey</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> brickKey brickKey</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrick mTreeBrickCloned</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> evalContext null</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.mTreeBrickDatas[brickKey] = mTreeBrickData</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> mTreeBrickData</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getMTreeBrickData</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> brickKey</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.mTreeBrickDatas[brickKey]</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getIttfDocumentUri</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> sourceKey</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ittfDocumentData = this.ittfDocumentDatas[sourceKey]</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> ittfDocumentData</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> ittfDocumentData.ittfDocumentUri</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span><span class="pp-pln"> 'Source ittfDocumentUri unknown'</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getSourceKey</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var k in this.ittfDocumentDatas</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> this.ittfDocumentDatas[k].ittfDocumentUri === ittfDocumentUri</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> k</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getIttfDocuments</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var k in this.ittfDocumentDatas</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> ittfDocumentData = this.ittfDocumentDatas[k]</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret[this.getIttfDocumentUri(ittfDocumentData.sourceKey)]</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey ittfDocumentData.sourceKey</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getNewNodeId</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ++this.nodeCount</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> enterFragmentCall</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mixerUri</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mixedUri</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.callChain.push</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mixerUri mixerUri</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mixedUri mixedUri</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> exitFragmentCall</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.callChain.pop()</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> checkForRecursion</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; this.callChain.length; i++</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> this.callChain[i].mixerUri == this.callChain[i].mixedUri</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                </span><span class="pp-tag">for</span><span class="pp-pln"> var j = 0; j &lt; this.callChain.length; j++</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> ((this.callChain[j].mixerUri == this.callChain[i].mixedUri) && (this.callChain[j].mixedUri == this.callChain[i].mixerUri))</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _old_getLoadStateAsync_VIA</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">            </span><span class="pp-tag">static</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> loadContext</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !MTreeBrickProvider</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> MTreeBrickProvider = require('./mTreeBrickProvider')</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> createdProvider</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> callback(err)</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext loadContext</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> provider createdProvider</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> getPrimaryMTreeBrick</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span><span class="pp-pln"> createdProvider.getPrimaryMTreeBrick()</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> callChain</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                                </span><span class="pp-tag">[</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> checkForLoops</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                                    </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; this.callChain.length; i++</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                                        </span><span class="pp-tag">if</span><span class="pp-pln"> this.callChain[i].mixer == this.callChain[i].mixed</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                                            </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                                        </span><span class="pp-tag">for</span><span class="pp-pln"> var j = 0; j &lt; this.callChain.length; j++</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                                            </span><span class="pp-tag">if</span><span class="pp-pln"> ((this.callChain[j].mixer == this.callChain[i].mixed) && (this.callChain[j].mixed == this.callChain[i].mixer))</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                                                </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">                                    </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d62">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/mixer.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.mixer</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> path = require('path')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> assert = require('assert')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> async = require('async')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../errors')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> includer = require('./includer')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> utilnode = require("../util/node")</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> mTreePiece</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> mTreeBrickProvider</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> assert.equal(mTreeBrickProvider.__type, 'MTreeBrickProvider', 'param mTreeBrickProvider must be of type MTreeBrickProvider')</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> mTreePiece.mixed = false</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> mixNodeCollection</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreePiece.nodes</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> mixedNodes</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> mTreePiece.nodes = mixedNodes</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, mTreePiece)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> mixNodeCollection</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> mixerNodes</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> resultingNodes_Parent</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mixedNodesAccumulator</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> len = mixerNodes.length</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">function</span><span class="pp-pln"> repeater</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> index === len</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, mixedNodesAccumulator)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> mixNodeIfTheCase</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixerNodes[index]</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> mixedNodes</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> appendItemsToCollection(mixedNodes, mixedNodesAccumulator, resultingNodes_Parent)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(index + 1)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(0)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> mixerNode: Object - may contain a mixin call if name ends with '('; example: class()</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> If the mixerNode is a mixin call</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> fetches the mixed document and mixes it</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> else</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> go down and execute the mix operation on the children nodes of the mixerNode.</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> mixNodeIfTheCase</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> mixerNode</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> isMixinCall = false</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> mixerNode.tagSuffix === '('</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> utilnode.isParentOfName(mixerNode, ['$', '$global']) == false</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> isMixinCall = true</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> mixerNode.name += mixerNode.tagSuffix</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> mixerNode.tagSuffix = null</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> isMixinCall</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> mixerNode.name is the name of the mixin to include (IttfFragment)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> mixerNode.value is a comma separated list of arguments of the mixin call</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> mixerNode.model.uri is the mixer IttfDocument uri; its folder is the base path</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> for resolving the uri of the mixin</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> args = mixerNode.value.trim()</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> args.substr(-1, 1) === ')'</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> mixerNode.value = args.substring(0, args.length - 1)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> mixeruri = mixerNode.model.uri</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> mixerbasedir = path.dirname(mixeruri)</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                    </span><span class="pp-tag">##</span><span class="pp-pln"> load the parsed mTreeBrickModel of the mixin (we name it 'the mixed')</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBrickProvider.get</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> from 'store'</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> basedir mixerbasedir</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> relpath mixerNode.name</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d87">f_cb_no_err(</span><span class="pp-arg"> mixedNodifiedMTree </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-mtree.loader.mixer.err', err</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                                </span><span class="pp-tag">log</span><span class="pp-pln"> 'wizzi-mtree.loader.mixer.mixerNode', mixerNode.name, mixerNode.value</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> err</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBrickProvider.enterFragmentCall</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mixeruri</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mixedNodifiedMTree.uri</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> mTreeBrickProvider.checkForRecursion()</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                                </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidIttfError'</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'default'</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Recursive mixin or include: ' + mixerNode.name</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> mixerNode</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> before mixing the mixedNodifiedMTree</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> resolve its eventual includes</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> includer</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mixedNodifiedMTree</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickProvider</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> mixedIncludedMTree </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                                    </span><span class="pp-tag">#</span><span class="pp-pln"> now mix the mixed root nodes</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> mixCalleeRootNodes</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixedIncludedMTree.nodes</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixerNode</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> mixedNodes</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeBrickProvider.exitFragmentCall()</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, mixedNodes)</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> mixerNode.name === '$.'</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> mixerNode is a TEXT CONTAINER (CDATA)</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> mixerNode.children.length &gt; 0</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> mixerNode.value = utilnode.nodeToTextLine(mixerNode)</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> mixerNode.children = []</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                            </span><span class="pp-tag">[</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mixerNode</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> mixerNode IS NOT a mixin call</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> but its children could contain mixin calls</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> so analyze and mix its children before returning it</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> mixNodeCollection</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixerNode.children</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixerNode</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> mixedNodes</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> mixerNode.children = mixedNodes</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> return a node collection with mixerNode as the only element</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                                    </span><span class="pp-tag">[</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixerNode</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> mixCalleeRootNodes</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> mixedRootNodes</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> mixerNode</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                </span><span class="pp-tag">var</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                    </span><span class="pp-tag">decl</span><span class="pp-pln"> mixedRootNode</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                    </span><span class="pp-tag">decl</span><span class="pp-pln"> len = mixedRootNodes.length</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                    </span><span class="pp-tag">decl</span><span class="pp-pln"> mixedNodesAccumulation</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                </span><span class="pp-tag">#</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> The mixedNodifiedMTree may contain multiple root nodes.</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> The $group command is used as the root node of an IttfDocument</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> when multiple root nodes have to be declared.</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> So the repeater function execute the mixup of every child node of the mixedNodifiedMTree</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> and accumulates the resulting mixed nodes in the var "mixedNodesAccumulation"</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                </span><span class="pp-tag">function</span><span class="pp-pln"> repeater</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> index</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> index === len</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> we are done, return the result</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> firstSemanticNode = getFirstSemanticNode(mixedNodesAccumulation)</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> firstSemanticNode != null</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.mixer.firstSemanticNode' , firstSemanticNode.name, firstSemanticNode.value</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> firstSemanticNode.__firstOfMixedNodes = true</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, mixedNodesAccumulation)</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> mixedRootNode = mixedRootNodes[index]</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> TODO to set $args and $mixerBrickKey on mixedRootNodes should be the same and more clear</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> THEY ARE NOT SET ON ROOT NODES BUT ON THE MODEL</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> sets the mixer args for the evaluation step (see ./evaluator.js)</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> mixedRootNode.model.$args = mixerNode.value</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> mixedRootNode.model.$mixerBrickKey = mixerNode.model.brickKey</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> mTreePiece.mixed = true</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> search a default hook inside the mixedRootNode</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> hook = utilnode.findIttfCommand(mixedRootNode, 'default', 'hook')</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> The mixerNode.children, when mixed,</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> must be added to each mixedRootNode.</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> mixNodeCollection</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixerNode.children</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixedRootNode</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> mixedNodes</span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> hook</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> A default hook was found,</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> the mixer node children must replace the $hook node;</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> utilnode.replace will set the parent of the nodes of</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> mixedNodes to the parent of hook.</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> utilnode.replace(hook, mixedNodes)</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> A default hook was not found,</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> the mixer node children must be</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> appended to the last child of the mixedRootNode;</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> the mixedRootNode becomes the parent of the mixer node children.</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                                </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in mixedNodes</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> mixedRootNode.children.push</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> It seams we are done, but there is a notch.</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> mixedRootNode could contain itself a mixin call.</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> It must be analyzed and mixed if the case.</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> Set the mixerNode.parent as its parent</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> and add it to the resultMixedNodes collection.</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> mixNodeIfTheCase</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mixedRootNode</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> mixedNodes</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> appendItemsToCollection</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixedNodes</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixedNodesAccumulation</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> mixerNode.parent</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> process.nextTick</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">                                        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(index + 1)</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> repeater(0)</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">            </span><span class="pp-tag">function</span><span class="pp-pln"> appendItemsToCollection</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> items</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> collection</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> parent</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">                </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in items</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parent</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> item.parent = parent</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> collection.push(item)</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> getFirstSemanticNode</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> nodes</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> node in nodes</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> node.name[0] != '$' || ((node.name === '$' || node.name === '$global') && node.value && node.value.length &gt; 0)</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> node</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> ret = getFirstSemanticNode(node.children)</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ret</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d90"> local_error</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d63">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/mTreeBrick.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.mTreeBrick</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> An mTreeBrick is a nodified ittf document.</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> In the build-up of an mTree, the same mTreeBrick can be mixed</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> or included many times, so it is created once then cloned.</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { mTreeBrick</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string uri       // The location of the source IttfDocument.</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string schema    // The source IttfDocument schema.</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { loadHistory    // The loadHistory object</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> [ lines          // parsed lines of source text</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> [ nodes          // nodified lines of source text</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string sourceKey // key of the source info of the IttfDocument</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string brickKey  // key of the cloned mTreeBrick</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> ... these are set by the mixer, on the cloned object</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> boolean mixed          // true if has been mixed</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string $mixerBrickKey  // the brickKey of the mTreeBrick of the calling node (mixer)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string $args           // the node-value of the mixer node</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string $argArray       // the $arg array of the mixer node</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> ... these are set by the nodifier on the original mtree, then cloned</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> string $params:        // the node-value of the $params node, if declared</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Methods</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> load                // apply liner + nodifier to a Ittf source text</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> setKeys</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> clone</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> calcParamValues</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> toIttf</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> toText</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> dump</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> path = require('path')</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../errors')</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> types = require('../util/types')</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> liner = require('./liner')</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> nodifier = require('./nodifier')</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">    </span><span class="pp-tag">wz-class</span><span class="pp-pln"> MTreeBrick</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> loadHistory</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.uri = uri</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.loadHistory = loadHistory</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> load</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> ittfSourceTextContent</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> ittfDocumentData</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">string</span><span class="pp-pln"> sourceKey</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> lines</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> liner(ittfSourceTextContent, ittfDocumentData)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d84">checked_call_return(</span><span class="pp-arg"> nodes</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> nodifier(lines, this)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.nodes = nodes</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> setKeys</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> sourceKey</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> brickKey</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.sourceKey = sourceKey</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.brickKey = brickKey</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> clone</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> clonedModel</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">new</span><span class="pp-pln"> MTreeBrick</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> this.uri</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> this.loadHistory</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.$params</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> clonedModel.$params = this.$params</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> clonedModel.nodes = this._cloneNodes(this.nodes, null, clonedModel)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> clonedModel</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> _cloneNodes</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> nodes</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> parent</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> clonedModel</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> self = this</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> clnode</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> clnodes</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> node in nodes</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> clnode =</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> id self.loadHistory.getNewNodeId()</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parsedId node.id</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> name node.name</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> value node.value</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> tagSuffix node.tagSuffix</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> row node.row</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> col node.col</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey node.sourceKey</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> hasMacro node.hasMacro</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> parent parent</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> model clonedModel</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> clnode.children = self._cloneNodes(node.children, clnode, clonedModel)</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> clnodes.push(clnode)</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> clnodes</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="unknown"> mtreeBrick/calcParamValues</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> dump</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> evaluated</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> buffer</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> ctx</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> evaluated evaluated</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> loadHistory this.loadHistory</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.nodes.forEach</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> _dumpNodeDeep(node, 1, buffer, ctx)</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> buffer.join('\n')</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> toIttf</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> buffer</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.nodes.forEach</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> _toIttfNodeDeep(node, 0, buffer)</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> buffer.join('\n')</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> toText</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> buffer</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.nodes.length == 1</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> root = this.nodes[0]</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                </span><span class="pp-tag">foreach</span><span class="pp-pln"> child in root.children</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> _toTextNodeDeep(child, 0, buffer)</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> buffer.join('\n')</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _dumpNodeDeep</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> indent</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> buffer</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ctx.evaluated && node.u</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> sourceUri = ctx.loadHistory.ittfDocumentDatas[node.u].ittfDocumentUri</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> sourceUriName = path.basename(sourceUri)</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> sourceUriFolder = path.basename(path.dirname(sourceUri))</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> buffer.push</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> spaces(indent * 2) + node.n + ' ' + (node.v || '') + '    r' + node.r + ',c' + node.c + '    source:  ' + sourceUriFolder + '/' + sourceUriName</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> buffer.push</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> spaces(indent * 2) + node.name + ' ' + (node.value || '') + '  r' + node.row + ',c' + node.col + '    ids: ' + node.parsedId + ' ' + node.id + ' brickKey: ' + node.model.brickKey + ' mixed by: ' + (node.model.$mixerBrickKey || 'none')</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.model</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> node.model.$args || node.model.$params</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !ctx[node.model.brickKey]</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> ctx[node.model.brickKey] = node.model</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> buffer.push</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> spaces(indent * 2) + '  -- fragment: ' + node.model.uri</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> buffer.push</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> spaces(indent * 2) + '  -- $args: ' + node.model.$args + ' $params: ' + node.model.$params</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> indent++</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> node.children.forEach</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> n</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> _dumpNodeDeep(n, indent, buffer, ctx)</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _toIttfNodeDeep</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> indent</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> buffer</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.name</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> buffer.push</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> spaces(indent * 4) + node.name + ' ' + (node.value || '')</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> buffer.push</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> spaces(indent * 4) + node.n + ' ' + (node.v || '')</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> indent++</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> child in node.children</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> _toIttfNodeDeep(child, indent, buffer)</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _toTextNodeDeep</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> indent</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> buffer</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> buffer.push</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> spaces(indent * 4) + node.n + ' ' + node.v || ''</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> indent++</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> child in node.children</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> _toTextNodeDeep(child, indent, buffer)</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> spaces</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> num</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> Array(num + 1)</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> join(" ")</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> local_error</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> method</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> message</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> inner</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nodeError = new errors.NodeError(message, node)</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> message = nodeError.message</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d94">r_wz_err(</span><span class="pp-arg"> name</span><span class="pp-pln">,</span><span class="pp-arg">  method</span><span class="pp-pln">,</span><span class="pp-arg">  inner </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> message</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d64">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/mTreeBrickProvider.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.mTreeBrickProvider</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> url</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../errors')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> LoadHistory = require('./loadHistory').LoadHistory</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrick = require('./mTreeBrick').MTreeBrick</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> IttfDocumentFinder = require('./ittfDocumentFinder')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Each mTree loading requires one instance of the MTreeBrickProvider</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> To date there is no global cache for mTrees, but only a cache of</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> mTreeBricks used during a single loading.</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> MTreeBrickProvider</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.__type = 'MTreeBrickProvider'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.bricksCache = {}</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.store = null</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeKind = null</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.uri = null</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.schema = null</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.userId = null</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.documentFinder = null</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.primaryMTreeBrickCloned = null</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.loadHistory = null</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.productionContext = null</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.mTreeBuildUpContext = null</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.sourcePreprocessor = null</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The primary mTreeBrick of an mTree loading</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getPrimaryMTreeBrick</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.primaryMTreeBrickCloned</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The starting point of an mTree loading</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Creates the mTree loadHistory</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Load the primary mTreeBrick form the primary IttfDocument</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> init</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> primaryIttfDocumentUri</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> loadContext</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">{</span><span class="pp-pln"> __ittfDocumentStore</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">{</span><span class="pp-pln"> productionContext</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">{</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">func</span><span class="pp-pln"> sourcePreprocessor</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-tag">optional</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.store = loadContext.__ittfDocumentStore</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> parse the primary IttfDocument Uri and collect</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> infos from the uri</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.store.parseUri</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> primaryIttfDocumentUri</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> parsedUri </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.mTreeBrickProvider.parsedUri', parsedUri</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> that.storeKind = parsedUri.storeKind</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> that.uri = parsedUri.uri || parsedUri.originalUri</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> that.userId = parsedUri.userId</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> that.projectId = parsedUri.projectId</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> that.schema = parsedUri.schema</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> load the document text content</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> that.store.getModelContent</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> that.uri</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d87">f_cb_no_err(</span><span class="pp-arg"> ittfContent </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> err.documentUri = that.uri</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                                </span><span class="pp-tag">#</span><span class="pp-pln"> set err.MTreeBrickProviderStack = (new Error()).stack</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d91">r_cb_err(</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> init helper objects</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> that.documentFinder</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                                </span><span class="pp-tag">new</span><span class="pp-pln"> IttfDocumentFinder</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> that.store</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> that.schema</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> that.loadHistory = new LoadHistory()</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> that.productionContext = loadContext.productionContext</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> that.mTreeBuildUpContext = loadContext.mTreeBuildUpContext</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> that.sourcePreprocessor = loadContext.sourcePreprocessor</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.mTreeBrickProvider.ittfContent', ittfContent</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> load the primary mTreeBrick from the ittf content</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> that.loadMTreeBrickFromSource</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> that.uri</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfContent</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> primaryMTreeBrickCloned </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                                    </span><span class="pp-tag">#</span><span class="pp-pln"> save the cloned primary mTreeBrick on the mTreeBrickProvider instance</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                                    </span><span class="pp-tag">set</span><span class="pp-pln"> that.primaryMTreeBrickCloned = primaryMTreeBrickCloned</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                                    </span><span class="pp-tag">#</span><span class="pp-pln"> callbacks returning the mTreeBrickProvider instance</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, that)</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> Clones, or loads from source, an included or mixed ittf document</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> { options</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> string ittfDocumentUri</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> boolean include</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> // If true the mTreeBrick loaded from the IttfDocument will be included in the includer mTreeBrick</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> // and its scope will become that of the includer (its brickKey will be that of the includer).</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> // A $include command must not have any argument.</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> // An included ittf document must not have params (must not have the $params command).</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> string includerBrickKey</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> string basedir</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> string relpath</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">            </span><span class="pp-tag">#</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> called from</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> ./mtree.load</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> ./includer</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> ./mixer</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> get</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> loadHistory = this.loadHistory</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> productionContext = this.productionContext</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> that = this</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.documentFinder.resolvePath</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> options</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> uri </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.mTreeBrickProvider.path resolved', uri</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBrickCloned = null</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> check cache</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'searching in cache', that.bricksCache, uri</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> cachedMTreeBrick = that.bricksCache[uri]</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> cachedMTreeBrick</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> found in cache, clone it</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> mTreeBrickCloned = cachedMTreeBrick.clone()</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> this is not superflous</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> the productionContext counts the cached used</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> productionContext.addIttfDocument</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> uri</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> cachedMTreeBrick.inputContent</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> adding the mTreeBrickCloned to the loadHistory</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> generates the sourceKey and brickKey</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                        </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBrickData</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> loadHistory.addMTreeBrick</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> uri</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> that.schema</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrickCloned</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> options</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> mTreeBrickCloned.sourceKey = mTreeBrickData.sourceKey</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> mTreeBrickCloned.brickKey = mTreeBrickData.brickKey</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> mTreeBrickCloned.$schema = that.schema</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, mTreeBrickCloned)</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> not found in cache, get the content from the store</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> than load the mTreeBrick from source</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> that.store.getModelContent</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> uri</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> ittfContent </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> that.loadMTreeBrickFromSource</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> uri</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> options</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> ittfContent</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> loadMTreeBrickFromSource</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> options</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> ittfContent</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.productionContext.addIttfDocument</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> uri</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfContent</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.loadHistory.addIttfDocument</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> uri</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfContent</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.sourcePreprocessor</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> TODO save the preprocessed in productionContext and loadHistory</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> or save the sourcePreprocessor function</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ittfContent = this.sourcePreprocessor(ittfContent)</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> Creates the mTreeBrickData object passing</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> null in the mTreeBrick parameter</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> it will be added later if the parameter</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> options.include is false.</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> This because if the mTreeBrick</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> is included it does not have its own evalContext, its nodes become part</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> of the includer, and a cloned mTreeBrick is not needed.</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBrickData</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.loadHistory.addMTreeBrick</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> uri</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> this.schema</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> options</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> newMTreeBrick = new MTreeBrick(uri, this.loadHistory)</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> parses the ittf document content and loads the mTreeBrick</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> frome the ittf node tree.</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d85">checked_call(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> newMTreeBrick.load(ittfContent, mTreeBrickData)</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.mTreeBrickProvider.parsed newMTreeBrick', newMTreeBrick</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> caches the newMTreeBrick</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.bricksCache[uri] = newMTreeBrick</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> clone it</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBrickCloned = newMTreeBrick.clone()</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> set keys</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> mTreeBrickCloned.sourceKey = mTreeBrickData.sourceKey</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> mTreeBrickCloned.brickKey = mTreeBrickData.brickKey</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> mTreeBrickCloned.$schema = this.schema</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !(options.include)</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> mTreeBrickData.mTreeBrick = mTreeBrickCloned</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">            </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'cloned newMTreeBrick', mTreeBrickCloned</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, mTreeBrickCloned)</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> enterFragmentCall</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mixerUri</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mixedUri</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.loadHistory.enterFragmentCall</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mixerUri</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mixedUri</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> exitFragmentCall</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.loadHistory.exitFragmentCall()</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> checkForRecursion</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> this.loadHistory.checkForRecursion()</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Creates an MTreeBrickProvider for loading</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> an IttfDocucument</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> primaryIttfDocumentUri</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> loadContext</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.mTreeBrickProvider.createFromUri', primaryIttfDocumentUri</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> provider = new MTreeBrickProvider()</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> provider.init</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> primaryIttfDocumentUri</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, provider)</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ex.message += '\n creating from uri: ' + primaryIttfDocumentUri</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> ex</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = MTreeBrickProvider</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d65">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/mTreeBuildUpScripter.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.mTreeBuildUpScripter</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> from a composed-MTree</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> write the jsWizziScript that will</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> buildup an evaluated mTree.</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The script will be executed</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> by the JsWizziRunner.</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> interpolate = require('./ittfInterpolate')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> codify</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> nparent</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">var</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> nnode = ++ctx.counter</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">decl</span><span class="pp-pln"> closeBlock = null</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> tag = node.name</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> tag == '$' || tag == '$+'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.brickKey</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> codeBlock(node, jsScriptCoder, ctx)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$global'</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'global'</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.brickKey</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> codeBlock(node, jsScriptCoder, ctx)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.brickKey</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$.'</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext(ctx, null, jsScriptCoder)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> vparent = ('$' + nparent)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> value</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> codifyValue</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.brickKey</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.value</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'string'</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder.length + 1</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.hasMacro</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> vparent + ".v = " + vparent + ".v ? " + vparent + ".v : ''" + ' //' + node.id</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> vparent + '.v += ($.textSep + ' + value + ');' + ' //' + node.id</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$if'</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.brickKey</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.if</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.value</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> closeBlock = '}'</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$else'</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.else(node)</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ctx.brickKey = -1</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> closeBlock = '}'</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$elif'</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.elif</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.value</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ctx.brickKey = - (1)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> closeBlock = '}'</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$while'</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.while</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.value</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ctx.brickKey = - (1)</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> closeBlock = '}'</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$for'</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.brickKey</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.for</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.value</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> closeBlock = '}'</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$for_stop'</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.brickKey</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> items = node.value.split(' ')</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> namevalue = items[0].split(',')</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> name = namevalue[0]</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> value = namevalue[1]</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'var ' + name + ', ' + value + ';' + ' //' + node.id</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.for</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> name + ' in ' + items[2] + ' //' + node.id</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> value + ' = ' + items[2] + '[' + name + '];' + ' //' + node.id</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> closeBlock = '}'</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$foreach'</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.brickKey</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> items = node.value.split(' ')</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.for</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'var i' + nnode + '=0, l' + nnode + ' = ' + items[2] + '.length; i' + nnode + '&lt;l' + nnode + '; i' + nnode + '++'</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'var ' + items[0] + ' = ' + items[2] + '[i' + nnode + '];' + ' //' + node.id</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'var _index = i' + nnode + ';' + ' //' + node.id</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'var _count = ' + items[2] + '.length;' + ' //' + node.id</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> closeBlock = '}'</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$backeach'</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.brickKey</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> items = node.value.split(' ')</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.for</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'var i' + nnode + '=' + items[2] + '.length-1; i' + nnode + '&gt;-1; i' + nnode + '--'</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'var ' + items[0] + ' = ' + items[2] + '[i' + nnode + '];' + ' //' + node.id</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'var _index = i' + nnode + ';' + ' //' + node.id</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'var _count = ' + items[2] + '.length;' + ' //' + node.id</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> closeBlock = '}'</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$virtual'</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">            </span><span class="pp-tag">+</span><span class="pp-pln"> ;</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$function'</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.brickKey</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> params = '$parent'</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.children</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> item.name === '$param'</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> params += ',' + item.value</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w('function ' + node.value + '(' + params + ') {')</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.indent</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.children</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> item.name !== '$param'</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> codify(item, 'parent', jsScriptCoder, ctx)</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.deindent</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w('}');</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ctx.brickKey = -1</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> tag == '$_'</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ctx.brickKey = null</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.brickKey</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> vparent = '$' + nparent</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> args = vparent</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.children</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> item.name === '$@'</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> args += ',' + item.value</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w(node.value + '(' + args + ');');</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ctx.brickKey = null</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ctx</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.brickKey</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ctx.isCompile && node.__firstOfMixedNodes</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '// firstOfMixed ' + node.model.$args + '/' + node.model.$params</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> isCompilePassedParameters</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.calcParamValues(node.model.$args)</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> setJsWizziContext(ctx, null, jsScriptCoder)</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'var $' + nnode + ' = { ' +</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">                    </span><span class="pp-kwd">$$</span><span class="pp-pln"> \b 'n: "' + escapename(tag) + '", ' +</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">                    </span><span class="pp-tag">\b</span><span class="pp-pln"> 'n: ' + codifyValue(node.model.brickKey, tag, 'string', jsScriptCoder.length + 1, node.hasMacro, ctx) + ', ' +</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">                    </span><span class="pp-tag">\b</span><span class="pp-pln"> (node.source ? 'source: ' + escapename(node.source) + ', ' : '') +</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">                    </span><span class="pp-tag">\b</span><span class="pp-pln"> 'v: ' + codifyValue(node.model.brickKey, node.value, 'string', jsScriptCoder.length + 1, node.hasMacro, ctx) + ', ' +</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">                    </span><span class="pp-tag">\b</span><span class="pp-pln"> 'r: ' + node.row + ', ' +</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">                    </span><span class="pp-tag">\b</span><span class="pp-pln"> 'c: ' + node.col + ', ' +</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">                    </span><span class="pp-tag">\b</span><span class="pp-pln"> 's: "' + node.model.brickKey + '", ' +</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">                    </span><span class="pp-tag">\b</span><span class="pp-pln"> 'u: "' + node.sourceKey + '", ' + ' };' + ' //' + node.id</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> vparent = ('$' + nparent)</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '$.a(' + vparent + ', $' + nnode + ', ' + (jsScriptCoder.length + 1) + ');'</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> nparent = nnode</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> tag !== '$' && tag !== '$global' && tag !== '$+'</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.children</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> codify(item, nparent, jsScriptCoder, ctx)</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> closeBlock</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.end()</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ctx.brickKey = -1</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> setJsWizziContext</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> brickKey</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> brickKeyInGlobal</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> ctx.brickKey === brickKey</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> brickKey === null</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w('$.n();')</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> brickKey === 'global'</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w('$.g("' + brickKeyInGlobal + '");')</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w('$.s("' + brickKey + '");')</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> ctx.brickKey = brickKey</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> codifyValue</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> brickKey</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> type</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> line</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> hasMacro</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(value) === 'undefined' || value == null</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> '""'</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> type === 'string'</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> value.indexOf('</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> sHasMacro = hasMacro ? 'true' : 'false'</span></div><div class="L8"><span class="pp-ln"> 228 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ctx.isCompile</span></div><div class="L9"><span class="pp-ln"> 229 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> newValue</span></div><div class="L0"><span class="pp-ln"> 230 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> interpolate</span></div><div class="L1"><span class="pp-ln"> 231 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> value</span></div><div class="L2"><span class="pp-ln"> 232 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 233 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln"> 234 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> isCompile true</span></div><div class="L5"><span class="pp-ln"> 235 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> return '"' + newValue + '"'</span></div><div class="L6"><span class="pp-ln"> 236 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> newValue</span></div><div class="L7"><span class="pp-ln"> 237 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln"> 238 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> '$.ip("' + brickKey + '", ' + escape(value) + ', "' + type + '", ' + line + ', ' + sHasMacro + ')'</span></div><div class="L9"><span class="pp-ln"> 239 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> 23/5/18 return escape(hasMacro ? remacro(value) : value)</span></div><div class="L0"><span class="pp-ln"> 240 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> escape(remacro(value))</span></div><div class="L1"><span class="pp-ln"> 241 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> value</span></div><div class="L2"><span class="pp-ln"> 242 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> codeBlock</span></div><div class="L3"><span class="pp-ln"> 243 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L4"><span class="pp-ln"> 244 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L5"><span class="pp-ln"> 245 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> ctx</span></div><div class="L6"><span class="pp-ln"> 246 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node.name == '$' || node.name == '$global' || node.name == '$+'</span></div><div class="L7"><span class="pp-ln"> 247 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> node.value && node.value.trim().length &gt; 0</span></div><div class="L8"><span class="pp-ln"> 248 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L9"><span class="pp-ln"> 249 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.value</span></div><div class="L0"><span class="pp-ln"> 250 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 251 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> (node.name && (node.name.trim().length &gt; 0))</span></div><div class="L2"><span class="pp-ln"> 252 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> ctx.isCompile && node.__firstOfMixedNodes</span></div><div class="L3"><span class="pp-ln"> 253 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L4"><span class="pp-ln"> 254 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> '// firstOfMixed ' + node.model.$args + '/' + node.model.$params</span></div><div class="L5"><span class="pp-ln"> 255 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log '=========', node.model.calcParamValues(node.model.$args)</span></div><div class="L6"><span class="pp-ln"> 256 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> isCompilePassedParameters</span></div><div class="L7"><span class="pp-ln"> 257 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L8"><span class="pp-ln"> 258 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node.model.calcParamValues(node.model.$args)</span></div><div class="L9"><span class="pp-ln"> 259 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L0"><span class="pp-ln"> 260 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> node.name + ' ' + (node.value || '') + ' //' + node.id</span></div><div class="L1"><span class="pp-ln"> 261 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.children</span></div><div class="L2"><span class="pp-ln"> 262 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> codeBlock(item, jsScriptCoder, ctx)</span></div><div class="L3"><span class="pp-ln"> 263 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> isCompilePassedParameters</span></div><div class="L4"><span class="pp-ln"> 264 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L5"><span class="pp-ln"> 265 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> parameters</span></div><div class="L6"><span class="pp-ln"> 266 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> p in parameters</span></div><div class="L7"><span class="pp-ln"> 267 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> p.type = 'string'</span></div><div class="L8"><span class="pp-ln"> 268 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L9"><span class="pp-ln"> 269 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> p.name + ' = "' + p.value + '";'</span></div><div class="L0"><span class="pp-ln"> 270 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 271 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> jsScriptCoder.w</span></div><div class="L2"><span class="pp-ln"> 272 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> p.name + ' = ' + p.value + ';'</span></div><div class="L3"><span class="pp-ln"> 273 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> escape</span></div><div class="L4"><span class="pp-ln"> 274 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L5"><span class="pp-ln"> 275 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (value) === 'undefined'</span></div><div class="L6"><span class="pp-ln"> 276 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> "null"</span></div><div class="L7"><span class="pp-ln"> 277 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> typeof (value) === 'string'</span></div><div class="L8"><span class="pp-ln"> 278 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> "\"" + escapevalue(value) + "\""</span></div><div class="L9"><span class="pp-ln"> 279 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 280 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> value</span></div><div class="L1"><span class="pp-ln"> 281 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> escapename</span></div><div class="L2"><span class="pp-ln"> 282 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L3"><span class="pp-ln"> 283 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(value)</span></div><div class="L4"><span class="pp-ln"> 284 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 285 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> verify.replaceAll</span></div><div class="L6"><span class="pp-ln"> 286 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> verify.replaceAll(value, "\\", "\\\\")</span></div><div class="L7"><span class="pp-ln"> 287 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '"'</span></div><div class="L8"><span class="pp-ln"> 288 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '\\"'</span></div><div class="L9"><span class="pp-ln"> 289 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 290 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> value</span></div><div class="L1"><span class="pp-ln"> 291 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> escapevalue</span></div><div class="L2"><span class="pp-ln"> 292 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L3"><span class="pp-ln"> 293 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isNotEmpty(value)</span></div><div class="L4"><span class="pp-ln"> 294 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 295 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> verify.replaceAll</span></div><div class="L6"><span class="pp-ln"> 296 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> escapename</span></div><div class="L7"><span class="pp-ln"> 297 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> value</span></div><div class="L8"><span class="pp-ln"> 298 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> "\n"</span></div><div class="L9"><span class="pp-ln"> 299 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> "\\n"</span></div><div class="L0"><span class="pp-ln"> 300 </span><span class="pp-pln">        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln"> 301 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> value</span></div><div class="L2"><span class="pp-ln"> 302 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> remacro</span></div><div class="L3"><span class="pp-ln"> 303 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L4"><span class="pp-ln"> 304 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> value.substr(-2) === '\\b'</span></div><div class="L5"><span class="pp-ln"> 305 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> value = value.substr(0, value.length-2) + ' '</span></div><div class="L6"><span class="pp-ln"> 306 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Alt+146: Ã†</span></div><div class="L7"><span class="pp-ln"> 307 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> verify.replaceAll(value, "${", "</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d66">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/nodifier.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.loader.nodifier</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Nodifies the lines of an IttfDocument and creates a</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> tree structure object based on line indentation.</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . detects the $params command</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . implements line continuation</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> . assigns an id to each node</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> !!! A line object is transformed in place into a node object</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> without recreation (no cloning) !!!</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Inputs</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> - the lines produced by the liner</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> - a newly created, empty, mTreeBrick</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Outputs</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> [ nodes</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { line -&gt; mTreeNode</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { parent</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> // parent mTreeNode</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { model</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> // the mTreeBrick to which the line belongs</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> [ children</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> // the children mTreeNodes</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> id: Number,</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> indent: Number,</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> name: String,</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> value: String,</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> row: Number,</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> col: Number,</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> sourceKey: String,</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> tagSuffix: undefined || '('</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> hasMacro: Boolean</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Ittf commands:</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> $params  // the param values are stored in the MTree</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> \        // implements line continuation</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> //   the value is appendend to the value of the parent line</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> //   without separators</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> \b       // implements line continuation</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> //   the value is appendend to the value of the parent line</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> //   with a space separator:  prevLine,value += ' ' + currentLine.value</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> \n       // implements line continuation</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> //   the value is appendend to the value of the parent line</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> //   with a line break separator:  prevLine,value += '\n' + currentLine.value</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">[</span><span class="pp-pln"> lines</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> mTreeBrick</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> nodes</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> root = null</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> current = null</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> nameFirstChar = null</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> nameLength = 0</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> line</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> i</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> l = lines.length</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> var i = 0; i &lt; l; i++</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> line = lines[i]</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> nameFirstChar = line.name[0]</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> nameLength = line.name.length</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> line.id = mTreeBrick.loadHistory.getNewNodeId()</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> line.model = mTreeBrick</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> line.indent == 0 && current == null</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> line.parent = null</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> nodes.push(line)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> current == null</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidIttfError'</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'default'</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'Malformed tree, root node cannot have an indent.'</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> line</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrick</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> line.indent == current.indent</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(current.parent) === 'undefined' || current.parent === null</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidIttfError'</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'default'</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Malformed tree, only one root note allowed.'</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> line</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrick</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> line.parent = current.parent</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> current.parent.children.push(line)</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> line.indent &gt; current.indent</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> nameFirstChar == '$' && line.name === '$params'</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> current.indent &gt; 0</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidIttfError'</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'default'</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'The $params node must be a child of the root node.'</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> line</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrick</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> current.model.$params = line.value</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> nameFirstChar == '\\' && nameLength == 1</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> value continuation on new line</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> current.value += line.value</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> nameFirstChar == '\\' && line.name === '\\b'</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> value continuation on new line with space</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> current.value += (' ' + line.value)</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                    </span><span class="pp-tag">elif</span><span class="pp-pln"> nameFirstChar == '\\' && line.name === '\\n'</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> value continuation on new line with line break</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> current.value += ('\n' + line.value)</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                        </span><span class="pp-tag">continue</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> line.parent = current</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> current.children.push(line)</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> line.indent &lt; current.indent</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> parent = current.parent</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">                    </span><span class="pp-tag">while</span><span class="pp-pln"> parent != null && line.indent &lt; parent.indent</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> parent = parent.parent</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> line.parent = parent.parent</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> parent.parent</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> parent.parent.children.push(line)</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> local_error</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'InvalidIttfError'</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'default'</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Malformed tree, only one root note allowed.'</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> line</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBrick</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> current = line</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> current.children = []</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> nodes</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> local_error</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> method</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> message</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> line</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> mTreeBrick</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> line</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> message = message + '\nIn node: ' + line.name + ' ' + (line.value || '') + ' row: ' + line.row + ' col: ' + line.col + ' file: ' + mTreeBrick.uri</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> name</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> method</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> message</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d67">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/readme.md.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">mdx</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">h2</span><span class="pp-pln"> Glossary</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">table</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> $append [hook-name] </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> Is an ittf node command that declares a node branch that</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> must be appended to a related '$hook [hook-name]' node command in</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> a mixed mTree brick.</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> $hook [hook-name] </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> Is an ittf node command that declares an insertion point in</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> the tree structure of a mixed mTree brick. Node branches,</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> children of a 'mix' node command, declared with the</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> '$append [hook-name]' node command can be appended to the '$hook' node.</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> $include [path] </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> Is an ittf node command that invokes the inclusion of another mTree brick.</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> An include node command cannot have children nodes, and it is simply</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> replaced by the included brick.</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> ittf document </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> Ittf, short for Indented Text Tree Format, is the textual notation format of an mTree.</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> An ittf document is a syntax tree, codified in a text document,</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> where child nodes are indented to their parent.</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> Every line is a node consisting of a name-value pair.</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> The name is the first string of chars of the line and is separated</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> from the value by a space or a tab.</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> An ittf document is a template and when loaded for building an mTree</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> we can pass a context object to the mTree loader.</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> All nodes are templateable and composable. Even the root node may be a command node</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> that invokes the mixup of its container.</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> When parsed and nodified an ittf document become an mTree brick.</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> jsWizzi </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> JsWizzi is a subset of the ECMA-262 javascript standard used by the wizzi factory</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> for the buildup of mTrees.</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> It is built on the quite efficent esprima parsing infrastructure and is run</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> by a custom, sandboxed, javascript engine. See jsWizziRunner.</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> jsWizziContext </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> The evaluation step of an mTree loading uses three types of value contexts.</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">ul</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">li</span><span class="pp-pln"> One global context.</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">li</span><span class="pp-pln"> One single node structure context, where the mTree is built.</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">li</span><span class="pp-pln"> One value context for each mTree brick.</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> jsWizziRunner </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> The javascript engine of an mTree buildup. It is run for expressions interpolation,</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> template commands evaluation and mTree final buildup.</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> mix node command </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> Is an ittf node command that invokes the mixup of another mTree brick.</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> Every node with the node-name ending with an open paren is a mix node command.</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> A mix node command may have children nodes, that may declare</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> branches to be appended to hooks in the mixed mTree brick.</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> See the $append and $hook command nodes.</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> mTree </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> An in-memory tree data structure of name-valued nodes that is built loading and</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> processing an ittf document</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> mTree brick </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> A nodified ittf document.</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> mTree bricks are the items that compose an mTree.</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> They can mix (or include) other bricks and be mixed (or included).</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> The same brick can be reused in many branches of the mTree,</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> so a brick is loaded once and always cloned.</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> - included mTree brick </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> An mTree brick included in an including mTree brick</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> using the node command &lt;bold&gt;$include [path]&lt;/bold&gt;.</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">p</span><span class="pp-pln"> Both the tree structure and the value context are included.</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> Context values declared in the included nodes are created in</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> the scope of the includer.</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> - mixed mTree brick </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> An mTree brick mixed in a mixing mTree brick</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> using the node command &lt;bold&gt;[path]([params])&lt;/bold&gt;.</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">            </span><span class="pp-tag">p</span><span class="pp-pln"> The tree structure is mixed but the value context remain distinct.</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> Context values declared in the mixed nodes are created in</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> the scope of the mixed mTree brick and do not interfere with the mixer.</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> mTree loading </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> The creation of an mTree from an ittf document.</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">ul</span><span class="pp-pln"> Loading steps</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">li</span><span class="pp-pln"> line parsing (of a source ittf document)</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">li</span><span class="pp-pln"> nodification (produces one mTree brick from every source ittf document)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">li</span><span class="pp-pln"> mix-composition (recursive on mixed and included mTree bricks)</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">li</span><span class="pp-pln"> include-composition (recursive on mixed and included mTree bricks)</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">li</span><span class="pp-pln"> append-resolution (on the composed mTree piece)</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">li</span><span class="pp-pln"> evaluation (on the mixed and appended mTree piece)</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> - line parsing </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> The text of the ittf document is parsed into name-valued lines,</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> eliminating comments, resolving line continuations, detecting indentation</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> and managing chars that interfere with variable interpolation.</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> - nodification </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> The lines parsed in the previous step are transformed in a tree</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> structure, an mTree brick, respecting the indentation of the source.</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> One root node only is allowed.</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> - mix-composition </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> The mTree brick, produced by the previous step, is traversed and</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> all the 'mix node commands' encountered are recursively resolved.</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> The result is an mTree piece composed by one or many bricks.</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> - include-composition </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> The mTree piece, produced by the previous step, is traversed and</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> all the '$include [path]' node commands encountered are recursively resolved.</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> The recursion manages the mix-composition of included bricks too.</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> - append resolution </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> The mTree piece resulting from composition is traversed again and</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> child branches (of mix node commands), declared with the '$append [hook-name]'</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> node command, are moved, replacing the related '$hook [hook-name]'</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> node command of the mixed mTree brick.</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> - evaluation </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> The last step of an mTree loading. From the mTree piece produced</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> by the previous steps is created a jsWizzi script that evaluates</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> the template commands of its nodes and builds the final mTree.</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> mTree buildup script </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> The jsWizzi script that, once executed, by the</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> jsWizziRunner, will give as result the final mTree</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> of the source ittf document.</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> mTreeBuildUpScriptCoder</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> A module of the wizzi.mtree package that generates the</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> mTree build up script.</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> path resolution </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> Include and mix command nodes declare the path of the ittf document</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> that must be mixed or included. At first the path to match is built</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> joining the current folder path of the calling document and the name</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> of the callee document. If this match fails, then the 't' folder rule is applied,</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> starting from the current folder path and going up on the folder tree.</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> See 't' folder.</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d50">md/glo-item(</span><span class="pp-arg"> 't' folder </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> Folders named 't' have special rules for the path resolution</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> of mixed and included ittf documents. In the folder structure</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> of a wizzi factory package, ittf documents contained in a 't' folder,</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> can be referenced with the same rules that apply to nodejs packages</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> in 'node_modules' folders. They are searched up on the folder tree, until the</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                </span><span class="pp-tag">+</span><span class="pp-pln"> relative path of the mixin or include call is matched or the path resolution fails.</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d68">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/loader/requireFromString.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> License</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> MIT Â© Vsevolod Strukchinsky [https://github.com/floatdrop]</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> original source [https://github.com/floatdrop/require-from-string/blob/master/index.js]</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> Module = require('module')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> path = require('path')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> requireFromString</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> code</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> filename</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> opts</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof filename === 'object'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> opts = filename</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> filename = undefined</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> opts = opts || {}</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> filename = filename || ''</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> opts.appendPaths = opts.appendPaths || []</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> opts.prependPaths = opts.prependPaths || []</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof code !== 'string'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error('code must be a string, not ' + typeof code)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> paths = Module._nodeModulePaths(path.dirname(filename))</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> parent = module.parent;</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> m = new Module(filename, parent)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> m.filename = filename</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> m.paths = [].concat(opts.prependPaths).concat(paths).concat(opts.appendPaths)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> m._compile</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> filename</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> exports = m.exports</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> parent.children && parent.children.splice(parent.children.indexOf(m), 1)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> exports</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d69">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/util/node.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> assert = require('assert')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Node object {</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> name:String</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> value:String</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> parent:Object of type Node</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> children:Array  of items of type Node</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> }</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> IttfCommands are nodes which name</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> starts with the char "$"</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The search go down to descendants</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.findIttfCommand</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cmdname</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> cmdtype</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> startItem</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> (startItem && item.id === startItem.id)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> \b || (startItem && item.parent && item.parent.id === startItem.parent.id)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> searching the hook for an append command</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> when descending from a parent we encounter startItem</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> or a sibling we skip it and its descendants</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> item.name === ('$' + cmdtype)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> item.value && item.value.trim() === cmdname</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> item</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> !item.value && cmdname === 'default'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> item</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> found</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> i</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> l = item.children.length</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> i = 0; i &lt; l; i++</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> found = md.findIttfCommand(item.children[i], cmdname, cmdtype, startItem)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> found</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> found</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Search a $hook node command going down deep</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.findHookExtDeep</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> hookname</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> searchType</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> startAppendNode</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> mixedNode</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof mixedNode === 'undefined'</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'md.findHookExtDeep.enter first', item.name, item.value, item.model.brickKey</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> this must be the first call for a new mixed node</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> assert.ok(typeof(item.model.$mixerBrickKey) !== 'undefined', 'wizzi-mtree.util.node.findHookExtDeep Error. In a first call the paramater item must be the root node of a mixed document. Found: ' + item.model.$mixerBrickKey)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> mixedNode = item</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> (startAppendNode && item.id === startAppendNode.id)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> \b || (startAppendNode && item.parent && item.parent.id === startAppendNode.parent.id)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> searching the hook for an append command</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> when descending from a parent we encounter startAppendNode</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> or a sibling we skip it and its descendants</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> searchType == 1</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> item.model.brickKey == mixedNode.model.brickKey</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> item.name === ('$hook')</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> item.value && item.value.trim() === hookname</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'md.findHookExtDeep.found', item.name, item.value, item.model.brickKey, 'mixedNode', mixedNode.name, mixedNode.value, mixedNode.model.brickKey</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span><span class="pp-pln"> item</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> !item.value && hookname === 'default'</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'md.findHookExtDeep.found', item.name, item.value, item.model.brickKey, 'mixedNode', mixedNode.name, mixedNode.value, mixedNode.model.brickKey</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                            </span><span class="pp-tag">return</span><span class="pp-pln"> item</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> item.name === ('$hook')</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> item.value && item.value.trim() === hookname</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> item</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> !item.value && hookname === 'default'</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> item</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">            </span><span class="pp-tag">var</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> found</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> i</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">decl</span><span class="pp-pln"> l = item.children.length</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">for</span><span class="pp-pln"> i = 0; i &lt; l; i++</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> found = md.findHookExtDeep(item.children[i], hookname, searchType, startAppendNode, mixedNode)</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> found</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> found</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Start the search of a $hook node command from a $append node command.</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The search start going up to ancestor mixed fragments.</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.findHookExt</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> hookname</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> searchType</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> startAppendNode</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'md.findHookExt.enter:', item.name, item.value, 'id', item.id, 'brickKey', item.model.brickKey</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> the startitem (the $append node command) is saved</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> and will be checked when the search descends, to avoid</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> searching descendants of the $append node command itself.</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof startAppendNode === 'undefined'</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> startAppendNode = item</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> var prn = item.parent</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> prn = md.findParentMixinRoot(item)</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !prn</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'md.findHookExt.parent.mixin', prn.name, prn.value, 'id', prn.id, 'brickKey', prn.model.brickKey, 'mixed by', prn.model.$mixerBrickKey</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> hook = md.findHookExtDeep(prn, hookname, searchType, startAppendNode)</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> hook</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> hook</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> md.findHookExt(prn, hookname, searchType, startAppendNode)</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> find a $virtual command</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> The search go up to ancestors</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.findVirtual =</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> virtname</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> prn = item.parent</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !prn</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> virt = md.findIttfCommand(prn, virtname, 'virtual')</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> virt</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> virt</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> md.findVirtual(prn, virtname)</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> find the first parent node that is</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> the root of a mixin</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.findParentMixinRoot =</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> prn = item.parent</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'md.findParentMixinRoot', prn.model.$mixerBrickKey</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">            </span><span class="pp-tag">while</span><span class="pp-pln"> prn != null && typeof(prn.model.$mixerBrickKey) === 'undefined'</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> prn = prn.parent</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'md.findParentMixinRoot', prn ? prn.model.$mixerBrickKey : prn</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> prn</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.replace</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> replacers</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> !item.parent</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'util/node/replace/item', item</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                </span><span class="pp-tag">foreach</span><span class="pp-pln"> repl in replacers</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'util/node/replace/repl', repl</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nodes = item.parent.children</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> item.parent.children = []</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> child in nodes</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> child === item</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">                    </span><span class="pp-tag">foreach</span><span class="pp-pln"> replchild in replacers</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> replchild.parent = item.parent</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> item.parent.children.push(replchild)</span></div><div class="L6"><span class="pp-ln"> 156 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln"> 157 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> item.parent.children.push(child)</span></div><div class="L8"><span class="pp-ln"> 158 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.remove</span></div><div class="L9"><span class="pp-ln"> 159 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln"> 160 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> item</span></div><div class="L1"><span class="pp-ln"> 161 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nodes = item.parent.children</span></div><div class="L2"><span class="pp-ln"> 162 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> item.parent.children = []</span></div><div class="L3"><span class="pp-ln"> 163 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> child in nodes</span></div><div class="L4"><span class="pp-ln"> 164 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> child !== item</span></div><div class="L5"><span class="pp-ln"> 165 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> item.parent.children.push(child)</span></div><div class="L6"><span class="pp-ln"> 166 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln"> 167 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> inline a node hierarchy in a single text line</span></div><div class="L8"><span class="pp-ln"> 168 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> separated by the "__LS__" sequence</span></div><div class="L9"><span class="pp-ln"> 169 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.nodeToTextLine</span></div><div class="L0"><span class="pp-ln"> 170 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln"> 171 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L2"><span class="pp-ln"> 172 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> acc</span></div><div class="L3"><span class="pp-ln"> 173 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln"> 174 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> node.children</span></div><div class="L5"><span class="pp-ln"> 175 </span><span class="pp-pln">                </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.children</span></div><div class="L6"><span class="pp-ln"> 176 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> textline(item, acc, '')</span></div><div class="L7"><span class="pp-ln"> 177 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln"> 178 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> acc.join</span></div><div class="L9"><span class="pp-ln"> 179 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> work.lineSep</span></div><div class="L0"><span class="pp-ln"> 180 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> textline</span></div><div class="L1"><span class="pp-ln"> 181 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L2"><span class="pp-ln"> 182 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> acc</span></div><div class="L3"><span class="pp-ln"> 183 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> indent</span></div><div class="L4"><span class="pp-ln"> 184 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> open = node.tagSuffix == '(' ? '(' : ' '</span></div><div class="L5"><span class="pp-ln"> 185 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> acc.push</span></div><div class="L6"><span class="pp-ln"> 186 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> indent + node.name + open + (node.value || '')</span></div><div class="L7"><span class="pp-ln"> 187 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in node.children</span></div><div class="L8"><span class="pp-ln"> 188 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> textline(item, acc, (indent + '  '))</span></div><div class="L9"><span class="pp-ln"> 189 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.inlinedTextToTextLines</span></div><div class="L0"><span class="pp-ln"> 190 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln"> 191 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> text</span></div><div class="L2"><span class="pp-ln"> 192 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(text) === 'undefined' || text == null</span></div><div class="L3"><span class="pp-ln"> 193 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln"> 194 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln"> 195 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> text text</span></div><div class="L6"><span class="pp-ln"> 196 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> lines null</span></div><div class="L7"><span class="pp-ln"> 197 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> text</span></div><div class="L8"><span class="pp-ln"> 198 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> verify.replaceAll</span></div><div class="L9"><span class="pp-ln"> 199 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> text</span></div><div class="L0"><span class="pp-ln"> 200 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> work.textSep</span></div><div class="L1"><span class="pp-ln"> 201 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '\n'</span></div><div class="L2"><span class="pp-ln"> 202 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ss = text.split('\n')</span></div><div class="L3"><span class="pp-ln"> 203 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> ss.length == 1</span></div><div class="L4"><span class="pp-ln"> 204 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln"> 205 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln"> 206 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> text ss[0]</span></div><div class="L7"><span class="pp-ln"> 207 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> lines null</span></div><div class="L8"><span class="pp-ln"> 208 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln"> 209 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> lines</span></div><div class="L0"><span class="pp-ln"> 210 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> verify.replaceAll</span></div><div class="L1"><span class="pp-ln"> 211 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> ss[1]</span></div><div class="L2"><span class="pp-ln"> 212 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> work.lineSep</span></div><div class="L3"><span class="pp-ln"> 213 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> '\n'</span></div><div class="L4"><span class="pp-ln"> 214 </span><span class="pp-pln">                        </span><span class="pp-tag">._</span><span class="pp-pln"> split('\n')</span></div><div class="L5"><span class="pp-ln"> 215 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln"> 216 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln"> 217 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> text ss[0]</span></div><div class="L8"><span class="pp-ln"> 218 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> lines lines</span></div><div class="L9"><span class="pp-ln"> 219 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.isParentOfName</span></div><div class="L0"><span class="pp-ln"> 220 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln"> 221 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> parsernode</span></div><div class="L2"><span class="pp-ln"> 222 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> nameOrArray</span></div><div class="L3"><span class="pp-ln"> 223 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> test = parsernode.parent</span></div><div class="L4"><span class="pp-ln"> 224 </span><span class="pp-pln">            </span><span class="pp-tag">while</span><span class="pp-pln"> test</span></div><div class="L5"><span class="pp-ln"> 225 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isArray(nameOrArray)</span></div><div class="L6"><span class="pp-ln"> 226 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> match = false</span></div><div class="L7"><span class="pp-ln"> 227 </span><span class="pp-pln">                    </span><span class="pp-tag">foreach</span><span class="pp-pln"> value in nameOrArray</span></div><div class="L8"><span class="pp-ln"> 228 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> match = match || test.name === value</span></div><div class="L9"><span class="pp-ln"> 229 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> match</span></div><div class="L0"><span class="pp-ln"> 230 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> match</span></div><div class="L1"><span class="pp-ln"> 231 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln"> 232 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> test.name === nameOrArray</span></div><div class="L3"><span class="pp-ln"> 233 </span><span class="pp-pln">                        </span><span class="pp-tag">return</span><span class="pp-pln"> true</span></div><div class="L4"><span class="pp-ln"> 234 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> test = test.parent</span></div><div class="L5"><span class="pp-ln"> 235 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L6"><span class="pp-ln"> 236 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> spaces</span></div><div class="L7"><span class="pp-ln"> 237 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> num</span></div><div class="L8"><span class="pp-ln"> 238 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln"> 239 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> Array((num + 1))</span></div><div class="L0"><span class="pp-ln"> 240 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> join(" ")</span></div><div class="L1"><span class="pp-ln"> 241 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> _dumpNodeDeep</span></div><div class="L2"><span class="pp-ln"> 242 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L3"><span class="pp-ln"> 243 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> indent</span></div><div class="L4"><span class="pp-ln"> 244 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> spaces(indent) + node.name + ' ' + (node.value || '') + ' ids: ' + node.parsedId + ' ' + node.id</span></div><div class="L5"><span class="pp-ln"> 245 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> (node.$args || node.$params)</span></div><div class="L6"><span class="pp-ln"> 246 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> spaces(indent) + ' $args: ' + node.$args + ' $params: ' + node.$params</span></div><div class="L7"><span class="pp-ln"> 247 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> indent++</span></div><div class="L8"><span class="pp-ln"> 248 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> child in node.children</span></div><div class="L9"><span class="pp-ln"> 249 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> _dumpNodeDeep(child, indent)</span></div><div class="L0"><span class="pp-ln"> 250 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.dump</span></div><div class="L1"><span class="pp-ln"> 251 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln"> 252 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> nodes</span></div><div class="L3"><span class="pp-ln"> 253 </span><span class="pp-pln">            </span><span class="pp-tag">foreach</span><span class="pp-pln"> node in nodes</span></div><div class="L4"><span class="pp-ln"> 254 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> _dumpNodeDeep(node, 1)</span></div><div class="L5"><span class="pp-ln"> 255 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> work</span></div><div class="L6"><span class="pp-ln"> 256 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln"> 257 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> work.lineSep = "__LS__"</span></div><div class="L8"><span class="pp-ln"> 258 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> work.textSep = "__TS__"</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d70">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/util/types.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../errors')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> objectify</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> value</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> type</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> unquote</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> value === '@@null'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> null</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> value === '@@undefined'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> undefined</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> _isTemplate = isTemplate(value)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> _isTemplate</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> value</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> type == null || typeof(type) === 'undefined' || type == 'string'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> verify.isString(value)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> unquote</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> verify.unquote(value)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">return</span><span class="pp-pln"> value</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> ''</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> type == 'integer'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isNaN(value) == false</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> parseInt(value, 10)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Cannot convert ' + value + ' to integer'</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'objectify'</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> type == 'float'</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isNaN(value) == false</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> parseFloat(value)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Cannot convert ' + value + ' to float'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'objectify'</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> type == 'boolean'</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isBool(value)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> parseBool(value)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Cannot convert ' + value + ' to boolean'</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'objectify'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">        </span><span class="pp-tag">elif</span><span class="pp-pln"> type == 'date'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> isDate(value)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> parseDate(value)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Cannot convert ' + value + ' to date'</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'objectify'</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'Invalid type: "' + type + '", expected (string, integer, float, boolean, date)'</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'objectify'</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> isTemplate</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> isString(obj) === false</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> false</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> obj.substr(0, 2) === '</span><span class="pp-kwd">${</span><span class="pp-expr">' && obj.substr(-1, 1) === '</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> isDefined</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> !(typeof(obj) === 'undefined')</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> isObject</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> obj !== null && typeof(obj) === 'object'</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> isString</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> obj !== null && typeof(obj) === 'string'</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> isBool</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> isString(obj)</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> obj === 'true' || obj === 'false'</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> typeof(obj) === "boolean"</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> isDate</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> parts = input.split('/')</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> parts.length == 3</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> parseBool</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> obj === 'true' ? true : false</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">    </span><span class="pp-tag">wz-function</span><span class="pp-pln"> parseDate</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> obj</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> parts = input.split('/')</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> Date</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parts[0]</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parts[1] - 1</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> parts[2]</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> error</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> message</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> method</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> nodeError = new errors.NodeError(message, node)</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __is_error true</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> message nodeError.message</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> source "wizzi/util/types/" + method</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d71">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/lib/errors.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> util = require('util')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports =</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d86">error(</span><span class="pp-arg"> Node</span><span class="pp-pln">,</span><span class="pp-arg">  message</span><span class="pp-pln">,</span><span class="pp-arg">  node </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> msg</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> message</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> node.wzSourceLineInfo</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> info = node.wzSourceLineInfo</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> filePath = 'TODO'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> node.wzSourceFilepath</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                    </span><span class="pp-tag">set</span><span class="pp-pln"> filePath = node.wzSourceFilepath(info.sourceKey)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push(' at row: ' + info.row)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push(', col: ' + info.col)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push(', source: ' + info.sourceKey)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push(', in file: ' + filePath)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> node.row</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push(' at row: ' + node.row)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push(', col: ' + node.col)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push(', source: ' + node.sourceKey)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push(', in file: ' + (node.model ? node.model.uri : 'unavailable'))</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = msg.join('')</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'NodeError', this.message</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> set this.node = node</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d86">error(</span><span class="pp-arg"> IttfNotFound</span><span class="pp-pln">,</span><span class="pp-arg">  resourceType</span><span class="pp-pln">,</span><span class="pp-arg">  name</span><span class="pp-pln">,</span><span class="pp-arg">  sourceUri </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = resourceType + ': ' + name +' not found, processing document ' + md.getSrcPathInfo(sourceUri)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d86">error(</span><span class="pp-arg"> IttfLoad</span><span class="pp-pln">,</span><span class="pp-arg">  message</span><span class="pp-pln">,</span><span class="pp-arg">  srcPath</span><span class="pp-pln">,</span><span class="pp-arg">  node</span><span class="pp-pln">,</span><span class="pp-arg">  ex </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> !(ex)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> ex = node</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> node = null</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = 'Error: ' + message + '\nLoading ittf document ' + md.getSrcPathInfo(srcPath)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.message += ('\n' + new NodeError('', node).message)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d86">error(</span><span class="pp-arg"> RepoIO</span><span class="pp-pln">,</span><span class="pp-arg">  message</span><span class="pp-pln">,</span><span class="pp-arg">  uri</span><span class="pp-pln">,</span><span class="pp-arg">  innerEx </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message + '\nuri: ' + uri</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.getSrcPathInfo</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> srcPath</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof (srcPath) === 'string'</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> srcPath</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> (srcPath && (typeof (srcPath) === 'object'))</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> msg = md.getSrcPathInfoFromNode(srcPath)</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">iif</span><span class="pp-pln"> msg</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">then</span><span class="pp-pln"> msg</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> srcPath.toString()</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> 'unavailable'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.getSrcPathInfoFromNode</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> msg</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> node</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> node.WmtSourceLineInfo</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> info = node.WmtSourceLineInfo</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push((' at row: ' + info.row))</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push((', col: ' + info.col))</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push((', source: ' + info.source))</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push((', in file: ' + 'TODO'))</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">elif</span><span class="pp-pln"> node.wzSourceLineInfo</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> info = node.wzSourceLineInfo</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> filePath = 'TODO'</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> node.wzSourceFilepath</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> filePath = node.wzSourceFilepath(info.sourceKey)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push((' at row: ' + info.row))</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push((', col: ' + info.col))</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push((', source: ' + info.sourceKey))</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> msg.push((', in file: ' + filePath))</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> msg.length == 0</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span><span class="pp-pln"> null</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> msg.join('')</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d72">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/meta/index.json.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">name</span><span class="pp-pln"> 'wizzi-mtree'</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">version</span><span class="pp-pln"> '0.5.4'</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">title</span><span class="pp-pln"> 'Loader component for Indented Text Tree Format (ittf) documents. Implements the Wizzi Magical Tree buildup'</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">license</span><span class="pp-pln"> 'MIT'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">[</span><span class="pp-pln"> schemas</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d73">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/root/t/readme_content.md.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d74">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/root/.gitignore.text.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">common/proj_gitignore(</span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d75">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/root/index.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi.mtree</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> loader = require('./lib/loader')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = module.exports = {}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">#</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> function createStore</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> api-ref wizzi-repo.createStore</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> { options</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> boolean useCache</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> boolean raw</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> boolean debugInfo</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.createLoadMTree</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> createLoadMTree</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">func</span><span class="pp-pln"> createStore</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">optional</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> options = options || {}</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> useCache = options.useCache || false</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> raw = options.raw || false</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> debugInfo = options.debugInfo || false</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ittfDocumentStore</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">function</span><span class="pp-pln"> loadMTree</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">string</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span><span class="pp-pln"> loadContext</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span><span class="pp-pln"> __productionManager</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span><span class="pp-pln"> productionContext</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span><span class="pp-pln"> aclstat</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                            </span><span class="pp-tag">optional</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">callback</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">#</span><span class="pp-pln"> log 'wizzi-mtree.loadMTree.loadContext', loadContext</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">if</span><span class="pp-pln"> !useCache || !ittfDocumentStore</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> createStore</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d89">f_cb(</span><span class="pp-arg"> store </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> ittfDocumentStore = store</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.__ittfDocumentStore = store</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                </span><span class="pp-tag">if</span><span class="pp-pln"> raw</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> loader.loadMTreeRaw</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                </span><span class="pp-tag">elif</span><span class="pp-pln"> debugInfo</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> loader.loadMTreeDebugInfo</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                </span><span class="pp-tag">else</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> loader.loadMTree</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> loadContext.__ittfDocumentStore = ittfDocumentStore</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                        </span><span class="pp-tag">if</span><span class="pp-pln"> raw</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> loader.loadMTreeRaw</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                        </span><span class="pp-tag">elif</span><span class="pp-pln"> debugInfo</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> loader.loadMTreeDebugInfo</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                        </span><span class="pp-tag">else</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> loader.loadMTree</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d76">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/root/license.text.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">common/mit_license(</span><span class="pp-arg"> 1982 - 2018 The Wizzi Team </span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d77">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/root/package.json.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">common/kernel_package(</span><span class="pp-arg"> wizzi-mtree</span><span class="pp-pln">,</span><span class="pp-arg">  ${wfpackage.version}</span><span class="pp-pln">,</span><span class="pp-arg">  ${wfpackage.title}.</span><span class="pp-pln">,</span><span class="pp-arg">  ${wfpackage.license}  </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">escodegen</span><span class="pp-pln"> "^1.8.1"</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">esprima</span><span class="pp-pln"> "^3.1.3"</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">glob</span><span class="pp-pln"> "^7.1.2"</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">i</span><span class="pp-pln"> "^0.3.5"</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">promise</span><span class="pp-pln"> "^7.1.1"</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> devDependencies</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d78">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/root/readme.md.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">common/kernel(</span><span class="pp-arg"> wizzi-mtree</span><span class="pp-pln">,</span><span class="pp-arg">  ${wfpackage.title}. </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">h2</span><span class="pp-pln"> Features</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">ul</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">li</span><span class="pp-pln"> Loads an ittf document into an mTree instance (</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">a</span><span class="pp-pln"> wizzi-mtree.mTree</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">href</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">span</span><span class="pp-pln"> , executing documents composition and template evaluation.</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">h3</span><span class="pp-pln"> Interface</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">p</span><span class="pp-pln"> This interface is used by the wizziFactory class and by</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> test and demo modules.</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">js</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> mtree.createLoadMTree(</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> createStore,</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> options,</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> callback</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">+</span><span class="pp-pln"> );</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">h4</span><span class="pp-pln"> Parameters</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">table</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">tr</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">td</span><span class="pp-pln"> createStore</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">td</span><span class="pp-pln"> function returned by wizzi-repo.createSore</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">tr</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">td</span><span class="pp-pln"> options</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">td</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">table</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">tr</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">td</span><span class="pp-pln"> useCache</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">td</span><span class="pp-pln"> default : false</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">tr</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">td</span><span class="pp-pln"> callback</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">td</span><span class="pp-pln"> returns the function</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">a</span><span class="pp-pln"> wizzi-mtree.loader.loadMTree</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">href</span><span class="pp-pln"> https://wizzifactory.github.io/api.html#wizzi-mtree.loader</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">span</span><span class="pp-pln"> .</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d79">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/mocks/errors.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> md = module.exports = {}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d86">error(</span><span class="pp-arg"> RepoIO</span><span class="pp-pln">,</span><span class="pp-arg">  message</span><span class="pp-pln">,</span><span class="pp-arg">  uri</span><span class="pp-pln">,</span><span class="pp-arg">  innerEx </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message + '\nuri: ' + uri</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d86">error(</span><span class="pp-arg"> InvalidRequest</span><span class="pp-pln">,</span><span class="pp-arg">  message</span><span class="pp-pln">,</span><span class="pp-arg">  code </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'message', message</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.message = message</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.code = code</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d80">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/mocks/fileSystemStore.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.tests.mocks.fileSystemStore</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> Copied from wizzi-repo.fileSystemStore</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('wizzi-utils').file</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> FileSystemStore</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">ctor</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeKind = 'filesystem'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> documentExists</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> filepath</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> documentExists</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> documentExists = file.isFile(filepath)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, documentExists)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d93">r_cb_wz_err(</span><span class="pp-arg"> RepoIOError</span><span class="pp-pln">,</span><span class="pp-arg">  documentExists</span><span class="pp-pln">,</span><span class="pp-arg">  ex </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Checking the existence of document: ' + filepath + '. Message: ' + ex.message</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> folderExistsSync</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> folderpath</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> folderExists</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> folderExists = file.isDirectory(folderpath)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> folderExists</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d94">r_wz_err(</span><span class="pp-arg"> RepoIOError</span><span class="pp-pln">,</span><span class="pp-arg">  folderExistsSync</span><span class="pp-pln">,</span><span class="pp-arg">  ex </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Checking the existence of folder: ' + folderpath + '. Message: ' + ex.message</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getFoldersSync</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> parentFolderPath</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> folders</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> folders = file.getFolders(parentFolderPath, options)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> folders</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d94">r_wz_err(</span><span class="pp-arg"> RepoIOError</span><span class="pp-pln">,</span><span class="pp-arg">  getFoldersSync</span><span class="pp-pln">,</span><span class="pp-arg">  ex </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Getting folder: ' + parentFolderPath + '. Message: ' + ex.message</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getModelContent</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> filepath</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> content</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">try</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> content = file.read(filepath)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-tag">return</span><span class="pp-pln"> callback(null, content)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">catch</span><span class="pp-pln"> ex</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d93">r_cb_wz_err(</span><span class="pp-arg"> RepoIOError</span><span class="pp-pln">,</span><span class="pp-arg">  getModelContent</span><span class="pp-pln">,</span><span class="pp-arg">  ex </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Reading filepath: ' + filepath + '. Message: ' + ex.message</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = FileSystemStore</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d81">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/mocks/ittfDocumentStore.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span><span class="pp-pln"> wizzi-mtree.tests.mocks.ittfDocumentStore</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> Copied from wizzi-repo.ittfDocumentStore</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> uriparser = require('./uriparser')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> FileSystemStore = require('./fileSystemStore')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">class</span><span class="pp-pln"> IttfDocumentStore</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> parseUri</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> uriparser</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> params</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> { ittfDocumentInfo</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> string storeKind</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> oneOf filesystem, mongodb, localstorage</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> init</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> ittfDocumentInfo</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">string</span><span class="pp-pln"> storeKind</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeImpl = new FileSystemStore()</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeKind = this.storeImpl.storeKind</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> initSync</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> ittfDocumentInfo</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">string</span><span class="pp-pln"> storeKind</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeImpl = new FileSystemStore()</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> this.storeKind = this.storeImpl.storeKind</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> documentExists</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> documentUri</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.storeImpl.documentExists(documentUri, callback)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getModelContent</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> documentUri</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">callback</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.storeImpl.getModelContent(documentUri, callback)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> folderExistsSync</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> folderUri</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.storeKind !== 'filesystem'</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d93">r_cb_wz_err(</span><span class="pp-arg"> InvalidRequest</span><span class="pp-pln">,</span><span class="pp-arg">  folderExistsSync </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Method "folderExistsSync" is for storeKind "filesystem" only. ' + 'Current storeKind is: ' + this.storeKind</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.storeImpl.folderExists(folderUri)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> getFoldersSync</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">string</span><span class="pp-pln"> parentFolderUri</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">{</span><span class="pp-pln"> options</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> this.storeKind !== 'filesystem'</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d93">r_cb_wz_err(</span><span class="pp-arg"> InvalidRequest</span><span class="pp-pln">,</span><span class="pp-arg">  getFoldersSync </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Method "getFoldersSync" is for storeKind "filesystem" only. ' + 'Current storeKind is: ' + this.storeKind</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.storeImpl.getFoldersSync(parentFolderUri, options)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">        </span><span class="pp-tag">m</span><span class="pp-pln"> createFileSystemDocumentStore</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">            </span><span class="pp-tag">static</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = new IttfDocumentStore()</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> ret.initSync</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind "filesystem"</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> ret</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports = IttfDocumentStore</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d82">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/mocks/uriparser.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> url</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('./errors');</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> uri = uri.toLowerCase()</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> ret = {}</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> parsedUri = url.parse(uri)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(parsedUri.protocol) !== 'string'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d95">var_cb_error(</span><span class="pp-arg"> InvalidRequest </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> "ittf.uriparser. uri must have a protocol (must be an absolute url) : " + uri</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> "UriError"</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> protocol</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> parsedUri.protocol.substr(-1, 1) === ':'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> parsedUri.protocol.substr(0, (parsedUri.protocol.length - 1))</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> parsedUri.protocol</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'parseuri.parsedUri', parsedUri</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> name, parts = parsedUri.pathname ? parsedUri.pathname.split('/') : []</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> parsedUri.pathname && parsedUri.pathname.length &gt; 0 && parsedUri.pathname[0] == '/'</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> parts.shift()</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> protocol.length === 1</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> parts.length &lt; 3</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d95">var_cb_error(</span><span class="pp-arg"> InvalidRequest </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Invalid uri for an IttfDocument. Too short: ' + uri</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'UriError'</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.storeKind = 'filesystem'</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.userId = parts[0]</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.projectId = parts[1]</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.uri = uri</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> parts.shift()</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> parts.shift()</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.path = parts.join('/')</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> name = parts[parts.length-1]</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> protocol === 'repo'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">if</span><span class="pp-pln"> parts.length &lt; 2</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d95">var_cb_error(</span><span class="pp-arg"> InvalidRequest </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'Invalid uri for an IttfDocument. Too short: ' + uri</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'UriError'</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'parsedUri.parts', parts</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'parsedUri', parsedUri</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.storeKind = 'repo'</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.userId = parsedUri.host</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.projectId = parts[0]</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.uri = uri</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> parts.shift();</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.path = parts.join('/')</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> name = parts[parts.length-1]</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d95">var_cb_error(</span><span class="pp-arg"> InvalidRequest </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'Invalid uri protocol for an IttfDocument. Must be a drive letter or "repo": uri=' + uri</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'UriError'</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nameparts = name.split('.')</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> nameparts.length &gt; 2 && nameparts[nameparts.length -1] === 'ittf'</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.isIttfDocument = true</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.schema = nameparts[nameparts.length -2]</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> ret.isIttfDocument = false</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> ret</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d83">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/checked_call_return_set.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> varName</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln"> && </span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">.__is_error</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d84">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/checked_call_return.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> varName</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln"> && </span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">.__is_error</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d85">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/checked_call.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> varName, message|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">if</span><span class="pp-kwd"> ${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln"> && </span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">.__is_error</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> '__is_error </span><span class="pp-kwd">${</span><span class="pp-expr">message</span><span class="pp-kwd">}</span><span class="pp-pln">', </span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> callback(</span><span class="pp-kwd">${</span><span class="pp-expr">varName</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d86">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/error.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, arg1|@@null, arg2|@@null, arg3|@@null, arg4|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg1 != null</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg1</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg2 != null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg2</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg3 != null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg3</span><span class="pp-kwd">}</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg4 != null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg4</span><span class="pp-kwd">}</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> this.name = '</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> 5/8/17 set this.stack = (new Error()).stack</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error.prototype.toString</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">return</span><span class="pp-pln"> this.message</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error.prototype = Object.create(Error.prototype)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error.prototype.constructor = </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> md.</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error = </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d87">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/f_cb_no_err.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d88">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/f_cb_throw.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'err', err</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error(err.message)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d89">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/f_cb.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">return</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> err</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d90">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/local_error.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> local_error</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> name</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> method</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> message</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> node</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> inner</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> node</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">#</span><span class="pp-pln"> log 'local_error.node', node</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> nodeError = new errors.NodeError(message, node)</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">set</span><span class="pp-pln"> message = nodeError.message</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> name</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> method</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> message</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> inner</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d91">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/r_cb_err.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> callback(err)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d92">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/r_cb_error.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">return</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> this.error</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d93">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/r_cb_wz_err.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> errorCode, method, inner|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">errorCode</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">method</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-kwd">$hook</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> inner != null</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">inner</span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d94">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/r_wz_err.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> errorCode, method, inner|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">return</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> error</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">errorCode</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> '</span><span class="pp-kwd">${</span><span class="pp-expr">method</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-kwd">$if</span><span class="pp-expr"> inner != null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">inner</span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d95">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/var_cb_error.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> errorName</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> error</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> errors.</span><span class="pp-kwd">${</span><span class="pp-expr">errorName</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">return</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> callback</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> error</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d96">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/t/var_error.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> errorName</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> error</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">new</span><span class="pp-pln"> errors.</span><span class="pp-kwd">${</span><span class="pp-expr">errorName</span><span class="pp-kwd">}</span><span class="pp-pln">Error</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d97">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests_stop/basicloader/data/doc1.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">tests</span><span class="pp-pln"> School</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">table</span><span class="pp-pln"> Teacher</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">table</span><span class="pp-pln"> Course</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">table</span><span class="pp-pln"> student</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d98">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests_stop/basicloader/index.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a">base_test(</span><span class="pp-arg"> basicloader </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> loader = require('../../lib/basicloader')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> ittfSource</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'doc1.tests.ittf'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should load an ittfdocument with no frills</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> loader.loadMTreeBrick</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> ittfSource</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a">f_cb_test(</span><span class="pp-arg"> mTreeBrick </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_object(</span><span class="pp-arg"> mTreeBrick </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_array(</span><span class="pp-arg"> mTreeBrick.nodes</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> mTreeBrick.nodes[0].n</span><span class="pp-pln">,</span><span class="pp-arg">  tests </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a">tobe_string(</span><span class="pp-arg"> mTreeBrick.nodes[0].v</span><span class="pp-pln">,</span><span class="pp-arg">  School </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d99">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/jswizzi/t/builtinFunctions.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> builtinFunctions</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = typeof(nemo); return x;'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 'undefined'</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d100">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/jswizzi/t/conditionals.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> conditionals</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code '10 &gt; 9 ? 1 : 0'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 1</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 10, y = 0; if ( x &gt; 5 ) { y += 2; } return y;'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 2</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 10, y = 0; if ( x &gt; 15 ) { y += 2; } else { y -= 2; } return y;'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number -2</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-kwd">$*</span><span class="pp-pln"> TODO switch not implemented yet</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 10, y = 0; switch (x) { case 2: y--; case 4: y++; default: y += 6; } return y;'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 6</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">*$</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d101">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/jswizzi/t/declares.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> declares</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = { a:1, b:\'alfa\', c:4 }; return x;'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> a 1</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> b 'alfa'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> c 4</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = [ 1, \'alfa\', 4 ]; return x;'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 1</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'alfa'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 4</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d102">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/jswizzi/t/iterations.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> iterations</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 10, y = 0; for( var i=0; i&lt;x; i++) { y += 2; } return y;'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 20</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 10, y = 0; for( var i=0; i&lt;x; i++) { if (i &gt; 4) { continue; } y += 2; } return y;'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 10</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 10, y = 0; while( x &gt; 0 ) { y += 2; x--; } return y;'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 20</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 10, y = 0; while( x &gt; 0 ) { y += 2; x--; if (x &lt; 6) { break; } } return y;'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 10</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 10, y = 0; do { y += 2; x--; } while( x &gt; 0 ) return y;'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 20</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d103">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/jswizzi/t/logicalExpressions.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> logicalExpressions</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'true && false'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal false</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'true || false'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal true</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code '!true'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal false</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code '\'aa\' == \'aa\''</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal true</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code '\'aa\' === \'aa\''</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal true</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code '3 &gt; 2'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal true</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code '3 &gt;= 3'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal true</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code '3 &gt;= 3 && 4 &lt; 5'</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal true</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code '3 &gt;= 3 && 4 &lt;= 4'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal true</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d104">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/jswizzi/t/mathExpressions.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mathExpressions</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code '2 + 10'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 12</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code '2 - 10'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected -8</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code '2 * 10'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 20</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code '2 / 10'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 0.2</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 10; x += 2; return x;'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 12</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 10; x -= 2; return x;'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 8</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 10; x *= 2; return x;'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 20</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 10; x /= 2; return x;'</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 5</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d105">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/jswizzi/t/memberAccesses.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> memberAccesses</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = { a: [ { b:[9] } ] }; return x.a[0].b[0];'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 9</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = { a: [ { b:[\'abcd\'] } ] }; return x.a[0].b;'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">[</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'abcd'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = { a: [ { b:[\'abcd\'] } ] }; return x.a[0].b[0];'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal 'abcd'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = { a: [ { b:[\'abcd\'] } ] }; return x.a[0].b[0].toUpperCase();'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal 'ABCD'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = { a: [ { b:[\'abcd\'] } ] }; return x.a[0].b[0].toUpperCase()[1];'</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal 'B'</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d106">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/jswizzi/t/stringExpressions.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> stringExpressions</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = \'alba\'; x = x.toUpperCase(); return x;'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 'ALBA'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = \'a,b,c,d\'; x = x.split(\',\'); return x;'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal ['a', 'b', 'c', 'd']</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = \'a1,b1,c1,d1\'; x = x.indexOf(\'b1\'); return x;'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 3</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = \'a1,b1,c1,d1\'; x = x.substr(-2,2); return x;'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 'd1'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = \'a1,b1,c1,d1\'; x = x.substring(0,5); return x;'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 'a1,b1'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'String.fromCodePoint(65, 90)'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 'AZ'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'String.fromCodePoint(65, 66, 67)'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 'ABC'</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d107">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/jswizzi/t/unaryExpressions.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> unaryExpressions</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 2; x = -x; return x'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number -2</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 2; x = +x; return x'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 2</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 2; x++; return x'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 3</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 2, y = 2; y = x++; return y'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 2</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 2, y = 2; y = ++x; return y'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_number 3</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 2, y = 2; y = --x; return { x:x, y:y }'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> x  1</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> y  1</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> code 'var x = 2, y = 2; y = x--; return { x:x, y:y }'</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected_equal</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> x  1</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> y  2</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d108">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/jswizzi/contextData.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> contextData </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> contextData = require('../../lib/jswizzi/contextData')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> cd</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> values</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> alfa, beta, gamma, sigma</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> alfa_d, beta_d, gamma_d, sigma_d</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">before</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> cd = new contextData('evalContext', 'f1')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should set and get values</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> cd.setValue('alfa', 10)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> cd.setValue('beta', 'annie')</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> alfa_d = cd.isDeclared('alfa')</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d168">tobe_true(</span><span class="pp-arg"> alfa_d </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> alfa = cd.getValue('alfa')</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> alfa</span><span class="pp-pln">,</span><span class="pp-arg">  10 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> beta_d = cd.isDeclared('beta')</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d168">tobe_true(</span><span class="pp-arg"> beta_d </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> beta = cd.getValue('beta')</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> beta</span><span class="pp-pln">,</span><span class="pp-arg">  annie </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> asterix_d = cd.isDeclared('asterix')</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d162">tobe_false(</span><span class="pp-arg"> asterix_d </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> values = cd.getValues()</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d164">tobe_object_len(</span><span class="pp-arg"> values</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should push a first time and set and get values</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> cd.push()</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> values = cd.getValues()</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d164">tobe_object_len(</span><span class="pp-arg"> values</span><span class="pp-pln">,</span><span class="pp-arg">  0 </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> alfa = cd.getValue('alfa')</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> alfa</span><span class="pp-pln">,</span><span class="pp-arg">  10 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> beta = cd.getValue('beta')</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> beta</span><span class="pp-pln">,</span><span class="pp-arg">  annie </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> cd.setValue('gamma', 30)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> values = cd.getValues()</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d164">tobe_object_len(</span><span class="pp-arg"> values</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> gamma = cd.getValue('gamma')</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> gamma</span><span class="pp-pln">,</span><span class="pp-arg">  30 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should push a second time and set and get values</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> cd.push()</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> values = cd.getValues()</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d164">tobe_object_len(</span><span class="pp-arg"> values</span><span class="pp-pln">,</span><span class="pp-arg">  0 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> cd.setValue('sigma', 40)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> values = cd.getValues()</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d164">tobe_object_len(</span><span class="pp-arg"> values</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> alfa = cd.getValue('alfa')</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> alfa</span><span class="pp-pln">,</span><span class="pp-arg">  10 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> beta = cd.getValue('beta')</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> beta</span><span class="pp-pln">,</span><span class="pp-arg">  annie </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> gamma = cd.getValue('gamma')</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> gamma</span><span class="pp-pln">,</span><span class="pp-arg">  30 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> sigma = cd.getValue('sigma')</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> sigma</span><span class="pp-pln">,</span><span class="pp-arg">  40 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should pop a first time and set and get values</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> cd.pop()</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> alfa = cd.getValue('alfa')</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> alfa</span><span class="pp-pln">,</span><span class="pp-arg">  10 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> beta = cd.getValue('beta')</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> beta</span><span class="pp-pln">,</span><span class="pp-arg">  annie </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> gamma = cd.getValue('gamma')</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> gamma</span><span class="pp-pln">,</span><span class="pp-arg">  30 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> sigma_d = cd.isDeclared('sigma')</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d162">tobe_false(</span><span class="pp-arg"> sigma_d </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should pop a second time and set and get values</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> cd.pop()</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> alfa = cd.getValue('alfa')</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> alfa</span><span class="pp-pln">,</span><span class="pp-arg">  10 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> beta = cd.getValue('beta')</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> beta</span><span class="pp-pln">,</span><span class="pp-arg">  annie </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> sigma_d = cd.isDeclared('sigma')</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d162">tobe_false(</span><span class="pp-arg"> sigma_d </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> gamma_d = cd.isDeclared('gamma')</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d162">tobe_false(</span><span class="pp-arg"> gamma_d </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should pop a third time and set and get values</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> cd.pop()</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> alfa = cd.getValue('alfa')</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> alfa</span><span class="pp-pln">,</span><span class="pp-arg">  10 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> beta = cd.getValue('beta')</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> beta</span><span class="pp-pln">,</span><span class="pp-arg">  annie </span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d109">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/jswizzi/jsWizziRunner.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> jsWizziRunner </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> JsWizziContext = require('../../lib/jswizzi/jsWizziContext')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> jsWizziRunner = require('../../lib/jswizzi/jsWizziRunner')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d101"> declares</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d104"> mathExpressions</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d106"> stringExpressions</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d103"> logicalExpressions</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d107"> unaryExpressions</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d105"> memberAccesses</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d100"> conditionals</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d102"> iterations</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d99"> builtinFunctions</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should run declares</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> runGroup(declares)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should run string expressions</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> runGroup(stringExpressions)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should run math expressions</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> expr in mathExpressions</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> runExpression(expr.code)</span><span class="pp-pln">,</span><span class="pp-arg">  expr.expected </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should run logical expressions</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> runGroup(logicalExpressions)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should run unary expressions</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> runGroup(unaryExpressions)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should run member accesses</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> runGroup(memberAccesses)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should run conditional statements</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> runGroup(conditionals)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should run iteration statements</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> runGroup(iterations)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should run builtinFunctions expressions</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> runGroup(builtinFunctions)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> runGroup</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> items</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> expr in items</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> typeof(expr.expected_equal) !== 'undefined'</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d161">tobe_eql(</span><span class="pp-arg"> runExpression(expr.code)</span><span class="pp-pln">,</span><span class="pp-arg">  expr.expected_equal </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">elif</span><span class="pp-pln"> typeof(expr.expected_number) !== 'undefined'</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> runExpression(expr.code)</span><span class="pp-pln">,</span><span class="pp-arg">  expr.expected_number </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">            </span><span class="pp-tag">else</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'expr.code, expr.expected', expr.code, expr.expected</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d166">tobe_string_value(</span><span class="pp-arg"> runExpression(expr.code)</span><span class="pp-pln">,</span><span class="pp-arg">  expr.expected </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">    </span><span class="pp-tag">function</span><span class="pp-pln"> runExpression</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> code</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> without ctor arguments means: isForInterpolation</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> jsWizziContext</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> JsWizziContext()</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> run the expression embedded in a var declaration 'result'</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> hr</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> jsWizziRunner.run</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">iif</span><span class="pp-pln"> code.indexOf('return ') &gt; -1</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-tag">then</span><span class="pp-pln"> 'var result = function dummy() { ' + code + ' }();'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">else</span><span class="pp-pln"> 'var result = ' + code + ';'</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> jsWizziContext</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> verbose false</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> hr && hr.__is_error</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error(hr)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> return the 'result' var from the context</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">        </span><span class="pp-tag">return</span><span class="pp-pln"> jsWizziContext.getValue('result')</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d110">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/mocks/errors.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d79">mocks/errors(</span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d111">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/mocks/fileSystemStore.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d80">mocks/fileSystemStore(</span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d112">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/mocks/ittfDocumentStore.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d81">mocks/ittfDocumentStore(</span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d113">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/mocks/misc.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('wizzi-utils').file</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> IttfDocumentStore = require('./ittfDocumentStore')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> IttfDocumentStore IttfDocumentStore</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> ProductionManager</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> aclstat</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> addIttfDocument</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> addMixedMTree</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> addEvaluatedMTree</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> addMTreeBuildUpScript</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                    </span><span class="pp-tag">param</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                    </span><span class="pp-tag">log</span><span class="pp-pln"> 'addMTreeBuildUpScript'</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> path.dirname(uri)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> '_debug_dumps'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> path.basename(uri)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> jsScriptCoder.toCode()</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> ProductionContext</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> IttfDocumentStoreType IttfDocumentStore</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> dump true</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> addIttfDocument</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> content</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpScripts</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> addMTreeBuildUpScript</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> jsScriptCoder</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> uri = uri</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> script = jsScriptCoder.toCode()</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                            </span><span class="pp-tag">set</span><span class="pp-pln"> this.mTreeBuildUpScripts[uri]</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> uri uri</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> script script</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                            </span><span class="pp-tag">log</span><span class="pp-pln"> script, uri</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> this.dump</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                                </span><span class="pp-tag">log</span><span class="pp-pln"> 'dump'</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> path.dirname(uri)</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> '_debug'</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> path.basename(uri) + '.js.dump'</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> script</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> raiseIttfEvaluationScriptError</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                        </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> uri</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                            </span><span class="pp-tag">param</span><span class="pp-pln"> exception</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> uri = uri</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                            </span><span class="pp-tag">var</span><span class="pp-pln"> script = this.mTreeBuildUpScripts[uri]</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                            </span><span class="pp-tag">if</span><span class="pp-pln"> script && script.ittfEvalScript && exception && exception.lineNumber</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                                </span><span class="pp-tag">var</span><span class="pp-pln"> lines = script.ittfEvalScript.getErrorLines(exception).join('\n')</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> exception.message = '\nError evaluating ittf in uri: ' + uri + '\n' + lines + '\n'</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                            </span><span class="pp-tag">else</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> exception.message = '\nError evaluating ittf in uri: ' + uri + '\n' + exception.message + '\n'</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                            </span><span class="pp-tag">#</span><span class="pp-pln"> In case of --force proceed inside the try/catch flow</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                            </span><span class="pp-tag">throw</span><span class="pp-pln"> exception</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d114">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/mocks/mTreeLoader.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> url</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('./misc')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrickProvider = require('../../../lib/loader/mTreeBrickProvider')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> mixer = require('../../../lib/loader/mixer')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> appender = require('../../../lib/loader/appender')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> evaluator = require('../../../lib/loader/evaluator')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">set</span><span class="pp-pln"> module.exports</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> store</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> content_filepath</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> callback</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">var</span><span class="pp-pln"> loadContext</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content_filepath</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> provider </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">var</span><span class="pp-pln"> mTree = provider.getPrimaryMTreeBrick()</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> mixer</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> mTree</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> provider</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> mixedModel </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> appender</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mixedModel</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                                </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> appendedModel </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                                    </span><span class="pp-tag">_</span><span class="pp-pln"> evaluator</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> appendedModel</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                                            </span><span class="pp-kwd">$*</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> console.log</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'err'</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> err</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'evaluator.result'</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                                </span><span class="pp-tag">_</span><span class="pp-pln"> util.inspect</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> result</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                                    </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                                        </span><span class="pp-tag">@</span><span class="pp-pln"> depth null</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                            </span><span class="pp-tag">*$</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> callback(null, result)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d115">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/mocks/uriParser.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">mocks/uriParser(</span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d116">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/t/frag1.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">property</span><span class="pp-pln"> Nemo</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d117">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/t/frag2.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">property</span><span class="pp-pln"> Nemo</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d118">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/t/ittf_object_args_item.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">gamma</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> &item</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> tau_</span><span class="pp-kwd">${</span><span class="pp-expr">item.name</span><span class="pp-kwd">}</span><span class="pp-pln"> = </span><span class="pp-kwd">${</span><span class="pp-expr">item.value</span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d119">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/t/lia.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">li</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> text, href</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">a</span><span class="pp-kwd"> ${</span><span class="pp-expr">text</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">href</span><span class="pp-kwd"> ${</span><span class="pp-expr">href</span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d120">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/t/mixin_1.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">tau</span><span class="pp-pln"> 1</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">boss</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d121">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/t/mixin_2_appender.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">leaf</span><span class="pp-pln"> 1</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-pln"> 1.1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span><span class="pp-pln"> alpha</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d122">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/t/mixin_2_evaluator.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">root</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> team|milan</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-kwd"> ${</span><span class="pp-expr">team</span><span class="pp-kwd">}</span><span class="pp-pln"> 1</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span><span class="pp-pln"> alpha</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-kwd"> ${</span><span class="pp-expr">team</span><span class="pp-kwd">}</span><span class="pp-pln"> 2</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d123">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/t/mixin_3_evaluator.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d122">mixin_2_evaluator(</span><span class="pp-arg"> ${team} </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> team|milan</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">team</span><span class="pp-kwd"> ${</span><span class="pp-expr">team</span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d124">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/appender_1.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">root</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d121">mixin_2_appender(</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-kwd">$appendto</span><span class="pp-pln"> alpha</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">leaf</span><span class="pp-pln"> 1.1.1</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d125">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/doc1.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">tests</span><span class="pp-pln"> School</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">table</span><span class="pp-pln"> Teacher</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">table</span><span class="pp-pln"> Course</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">table</span><span class="pp-pln"> student</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d126">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/evaluator_1.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">test</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">team</span><span class="pp-kwd"> ${</span><span class="pp-expr"> 'inter'.toUpperCase() </span><span class="pp-kwd">}</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d127">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/evaluator_2.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d123">mixin_3_evaluator(</span><span class="pp-arg"> inter </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-pln"> 2.1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> alpha</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">leaf</span><span class="pp-pln"> 1.1</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d128">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/evaluator_3.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d123">mixin_3_evaluator(</span><span class="pp-arg"> inter </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-pln"> 2.1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> alpha</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">leaf</span><span class="pp-pln"> 1.1</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d129">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/evaluator_4.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d123">mixin_3_evaluator(</span><span class="pp-arg"> inter </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-pln"> 2.1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> alpha</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">leaf</span><span class="pp-pln"> 1.1</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d130">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/evaluator_5.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d123">mixin_3_evaluator(</span><span class="pp-arg"> inter </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">leaf</span><span class="pp-pln"> 2.1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> alpha</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">leaf</span><span class="pp-pln"> 1.1</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d131">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/evaluator_6.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">html</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">head</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">body</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d119">lia(</span><span class="pp-arg"> home</span><span class="pp-pln">,</span><span class="pp-arg">  /home </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d119">lia(</span><span class="pp-arg"> docs</span><span class="pp-pln">,</span><span class="pp-arg">  /docs </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d119">lia(</span><span class="pp-arg"> about</span><span class="pp-pln">,</span><span class="pp-arg">  /about </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-kwd">$</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> sections = ['products', 'services', 'support']</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">ul</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-kwd">$foreach</span><span class="pp-pln"> section in sections</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d119">lia(</span><span class="pp-arg"> ${section}</span><span class="pp-pln">,</span><span class="pp-arg">  /${section} </span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d132">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/function_1.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">alfa</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$function</span><span class="pp-pln"> buildup_beta</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-kwd">$param</span><span class="pp-pln"> name</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">beta</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-kwd">$</span><span class="pp-pln"> var y = 'stefi';</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-kwd">$_</span><span class="pp-pln"> buildup_beta</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-kwd">$@</span><span class="pp-pln"> y</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d133">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/function_2.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">alfa</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">beta</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-kwd">$function</span><span class="pp-pln"> buildup_sigma</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$param</span><span class="pp-pln"> name</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">sigma</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-kwd">$</span><span class="pp-pln"> var y = 'stefi';</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">gamma</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-kwd">$_</span><span class="pp-pln"> buildup_sigma</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-kwd">$@</span><span class="pp-pln"> y</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d134">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/function_3.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">plutone</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> item_data = {</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-expr">name:</span><span class="pp-expr"> 'alfa',</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-expr">value:</span><span class="pp-expr"> 'x',</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-expr">children:</span><span class="pp-expr"> [{</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-expr">name:</span><span class="pp-expr"> 'beta',</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-expr">value:</span><span class="pp-expr"> 'y',</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-expr">children:</span><span class="pp-expr"> [{</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-expr">name:</span><span class="pp-expr"> 'sigma',</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-expr">value:</span><span class="pp-expr"> 't',</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-expr">children:</span><span class="pp-expr"> []</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-expr">}]</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-expr">},{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-expr">name:</span><span class="pp-expr"> 'gamma',</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-expr">value:</span><span class="pp-expr"> 'z',</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-expr">children:</span><span class="pp-expr"> []</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-expr">}]</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-expr">};</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">    </span><span class="pp-kwd">$function</span><span class="pp-pln"> buildup_item</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-kwd">$param</span><span class="pp-pln"> item</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">giove</span><span class="pp-kwd"> ${</span><span class="pp-expr">item.name</span><span class="pp-kwd">}</span><span class="pp-pln"> </span><span class="pp-kwd">${</span><span class="pp-expr">item.value</span><span class="pp-kwd">}</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-kwd">$foreach</span><span class="pp-pln"> c in item.children</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-kwd">$_</span><span class="pp-pln"> buildup_item</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-kwd">$@</span><span class="pp-pln"> c</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">    </span><span class="pp-kwd">$_</span><span class="pp-pln"> buildup_item</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-kwd">$@</span><span class="pp-pln"> item_data</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d135">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/ittf_object_args.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">alpha</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">beta</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-kwd">$foreach</span><span class="pp-pln"> item in items</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d118">ittf_object_args_item(</span><span class="pp-arg"> &item </span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d136">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/liner_1.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">alpha</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$*</span><span class="pp-pln"> bla bla *$beta 1</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">beta</span><span class="pp-pln"> 2</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">gamma</span><span class="pp-pln"> 2.1</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-kwd">$*</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag"><</span><span class="pp-pln"> *</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">margin</span><span class="pp-pln"> 0</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">padding</span><span class="pp-pln"> 0</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">*$</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag"><</span><span class="pp-pln"> body</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">margin</span><span class="pp-pln"> 0</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">padding</span><span class="pp-pln"> 0</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d137">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/mixer_1.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">sigma</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d120">mixin_1(</span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d138">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/repo/data/params_1.tests.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">tests</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> alfa, num:integer|9, ok:boolean|true, when:date|2015-8-23, cost:float|9.99</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d139">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/t/mtreeBrick/calcParamValues.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get an mTreeBrick param values</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'params_1.tests.ittf'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> provider </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> provider </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mTree = provider.getPrimaryMTreeBrick()</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> mTree </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> expected = 'alfa, num:integer|9, ok:boolean|true, when:date|2015-8-23, cost:float|9.99'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d166">tobe_string_value(</span><span class="pp-arg"> mTree.$params</span><span class="pp-pln">,</span><span class="pp-arg">  expected </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> prms</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> mTree.calcParamValues('pluto')</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> prms</span><span class="pp-pln">,</span><span class="pp-arg">  5</span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> prms[0].value</span><span class="pp-pln">,</span><span class="pp-arg">  pluto</span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> prms[1].value</span><span class="pp-pln">,</span><span class="pp-arg">  9</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d168">tobe_true(</span><span class="pp-arg"> prms[2].value</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> expected = new Date(2015, 7, 23)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d161">tobe_eql(</span><span class="pp-arg"> prms[3].value</span><span class="pp-pln">,</span><span class="pp-arg">  expected</span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> prms[4].value</span><span class="pp-pln">,</span><span class="pp-arg">  9.99</span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d140">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/t/initStore.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> store</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">before-async</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-kwd">$*</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> del.sync</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'dummy'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '**'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> force true</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">*$</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> store = new mocks.IttfDocumentStore()</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> store.init</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'filesystem'</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d141">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/appender.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> appender </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('./mocks/misc')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrickProvider = require('../../lib/loader/mTreeBrickProvider')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mixer = require('../../lib/loader/mixer')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> appender = require('../../lib/loader/appender')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> store</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> appendedModel</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> node</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">before-async</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> store = new mocks.IttfDocumentStore()</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> store.init</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'filesystem'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should load an mTree</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> content_filepath</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'appender_1.tests.ittf'</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> content_filepath</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> provider </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mTree = provider.getPrimaryMTreeBrick()</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> mixer</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTree</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> provider</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> mixedModel </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> appender</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> mixedModel</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                </span><span class="pp-tag">set</span><span class="pp-pln"> appendedModel = result</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> nodes[0]</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> appendedModel </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> appendedModel.nodes</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> appendedModel.nodes[0] </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = appendedModel.nodes[0]</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.row</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.col</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.name</span><span class="pp-pln">,</span><span class="pp-arg">  'root' </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> nodes [0][0]</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> appendedModel.nodes[0].children</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = appendedModel.nodes[0].children[0]</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.row</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.col</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.name</span><span class="pp-pln">,</span><span class="pp-arg">  'leaf' </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.value</span><span class="pp-pln">,</span><span class="pp-arg">  '1' </span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d142">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/evaluator.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> evaluator </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('./mocks/misc')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrickProvider = require('../../lib/loader/mTreeBrickProvider')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mixer = require('../../lib/loader/mixer')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> appender = require('../../lib/loader/appender')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> evaluator = require('../../lib/loader/evaluator')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> store</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> evaluatedModel</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> node</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">before-async</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> store = new mocks.IttfDocumentStore()</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> store.init</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'filesystem'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should load and evaluate</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> content_filepath</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'evaluator_1.tests.ittf'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> loadContext</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> content_filepath</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> provider </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mTree = provider.getPrimaryMTreeBrick()</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> mixer</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTree</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> provider</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> mixedModel </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> appender</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> mixedModel</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                            </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> appendedModel </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                </span><span class="pp-tag">_</span><span class="pp-pln"> evaluator</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> appendedModel</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> loadContext</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                        </span><span class="pp-tag">set</span><span class="pp-pln"> evaluatedModel = result</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                                        </span><span class="pp-kwd">$*</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> console.log</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'err'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> err</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'evaluator.evaluatedModel'</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                            </span><span class="pp-tag">_</span><span class="pp-pln"> util.inspect</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> evaluatedModel</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                                </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                                                    </span><span class="pp-tag">@</span><span class="pp-pln"> depth null</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                                        </span><span class="pp-tag">*$</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                                        </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> nodes[0]</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> evaluatedModel </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> evaluatedModel.nodes</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> evaluatedModel.nodes[0] </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = evaluatedModel.nodes[0]</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.r</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.c</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.n</span><span class="pp-pln">,</span><span class="pp-arg">  'test' </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> nodes [0][0]</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> evaluatedModel.nodes[0].children</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = evaluatedModel.nodes[0].children[0]</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.r</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.c</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.n</span><span class="pp-pln">,</span><span class="pp-arg">  'team' </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.v</span><span class="pp-pln">,</span><span class="pp-arg">  'INTER' </span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d143">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/function.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> function </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('./mocks/misc')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeLoader = require('./mocks/mTreeLoader')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">var</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> store</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> evaluatedModel</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> node</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">before-async</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> store = new mocks.IttfDocumentStore()</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> store.init</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'filesystem'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should load and evaluate an ittf with a function</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> content_filepath</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'function_1.tests.ittf'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeLoader</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> store</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> content_filepath</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> evaluatedModel = result</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> evaluatedModel </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> evaluatedModel.nodes</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> nodes[0]</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> evaluatedModel </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> evaluatedModel.nodes</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> evaluatedModel.nodes[0] </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = evaluatedModel.nodes[0]</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.r</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.c</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.n</span><span class="pp-pln">,</span><span class="pp-arg">  'alfa' </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> nodes [0][0]</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> evaluatedModel.nodes[0].children</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = evaluatedModel.nodes[0].children[0]</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.r</span><span class="pp-pln">,</span><span class="pp-arg">  4 </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.c</span><span class="pp-pln">,</span><span class="pp-arg">  9 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.n</span><span class="pp-pln">,</span><span class="pp-arg">  'beta' </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.v</span><span class="pp-pln">,</span><span class="pp-arg">  'stefi' </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should load and evaluate an ittf with a complex function</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> content_filepath</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'function_2.tests.ittf'</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeLoader</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> store</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> content_filepath</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> evaluatedModel = result</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> evaluatedModel </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> evaluatedModel.nodes</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> complex function nodes[0]</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> evaluatedModel </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> evaluatedModel.nodes</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> evaluatedModel.nodes[0] </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = evaluatedModel.nodes[0]</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.r</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.c</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.n</span><span class="pp-pln">,</span><span class="pp-arg">  'alfa' </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> complex function nodes [0][0]</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'evaluatedModel.nodes[0].children', evaluatedModel.nodes[0].children</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> evaluatedModel.nodes[0].children</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = evaluatedModel.nodes[0].children[0]</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.r</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.c</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.n</span><span class="pp-pln">,</span><span class="pp-arg">  'beta' </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = evaluatedModel.nodes[0].children[1]</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.r</span><span class="pp-pln">,</span><span class="pp-arg">  7 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.c</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.n</span><span class="pp-pln">,</span><span class="pp-arg">  'gamma' </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = evaluatedModel.nodes[0].children[1].children[0]</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.r</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.c</span><span class="pp-pln">,</span><span class="pp-arg">  9 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.n</span><span class="pp-pln">,</span><span class="pp-arg">  'sigma' </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should load and evaluate an ittf with a recursive function</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> content_filepath</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'function_3.tests.ittf'</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> mTreeLoader</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> store</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> content_filepath</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> '================', err, result</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> evaluatedModel = result</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> evaluatedModel </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> evaluatedModel.nodes</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> recursive nodes[0]</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = evaluatedModel.nodes[0]</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> node </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> node.children</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> node.children[0] </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> n1 = node.children[0]</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> n1.r</span><span class="pp-pln">,</span><span class="pp-arg">  22 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> n1.c</span><span class="pp-pln">,</span><span class="pp-arg">  9 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> n1.n</span><span class="pp-pln">,</span><span class="pp-arg">  'giove' </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> n1.v</span><span class="pp-pln">,</span><span class="pp-arg">  'alfa x' </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> recursive nodes[0][0][0]</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = evaluatedModel.nodes[0].children[0].children[0]</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> node </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> node.children</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> node.children[0] </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.r</span><span class="pp-pln">,</span><span class="pp-arg">  22 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.c</span><span class="pp-pln">,</span><span class="pp-arg">  9 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.n</span><span class="pp-pln">,</span><span class="pp-arg">  'giove' </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.v</span><span class="pp-pln">,</span><span class="pp-arg">  'beta y' </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> n1 = node.children[0]</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> n1.r</span><span class="pp-pln">,</span><span class="pp-arg">  22 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> n1.c</span><span class="pp-pln">,</span><span class="pp-arg">  9 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> n1.n</span><span class="pp-pln">,</span><span class="pp-arg">  'giove' </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> n1.v</span><span class="pp-pln">,</span><span class="pp-arg">  'sigma t' </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> recursive nodes[0][0][1]</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> node = evaluatedModel.nodes[0].children[0].children[1]</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> node </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> node.children</span><span class="pp-pln">,</span><span class="pp-arg">  0 </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.r</span><span class="pp-pln">,</span><span class="pp-arg">  22 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.c</span><span class="pp-pln">,</span><span class="pp-arg">  9 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.n</span><span class="pp-pln">,</span><span class="pp-arg">  'giove' </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.v</span><span class="pp-pln">,</span><span class="pp-arg">  'gamma z' </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d144">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/index.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> index </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('./mocks/misc')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('wizzi-utils').file</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> stringify = require('json-stringify-safe')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> loader = require('../../lib/loader')</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> result</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> store</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">before-async</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> store = new mocks.IttfDocumentStore()</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> store.init</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'filesystem'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should load an mTree</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> loader.loadMTree</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'ittf_object_args.tests.ittf'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> items</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                            </span><span class="pp-tag">[</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> name 'stefi'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> value 60</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> name 'annie'</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> value 59</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> name 'afro'</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> value 98</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __productionManager mocks.ProductionManager</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> mTree </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">set</span><span class="pp-pln"> result = mTree</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d165">tobe_object(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> file.write</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'ittf_object_args.json'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> stringify</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> mTree</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> null</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 2</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get a NotFoundError</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> loader.loadMTree</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'dummy.tests.ittf'</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __productionManager mocks.ProductionManager</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'should get an RepoIOError error.err', err</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> err.name</span><span class="pp-pln">,</span><span class="pp-arg">  RepoIOError </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d145">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/ittfDocumentFinder.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> ittfDocumentFinder </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('./mocks/misc')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> IttfDocumentFinder = require('../../lib/loader/ittfDocumentFinder')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d140">initStore(</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get an IttfNotFound error</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> ittfDocumentFinder = new IttfDocumentFinder(store, 'tests')</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ittfDocumentFinder.resolvePath</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> ittfDocumentUri</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'dummy.tests.ittf'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> result </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'should get an IttfNotFound error.err', err</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> err.name</span><span class="pp-pln">,</span><span class="pp-arg">  IttfNotFound </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d168">tobe_true(</span><span class="pp-arg"> err.__is_error </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d146">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/ittfInterpolate.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> ittfInterpolate </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> Context = require('../../lib/jswizzi/jsWizziContext')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> ip = require('../../lib/loader/ittfInterpolate')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../../lib/jswizzi/errors')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> ctx = new Context()</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">before-each</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.clear()</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.set_GlobalContext()</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> interpolate a single var</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.setValue('name', 'stefi')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> result = ip('My name is $' + '{name}.', ctx)</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'result', result</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> result</span><span class="pp-pln">,</span><span class="pp-arg">  My name is stefi. </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> interpolate a single var + an empty var</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.setValue('name', 'stefi')</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.setValue('hobby', '')</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> result = ip('My name is $' + '{name} and hobby $' + '{hobby}.', ctx)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'result', result</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> result</span><span class="pp-pln">,</span><span class="pp-arg">  My name is stefi and hobby . </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> escaped interpolation</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.setValue('name', 'stefi')</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.setValue('hobby', 'walking')</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> result = ip('My name is \\$' + '\\{name} and hobby $' + '{hobby}.', ctx)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'result', result</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> expect(result).to.be.a('string')</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> expect(result).to.be('My name is $' + '{name} and hobby walking.')</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> strange template string</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.setValue('name', 'stefi')</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> result = ip('Hello *{ $a $ {} a$ ok.', ctx)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'result', result</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> result</span><span class="pp-pln">,</span><span class="pp-arg">  Hello *{ $a $ {} a$ ok. </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> not closed var delimiter</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.setValue('name', 'stefi')</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> result = ip('Hello </span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'result', result</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> result</span><span class="pp-pln">,</span><span class="pp-arg">  Hello ${a </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> ending dollar</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.setValue('name', 'stefi')</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> result = ip('Hello $', ctx)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'result', result</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> result</span><span class="pp-pln">,</span><span class="pp-arg">  Hello $ </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> double dollar</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.setValue('name', 'stefi')</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> result = ip('Hello $' + '$ ok', ctx)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'result', result</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> expect(result).to.be.a('string')</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> expect(result).to.be('Hello $' + '$ ok')</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> interpolated can manage methods on values</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> ctx.setValue('name', 'stefi')</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> result = ip('Hello $' + '{ name.capitalize(); }.', ctx)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'result', result</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> result</span><span class="pp-pln">,</span><span class="pp-arg">  Hello Stefi.</span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d147">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/liner.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> liner </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> liner = require('../../lib/loader/liner')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('wizzi-utils').file</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should have : an indent, row and col number, name and value</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> lines</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> liner</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> file.read</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> 'liner_1.tests.ittf'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey 'f1'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'liner lines', lines</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> lines</span><span class="pp-pln">,</span><span class="pp-arg">  7 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[0].indent</span><span class="pp-pln">,</span><span class="pp-arg">  0 </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[0].row</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[0].col</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[0].sourceKey</span><span class="pp-pln">,</span><span class="pp-arg">  'f1' </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[0].name</span><span class="pp-pln">,</span><span class="pp-arg">  'alpha' </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d169">tobe_undefined(</span><span class="pp-arg"> lines[0].value </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[1].indent</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[1].row</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[1].col</span><span class="pp-pln">,</span><span class="pp-arg">  18 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[1].sourceKey</span><span class="pp-pln">,</span><span class="pp-arg">  'f1' </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[1].name</span><span class="pp-pln">,</span><span class="pp-arg">  'beta' </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[1].value</span><span class="pp-pln">,</span><span class="pp-arg">  '1' </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[2].indent</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[2].row</span><span class="pp-pln">,</span><span class="pp-arg">  3 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[2].col</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[2].sourceKey</span><span class="pp-pln">,</span><span class="pp-arg">  'f1' </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[2].name</span><span class="pp-pln">,</span><span class="pp-arg">  'beta' </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[2].value</span><span class="pp-pln">,</span><span class="pp-arg">  '2' </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[4].indent</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[4].row</span><span class="pp-pln">,</span><span class="pp-arg">  10 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[4].col</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[4].sourceKey</span><span class="pp-pln">,</span><span class="pp-arg">  'f1' </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[4].name</span><span class="pp-pln">,</span><span class="pp-arg">  '&lt;' </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[4].value</span><span class="pp-pln">,</span><span class="pp-arg">  'body' </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should skip multi line comments</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> lines</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> liner</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'root'</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    node1 value1'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    $$ node2 value2'</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    node3 value3'</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    $*'</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    node4 value4'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    node5 value5'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    *$'</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    node6 value6'</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> join('\n')</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey 'f1'</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'should skip comments liner lines', lines</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> lines</span><span class="pp-pln">,</span><span class="pp-arg">  4 </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[0].indent</span><span class="pp-pln">,</span><span class="pp-arg">  0 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[0].row</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[0].col</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[0].name</span><span class="pp-pln">,</span><span class="pp-arg">  'root' </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[3].indent</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[3].row</span><span class="pp-pln">,</span><span class="pp-arg">  9 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[3].col</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[3].name</span><span class="pp-pln">,</span><span class="pp-arg">  'node6' </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should skip line comments 2</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> lines</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> liner</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'root'</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    node1 value1'</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '$$ node2 value2'</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    node3 value3'</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '$*'</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    node4 value4'</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    node5 value5'</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '*$'</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    node6 v$$alue6'</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> join('\n')</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey 'f1'</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'should skip comments liner lines', lines</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> lines</span><span class="pp-pln">,</span><span class="pp-arg">  4 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[0].indent</span><span class="pp-pln">,</span><span class="pp-arg">  0 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[0].row</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[0].col</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[0].name</span><span class="pp-pln">,</span><span class="pp-arg">  'root' </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[3].indent</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[3].row</span><span class="pp-pln">,</span><span class="pp-arg">  9 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[3].col</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[3].name</span><span class="pp-pln">,</span><span class="pp-arg">  'node6' </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[3].value</span><span class="pp-pln">,</span><span class="pp-arg">  'v' </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should escape wizzi macro delimiters</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> lines</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> liner</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">[</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> 'root'</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    node1 value1'</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> '    </span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">'</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                    </span><span class="pp-tag">._</span><span class="pp-pln"> join('\n')</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey 'f1'</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'should skip comments liner lines', lines</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> lines</span><span class="pp-pln">,</span><span class="pp-arg">  3 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[0].indent</span><span class="pp-pln">,</span><span class="pp-arg">  0 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[0].name</span><span class="pp-pln">,</span><span class="pp-arg">  'root' </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[2].indent</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[2].name</span><span class="pp-pln">,</span><span class="pp-arg">  '${'$'}{name}' </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should escape javascript string macro delimiters</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> source</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'root'</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '    node1 value1'</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '    `my ${name}`'</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> join('\n')</span></div><div class="L8"><span class="pp-ln"> 118 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'source', source</span></div><div class="L9"><span class="pp-ln"> 119 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> lines</span></div><div class="L0"><span class="pp-ln"> 120 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> liner</span></div><div class="L1"><span class="pp-ln"> 121 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> source</span></div><div class="L2"><span class="pp-ln"> 122 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln"> 123 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey 'f1'</span></div><div class="L4"><span class="pp-ln"> 124 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'should skip comments liner lines', lines</span></div><div class="L5"><span class="pp-ln"> 125 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> lines</span><span class="pp-pln">,</span><span class="pp-arg">  3 </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln"> 126 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[0].indent</span><span class="pp-pln">,</span><span class="pp-arg">  0 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln"> 127 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[0].name</span><span class="pp-pln">,</span><span class="pp-arg">  'root' </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln"> 128 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[2].indent</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln"> 129 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Alt+146 = Ã†</span></div><div class="L0"><span class="pp-ln"> 130 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> expected = String.fromCodePoint(96) + 'my ' + 'Ã†' + '{name}' + String.fromCodePoint(96)</span></div><div class="L1"><span class="pp-ln"> 131 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d166">tobe_string_value(</span><span class="pp-arg"> lines[2].name + ' ' + lines[2].value</span><span class="pp-pln">,</span><span class="pp-arg">  expected </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 132 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should escape javascript string macro delimiters with escapes</span></div><div class="L3"><span class="pp-ln"> 133 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> template = String.fromCodePoint(96) + 'alfa ' + '\\' + String.fromCodePoint(96) + 'beta' + '\\' + String.fromCodePoint(96) + ', </span><span class="pp-kwd">${</span><span class="pp-expr">'$'</span><span class="pp-kwd">}</span><span class="pp-pln">{name}' + String.fromCodePoint(96)</span></div><div class="L4"><span class="pp-ln"> 134 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> Alt+146 = Ã†</span></div><div class="L5"><span class="pp-ln"> 135 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> template_expected = String.fromCodePoint(96) + 'alfa ' + '\\' + String.fromCodePoint(96) + 'beta' + '\\' + String.fromCodePoint(96) + ', ${name}' + String.fromCodePoint(96)</span></div><div class="L6"><span class="pp-ln"> 136 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> source</span></div><div class="L7"><span class="pp-ln"> 137 </span><span class="pp-pln">            </span><span class="pp-tag">[</span></div><div class="L8"><span class="pp-ln"> 138 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'root'</span></div><div class="L9"><span class="pp-ln"> 139 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '    node1 value1'</span></div><div class="L0"><span class="pp-ln"> 140 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '    node2 ' + template</span></div><div class="L1"><span class="pp-ln"> 141 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> '    node3 value2'</span></div><div class="L2"><span class="pp-ln"> 142 </span><span class="pp-pln">                </span><span class="pp-tag">._</span><span class="pp-pln"> join('\n')</span></div><div class="L3"><span class="pp-ln"> 143 </span><span class="pp-pln">        </span><span class="pp-tag">log</span><span class="pp-pln"> 'source', source</span></div><div class="L4"><span class="pp-ln"> 144 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> lines</span></div><div class="L5"><span class="pp-ln"> 145 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> liner</span></div><div class="L6"><span class="pp-ln"> 146 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> source</span></div><div class="L7"><span class="pp-ln"> 147 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln"> 148 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey 'f1'</span></div><div class="L9"><span class="pp-ln"> 149 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'should skip comments liner lines', lines</span></div><div class="L0"><span class="pp-ln"> 150 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> lines</span><span class="pp-pln">,</span><span class="pp-arg">  4 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln"> 151 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[0].indent</span><span class="pp-pln">,</span><span class="pp-arg">  0 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln"> 152 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[0].name</span><span class="pp-pln">,</span><span class="pp-arg">  'root' </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln"> 153 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> lines[2].indent</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln"> 154 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> lines[2].name</span><span class="pp-pln">,</span><span class="pp-arg">  'node2' </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln"> 155 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d166">tobe_string_value(</span><span class="pp-arg"> lines[2].value</span><span class="pp-pln">,</span><span class="pp-arg">  template_expected </span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d148">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/loadContext.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> loadContext </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> LoadHistory = require('../../lib/loader/loadHistory').LoadHistory</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> loadHistory</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> adding a source IttfDocument to the loadHistory should return a key for retreaving the uri</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> loadHistory = new LoadHistory()</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> content_filepath</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'lexer_1.tests.ittf'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> sourceData</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> loadHistory.addIttfDocument</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> content_filepath</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> uri</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> loadHistory.getIttfDocumentUri</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> sourceData.sourceKey</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> sourceData.sourceKey</span><span class="pp-pln">,</span><span class="pp-arg">  f1 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> expect(uri).to.be(content_filepath)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d149">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/mixer.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> mixer </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('./mocks/misc')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrickProvider = require('../../lib/loader/mTreeBrickProvider')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mixer = require('../../lib/loader/mixer')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">var</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> store</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> result_mixedModel</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-tag">decl</span><span class="pp-pln"> node</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">before-async</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">set</span><span class="pp-pln"> store = new mocks.IttfDocumentStore()</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> store.init</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> storeKind 'filesystem'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> notUsed </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> content_filepath</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'mixer_1.tests.ittf'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> content_filepath</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> provider </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mTree = provider.getPrimaryMTreeBrick()</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> mixer</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> mTree</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> provider</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">param</span><span class="pp-pln"> mixedModel</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> result_mixedModel = mixedModel</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                        </span><span class="pp-kwd">$*</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> console.log</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'err'</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> err</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> 'mixer.mixedModel'</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> util.inspect</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> mixedModel.nodes</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                    </span><span class="pp-tag">@</span><span class="pp-pln"> depth null</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">*$</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> node = result_mixedModel.nodes[0]</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.row</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.col</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.name</span><span class="pp-pln">,</span><span class="pp-arg">  sigma </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d169">tobe_undefined(</span><span class="pp-arg"> node.value </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                        </span><span class="pp-tag">set</span><span class="pp-pln"> node = result_mixedModel.nodes[0].children[0]</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.row</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> node.col</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.name</span><span class="pp-pln">,</span><span class="pp-arg">  tau </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> node.value</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d150">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/mTreeBrick.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> mTree </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrickProvider = require('../../lib/loader/mTreeBrickProvider')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('./mocks/misc')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d140">initStore(</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d139"> mtreeBrick/calcParamValues</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d151">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/mTreeBrickProvider.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> mTreeBrickProvider </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrickProvider = require('../../lib/loader/mTreeBrickProvider')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> errors = require('../../lib/errors')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mocks = require('./mocks/misc')</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-mix frag-to-link-a" data-frag-id="d140">initStore(</span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get a protocol error</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'alfa.txt'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err.name).to.be('InvalidRequestError')</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err.code).to.be('UriError')</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get a uri error</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'http://alpha.txt'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err.name).to.be('InvalidRequestError')</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err.code).to.be('UriError')</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get an invalid request error</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo://alpha.txt'</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err.name).to.be('InvalidRequestError')</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should get a RepoIOError (NotFound)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'dummy'</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'alpha.txt'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d157">f_cb_no_err(</span><span class="pp-arg"> content </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(err.name).to.be('RepoIOError')</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should load the raw MTreeBrick</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'doc1.tests.ittf'</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> provider </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'err, provider', err, provider</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(provider).to.be.an('object')</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> mTreeBrick = provider.getPrimaryMTreeBrick()</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick).to.be.an('object')</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.$schema).to.be('tests')</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.sourceKey).to.be('f1')</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.brickKey).to.be('f1')</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.nodes).to.be.an('array')</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.nodes[0]).to.be.an('object')</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.nodes[0].name).to.be('tests')</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.nodes[0].value).to.be('School')</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.nodes[0].children).to.be.an('array')</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.nodes[0].children.length).to.be(3)</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> loadHistory = provider.loadHistory</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(loadHistory).to.be.an('object')</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">    </span><span class="pp-tag">it-async</span><span class="pp-pln"> should load the raw mTreeBrick</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> MTreeBrickProvider.createFromUri</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'doc1.tests.ittf'</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> productionContext mocks.ProductionContext</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> mTreeBuildUpContext</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __ittfDocumentStore store</span></div><div class="L7"><span class="pp-ln">  97 </span><span class="pp-pln">            </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> provider </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  98 </span><span class="pp-pln">                </span><span class="pp-tag">#</span><span class="pp-pln"> log 'err, provider', err, provider</span></div><div class="L9"><span class="pp-ln">  99 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(provider).to.be.an('object')</span></div><div class="L0"><span class="pp-ln"> 100 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> provider.get</span></div><div class="L1"><span class="pp-ln"> 101 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln"> 102 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> from 'store'</span></div><div class="L3"><span class="pp-ln"> 103 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> basedir</span></div><div class="L4"><span class="pp-ln"> 104 </span><span class="pp-pln">                            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L5"><span class="pp-ln"> 105 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L6"><span class="pp-ln"> 106 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L7"><span class="pp-ln"> 107 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L8"><span class="pp-ln"> 108 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> relpath 'frag1.tests.ittf'</span></div><div class="L9"><span class="pp-ln"> 109 </span><span class="pp-pln">                    </span><span class="pp-mix frag-to-link-a" data-frag-id="d158">f_cb_test(</span><span class="pp-arg"> mTreeBrick </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln"> 110 </span><span class="pp-pln">                        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'err, mTreeBrick', err, mTreeBrick</span></div><div class="L1"><span class="pp-ln"> 111 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick).to.be.an('object')</span></div><div class="L2"><span class="pp-ln"> 112 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.$schema).to.be('tests')</span></div><div class="L3"><span class="pp-ln"> 113 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.nodes).to.be.an('array')</span></div><div class="L4"><span class="pp-ln"> 114 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.nodes[0]).to.be.an('object')</span></div><div class="L5"><span class="pp-ln"> 115 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.nodes[0].name).to.be('property')</span></div><div class="L6"><span class="pp-ln"> 116 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> expect(mTreeBrick.nodes[0].value).to.be('Nemo')</span></div><div class="L7"><span class="pp-ln"> 117 </span><span class="pp-pln">                        </span><span class="pp-tag">_</span><span class="pp-pln"> done()</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d152">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/loader/nodifier.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> nodifier </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> liner = require('../../lib/loader/liner')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> nodifier = require('../../lib/loader/nodifier')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> MTreeBrick = require('../../lib/loader/mTreeBrick').MTreeBrick</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> LoadHistory = require('../../lib/loader/loadHistory').LoadHistory</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('wizzi-utils').file</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> loadHistory = new LoadHistory()</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> nodes should have : row and col number, name and value</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> uri</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> path.join</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> __dirname</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'repo'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'data'</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> 'liner_1.tests.ittf'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> mTree</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">new</span><span class="pp-pln"> MTreeBrick</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> uri</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> loadHistory</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> lines</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-pln"> liner</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> file.read</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> uri</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> sourceKey 'f1'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> nodes = nodifier(lines, mTree)</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">#</span><span class="pp-pln"> log 'nodifier nodes', nodes</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> nodes</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> nodes[0].children</span><span class="pp-pln">,</span><span class="pp-arg">  3 </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d160">tobe_array(</span><span class="pp-arg"> nodes[0].children[1].children</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> nodes[0].row</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> nodes[0].col</span><span class="pp-pln">,</span><span class="pp-arg">  1 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].sourceKey</span><span class="pp-pln">,</span><span class="pp-arg">  'f1' </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].name</span><span class="pp-pln">,</span><span class="pp-arg">  'alpha' </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d169">tobe_undefined(</span><span class="pp-arg"> nodes[0].value </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> nodes[0].children[0].row</span><span class="pp-pln">,</span><span class="pp-arg">  2 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> nodes[0].children[0].col</span><span class="pp-pln">,</span><span class="pp-arg">  18 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].children[0].sourceKey</span><span class="pp-pln">,</span><span class="pp-arg">  'f1' </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].children[0].name</span><span class="pp-pln">,</span><span class="pp-arg">  'beta' </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].children[0].value</span><span class="pp-pln">,</span><span class="pp-arg">  '1' </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> nodes[0].children[1].row</span><span class="pp-pln">,</span><span class="pp-arg">  3 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> nodes[0].children[1].col</span><span class="pp-pln">,</span><span class="pp-arg">  5 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].children[1].sourceKey</span><span class="pp-pln">,</span><span class="pp-arg">  'f1' </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].children[1].name</span><span class="pp-pln">,</span><span class="pp-arg">  'beta' </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].children[1].value</span><span class="pp-pln">,</span><span class="pp-arg">  '2' </span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> nodes[0].children[1].children[0].row</span><span class="pp-pln">,</span><span class="pp-arg">  4 </span><span class="pp-mix">)</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> nodes[0].children[1].children[0].col</span><span class="pp-pln">,</span><span class="pp-arg">  9 </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].children[1].children[0].sourceKey</span><span class="pp-pln">,</span><span class="pp-arg">  'f1' </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].children[1].children[0].name</span><span class="pp-pln">,</span><span class="pp-arg">  'gamma' </span><span class="pp-mix">)</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].children[1].children[0].value</span><span class="pp-pln">,</span><span class="pp-arg">  '2.1' </span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> nodes[0].children[2].children[0].row</span><span class="pp-pln">,</span><span class="pp-arg">  11 </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d163">tobe_number(</span><span class="pp-arg"> nodes[0].children[2].children[0].col</span><span class="pp-pln">,</span><span class="pp-arg">  9 </span><span class="pp-mix">)</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].children[2].children[0].sourceKey</span><span class="pp-pln">,</span><span class="pp-arg">  'f1' </span><span class="pp-mix">)</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].children[2].children[0].name</span><span class="pp-pln">,</span><span class="pp-arg">  'margin' </span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="d167">tobe_string(</span><span class="pp-arg"> nodes[0].children[2].children[0].value</span><span class="pp-pln">,</span><span class="pp-arg">  '0' </span><span class="pp-mix">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d153">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/async.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> call, arg1|@@null, arg2|@@null, arg3|@@null, arg4|@@null, arg5|@@null, arg6|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-kwd"> ${</span><span class="pp-expr">call</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg1 != null</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg1</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg2 != null</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg2</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg3 != null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg3</span><span class="pp-kwd">}</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg4 != null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg4</span><span class="pp-kwd">}</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg5 != null</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg5</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg6 != null</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg6</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> result</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error()</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d154">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/base_test.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">module</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">kind</span><span class="pp-pln"> jsfile</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> path</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-tag">import</span><span class="pp-pln"> util</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> del = require('del')</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> expect = require('expect.js')</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> _ = require('lodash')</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> file = require('wizzi-utils').file</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> verify = require('wizzi-utils').verify</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">    </span><span class="pp-kwd">$hook</span><span class="pp-pln"> imports</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">    </span><span class="pp-tag">+</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">    </span><span class="pp-tag">describe</span><span class="pp-kwd"> ${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d155">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/expect_throw_error.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> error</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">function</span><span class="pp-pln"> fn</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">            </span><span class="pp-kwd">$hook</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">.</span><span class="pp-pln"> to</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-tag">._</span><span class="pp-pln"> throwException</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">function</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">param</span><span class="pp-pln"> e</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> expect(e).to.be.a(errors.</span><span class="pp-kwd">${</span><span class="pp-expr">error</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d156">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/f_cb_done.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'err', err</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error(err.message)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> done</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d157">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/f_cb_no_err.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d158">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/f_cb_test.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">function</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">param</span><span class="pp-kwd"> ${</span><span class="pp-expr">result</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">if</span><span class="pp-pln"> err</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">log</span><span class="pp-pln"> 'err', err</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">throw</span><span class="pp-pln"> new Error(err.message)</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">        </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d159">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/itasync.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> title, call, arg1|@@null, arg2|@@null, arg3|@@null, arg4|@@null, arg5|@@null, arg6|@@null</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> it</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">@</span><span class="pp-pln"> "</span><span class="pp-kwd">${</span><span class="pp-expr">title</span><span class="pp-kwd">}</span><span class="pp-pln">"</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-tag">function</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">            </span><span class="pp-tag">param</span><span class="pp-pln"> done</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">_</span><span class="pp-kwd"> ${</span><span class="pp-expr">call</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg1 != null</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg1</span><span class="pp-kwd">}</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg2 != null</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg2</span><span class="pp-kwd">}</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg3 != null</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg3</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg4 != null</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg4</span><span class="pp-kwd">}</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg5 != null</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg5</span><span class="pp-kwd">}</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-kwd">$if</span><span class="pp-expr"> arg6 != null</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-kwd"> ${</span><span class="pp-expr">arg6</span><span class="pp-kwd">}</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">function</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> err</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                    </span><span class="pp-tag">param</span><span class="pp-pln"> result</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                    </span><span class="pp-kwd">$hook</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d160">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/tobe_array.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, length</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.an('array')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">.length).to.be(</span><span class="pp-kwd">${</span><span class="pp-expr">length</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d161">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/tobe_eql.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, value</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> loose equality works for objects</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.eql(</span><span class="pp-kwd">${</span><span class="pp-expr">value</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d162">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/tobe_false.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be(false)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d163">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/tobe_number.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, value</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.a('number')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be(</span><span class="pp-kwd">${</span><span class="pp-expr">value</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d164">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/tobe_object_len.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, length</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.an('object')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(Object.keys(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).length).to.be(</span><span class="pp-kwd">${</span><span class="pp-expr">length</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d165">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/tobe_object.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.an('object')</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d166">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/tobe_string_value.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, value</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.a('string')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be(</span><span class="pp-kwd">${</span><span class="pp-expr">value</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d167">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/tobe_string.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, value</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be.a('string')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be('</span><span class="pp-kwd">${</span><span class="pp-expr">value</span><span class="pp-kwd">}</span><span class="pp-pln">')</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d168">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/tobe_true.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be(true)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d169">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/tobe_undefined.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be(undefined)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d170">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/t/tobe.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$params</span><span class="pp-pln"> name, value</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">    </span><span class="pp-tag">#</span><span class="pp-pln"> strict equality</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-tag">_</span><span class="pp-pln"> expect(</span><span class="pp-kwd">${</span><span class="pp-expr">name</span><span class="pp-kwd">}</span><span class="pp-pln">).to.be(</span><span class="pp-kwd">${</span><span class="pp-expr">value</span><span class="pp-kwd">}</span><span class="pp-pln">)</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d171">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/util/t/nodeFinds.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> nodeFinds</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> action 'findCommand'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'hook'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'default'</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 5</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> original</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'root'</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> id 1</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n1'</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v1'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> id 2</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                                </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n11'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v11'</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> id 3</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                                            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n111'</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> id 4</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name '$hook'</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> value 'default'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> id 5</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> action 'findHook'</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> startitem 5</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected 2</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> original</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'root'</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> id 1</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name '$hook'</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'main'</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> id 2</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n11'</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v11'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> id 3</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n111'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> id 4</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name '$append'</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> value 'main'</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> id 5</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n2'</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v2'</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> id 6</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                                </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n3'</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v3'</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> id 7</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                                </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d172">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/util/t/nodeUpdates.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-kwd">$group</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-tag">var</span><span class="pp-pln"> nodeUpdates</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">[</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> action 'remove'</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n11'</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> original</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'root'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n1'</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v1'</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                                </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n11'</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v11'</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                                            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n111'</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n12'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v12'</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'root'</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n1'</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v1'</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                                </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n12'</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v12'</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> action 'replace'</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n11'</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> original</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'root'</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n1'</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v1'</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                                </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n11'</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v11'</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                                            </span><span class="pp-tag">{</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n111'</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n12'</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> value 'n12'</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                                            </span><span class="pp-tag">{</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n121'</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n2'</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v2'</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                                </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n21'</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> replacer</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n101'</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n1011'</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v1011'</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">                </span><span class="pp-tag">@</span><span class="pp-pln"> expected</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">                    </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'root'</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n1'</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v1'</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">                                </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n101'</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">                                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">                                            </span><span class="pp-tag">{</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n1011'</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v1011'</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n12'</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> value 'n12'</span></div><div class="L8"><span class="pp-ln">  88 </span><span class="pp-pln">                                        </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L9"><span class="pp-ln">  89 </span><span class="pp-pln">                                            </span><span class="pp-tag">{</span></div><div class="L0"><span class="pp-ln">  90 </span><span class="pp-pln">                                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n121'</span></div><div class="L1"><span class="pp-ln">  91 </span><span class="pp-pln">                            </span><span class="pp-tag">{</span></div><div class="L2"><span class="pp-ln">  92 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n2'</span></div><div class="L3"><span class="pp-ln">  93 </span><span class="pp-pln">                                </span><span class="pp-tag">@</span><span class="pp-pln"> value 'v2'</span></div><div class="L4"><span class="pp-ln">  94 </span><span class="pp-pln">                                </span><span class="pp-tag">[</span><span class="pp-pln"> children</span></div><div class="L5"><span class="pp-ln">  95 </span><span class="pp-pln">                                    </span><span class="pp-tag">{</span></div><div class="L6"><span class="pp-ln">  96 </span><span class="pp-pln">                                        </span><span class="pp-tag">@</span><span class="pp-pln"> name 'n21'</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d173">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/util/node.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> util.node </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> ittfTree = require('wizzi-utils').IttfMTreeEx</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> node = require('../../lib/util/node')</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d172"> nodeUpdates</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="d171"> nodeFinds</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should modify nodes</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in nodeUpdates</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> item.action === 'remove'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> original</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ittfTree.createFrom(item.original)</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'original', original.toString()</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> expected</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ittfTree.createFrom(item.expected)</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> toremove = original.find(item.name)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> node.remove</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> toremove</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'toremove', toremove.toString()</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'original after', original.toString()</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'expected', expected.toString()</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d168">tobe_true(</span><span class="pp-arg"> original.equals(expected) </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> item.action === 'replace'</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> original</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ittfTree.createFrom(item.original)</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'original', original.toString()</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> replacer</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ittfTree.createFrom(item.replacer)</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> expected</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ittfTree.createFrom(item.expected)</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> toreplace = original.find(item.name)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'toreplace', toreplace.toString()</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">                </span><span class="pp-tag">_</span><span class="pp-pln"> node.replace</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> toreplace</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">                    </span><span class="pp-tag">@</span><span class="pp-pln"> [replacer]</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'replacer', replacer.toString()</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'original after', original.toString()</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'expected', expected.toString()</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d168">tobe_true(</span><span class="pp-arg"> original.equals(expected) </span><span class="pp-mix">)</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should find node commands</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">        </span><span class="pp-tag">foreach</span><span class="pp-pln"> item in nodeFinds</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> item.action === 'findCommand'</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> original</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ittfTree.createFrom(item.original)</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'original', original.toString()</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> found</span></div><div class="L6"><span class="pp-ln">  46 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> node.findIttfCommand</span></div><div class="L7"><span class="pp-ln">  47 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> original</span></div><div class="L8"><span class="pp-ln">  48 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> item.value</span></div><div class="L9"><span class="pp-ln">  49 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> item.name</span></div><div class="L0"><span class="pp-ln">  50 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'findCommand.found', found</span></div><div class="L1"><span class="pp-ln">  51 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d161">tobe_eql(</span><span class="pp-arg"> item.expected</span><span class="pp-pln">,</span><span class="pp-arg">  found.id </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">  52 </span><span class="pp-pln">            </span><span class="pp-tag">if</span><span class="pp-pln"> item.action === 'findHook'</span></div><div class="L3"><span class="pp-ln">  53 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> original</span></div><div class="L4"><span class="pp-ln">  54 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> ittfTree.createFrom(item.original)</span></div><div class="L5"><span class="pp-ln">  55 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'original', original.toString()</span></div><div class="L6"><span class="pp-ln">  56 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> startitem</span></div><div class="L7"><span class="pp-ln">  57 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> original.find</span></div><div class="L8"><span class="pp-ln">  58 </span><span class="pp-pln">                        </span><span class="pp-tag">{</span></div><div class="L9"><span class="pp-ln">  59 </span><span class="pp-pln">                            </span><span class="pp-tag">@</span><span class="pp-pln"> id item.startitem</span></div><div class="L0"><span class="pp-ln">  60 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'startitem', item.startitem, startitem, startitem.value</span></div><div class="L1"><span class="pp-ln">  61 </span><span class="pp-pln">                </span><span class="pp-tag">var</span><span class="pp-pln"> found</span></div><div class="L2"><span class="pp-ln">  62 </span><span class="pp-pln">                    </span><span class="pp-tag">_</span><span class="pp-pln"> node.findHookExt</span></div><div class="L3"><span class="pp-ln">  63 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> startitem</span></div><div class="L4"><span class="pp-ln">  64 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> startitem.value</span></div><div class="L5"><span class="pp-ln">  65 </span><span class="pp-pln">                        </span><span class="pp-tag">@</span><span class="pp-pln"> startitem</span></div><div class="L6"><span class="pp-ln">  66 </span><span class="pp-pln">                </span><span class="pp-tag">log</span><span class="pp-pln"> 'findHook.found', found</span></div><div class="L7"><span class="pp-ln">  67 </span><span class="pp-pln">                </span><span class="pp-mix frag-to-link-a" data-frag-id="d161">tobe_eql(</span><span class="pp-arg"> item.expected</span><span class="pp-pln">,</span><span class="pp-arg">  found.id </span><span class="pp-mix">)</span></div><div class="L8"><span class="pp-ln">  68 </span><span class="pp-pln">    </span><span class="pp-kwd">$*</span></div><div class="L9"><span class="pp-ln">  69 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should find the first $virtual node command (up to ancestors)</span></div><div class="L0"><span class="pp-ln">  70 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> node.findVirtual</span></div><div class="L1"><span class="pp-ln">  71 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L2"><span class="pp-ln">  72 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello'</span></div><div class="L3"><span class="pp-ln">  73 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should find the first $virtual node command</span></div><div class="L4"><span class="pp-ln">  74 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> node.findVirtual</span></div><div class="L5"><span class="pp-ln">  75 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L6"><span class="pp-ln">  76 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello'</span></div><div class="L7"><span class="pp-ln">  77 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should inline a node hierarchy in a single text line</span></div><div class="L8"><span class="pp-ln">  78 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> node.nodeToTextLine</span></div><div class="L9"><span class="pp-ln">  79 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L0"><span class="pp-ln">  80 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should deinline a text into a node hierarchy</span></div><div class="L1"><span class="pp-ln">  81 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> node.inlinedTextToTextLines</span></div><div class="L2"><span class="pp-ln">  82 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> text</span></div><div class="L3"><span class="pp-ln">  83 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should check if parent of a node of a certain name</span></div><div class="L4"><span class="pp-ln">  84 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> node.isParentOfName</span></div><div class="L5"><span class="pp-ln">  85 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> node</span></div><div class="L6"><span class="pp-ln">  86 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> nameOrArray</span></div><div class="L7"><span class="pp-ln">  87 </span><span class="pp-pln">    </span><span class="pp-tag">*$</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d174">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/ittf/tests/util/types.js.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-mix frag-to-link-a" data-frag-id="d154">base_test(</span><span class="pp-arg"> util.types </span><span class="pp-mix">)</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$append</span><span class="pp-pln"> imports</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-tag">var</span><span class="pp-pln"> types = require('../../lib/util/types')</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">    </span><span class="pp-kwd">$*</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">    </span><span class="pp-tag">it</span><span class="pp-pln"> should objectify</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-tag">_</span><span class="pp-pln"> types.objectify</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> item</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'hello'</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> 'hook'</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">            </span><span class="pp-tag">@</span><span class="pp-pln"> startItem</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">    </span><span class="pp-tag">*$</span></div></pre>
                    </div>
                </div>
                <div class="code-panel" id="d175">
                    <div class="modal-view-container">
                        <h4 class="d-h2">/src/generate.wfjob.ittf</h4>
                        <pre class="prettyprint">

<div class="L1"><span class="pp-ln">   1 </span><span class="pp-pln"></span><span class="pp-tag">wfjob</span><span class="pp-pln"> v5-wizzi-mtree</span></div><div class="L2"><span class="pp-ln">   2 </span><span class="pp-pln">    </span><span class="pp-kwd">$</span></div><div class="L3"><span class="pp-ln">   3 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> ittf_meta_folder      = path.join(__dirname, 'ittf', 'meta');</span></div><div class="L4"><span class="pp-ln">   4 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> ittf_lib_folder       = path.join(__dirname, 'ittf', 'lib');</span></div><div class="L5"><span class="pp-ln">   5 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> ittf_root_folder      = path.join(__dirname, 'ittf', 'root');</span></div><div class="L6"><span class="pp-ln">   6 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> ittf_examples_folder  = path.join(__dirname, 'ittf', 'examples');</span></div><div class="L7"><span class="pp-ln">   7 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> ittf_tests_folder     = path.join(__dirname, 'ittf', 'tests');</span></div><div class="L8"><span class="pp-ln">   8 </span><span class="pp-pln">        </span><span class="pp-expr">var</span><span class="pp-expr"> dest_folder           = path.join(__dirname, '..', 'dist');</span></div><div class="L9"><span class="pp-ln">   9 </span><span class="pp-pln">    </span><span class="pp-tag">model</span><span class="pp-pln"> meta</span></div><div class="L0"><span class="pp-ln">  10 </span><span class="pp-pln">        </span><span class="pp-tag">schema</span><span class="pp-pln"> json</span></div><div class="L1"><span class="pp-ln">  11 </span><span class="pp-pln">        </span><span class="pp-tag">src</span><span class="pp-kwd"> ${</span><span class="pp-expr">ittf_meta_folder</span><span class="pp-kwd">}</span><span class="pp-pln">/index.json.ittf</span></div><div class="L2"><span class="pp-ln">  12 </span><span class="pp-pln">    </span><span class="pp-tag">line</span><span class="pp-pln"> ittf-lib</span></div><div class="L3"><span class="pp-ln">  13 </span><span class="pp-pln">        </span><span class="pp-tag">cwd-folder</span><span class="pp-kwd"> ${</span><span class="pp-expr">ittf_lib_folder</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">  14 </span><span class="pp-pln">        </span><span class="pp-tag">dest-folder</span><span class="pp-kwd"> ${</span><span class="pp-expr">dest_folder</span><span class="pp-kwd">}</span><span class="pp-pln">/lib</span></div><div class="L5"><span class="pp-ln">  15 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">wfjob/any_js(</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  16 </span><span class="pp-pln">            </span><span class="pp-tag">ignore</span><span class="pp-kwd"> ${</span><span class="pp-expr">ittf_lib_folder</span><span class="pp-kwd">}</span><span class="pp-pln">/**/*__copy/**/*.js.ittf</span></div><div class="L7"><span class="pp-ln">  17 </span><span class="pp-pln">        </span><span class="pp-tag">artifact</span><span class="pp-pln"> any_ittf_inside___copy</span></div><div class="L8"><span class="pp-ln">  18 </span><span class="pp-pln">            </span><span class="pp-tag">src</span><span class="pp-kwd"> ${</span><span class="pp-expr">ittf_lib_folder</span><span class="pp-kwd">}</span><span class="pp-pln">/**/*__copy/**/*.ittf</span></div><div class="L9"><span class="pp-ln">  19 </span><span class="pp-pln">            </span><span class="pp-tag">extension</span><span class="pp-pln"> ittf</span></div><div class="L0"><span class="pp-ln">  20 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">wfjob/any_md(</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  21 </span><span class="pp-pln">    </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="unknown"> wfjob/root</span></div><div class="L2"><span class="pp-ln">  22 </span><span class="pp-pln">    </span><span class="pp-tag">line</span><span class="pp-pln"> ittf-examples</span></div><div class="L3"><span class="pp-ln">  23 </span><span class="pp-pln">        </span><span class="pp-tag">cwd-folder</span><span class="pp-kwd"> ${</span><span class="pp-expr">ittf_examples_folder</span><span class="pp-kwd">}</span></div><div class="L4"><span class="pp-ln">  24 </span><span class="pp-pln">        </span><span class="pp-tag">dest-folder</span><span class="pp-kwd"> ${</span><span class="pp-expr">dest_folder</span><span class="pp-kwd">}</span><span class="pp-pln">/examples</span></div><div class="L5"><span class="pp-ln">  25 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">wfjob/any_js(</span><span class="pp-mix">)</span></div><div class="L6"><span class="pp-ln">  26 </span><span class="pp-pln">            </span><span class="pp-tag">ignore</span><span class="pp-kwd"> ${</span><span class="pp-expr">ittf_examples_folder</span><span class="pp-kwd">}</span><span class="pp-pln">/**/*__copy/**/*.js.ittf</span></div><div class="L7"><span class="pp-ln">  27 </span><span class="pp-pln">        </span><span class="pp-tag">artifact</span><span class="pp-pln"> any_ittf_inside___copy</span></div><div class="L8"><span class="pp-ln">  28 </span><span class="pp-pln">            </span><span class="pp-tag">src</span><span class="pp-kwd"> ${</span><span class="pp-expr">ittf_examples_folder</span><span class="pp-kwd">}</span><span class="pp-pln">/**/*__copy/**/*.ittf</span></div><div class="L9"><span class="pp-ln">  29 </span><span class="pp-pln">            </span><span class="pp-tag">extension</span><span class="pp-pln"> ittf</span></div><div class="L0"><span class="pp-ln">  30 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">wfjob/any_md(</span><span class="pp-mix">)</span></div><div class="L1"><span class="pp-ln">  31 </span><span class="pp-pln">    </span><span class="pp-tag">line</span><span class="pp-pln"> ittf-tests</span></div><div class="L2"><span class="pp-ln">  32 </span><span class="pp-pln">        </span><span class="pp-tag">cwd-folder</span><span class="pp-kwd"> ${</span><span class="pp-expr">ittf_tests_folder</span><span class="pp-kwd">}</span></div><div class="L3"><span class="pp-ln">  33 </span><span class="pp-pln">        </span><span class="pp-tag">dest-folder</span><span class="pp-kwd"> ${</span><span class="pp-expr">dest_folder</span><span class="pp-kwd">}</span><span class="pp-pln">/tests</span></div><div class="L4"><span class="pp-ln">  34 </span><span class="pp-pln">        </span><span class="pp-mix frag-to-link-a" data-frag-id="unknown">wfjob/any_js(</span><span class="pp-mix">)</span></div><div class="L5"><span class="pp-ln">  35 </span><span class="pp-pln">            </span><span class="pp-tag">ignore</span><span class="pp-kwd"> ${</span><span class="pp-expr">ittf_tests_folder</span><span class="pp-kwd">}</span><span class="pp-pln">/**/*__copy/**/*.js.ittf</span></div><div class="L6"><span class="pp-ln">  36 </span><span class="pp-pln">        </span><span class="pp-tag">artifact</span><span class="pp-pln"> any_ittf_inside___copy</span></div><div class="L7"><span class="pp-ln">  37 </span><span class="pp-pln">            </span><span class="pp-tag">src</span><span class="pp-kwd"> ${</span><span class="pp-expr">ittf_tests_folder</span><span class="pp-kwd">}</span><span class="pp-pln">/**/*__copy/**/*.ittf</span></div><div class="L8"><span class="pp-ln">  38 </span><span class="pp-pln">            </span><span class="pp-tag">extension</span><span class="pp-pln"> ittf</span></div><div class="L9"><span class="pp-ln">  39 </span><span class="pp-pln">        </span><span class="pp-kwd">$include</span><span class="pp-mix frag-to-link-a" data-frag-id="unknown"> wfjob/any_tests_ittf</span></div><div class="L0"><span class="pp-ln">  40 </span><span class="pp-pln">    </span><span class="pp-tag">production</span></div><div class="L1"><span class="pp-ln">  41 </span><span class="pp-pln">        </span><span class="pp-tag">dest-folder</span><span class="pp-kwd"> ${</span><span class="pp-expr">dest_folder</span><span class="pp-kwd">}</span></div><div class="L2"><span class="pp-ln">  42 </span><span class="pp-pln">        </span><span class="pp-tag">line-ref</span><span class="pp-pln"> ittf-lib</span></div><div class="L3"><span class="pp-ln">  43 </span><span class="pp-pln">        </span><span class="pp-tag">line-ref</span><span class="pp-pln"> ittf-root</span></div><div class="L4"><span class="pp-ln">  44 </span><span class="pp-pln">        </span><span class="pp-tag">line-ref</span><span class="pp-pln"> ittf-examples</span></div><div class="L5"><span class="pp-ln">  45 </span><span class="pp-pln">        </span><span class="pp-tag">line-ref</span><span class="pp-pln"> ittf-tests</span></div></pre>
                    </div>
                </div>
                <div id="frag-modal" class="modal">
                    <div id="frag-modal-content" class="modal-content">
                        <span class="modal-close">&times;</span>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script src="../jquery-3.2.1.js"></script>
    <script src="../wizzifactory.js"></script>
</body>

</html>
