<!doctype html>
<html VERSION-5="5" VERSION-4="4" version="5">
    <head>
        <title>The Wizzi Factory</title>
        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
        <link href="normalize.css" rel="stylesheet">
        <link href="wizzifactory.css" rel="stylesheet">
    </head>
    <body>
        <a href="https://github.com/wizzifactory"><img style="position: fixed; top: 0; right: 0; border: 0; z-index: 100;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png">
        </a>
        <header class="header" role="banner">
            <div class="header-logo">
                <a class="logo" href="index.html">Wizzi Factory</a>
            </div>
            <nav role="navigation" class="header-items">
                <a class="header-item" href="overview.html">View</a>
                <a class="header-item" href="starter.html">Starters</a>
                <a class="selected-header-item" href="docs.html">Documentation</a>
                <a class="header-item" href="specs.html">Specs</a>
                <a class="header-item" href="labs.html">Labs</a>
                <a class="header-item" href="project.html">Project</a>
                <a class="header-item" href="contribs.html">Contribs</a>
            </nav>
        </header>
        <main>
            <div class="main-sidebar-left">
                <section id="main-toc" class="toc">
                    <h3>Contents:</h3>
                    <ol>
                        <li><a href="#concept-1">Ittf notation</a>
                        </li>
                        <li><a href="#concept-2">Ittf command nodes</a>
                        </li>
                        <li><a href="#concept-3">Path resolution of mixin and include documents</a>
                        </li>
                        <li><a href="#concept-4">t-folders</a>
                        </li>
                        <li><a href="#concept-5">JsWizzi</a>
                        </li>
                        <li><a href="#concept-6">Wizzi model javascript module</a>
                        </li>
                        <li><a href="#concept-7">The &lt;schema-name&gt;-factory.g.js module</a>
                        </li>
                        <li><a href="#concept-8">The &lt;schema-name&gt;-model.g.js module</a>
                        </li>
                        <li><a href="#concept-9">Artifact generator</a>
                        </li>
                        <li><a href="#concept-10">The gencontext object</a>
                        </li>
                        <li><a href="#concept-11">Sample artifact generators</a>
                        </li>
                        <li><a href="#concept-12">Plugin</a>
                        </li>
                        <li><a href="#concept-13">Plugin API</a>
                        </li>
                    </ol>
                </section>
            </div>
            <div class="main-content">
                <h2 id="concept-1" class="concept">Ittf notation</h2>
                <div class="summary">
                    <p>Ittf stays for Indented Text Tree Format, the notation format of every wizzi factory model.</p><p>It is a textual representation of a <a href="https://en.wikipedia.org/wiki/Tree_(data_structure)">tree data structure</a> where child nodes are indented one level below their parent.</p><p>Example. This is a tree data structure in Ittf format:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">html</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">body</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">ul</span><span class="pln"> </span></li><li class="L4"><span class="pnl">            </span><span class="tag">li</span><span class="pln"> </span></li><li class="L5"><span class="pnl">                </span><span class="tag">a</span><span class="pln"> The Wizzi Factory</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">href</span><span class="pln"> https://wizzifactory.github.io</span></li></ol></pre><p>Some Ittf terms:</p><table class="pretty-table">    <tr>        <td>IttfDocument        </td><td>A text document containing a tree data structure written using the Ittf notation.        </td>    </tr><tr>        <td>IttfNode        </td><td>A node item; a string of chars on a single line, that is parsed in a name, value pair separated by a whitechar (space or TAB).        </td>    </tr><tr>        <td>Name        </td><td>The name part of an IttfNode, also IttfNodeTag.        </td>    </tr><tr>        <td>Value        </td><td>The value part of an IttfNode; may be optional or required; may be multi-line (see the $. \ command nodes for multi-line values).        </td>    </tr><tr>        <td>Parent        </td><td>The parent node of an IttfNode.        </td>    </tr><tr>        <td>Root        </td><td>The root node of an IttfDocument; its Parent is null.        </td>    </tr><tr>        <td>Branch        </td><td>A sub tree of an IttfNode that is not the root.        </td>    </tr><tr>        <td>Children        </td><td>The child nodes of an IttfNode.        </td>    </tr></table></div>
                <h2 id="concept-2" class="concept">Ittf command nodes</h2>
                <div class="summary">
                    <h3>Mixin inclusion command</h3><p>Format:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">...</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="mix">mixin-path(</span><span class="pln"> mixin-param-1 [mixin-param-2, [...]] ).</span></li><li class="L3"><span class="pnl">        </span><span class="tag">[</span><span class="pln"> optional ittf node branch ]</span></li></ol></pre><p>A mixin inclusion is recognized by the lexer when a node name ends with an open parenthesis. The chars before the parens are the relative path to the mixin. The base path is the current ittf document uri. No whitechar may separate the mixin path and the open paren.</p><p>The ittf of the mixin is inserted in the including ittf replacing the including command node. If the including node has children they, by default, are appended to the root node of the mixin. But if the mixin root has a descendant that is a default $hook command node, than the children of the including replace the $hook node.</p><p>Example of mixin with an $hook command node where children of the includer node will be appended.</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">table</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">tr</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="kwd">$hook</span><span class="pln"> </span></li></ol></pre><p>Root nodes can be command inclusion nodes:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="mix">mylayout(</span><span class="pln"> home )</span></li><li class="L2"><span class="pnl">    </span><span class="tag">div</span><span class="pln"> My content</span></li></ol></pre><h3>$include</h3><p>Format:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">...</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$include</span><span class="pln"> include-path</span></li></ol></pre><p>include-path is the relative path to an includeable ittf. The base path is the current ittf document uri.</p><p>The includeable is included as is replacing the $include command node.</p><p>An $include command node may not have children nodes.</p><h3>$params</h3><p>Format:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">rootnode</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> name1[:type[|default]][, name2[...</span></li></ol></pre><p>Example:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">li</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> text, href</span></li><li class="L3"><span class="pnl">    </span><span class="tag">a</span><span class="pln"> ${text}</span></li><li class="L4"><span class="pnl">        </span><span class="tag">href</span><span class="pln"> ${href}</span></li></ol></pre><h3>$hook</h3><p>Format</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">...</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$hook</span><span class="pln"> name</span></li></ol></pre><p>An $hook command node is a named insertion point where IttfNodeBranches can be appended. The name is optional, when missing its value is 'default'.</p><p>It has to be replaced and may not have child nodes.</p><p>See the statements MixinCall and AppendHookCall, for how to append IttfNodeBranches to an $hook node.</p><h3>$append</h3><p>Format</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">...</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$append</span><span class="pln"> hook-name</span></li><li class="L3"><span class="pnl">        </span><span class="tag">...</span><span class="pln"> nodeb ranch ...</span></li></ol></pre><p>An $append command node is the root of a node branch that should be appended to an ancestor $hook of name hook-name. The $append children nodes replace the $hook node.</p><h3>$group</h3><p>Format</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="kwd">$group</span><span class="pln"> empty-value</span></li><li class="L2"><span class="pnl">    </span><span class="tag">...</span><span class="pln"> node branch ...</span></li></ol></pre><p>An ittf document must have one and only one root node.</p><p>The $group command node is a convenience node that may be used as the root of an includeable or mixin with many root nodes.</p><p>The $group node disappear in the builded tree.</p><h3>$if, $elif, $else</h3><p>Format:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">...</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$if</span><span class="expr"> js-wizzi-conditional-expression</span></li><li class="L3"><span class="pnl">        </span><span class="tag">...</span><span class="pln"> nodeb ranch ...</span></li><li class="L4"><span class="pnl">    </span><span class="kwd">$elif</span><span class="expr"> js-wizzi-conditional-expression</span></li><li class="L5"><span class="pnl">        </span><span class="tag">...</span><span class="pln"> nodeb ranch ...</span></li><li class="L6"><span class="pnl">    </span><span class="kwd">$else</span><span class="pln"> empty-value</span></li><li class="L7"><span class="pnl">        </span><span class="tag">...</span><span class="pln"> nodeb ranch ...</span></li></ol></pre><p>Children node are included/excluded depending on the value of the conditional-expression, written in Js-Wizzi.</p><h3>$foreach statement</h3><p>Format:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">...</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$foreach</span><span class="pln"> item-name in collection-name</span></li><li class="L3"><span class="pnl">        </span><span class="tag">...</span><span class="pln"> node branch ...</span></li></ol></pre><p>This is a repeat template where item-name is user defined and collection-name is a Js-Wizzi expression that evaluates to an iterable.</p><p>The var statement that declares item-name is auto-generated.</p><p>Descendant nodes are repeated having item-name as a context value in scope.</p><h3>$break, $continue</h3><p>Format:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">...</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$break</span><span class="pln"> empty-value</span></li><li class="L3"><span class="pnl">    </span><span class="tag">...</span><span class="pln"> </span></li><li class="L4"><span class="pnl">    </span><span class="kwd">$continue</span><span class="pln"> empty-value</span></li></ol></pre><p>This statements have the same meaning than in javascript but operate breaking or continuing the template repetition.</p><p>Currently a label for continuation is not implemented.</p><h3>$while</h3><p>Format:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">...</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$while</span><span class="pln"> js-wizzi-conditional-expression</span></li><li class="L3"><span class="pnl">        </span><span class="tag">...</span><span class="pln"> node branch ...</span></li><li class="L4"><span class="pnl">        </span><span class="kwd">$</span><span class="expr"> js-wizzi-exit-condition-change</span></li></ol></pre><p>This is a repeat template statement where descendant nodes are repeated until the js-wizzi-conditional-expression evaluates to false.</p><p>$ or $global command nodes must be used to modify the context values of the exit condition. There is a limit of 10000 iterations to guard against accidental loops, after that an exception is raised.</p><h3>$ comman node</h3><p>Allow manipulation of the template context.</p><p>May declare and modify template context variables that have ittf document scope.</p><div>May modify template context variables that have global scope.</div><div>Statements are js-wizzi instructions.</div><p>Single line format:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">...</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$</span><span class="expr"> js-wizzi-statement</span></li></ol></pre><p>Multi-line format:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="kwd">$</span><span class="expr"> </span></li><li class="L2"><span class="pnl">    </span><span class="expr">js-wizzi-statement</span><span class="expr"> </span></li><li class="L3"><span class="pnl">    </span><span class="expr">js-wizzi-statement</span><span class="expr"> </span></li><li class="L4"><span class="pnl">    </span><span class="expr">...</span><span class="expr"> </span></li></ol></pre><h3>$global command node</h3><p>May declare and modify template context variables of the global scope.</p><div>Statements are js-wizzi instructions.</div><p>Single line format:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">...</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$global</span><span class="pln"> js-wizzi-statement</span></li></ol></pre><p>Multi-line format:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="kwd">$global</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="expr">js-wizzi-statement</span><span class="expr"> </span></li><li class="L3"><span class="pnl">    </span><span class="expr">js-wizzi-statement</span><span class="expr"> </span></li><li class="L4"><span class="pnl">    </span><span class="expr">...</span><span class="expr"> </span></li></ol></pre></div>
                <h2 id="concept-3" class="concept">Path resolution of mixin and include documents</h2>
                <div class="summary">
                    <p>When IttfDocuments are included or mixed-in, given {path current-dir{path} as the path of the including or mixing IttfDocument, they are searched (in order):</p><ul>    <li>in the {path current-dir{path} folder;    </li><li>in the {path current-dir{path}/t folder;    </li><li>in the folder named {path t{path} of the parent folder of the {path current-dir{path};    </li><li>in the folder named {path t{path} of the ancestor folders of the {path current-dir{path}.    </li></ul><p>Given this folder structure</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">folder-a</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">t</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">layout.html.ittf</span><span class="pln"> </span></li><li class="L4"><span class="pnl">    </span><span class="tag">folder-b</span><span class="pln"> </span></li><li class="L5"><span class="pnl">        </span><span class="tag">t</span><span class="pln"> </span></li><li class="L6"><span class="pnl">            </span><span class="tag">dialog.html.ittf</span><span class="pln"> </span></li><li class="L7"><span class="pnl">        </span><span class="tag">my-home-page.html.ittf</span><span class="pln"> </span></li></ol></pre><p>The IttfDocument my-home-page.html.ittf could be:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="mix">layout(</span><span class="pln"> home )</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$include</span><span class="pln"> dialog( )</span></li></ol></pre></div>
                <h2 id="concept-4" class="concept">t-folders</h2>
                <div class="summary">
                    <p>Mixin and include ittf document have a special path resolution algorithm when they are located in folders named 't', that we call t-folders.</p><p>The mTree loader path finder method, when cannot resolve a path for a mixin or include document, searches the documents in 't' folders just like nodejs searches a module in 'node_modules' folders.</p></div>
                <h2 id="concept-5" class="concept">JsWizzi</h2>
                <div class="summary">
                    <p>JsWizzi is a subset of the ECMA-262 javascript standard used by the wizzi factory for processing ittf documents and buildup mTrees. JsWizzi is built on the quite efficent <a href="http://esprima.org/">esprima</a> parsing infrastructure and is run by a custom javascript engine (JsWizziRunner).</p><p>Ittf documents may contain Js-Wizzi statements in    <ul>        <li>The value part of domain nodes (ittf node values are interpolated)<pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">caption</span><span class="pln"> ${ name.capitalize() {}</span></li></ol></pre>        </li><li>Conditional expression of $if, $elif, $while command nodes<pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="kwd">$if</span><span class="expr"> name.substring(1,2) === 'is'</span></li></ol></pre>        </li><li>Collection name of $foreach command node<pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="kwd">$foreach</span><span class="pln"> item in model.getCollection('alfa')</span></li></ol></pre>        </li><li>Body of $ and $global command nodes<pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="kwd">$</span><span class="expr"> var beta = 100</span></li></ol></pre>        </li>    </ul></p><p>Sample JsWizzi expressions and statements.<pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">ul</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$</span><span class="expr"> var i = 0;</span></li><li class="L3"><span class="pnl">    </span><span class="kwd">$while</span><span class="pln"> i &lt; 10</span></li><li class="L4"><span class="pnl">        </span><span class="tag">li</span><span class="pln"> counting ${i}</span></li><li class="L5"><span class="pnl">        </span><span class="kwd">$</span><span class="expr"> i++;</span></li></ol></pre></p><p>The esprima syntax tree format is expected to be compatible with the Mozilla SpiderMonkey Parser API.</p><h4>Node types implemented by JsWizzi:</h4><ul>    <li>VariableDeclaration    </li><li>Statements        <ul>            <li>EmptyStatement            </li><li>ExpressionStatement            </li><li>IfStatement            </li><li>WhileStatement            </li><li>DoWhileStatement            </li><li>ForStatement            </li><li>ForInStatement            </li><li>BreakStatement            </li><li>ContinueStatement            </li><li>ReturnStatement            </li>        </ul>    </li><li>Expressions        <ul>            <li>UnaryExpression: !            </li><li>BinaryExpression: +. -, *, /, ==, ===, !=, !==, >=, >, <=, <            </li><li>UpdateExpressions: ++, --            </li><li>LogicalExpression: &&, ||            </li><li>ConditionalExpression: test ? consequent : alternate            </li><li>CallExpression            </li><li>MemberExpression            </li><li>AssignmentExpression: =, *=, /=, %=, +=, -=, <<=, >>=, >>>=, &=, ^=, |=            </li><li>ArrayExpression            </li><li>ObjectExpression            </li><li>FunctionCall            </li>        </ul>    </li><li>FunctionDeclaration        <div>Simple function declaration. No prototypes. No function objects; functions cannot be built by code and used like objects.        </div>    </li></ul></div>
                <h2 id="concept-6" class="concept">Wizzi model javascript module</h2>
                <div class="summary">
                    <p>Wizzi models are javascript document object models, inspired by Xml document objects, that may validate and load an mTree.</p><p>A javascript implementation of a wizzi model is a set of software artifacts generated by the 'wizzi-core' plugin using the schema 'wfschema' and the artifact generators:    <li>'wfschema/factory'    </li><li>'wfschema/model'    </li><li>'wfschema/html_doc'    </li><li>'wfschema/json_doc'    </li></p></div>
                <h2 id="concept-7" class="concept">The &lt;schema-name&gt;-factory.g.js module</h2>
                <div class="summary">
                    <p>The javascript module &lt;schema-name&gt;-factory.g.js export the method for instantiating a wizzi model instance.</p><h4>&lt;schema-name&gt;-factory.g.js interface</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">createLoadModel</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> wizziPackage</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> </span></li><li class="L5"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> Load a wizzi model of type &lt;schema-name&gt; from an IttfDocument uri</span></li><li class="L6"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> </span></li><li class="L7"><span class="pnl">            </span><span class="tag">function</span><span class="pln"> loadModel</span></li><li class="L8"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> ittfDocumentUri</span></li><li class="L9"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> context</span></li><li class="L0"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> callback</span></li></ol></pre></div>
                <h2 id="concept-8" class="concept">The &lt;schema-name&gt;-model.g.js module</h2>
                <div class="summary">
                    <p>The javascript module &lt;schema-name&gt;-model.g.js contains the classes that implement a wizzi model    <li>wzSourceLineInfo - a source map item</li><li>&lt;schema-name&gt;Exception - exception object for this wizzi model    </li><li>&lt;schema-name&gt;Context - context object for methods wzInitialize and wzVerify    </li><li>&lt;schema-name&gt;Base - base class for all element classes    </li><li>&lt;element-name&gt; for each element of the schema    </li></p><h4>The wzSourceLineInfo interface</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">class</span><span class="pln"> wzSourceLineInfo</span></li><li class="L2"><span class="pnl">    </span><span class="tag">ctor</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> row</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> col</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> sourceKey</span></li><li class="L6"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> toString</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> instance?</span></li></ol></pre><h4>The &lt;schema-name&gt;Exception interface</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">class</span><span class="pln"> &lt;schema-name&gt;Exception</span></li><li class="L2"><span class="pnl">    </span><span class="tag">ctor</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> instance</span></li></ol></pre><h4>The &lt;schema-name&gt;Context interface</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">class</span><span class="pln"> &lt;schema-name&gt;Context</span></li><li class="L2"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> schemaIsValid</span></li><li class="L3"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> addError</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L6"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> verifyEnum</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> valueType</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> valueName</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> allowed</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li></ol></pre><h4>The &lt;schema-name&gt;Base interface</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">class</span><span class="pln"> &lt;schema-name&gt;Base</span></li><li class="L2"><span class="pnl">    </span><span class="tag">ctor</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> the node value of the source mTree node</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> that becomes the wzName of the newly created element</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> an istance of wzSourceLineInfo</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> sourceLineInfo</span></li><li class="L8"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Return the model root element</span></li><li class="L0"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> wzRoot</span></li><li class="L1"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Return an ittf source document file path given its 'sourceKey'</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> @{param} sourceKey</span></li><li class="L4"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> wzSourceFilepath</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> sourceKey</span></li><li class="L6"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Add a child node to the wzChildren collection</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> TODO when is this used ???</span></li><li class="L9"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> wzAddChild</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L1"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Creates a new element given its type and its mTree source node.</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Append it to the given coll parameter.</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Call the loadFromNode method of the newly created element</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> with the mTree source node as argument.</span></li><li class="L6"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> wzLoadToChildColl</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> child_mTreeNode</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> type</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> coll</span></li><li class="L0"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Creates a new element given its type and its mTree source node.</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Append it to the wzChildren collection.</span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Call the loadFromNode method of the newly created element</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> with the mTree source node as argument.</span></li><li class="L5"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> wzLoadToChildren</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> child_mTreeNode</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> type</span></li><li class="L8"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L9"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Creates a new element given its type and its mTree source node.</span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Assign it to the &lt;fieldName&gt; property.</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Call the loadFromNode method of the newly created element</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> with the mTree source node as argument.</span></li><li class="L3"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> wzLoadOneToOne</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> child_mTreeNode</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> type</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> fieldName</span></li><li class="L7"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> throw a &lt;schema-name&gt;Exception</span></li><li class="L9"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> error</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L1"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li></ol></pre><h4>The &lt;element-name&gt; interface</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">class</span><span class="pln"> &lt;element-name&gt;</span></li><li class="L2"><span class="pnl">    </span><span class="tag">ctor</span><span class="pln"> </span></li><li class="L3"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Tests if the mTree node name is a valid child element or attribute.</span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> If yes call the proper add method and return true.</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> If no return false.</span></li><li class="L7"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> loadChild</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> child_mTreeNode</span></li><li class="L9"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Calls the loadChild method on this element</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> for each child node of the mTree node to load.</span></li><li class="L2"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> loadFromNode</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> mTreeNode</span></li><li class="L4"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Initialize the element</span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Called after the source mTree has been succesfully loaded.</span></li><li class="L7"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> wzInitialize</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> An istance of &lt;schema-name&gt;Context</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L0"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Verify if the element is valid</span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Called after the initialize method.</span></li><li class="L3"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> wzVerify</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> An istance of &lt;schema-name&gt;Context</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> ctx</span></li></ol></pre></div>
                <h2 id="concept-9" class="concept">Artifact generator</h2>
                <div class="summary">
                    <p>An artifact using the code write method has no template.</p><p>The ArtifactGenerator exposed to the Wizzi Factory is a node.js module that contains the statements for generating the artifact writing its content into the ArtifactGenerationContext that is passed to the ArtifactGenerator as a parameter by the ProductionManager.</p><p>The CodeWriteArtifact module must be named main.js and must have this location in the WizziFactoryPackage:</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">node_modules</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">&lt;package-name&gt</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">lib</span><span class="pln"> </span></li><li class="L4"><span class="pnl">            </span><span class="tag">artifacts</span><span class="pln"> </span></li><li class="L5"><span class="pnl">                </span><span class="tag">&lt;wizzischema-name&gt</span><span class="pln"> </span></li><li class="L6"><span class="pnl">                    </span><span class="tag">&lt;artifact-name&gt</span><span class="pln"> </span></li><li class="L7"><span class="pnl">                        </span><span class="tag">gen</span><span class="pln"> </span></li><li class="L8"><span class="pnl">                            </span><span class="tag">main.js</span><span class="pln"> </span></li></ol></pre><p>The path &lt;wizzischema-name&gt/&lt;artifact-name&gt must be unique in the Wizzi Factory and is the value to be declared in the generator attribute of the artifact element of a wfjob document.</p><p>For example</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">wfjob</span><span class="pln"> job-name</span></li><li class="L2"><span class="pnl">    </span><span class="tag"></span><span class="pln"> </span></li><li class="L3"><span class="pnl">    </span><span class="tag">line</span><span class="pln"> line-name</span></li><li class="L4"><span class="pnl">        </span><span class="tag">artifact</span><span class="pln"> artifact-name</span></li><li class="L5"><span class="pnl">            </span><span class="tag">...</span><span class="pln"> </span></li><li class="L6"><span class="pnl">            </span><span class="tag">generator</span><span class="pln"> &lt;wizzischema-name&gt/&lt;artifact-name&gt</span></li><li class="L7"><span class="pnl">            </span><span class="tag">...</span><span class="pln"> </span></li></ol></pre></div>
                <h2 id="concept-10" class="concept">The gencontext object</h2>
                <div class="summary">
                    <p>An artifact generator must respect a folder structure and an interface.</p><h3>The artifact generator interface</h3><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">gen</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> model</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> gencontext</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> callback</span></li></ol></pre><p>The production manager passes a model and and an empty gencontext to the generator and expect to receive the gencontext containing the generated artifact in the callback.</p><p>The gencontext is an in-memory text writer enhanced with helper methods usefull for code write artifact generation. It may contain also an optional artifact context object.</p><h4>The interface of the gencontext object</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag"></span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Set line indentation to a given value</span></li><li class="L4"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> forceIndent</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L6"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Increase line indentation</span></li><li class="L8"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> indent</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L0"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Decrease line indentation</span></li><li class="L2"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> deindent</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L4"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L5"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Add a named value to the interpolation context</span></li><li class="L6"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> a</span></li><li class="L7"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> value</span></li><li class="L9"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Add a named value from the interpolation context</span></li><li class="L1"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> g</span></li><li class="L2"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L3"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Remove a named value from the interpolation context</span></li><li class="L5"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> r</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L7"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Write a text with interpolation and line feed</span></li><li class="L9"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> w</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L1"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L2"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Write a text with interpolation without line feed</span></li><li class="L3"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> write</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> text</span></li><li class="L5"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L6"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> throw a NodeError exception</span></li><li class="L7"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> error</span></li><li class="L8"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L9"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li><li class="L0"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> throw an ArtifactGenerationError exception</span></li><li class="L2"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> artifactGenerationError</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> message</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> location</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> node</span></li></ol></pre></div>
                <h2 id="concept-11" class="concept">Sample artifact generators</h2>
                <div class="summary">
                    <h4>Code write artifact generator sample</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">module</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag"></span><span class="pln"> </span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> md = module.exports = {}</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> myname = 'artifact rdbms.sqltables.main';</span></li><li class="L6"><span class="pnl">    </span><span class="tag"></span><span class="pln"> </span></li><li class="L7"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.gen</span></li><li class="L8"><span class="pnl">        </span><span class="tag">function</span><span class="pln"> </span></li><li class="L9"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> model</span></li><li class="L0"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L2"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> model.wzElement !== 'rdbms'</span></li><li class="L3"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> </span></li><li class="L4"><span class="pnl">                    </span><span class="tag">callback</span><span class="pln"> </span></li><li class="L5"><span class="pnl">                        </span><span class="tag">_ctx.error</span><span class="pln"> </span></li><li class="L6"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> myname + " error: the model paramater should be an 'rdbms' wizzi model"</span></li><li class="L7"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> model</span></li><li class="L8"><span class="pnl">            </span><span class="tag"></span><span class="pln"> </span></li><li class="L9"><span class="pnl">            </span><span class="kwd">$foreach</span><span class="pln"> table in model.tables</span></li><li class="L0"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ctx.a('TABLE', table.wzName)</span></li><li class="L1"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> ctx.w('declare table TABLE')</span></li><li class="L2"><span class="pnl">                </span><span class="tag">...</span><span class="pln"> </span></li><li class="L3"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> callback(null, ctx)</span></li></ol></pre><h4>Ittf document artifact generator sample</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">module</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag"></span><span class="pln"> </span></li><li class="L4"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> path = require('path')</span></li><li class="L5"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> wizzi = require('wizzi')</span></li><li class="L6"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> md = module.exports = {}</span></li><li class="L7"><span class="pnl">    </span><span class="tag">var</span><span class="pln"> myname = 'artifact rdbms.sqltables.main';</span></li><li class="L8"><span class="pnl">    </span><span class="tag"></span><span class="pln"> </span></li><li class="L9"><span class="pnl">    </span><span class="tag">set</span><span class="pln"> md.gen</span></li><li class="L0"><span class="pnl">        </span><span class="tag">function</span><span class="pln"> </span></li><li class="L1"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> model</span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L3"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L4"><span class="pnl">            </span><span class="tag">if</span><span class="pln"> model.wzElement !== 'rdbms'</span></li><li class="L5"><span class="pnl">                </span><span class="tag">return</span><span class="pln"> </span></li><li class="L6"><span class="pnl">                    </span><span class="tag">callback</span><span class="pln"> </span></li><li class="L7"><span class="pnl">                        </span><span class="tag">_ctx.error</span><span class="pln"> </span></li><li class="L8"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> myname + " error: the model paramater should be an 'rdbms' wizzi model"</span></li><li class="L9"><span class="pnl">                            </span><span class="tag">@</span><span class="pln"> model</span></li><li class="L0"><span class="pnl">            </span><span class="tag"></span><span class="pln"> </span></li><li class="L1"><span class="pnl">            </span><span class="tag">var</span><span class="pln"> ittfTemplatePath</span></li><li class="L2"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> path.join</span></li><li class="L3"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> __dirname</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'ittf'</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> 'sqltables.sql.ittf'</span></li><li class="L6"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> wizzi.fsnoaclFactory</span></li><li class="L7"><span class="pnl">                </span><span class="tag">#</span><span class="pln"> TODO</span></li><li class="L8"><span class="pnl">            </span><span class="tag">_</span><span class="pln"> callback(null, ctx)</span></li></ol></pre></div>
                <h2 id="concept-12" class="concept">Plugin</h2>
                <div class="summary">
                    <h4>A wizzi plugin implements and exposes to the wizzi factory</h4><ul>    <li>wizzi schemas and relative factories for wizzi models    </li><li>model transformers    </li><li>artifact generators    </li></ul><h4>A plugin package must export this method</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">set</span><span class="pln"> module.exports</span></li><li class="L2"><span class="pnl">    </span><span class="tag"></span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">...</span><span class="pln"> </span></li><li class="L4"><span class="pnl">        </span><span class="tag">@</span><span class="pln"> createFactoryPlugin</span></li><li class="L5"><span class="pnl">            </span><span class="tag">function</span><span class="pln"> </span></li><li class="L6"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> wizziPackage</span></li><li class="L7"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> options</span></li><li class="L8"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> callback</span></li><li class="L9"><span class="pnl">                </span><span class="tag">var</span><span class="pln"> plugin</span></li><li class="L0"><span class="pnl">                    </span><span class="tag">new</span><span class="pln"> FactoryPlugin</span></li><li class="L1"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> wizziPackage</span></li><li class="L2"><span class="pnl">                        </span><span class="tag">@</span><span class="pln"> this.provides</span></li><li class="L3"><span class="pnl">                </span><span class="tag">_</span><span class="pln"> plugin.initialize</span></li><li class="L4"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> options</span></li><li class="L5"><span class="pnl">                    </span><span class="mix">f_cb(</span><span class="pln"> notUsed )</span></li><li class="L6"><span class="pnl">                        </span><span class="tag">return</span><span class="pln"> </span></li><li class="L7"><span class="pnl">                            </span><span class="tag">_</span><span class="pln"> callback</span></li><li class="L8"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> null</span></li><li class="L9"><span class="pnl">                                </span><span class="tag">@</span><span class="pln"> plugin</span></li></ol></pre><p>The FactoryPlugin class instance returned to the caller must implement the plugin API.</p><p>The standard folder structure of a plugin</p><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">node_modules</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">&lt;package-name&gt</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">lib</span><span class="pln"> </span></li><li class="L4"><span class="pnl">            </span><span class="tag">artifacts</span><span class="pln"> </span></li><li class="L5"><span class="pnl">                </span><span class="tag">&lt;schema-name&gt</span><span class="pln"> </span></li><li class="L6"><span class="pnl">                    </span><span class="tag">&lt;artifact-name&gt</span><span class="pln"> </span></li><li class="L7"><span class="pnl">                        </span><span class="tag">gen</span><span class="pln"> </span></li><li class="L8"><span class="pnl">                            </span><span class="tag">main.js</span><span class="pln"> </span></li><li class="L9"><span class="pnl">                    </span><span class="tag">...</span><span class="pln"> </span></li><li class="L0"><span class="pnl">                    </span><span class="tag">&lt;transformer-name&gt</span><span class="pln"> </span></li><li class="L1"><span class="pnl">                        </span><span class="tag">trans</span><span class="pln"> </span></li><li class="L2"><span class="pnl">                            </span><span class="tag">main.js</span><span class="pln"> </span></li><li class="L3"><span class="pnl">                    </span><span class="tag">...</span><span class="pln"> </span></li><li class="L4"><span class="pnl">                </span><span class="tag">...</span><span class="pln"> </span></li><li class="L5"><span class="pnl">            </span><span class="tag">utils</span><span class="pln"> </span></li><li class="L6"><span class="pnl">                </span><span class="tag">...</span><span class="pln"> </span></li><li class="L7"><span class="pnl">            </span><span class="tag">wizzi</span><span class="pln"> </span></li><li class="L8"><span class="pnl">                </span><span class="tag">models</span><span class="pln"> </span></li><li class="L9"><span class="pnl">                    </span><span class="tag">&lt;schema-name&gt;-model.g.js</span><span class="pln"> </span></li><li class="L0"><span class="pnl">                    </span><span class="tag">&lt;schema-name&gt;-factory.g.js</span><span class="pln"> </span></li><li class="L1"><span class="pnl">                    </span><span class="tag">&lt;schema-name&gt;-schema.g.html</span><span class="pln"> </span></li><li class="L2"><span class="pnl">                    </span><span class="tag">&lt;schema-name&gt;-schema.g.json</span><span class="pln"> </span></li><li class="L3"><span class="pnl">                    </span><span class="tag">...</span><span class="pln"> </span></li><li class="L4"><span class="pnl">                </span><span class="tag">schemas</span><span class="pln"> </span></li><li class="L5"><span class="pnl">                    </span><span class="tag">&lt;schema-name&gt;.wfschema.ittf</span><span class="pln"> </span></li><li class="L6"><span class="pnl">                    </span><span class="tag">...</span><span class="pln"> </span></li><li class="L7"><span class="pnl">        </span><span class="tag">index.js</span><span class="pln"> </span></li></ol></pre></div>
                <h2 id="concept-13" class="concept">Plugin API</h2>
                <div class="summary">
                    <h4>Plugin api implemented by a FactoryPlugin class.</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag"></span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Retrieve a wizzi model factory by its wizzischema name</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Searching in this wizzi package. No search up in "node_modules" folders.</span></li><li class="L5"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> getModelFactory</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> schemaName</span></li><li class="L7"><span class="pnl">        </span><span class="tag">...</span><span class="pln"> </span></li><li class="L8"><span class="pnl">    </span><span class="tag"></span><span class="pln"> </span></li><li class="L9"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L0"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Retrieve a model transformer by its name</span></li><li class="L1"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Searching in this wizzi package. No search up in "node_modules" folders.</span></li><li class="L2"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> getModelTransformer</span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> transformerName</span></li><li class="L4"><span class="pnl">        </span><span class="tag">...</span><span class="pln"> </span></li><li class="L5"><span class="pnl">    </span><span class="tag"></span><span class="pln"> </span></li><li class="L6"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L7"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Retrieve an artifact generator by its name</span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Searching in this wizzi package. No search up in "node_modules" folders.</span></li><li class="L9"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> getArtifactGenerator</span></li><li class="L0"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> generationName</span></li><li class="L1"><span class="pnl">    </span><span class="tag"></span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">#</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Retrieve a wizzi schema definition in JSON format</span></li><li class="L4"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> Searching in this wizzi package. No search up in "node_modules" folders.</span></li><li class="L5"><span class="pnl">    </span><span class="tag">m</span><span class="pln"> getSchemaDefinition</span></li><li class="L6"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> schemaName</span></li></ol></pre><h4>Api of the object returned by getModelFactory</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">createLoadModel</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> wizziObject</span></li><li class="L4"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> loadMTree = wizziObject.loadMTree</span></li><li class="L5"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> file = wizziObject.file</span></li><li class="L6"><span class="pnl">        </span><span class="tag">var</span><span class="pln"> errors = wizziObject.errors</span></li><li class="L7"><span class="pnl">        </span><span class="tag">...</span><span class="pln"> </span></li><li class="L8"><span class="pnl">        </span><span class="tag">#</span><span class="pln"> </span></li><li class="L9"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> Load a wizzi model of type &lt;schema-nam&gt; from an IttfDocument uri</span></li><li class="L0"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> @param {String} ittfDocumentUri</span></li><li class="L1"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> @param {Object} context - the loading context object</span></li><li class="L2"><span class="pnl">            </span><span class="tag">#</span><span class="pln"> @param {Function} callback</span></li><li class="L3"><span class="pnl">        </span><span class="tag">return</span><span class="pln"> </span></li><li class="L4"><span class="pnl">            </span><span class="tag">function</span><span class="pln"> loadModel</span></li><li class="L5"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> ittfDocumentUri</span></li><li class="L6"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> context</span></li><li class="L7"><span class="pnl">                </span><span class="tag">param</span><span class="pln"> callback</span></li></ol></pre><h4>Api of the object returned by getModelTransformer</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">trans</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> model</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> callback</span></li></ol></pre><h4>Api of the object returned by getArtifactGenerator</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">gen</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">function</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> model</span></li><li class="L4"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> ctx</span></li><li class="L5"><span class="pnl">        </span><span class="tag">param</span><span class="pln"> callback</span></li></ol></pre><p>The object returned by getSchemaDefinition is a json representation of the requested schema.</p></div>
                <section></section>
            </div>
        </main>
        <script src="wizzifactory.js"></script>
    </body>

</html>
