<!doctype html>
<html VERSION-5="5" VERSION-4="4" version="5">
    <head>
        <title>The Wizzi Factory</title>
        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
        <link href="normalize.css" rel="stylesheet">
        <link href="wizzifactory.css" rel="stylesheet">
    </head>
    <body>
        <a href="https://github.com/wizzifactory"><img style="position: fixed; top: 0; right: 0; border: 0; z-index: 100;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png">
        </a>
        <header class="header" role="banner">
            <div class="header-logo">
                <a class="logo" href="index.html">Wizzi Factory</a>
            </div>
            <nav role="navigation" class="header-items">
                <a class="selected-header-item" href="overview.html">Overview</a>
                <a class="header-item" href="starter.html">Starters</a>
                <a class="header-item" href="docs.html">Docs</a>
                <a class="header-item" href="specs.html">Specs</a>
                <a class="header-item" href="wf-api.html">Api</a>
                <a class="header-item" href="labs.html">Labs</a>
                <a class="header-item" href="project.html">Project</a>
                <a class="header-item" href="contribs.html">Contribs</a>
            </nav>
        </header>
        <main>
            <div class="main-sidebar-left">
                <section id="main-toc" class="toc">
                    <h3>Contents:</h3>
                    <ol>
                        <li><a href="#intro">Introduction</a>
                        </li>
                        <li><a>Concepts</a>
                        <ol>
                            <li><a href="#concept-1">mTree (wizzi magical tree)</a>
                            </li>
                            <li><a href="#concept-2">Ittf document</a>
                            </li>
                            <li><a href="#concept-3">Wizzi model</a>
                            </li>
                            <li><a href="#concept-4">Wizzi schema</a>
                            </li>
                            <li><a href="#concept-5">Language schema</a>
                            </li>
                            <li><a href="#concept-6">Model transformer</a>
                            </li>
                            <li><a href="#concept-7">Artifact generator</a>
                            </li>
                            <li><a href="#concept-8">Wizzi job</a>
                            </li>
                        </ol>
                        </li>
                        <li><a>Samples</a>
                        <ol></ol>
                        </li>
                    </ol>
                </section>
            </div>
            <div class="main-content">
                <section>
                    <h1>Concepts</h1>
                    <div class="summary">
                        <p>The wizzi factory, is a model driven artifacts generator that generates its next version.</p><p>Its goal is to simplify, speed, improve, automate and document its autogeneration process.</p><p>The belief is that succeding in improving its autogeneration, will make it successfully reusable for any other usefull generation purpose. At least evolution has taught us that this makes sense.</p><p>For any of its operations the wizzi factory uses one basic concept/tool: the wizzi magical tree, or mTree for short.</p><p>Therefore, before considering artifact generation concepts, we need to get acquainted with an mTree.</p></div>
                    <h2 id="concept-1">mTree (wizzi magical tree)</h2>
                    <div class="summary">
                        <p>An mTree is an in-memory tree data structure that is built processing a textual template, coded in a text editor of choice.</p><p>The wizzi factory uses an mTree like a flexible AST, that can be relaxed or strictly schemed depending on artifact generations needs.</p><p>We have to examine the textual representation of an mTree and how it can be schemed in order to ease the artifact generation process.</p><p>In this regard we introduce ittf documents and wizzi models.</p></div>
                    <h2 id="concept-2">Ittf document</h2>
                    <div class="summary">
                        <p>Ittf, short for Indented Text Tree Format, is the textual notation format of an mTree. An Ittf document is a syntax tree, codified in a text document, where child nodes are indented to their parent.</p><h4>Example of ittf document</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">html</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">body</span><span class="pln"> </span></li><li class="L3"><span class="pnl">        </span><span class="tag">ul</span><span class="pln"> </span></li><li class="L4"><span class="pnl">            </span><span class="tag">li</span><span class="pln"> </span></li><li class="L5"><span class="pnl">                </span><span class="tag">a</span><span class="pln"> The Wizzi Factory</span></li><li class="L6"><span class="pnl">                    </span><span class="tag">href</span><span class="pln"> https://wizzifactory.github.io</span></li></ol></pre><p>Every line is a node consisting of a name value pair. The name is the first string of chars of the line and is separated from the value by a space or a tab.</p><p>The node name can be a domain tag with a semantic meaning or a node command for the template processor. The node value may contain expressions that are evaluated during value interpolation.</p><p>An ittf document is a template and when loaded for building an mTree we can pass a context object to the mTree loader.</p><p>Ittf documents are full templates and even the root node may be a command node that invokes the mixup of its container.</p><h4>Example of a root node that is a mixin inclusion command.</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">layout()</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$append</span><span class="pln"> appbar</span></li><li class="L3"><span class="pnl">        </span><span class="tag">ul</span><span class="pln"> </span></li><li class="L4"><span class="pnl">            </span><span class="kwd">$foreach</span><span class="pln"> item in menulist</span></li><li class="L5"><span class="pnl">                </span><span class="tag">li</span><span class="pln"> </span></li><li class="L6"><span class="pnl">                    </span><span class="tag">a</span><span class="pln"> ${item.name}</span></li><li class="L7"><span class="pnl">                        </span><span class="tag">href</span><span class="pln"> ${item.path}</span></li><li class="L8"><span class="pnl">    </span><span class="tag">.</span><span class="pln"> wrapper</span></li><li class="L9"><span class="pnl">        </span><span class="tag">.</span><span class="pln"> content</span></li></ol></pre><h4>Ittf document types</h4><ul>    <li>primary    </li><li>mixin    </li><li>include    </li></ul><p>A primary ittf document is the entry point of an mTree buildup.</p><p>A mixin can receive parameters.</p><p>An include is inserted as is and may not receive parameters.</p><h4>Example of a mixin ittf document.</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">li</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$params</span><span class="pln"> text, href</span></li><li class="L3"><span class="pnl">    </span><span class="tag">a</span><span class="pln"> ${text}</span></li><li class="L4"><span class="pnl">        </span><span class="tag">href</span><span class="pln"> ${href}</span></li></ol></pre><h4>Example of an include ittf document.</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">div</span><span class="pln"> License MIT</span></li><li class="L2"><span class="pnl">    </span><span class="tag">span</span><span class="pln"> copy Stefano Bassoli.</span></li></ol></pre><p></p><p>We have now to examine how an mTree can be transformed in a schemed (typed) model that we call wizzi model.</p></div>
                    <h2 id="concept-3">Wizzi model</h2>
                    <div class="summary">
                        <p>Wizzi models are javascript document object models, inspired by Xml document objects, that may validate and load an mTree.</p><p>Wizzi models are described in terms of elements, attributes and relations. An element is a classifier and a relation is a relationship between elements.</p><h4>In a wizzi model:</h4><ul>    <li>An element may have one super element (abstraction) and many derived elements (specializations), may be abstract or concrete and may have a name and attributes.    </li><li>Relationships are one-to-many (default) and one-to-one. They do not have attributes. Both imply ownership of contained (child) elements: arrays (one-to-many) and single child (one-to-one).    </li><li>An attribute has a name and a value of a primitive type.    </li></ul><h4>The tree structure of a wizzi model is mapped to a javascript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Introduction_to_Object-Oriented_JavaScript"> class</a>, where:</h4><ul>    <li>Elements are (pseudo)class functions.    </li><li>Attributes are properties, with a primitive type, of element classes.    </li><li>One-to-many relationships are array of element classes on the related element class.    </li><li>One-to-one relationships are element classes on the related element class.    </li><li>Attributes and relationships are inherited from super elements.    </li></ul><p>A wizzi model is an ideal object for a template context. It can expose properties and methods to the template processor and may speed up the construction of artifact generators.</p><p>The wizzi factory uses the concept of wizzi model to describe and generate the javascript module that implement a wizzi model.</p><p>As xml documents have xml schemas as well a wizzi model has a wizzi schema.</p></div>
                    <h2 id="concept-4">Wizzi schema</h2>
                    <div class="summary">
                        <p>A wizzi schema describe the node structure to which an mTree must be conformant in order to be loaded into a wizzi model.</p><p>Wizzi models are artifacts generated transforming a wizzi schema.</p><p>A wizzi schema is itself a wizzi model of schema 'wfschema' and is itself created coding an ittf document, like any wizzi model.</p><h3>Example of wizzi schema</h3><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">wfschema</span><span class="pln"> rdbms</span></li><li class="L2"><span class="pnl">    </span><span class="tag">e</span><span class="pln"> catalog</span></li><li class="L3"><span class="pnl">        </span><span class="tag">r</span><span class="pln"> table/s</span></li><li class="L4"><span class="pnl">    </span><span class="tag">e</span><span class="pln"> table</span></li><li class="L5"><span class="pnl">        </span><span class="tag">r</span><span class="pln"> column/s</span></li><li class="L6"><span class="pnl">        </span><span class="tag">r</span><span class="pln"> index/es</span></li><li class="L7"><span class="pnl">    </span><span class="tag">e</span><span class="pln"> column</span></li><li class="L8"><span class="pnl">        </span><span class="tag">a</span><span class="pln"> type</span></li><li class="L9"><span class="pnl">        </span><span class="tag">a</span><span class="pln"> caption</span></li><li class="L0"><span class="pnl">        </span><span class="tag">a</span><span class="pln"> defaultValue</span></li><li class="L1"><span class="pnl">            </span><span class="tag">tag</span><span class="pln"> default</span></li><li class="L2"><span class="pnl">    </span><span class="tag">e</span><span class="pln"> index</span></li><li class="L3"><span class="pnl">        </span><span class="tag">a</span><span class="pln"> primary</span></li><li class="L4"><span class="pnl">            </span><span class="tag">type</span><span class="pln"> boolean</span></li><li class="L5"><span class="pnl">        </span><span class="tag">a</span><span class="pln"> unique</span></li><li class="L6"><span class="pnl">            </span><span class="tag">type</span><span class="pln"> boolean</span></li><li class="L7"><span class="pnl">        </span><span class="tag">r</span><span class="pln"> column/s</span></li></ol></pre><p>A Wizzi schema may target any domain: data, ui, code language, etc ...</p><p>The notation for elements and attributes may be abbreviated. The schema can assign a short mnemonic tag to elements and attributes.</p><p>A javascript module mapping a wizzi model is generated from a wizzi schema.</p><p>A wizzi model once loaded can perform actions. A schema can declare schema and element methods and global functions, that will be inserted in the generated javascript. Schema and element methods will have access to model instance data loaded from mTrees.</p><p>Two methods: wzInitialize and wzVerify, autogenerated, perform initialization and validation actions inferred from the schema and its constraints. Schema designers may define custom methods and/or add code lines to the wzInitialize and wzVerify methods.</p><p>So far we have seen how to represent the models that drive software productions. Now we should focus on artifact generation. Models may require transformations and we need model transformers. Complex generations may require a task manager and the wizzi factory offers the wizzi job schema and the production manager component.</p><p>Before proceding we must also consider the fact that the most part of artifact generators targets programming languages (PL) and not plain tree data structures. The wizzi factory wants to use the power of mTrees for PL also. For this purpose it has developed the concept of language schema, that is a wizzi schema describing an approximate synthax tree for a PL, like javascript, html, css and so on.</p><p>So our concepts begin to get strange and we have approximate synthax tree too. Life in software factories is not easy.</p></div>
                    <h2 id="concept-5">Language schema</h2>
                    <div class="summary">
                        <p>A language schema defines a tree structure that an artifact generator can transform targeting the synthax of a programming language (PL) grammar.</p><h4>Examples:</h4><ul>    <li>The js schema in the wizzi-js plugin.    </li><li>The html and css schemas in the wizzi-html plugin.    </li></ul><p>A language schema can be viewd as a profile of a PL Grammar that can be implemented partially, with some of its symbols stereotyped.</p><p>The schema developer should try to find the optimal balance between ease of use and completeness and define the proper approximation of the schema in respect to the PL grammar.</p><p>wizzi v3 is entirely coded using the 'js' wizzi schema implemented by the wizzi-js plugin.</p><h3>Example of a js ittf document (yes we know it is javascript).</h3><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">module</span><span class="pln"> </span></li><li class="L2"><span class="pnl">    </span><span class="tag">kind</span><span class="pln"> jsfile</span></li><li class="L3"><span class="pnl">    </span><span class="tag">class</span><span class="pln"> Horse</span></li><li class="L4"><span class="pnl">        </span><span class="tag">super</span><span class="pln"> Animal</span></li><li class="L5"><span class="pnl">        </span><span class="tag">ctor</span><span class="pln"> </span></li><li class="L6"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L7"><span class="pnl">            </span><span class="tag">base</span><span class="pln"> name</span></li><li class="L8"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> say</span></li><li class="L9"><span class="pnl">            </span><span class="tag">log</span><span class="pln"> 'Hiiii i am ' + this.name</span></li><li class="L0"><span class="pnl">        </span><span class="tag">m</span><span class="pln"> create</span></li><li class="L1"><span class="pnl">            </span><span class="tag">static</span><span class="pln"> </span></li><li class="L2"><span class="pnl">            </span><span class="tag">param</span><span class="pln"> name</span></li><li class="L3"><span class="pnl">            </span><span class="tag">return</span><span class="pln"> </span></li><li class="L4"><span class="pnl">                </span><span class="tag">new</span><span class="pln"> Horse</span></li><li class="L5"><span class="pnl">                    </span><span class="tag">@</span><span class="pln"> name</span></li></ol></pre></div>
                    <h2 id="concept-6">Model transformer</h2>
                    <div class="summary">
                        <p>mTrees and wizzi models can compose complex data structures mixing source and context data, but sometimes we need to preprocess our models before artifact generation.</p><p>A model trasformer is an interface exported by plugins and its implementation is free. Usually the implementor is a javascript program that receives in input a wizzi model or an mTree and returns a transformed model as a POJO object.</p><p>To be used in a production, model transformers must be packaged in a plugin respecting folder structure and interface.</p><p>The transformer interface allow the declaration (for example in a wizzi job), that a wizzi model or an mTree require a trasformation before using it as a context object.</p><p>The production manager retrieve the transformer from its plugin and invoke the transform method.</p></div>
                    <h2 id="concept-7">Artifact generator</h2>
                    <div class="summary">
                        <p>An artifact generator transforms a context object into a software artifact targetting a programming language or a data structure schema.</p><p>Like a model trasformer an artifact generator is an interface exported by plugins and its implementation is free. Usually the implementor is a javascript program that receives in input a wizzi model or an mTree and returns the text of the generated artifact. To be used in a production, artifact generators must be packaged in a plugin respecting folder structure and interface.</p><p>The wizzi job executor retrieve the artifact generator from its plugin and invoke the generation method.</p></div>
                    <h2 id="concept-8">Wizzi job</h2>
                    <div class="summary">
                        <p>The wizzi job is the task runner of the wizzi factory.</p><p>Software production processes can be quite complex and may require long chains of model loadings, transformations and artifact generations. A wizzi job defines how to load models and exectute transformations and productions.</p><p>Obviously a wizzi job is a wizzi model. It has schema 'wfjob' and is implemented in the wizzi-core plugin.</p><h4>Example of the wizzi job that produces this documentation html page.</h4><pre class="prettyprint"><ol class="linenums"><li class="L1"><span class="pnl"></span><span class="tag">wfjob</span><span class="pln"> wizzi-docs-concepts</span></li><li class="L2"><span class="pnl">    </span><span class="kwd">$</span><span class="expr"> </span></li><li class="L3"><span class="pnl">        </span><span class="expr">var</span><span class="expr"> models_folder     = path.join(__dirname, 'models');</span></li><li class="L4"><span class="pnl">        </span><span class="expr">var</span><span class="expr"> html_folder       = path.join(__dirname, 'html');</span></li><li class="L5"><span class="pnl">        </span><span class="expr">var</span><span class="expr"> dest_folder       = "c:/my/wizzi/github/wizzifactory.github.io";</span></li><li class="L6"><span class="pnl">    </span><span class="tag">models-base-folder</span><span class="pln"> ${models_folder}</span></li><li class="L7"><span class="pnl">    </span><span class="tag">model</span><span class="pln"> concepts</span></li><li class="L8"><span class="pnl">        </span><span class="tag">src</span><span class="pln"> concepts.docs.ittf</span></li><li class="L9"><span class="pnl">        </span><span class="tag">schema</span><span class="pln"> docs</span></li><li class="L0"><span class="pnl">    </span><span class="tag">line</span><span class="pln"> html</span></li><li class="L1"><span class="pnl">        </span><span class="tag">cwd-folder</span><span class="pln"> ${html_folder}</span></li><li class="L2"><span class="pnl">        </span><span class="mix">wfjob/art-wo-html(</span><span class="pln"> concepts.html.ittf )</span></li><li class="L3"><span class="pnl">            </span><span class="tag">model-ref</span><span class="pln"> concepts</span></li><li class="L4"><span class="pnl">                </span><span class="tag">transformer</span><span class="pln"> docs/preprint</span></li><li class="L5"><span class="pnl">    </span><span class="tag">production</span><span class="pln"> </span></li><li class="L6"><span class="pnl">        </span><span class="tag">dest-folder</span><span class="pln"> ${dest_folder}</span></li><li class="L7"><span class="pnl">        </span><span class="tag">line-ref</span><span class="pln"> html</span></li></ol></pre></div>
                </section>
                <section>
                    <h1>Samples</h1>
                    <article></article>
                </section>
            </div>
        </main>
        <script src="wizzifactory.js"></script>
    </body>

</html>
